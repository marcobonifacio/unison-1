<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, FlexibleContexts, TypeSynonymInstances #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-incomplete-uni-patterns #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-9"></span><span class="hs-comment">{-|

Module      :  Text.Regex.Base.Context
Copyright   :  (c) Chris Kuklewicz 2006
SPDX-License-Identifier: BSD-3-Clause

Maintainer  :  hvr@gnu.org, Andreas Abel
Stability   :  stable
Portability :  non-portable (MPTC+FD)

This is a module of instances of 'RegexContext' (defined in
&quot;Text.Regex.Base.RegexLike&quot;).  Nothing else is exported.  This is
usually imported via the &quot;Text.Regex.Base&quot; convenience package which
itself is re-exported from newer @Text.Regex.XXX@ modules provided by
the different @regex-xxx@ backends.

These instances work for all the supported types and backends
interchangeably.  These instances provide the different results that
can be gotten from a 'match' or 'matchM' operation (often via the @=~@ and
@=~~@ operators with combine 'makeRegex' with 'match' and 'matchM'
respectively).  This module name is @Context@ because they operators are
context dependent: use them in a context that expects an 'Int' and you
get a count of matches, use them in a 'Bool' context and get 'True' if
there is a match, etc.

@'RegexContext' a b c@ takes a regular expression suppied in a type @a@
generated by 'RegexMaker' and a target text supplied in type @b@ to a
result type @c@ using the 'match' class function.  The 'matchM' class
function works like 'match' unless there is no match found, in which
case it calls 'fail' in the (arbitrary) monad context.

There are a few type synonyms from &quot;Text.Regex.Base.RegexLike&quot; that are used here:

@
-- | 0 based index from start of source, or (-1) for unused
type MatchOffset = Int
-- | non-negative length of a match
type MatchLength = Int
type MatchArray = Array Int (MatchOffset, MatchLength)
type MatchText source = Array Int (source, (MatchOffset, MatchLength))
@

There are also a few newtypes that used to prevent any possible
overlap of types, which were not needed for GHC's late overlap
detection but are needed for use in Hugs.

@
newtype AllSubmatches     f b = AllSubmatches     { getAllSubmatches     :: f b }
newtype AllTextSubmatches f b = AllTextSubmatches { getAllTextSubmatches :: f b }
newtype AllMatches        f b = AllMatches        { getAllMatches        :: f b }
newtype AllTextMatches    f b = AllTextMatches    { getAllTextMatches    :: f b }
@

The newtypes' @f@ parameters are the containers, usually @[]@ or
@Array Int@, (where the arrays all have lower bound 0).

The two @Submatches@ newtypes return only information on the first
match.  The other two newtypes return information on all the
non-overlapping matches.  The two @Text@ newtypes are used to mark
result types that contain the same type as the target text.

Where provided, noncaptured submatches will have a 'MatchOffset' of
(-1) and non-negative otherwise.  The semantics of submatches depend
on the backend and its compile and execution options.  Where provided,
'MatchLength' will always be non-negative.  Arrays with no elements
are returned with bounds of (1,0).  Arrays with elements will have a
lower bound of 0.

XXX THIS HADDOCK DOCUMENTATION IS OUT OF DATE XXX

These are for finding the first match in the target text:


@ 'RegexContext' a b Bool @:
  Whether there is any match or not.


@ 'RegexContext' a b () @:
  Useful as a guard with @matchM@ or @=~~@ in a monad, since failure to match calls 'fail'.


@ 'RegexContext' a b b @:
  This returns the text of the whole match.
  It will return 'empty' from the 'Extract' type class if there is no match.
  These are defined in each backend module, but documented here for convenience.


@ 'RegexContext' a b ('MatchOffset', 'MatchLength') @:
  This returns the initial index and length of the whole match.
  MatchLength will always be non-negative, and 0 for a failed match.


@ 'RegexContext' a b ('MatchResult' b) @: The
  'MatchResult' structure with details for the match.  This is the
  structure copied from the old @JRegex@ pacakge.


@ 'RegexContext' a b (b, b, b) @:
  The text before the match, the text of the match, the text after the match


@ 'RegexContext' a b (b, 'MatchText' b, b) @:
  The text before the match, the details of the match, and the text after the match


@ 'RegexContext' a b (b, b, b, [b]) @:
  The text before the match, the text of the match, the text after the
  match, and a list of the text of the 1st and higher sub-parts of the
  match.  This is the same return value as used in the old
  @Text.Regex@ API.

Two containers of the submatch offset information:


@ 'RegexContext' a b 'MatchArray' @:
  Array of @('MatchOffset', 'MatchLength')@ for all the sub matches.
  The whole match is at the intial 0th index.
  Noncaptured submatches will have a @'MatchOffset'@ of (-1)
  The array will have no elements and bounds (1,0) if there is no match.


@ 'RegexContext' a b ('AllSubmatches' [] ('MatchOffset', 'MatchLength') @:
  List of @('MatchOffset', 'MatchLength')@
  The whole match is the first element, the rest are the submatches (if any) in order.
  The list is empty if there is no match.

Two containers of the submatch text and offset information:

@ 'RegexContext' a b ('AllTextSubmatches' (Array Int) (b, ('MatchOffset', 'MatchLength'))) @

@ 'RegexContext' a b ('AllTextSubmatches' [] (b, ('MatchOffset', 'MatchLength')))  @

Two containers of the submatch text information:

@ 'RegexContext' a b ('AllTextSubmatches' [] b) @

@ 'RegexContext' a b ('AllTextSubmatches' (Array Int) b) @

These instances are for all the matches (non-overlapping).  Note that
backends are supposed to supply 'RegexLike' instances for which the
default 'matchAll' and 'matchAllText' stop searching after returning
any successful but empty match.


@ 'RegexContext' a b Int @:
  The number of matches, non-negative.

Two containers for locations of all matches:

@ 'RegexContext' a b ('AllMatches' [] ('MatchOffset', 'MatchLength')) @

@ 'RegexContext' a b ('AllMatches' (Array Int) ('MatchOffset', 'MatchLength')) @

Two containers for the locations of all matches and their submatches:

@ 'RegexContext' a b ['MatchArray'] @

@ 'RegexContext' a b ('AllMatches' (Array Int) 'MatchArray') @

Two containers for the text and locations of all matches and their submatches:

@ 'RegexContext' a b ['MatchText' b] @

@ 'RegexContext' a b ('AllTextMatches' (Array Int) ('MatchText' b)) @

Two containers for text of all matches:
@ 'RegexContext' a b ('AllTextMatches' [] b) @

@ 'RegexContext' a b ('AllTextMatches' (Array Int) b) @

Four containers for text of all matches and their submatches:

@ 'RegexContext' a b [[b]] @

@ 'RegexContext' a b ('AllTextMatches' (Array Int) [b]) @

@ 'RegexContext' a b ('AllTextMatches' [] (Array Int b)) @

@ 'RegexContext' a b ('AllTextMatches' (Array Int) (Array Int b)) @

Unused matches are 'empty' (defined via 'Extract')

-}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.Base.Context</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- see 'regexFailed'</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">elems</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">listArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span class="hs-comment">--  import Data.Maybe(maybe)</span><span>
</span><span id="line-201"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html"><span class="hs-identifier">Text.Regex.Base.RegexLike</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier">RegexLike</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier">RegexContext</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier">AllSubmatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier">AllTextSubmatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier">AllMatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier">AllTextMatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchResult"><span class="hs-identifier">MatchResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier">Extract</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier">MatchLength</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier">MatchArray</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier">MatchText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">{-
-- Get the ByteString type for mood/doom
import Data.ByteString(ByteString)
-- Get the Regex types for the mood/doom workaround
import qualified Text.Regex.Lib.WrapPosix as R1(Regex)
import qualified Text.Regex.Lib.WrapPCRE as R2(Regex)
import qualified Text.Regex.Lib.WrapLazy as R3(Regex)
import qualified Text.Regex.Lib.WrapDFAEngine as R4(Regex)
-- Get the RegexLike instances
import Text.Regex.Lib.StringPosix()
import Text.Regex.Lib.StringPCRE()
import Text.Regex.Lib.StringLazy()
import Text.Regex.Lib.StringDFAEngine()
import Text.Regex.Lib.ByteStringPosix()
import Text.Regex.Lib.ByteStringPCRE()
import Text.Regex.Lib.ByteStringLazy()
import Text.Regex.Lib.ByteStringDFAEngine()
-}</span><span>
</span><span id="line-224"></span><span class="hs-comment">{-

mood :: (RegexLike a b) =&gt; a -&gt; b -&gt; b
{-# INLINE mood #-}
mood r s = case matchOnceText r s of
    Nothing -&gt; empty
    Just (_, ma, _) -&gt; fst (ma ! 0)

doom :: (RegexLike a b,Monad m) =&gt; a -&gt; b -&gt; m b
{-# INLINE doom #-}
doom =  actOn (\ (_, ma, _) -&gt; fst (ma ! 0))

{- These run afoul of various restrictions if I say
   &quot;instance RegexContext a b b where&quot;
   so I am listing these cases explicitly
-}

instance RegexContext R1.Regex String String where match = mood; matchM = doom
instance RegexContext R2.Regex String String where match = mood; matchM = doom
instance RegexContext R3.Regex String String where match = mood; matchM = doom
instance RegexContext R4.Regex String String where match = mood; matchM = doom
instance RegexContext R1.Regex ByteString ByteString where match = mood; matchM = doom
instance RegexContext R2.Regex ByteString ByteString where match = mood; matchM = doom
instance RegexContext R3.Regex ByteString ByteString where match = mood; matchM = doom
instance RegexContext R4.Regex ByteString ByteString where match = mood; matchM = doom
-}</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span id="local-6989586621679048680"><span class="annot"><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-type">nullArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679048680"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-253"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-pragma hs-type">nullArray</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-254"></span><span id="nullArray"><span class="annot"><span class="annottext">nullArray :: forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var hs-var">nullArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621679048670"><span id="local-6989586621679048673"><span id="local-6989586621679048674"><span id="local-6989586621679048675"><span class="annot"><a href="Text.Regex.Base.Context.html#nullFail"><span class="hs-identifier hs-type">nullFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048675"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048674"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048673"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679048670"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048675"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048674"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048670"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048673"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-257"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Base.Context.html#nullFail"><span class="hs-pragma hs-type">nullFail</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-258"></span><span id="nullFail"><span class="annot"><span class="annottext">nullFail :: forall regex source target (m :: * -&gt; *).
(RegexContext regex source (AllMatches [] target), MonadFail m) =&gt;
regex -&gt; source -&gt; m (AllMatches [] target)
</span><a href="Text.Regex.Base.Context.html#nullFail"><span class="hs-identifier hs-var hs-var">nullFail</span></a></span></span><span> </span><span id="local-6989586621679048432"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679048432"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048431"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679048431"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679048432"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679048431"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-260"></span><span>                 </span><span id="local-6989586621679048427"><span class="annot"><span class="annottext">AllMatches [] target
</span><a href="#local-6989586621679048427"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">AllMatches [] target
</span><a href="#local-6989586621679048427"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span id="local-6989586621679048653"><span id="local-6989586621679048655"><span id="local-6989586621679048656"><span id="local-6989586621679048657"><span class="annot"><a href="Text.Regex.Base.Context.html#nullFailText"><span class="hs-identifier hs-type">nullFailText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048657"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048656"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048655"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679048653"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048657"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048656"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048653"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048655"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-263"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Base.Context.html#nullFailText"><span class="hs-pragma hs-type">nullFailText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-264"></span><span id="nullFailText"><span class="annot"><span class="annottext">nullFailText :: forall regex source target (m :: * -&gt; *).
(RegexContext regex source (AllTextMatches [] target),
 MonadFail m) =&gt;
regex -&gt; source -&gt; m (AllTextMatches [] target)
</span><a href="Text.Regex.Base.Context.html#nullFailText"><span class="hs-identifier hs-var hs-var">nullFailText</span></a></span></span><span> </span><span id="local-6989586621679048419"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679048419"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048418"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679048418"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679048419"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679048418"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-266"></span><span>                     </span><span id="local-6989586621679048416"><span class="annot"><span class="annottext">AllTextMatches [] target
</span><a href="#local-6989586621679048416"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">AllTextMatches [] target
</span><a href="#local-6989586621679048416"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span id="local-6989586621679048645"><span id="local-6989586621679048646"><span id="local-6989586621679048647"><span id="local-6989586621679048648"><span class="annot"><a href="Text.Regex.Base.Context.html#nullFail%27"><span class="hs-identifier hs-type">nullFail'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048648"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048647"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048646"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679048645"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048648"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048647"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048645"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048646"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-269"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Base.Context.html#nullFail%27"><span class="hs-pragma hs-type">nullFail'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span id="nullFail%27"><span class="annot"><span class="annottext">nullFail' :: forall regex source target (m :: * -&gt; *).
(RegexContext regex source [target], MonadFail m) =&gt;
regex -&gt; source -&gt; m [target]
</span><a href="Text.Regex.Base.Context.html#nullFail%27"><span class="hs-identifier hs-var hs-var">nullFail'</span></a></span></span><span> </span><span id="local-6989586621679048408"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679048408"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048407"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679048407"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679048408"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679048407"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-271"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-272"></span><span>                 </span><span id="local-6989586621679048406"><span class="annot"><span class="annottext">[target]
</span><a href="#local-6989586621679048406"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[target]
</span><a href="#local-6989586621679048406"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span id="local-6989586621679048660"><span id="local-6989586621679048661"><span class="annot"><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-type">regexFailed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679048661"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048661"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048660"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-275"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-pragma hs-type">regexFailed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-276"></span><span id="regexFailed"><span class="annot"><span class="annottext">regexFailed :: forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var hs-var">regexFailed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;regex failed to match&quot;</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="local-6989586621679048629"><span id="local-6989586621679048631"><span id="local-6989586621679048633"><span id="local-6989586621679048634"><span class="annot"><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-type">actOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048634"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048633"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679048631"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679048633"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-type">MatchText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048633"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679048633"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="#local-6989586621679048629"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048634"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048633"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679048631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048629"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-279"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-pragma hs-type">actOn</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-280"></span><span id="actOn"><span class="annot"><span class="annottext">actOn :: forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var hs-var">actOn</span></a></span></span><span> </span><span id="local-6989586621679048396"><span class="annot"><span class="annottext">(s, MatchText s, s) -&gt; t
</span><a href="#local-6989586621679048396"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679048395"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679048395"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048394"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679048394"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (source, MatchText source, source)
</span><a href="Text.Regex.Base.RegexLike.html#matchOnceText"><span class="hs-identifier hs-var">matchOnceText</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679048395"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679048394"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">Maybe (s, MatchText s, s)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679048392"><span class="annot"><span class="annottext">(s, MatchText s, s)
</span><a href="#local-6989586621679048392"><span class="hs-identifier hs-var">preMApost</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(s, MatchText s, s) -&gt; t
</span><a href="#local-6989586621679048396"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(s, MatchText s, s)
</span><a href="#local-6989586621679048392"><span class="hs-identifier hs-var">preMApost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- ** Instances based on matchTest ()</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048618"><span id="local-6989586621679048619"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048618"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048618"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679048383"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679048383"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; Bool
</span><a href="Text.Regex.Base.RegexLike.html#matchTest"><span class="hs-identifier hs-var">matchTest</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679048376"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m Bool
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048374"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048374"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048373"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048373"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048374"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048373"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-290"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048613"><span id="local-6989586621679048614"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048613"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048613"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679048366"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; ()
</span><a href="#local-6989586621679048366"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679048360"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m ()
</span><a href="#local-6989586621679048360"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048359"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048359"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048358"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048358"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; Bool
</span><a href="Text.Regex.Base.RegexLike.html#matchTest"><span class="hs-identifier hs-var">matchTest</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048359"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048358"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-296"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- ** Instance based on matchCount</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048608"><span id="local-6989586621679048609"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048608"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048608"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679048350"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; Int
</span><a href="#local-6989586621679048350"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; Int
</span><a href="Text.Regex.Base.RegexLike.html#matchCount"><span class="hs-identifier hs-var">matchCount</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679048340"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m Int
</span><a href="#local-6989586621679048340"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048339"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048339"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048338"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048338"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048339"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048338"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>                 </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-304"></span><span>                 </span><span id="local-6989586621679048337"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679048337"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679048337"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- ** Instances based on matchOnce,matchOnceText</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048603"><span id="local-6989586621679048604"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048603"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048603"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621679048325"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; (Int, Int)
</span><a href="#local-6989586621679048325"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048324"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048324"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048323"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048323"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (Array Int (Int, Int))
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048324"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048323"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679048313"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m (Int, Int)
</span><a href="#local-6989586621679048313"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048312"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048312"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048311"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048311"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (Array Int (Int, Int))
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048312"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048311"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048589"><span id="local-6989586621679048590"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048589"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048589"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048589"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679048296"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; MatchResult b
</span><a href="#local-6989586621679048296"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048295"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048295"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048294"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048294"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MR"><span class="hs-identifier hs-type">MR</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mrBefore :: b
</span><a href="#local-6989586621679048292"><span class="hs-identifier hs-var">mrBefore</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048294"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">mrMatch :: b
</span><a href="#local-6989586621679048291"><span class="hs-identifier hs-var">mrMatch</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">mrAfter :: b
</span><a href="#local-6989586621679048290"><span class="hs-identifier hs-var">mrAfter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-314"></span><span>                        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">mrSubs :: Array Int b
</span><a href="#local-6989586621679048289"><span class="hs-identifier hs-var">mrSubs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">mrSubList :: [b]
</span><a href="#local-6989586621679048288"><span class="hs-identifier hs-var">mrSubList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048295"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048294"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679048281"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m (MatchResult b)
</span><a href="#local-6989586621679048281"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679048280"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048280"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679048279"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048279"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679048278"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048278"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-316"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679048277"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048277"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679048276"><span class="annot"><span class="annottext">[(b, (Int, Int))]
</span><a href="#local-6989586621679048276"><span class="hs-identifier hs-var">subs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048279"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-317"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MR"><span class="hs-identifier hs-type">MR</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mrBefore :: b
</span><a href="#local-6989586621679048292"><span class="hs-identifier hs-var">mrBefore</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048280"><span class="hs-identifier hs-var">pre</span></a></span><span>
</span><span id="line-318"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mrMatch :: b
</span><a href="#local-6989586621679048291"><span class="hs-identifier hs-var">mrMatch</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048277"><span class="hs-identifier hs-var">whole</span></a></span><span>
</span><span id="line-319"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mrAfter :: b
</span><a href="#local-6989586621679048290"><span class="hs-identifier hs-var">mrAfter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048278"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-320"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mrSubs :: Array Int b
</span><a href="#local-6989586621679048289"><span class="hs-identifier hs-var">mrSubs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048279"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-321"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mrSubList :: [b]
</span><a href="#local-6989586621679048288"><span class="hs-identifier hs-var">mrSubList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(b, (Int, Int))]
</span><a href="#local-6989586621679048276"><span class="hs-identifier hs-var">subs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048572"><span id="local-6989586621679048573"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048572"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048572"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679048572"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-type">MatchText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048572"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679048572"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621679048266"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; (b, MatchText b, b)
</span><a href="#local-6989586621679048266"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048265"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048265"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048264"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048264"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048264"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (source, MatchText source, source)
</span><a href="Text.Regex.Base.RegexLike.html#matchOnceText"><span class="hs-identifier hs-var">matchOnceText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048265"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048264"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679048258"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (b, MatchText b, b)
</span><a href="#local-6989586621679048258"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048257"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048257"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048256"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048256"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (source, MatchText source, source)
</span><a href="Text.Regex.Base.RegexLike.html#matchOnceText"><span class="hs-identifier hs-var">matchOnceText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048257"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048256"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048567"><span id="local-6989586621679048568"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048567"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048567"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679048567"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679048567"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679048567"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679048244"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; (b, b, b)
</span><a href="#local-6989586621679048244"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048243"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048243"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048242"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048242"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048242"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048243"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048242"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679048238"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m (b, b, b)
</span><a href="#local-6989586621679048238"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679048237"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048237"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679048236"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048236"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679048235"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048235"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679048234"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048234"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(b, (Int, Int))]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048236"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-330"></span><span>                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048237"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048234"><span class="hs-identifier hs-var">whole</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048235"><span class="hs-identifier hs-var">post</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048562"><span id="local-6989586621679048563"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048563"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048562"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048563"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048562"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679048562"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679048562"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679048562"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679048562"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679048222"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; (b, b, b, [b])
</span><a href="#local-6989586621679048222"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048221"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048221"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048220"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048220"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048220"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall source. Extract source =&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048221"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048220"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679048216"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m (b, b, b, [b])
</span><a href="#local-6989586621679048216"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679048215"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048215"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679048214"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048214"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679048213"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048213"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679048212"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048212"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679048211"><span class="annot"><span class="annottext">[(b, (Int, Int))]
</span><a href="#local-6989586621679048211"><span class="hs-identifier hs-var">subs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048214"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-335"></span><span>                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048215"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048212"><span class="hs-identifier hs-var">whole</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048213"><span class="hs-identifier hs-var">post</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(b, (Int, Int))]
</span><a href="#local-6989586621679048211"><span class="hs-identifier hs-var">subs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- now AllSubmatches wrapper</span><span>
</span><span id="line-338"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048557"><span id="local-6989586621679048558"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048558"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048557"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048558"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048557"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier hs-type">MatchArray</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679048203"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; Array Int (Int, Int)
</span><a href="#local-6989586621679048203"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048202"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048202"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048201"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048201"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (Array Int (Int, Int))
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048202"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048201"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679048195"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (Array Int (Int, Int))
</span><a href="#local-6989586621679048195"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048194"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048194"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048193"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048193"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (Array Int (Int, Int))
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048194"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048193"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048551"><span id="local-6989586621679048552"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048551"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048551"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier hs-type">AllSubmatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679048184"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllSubmatches [] (Int, Int)
</span><a href="#local-6989586621679048184"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048183"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048183"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048182"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048182"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier hs-var">AllSubmatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048183"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048182"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621679048175"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllSubmatches [] (Int, Int))
</span><a href="#local-6989586621679048175"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048174"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048174"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048173"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048173"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (Array Int (Int, Int))
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048174"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048173"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-344"></span><span>                 </span><span class="annot"><span class="annottext">Maybe (Array Int (Int, Int))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-345"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679048172"><span class="annot"><span class="annottext">Array Int (Int, Int)
</span><a href="#local-6989586621679048172"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier hs-var">AllSubmatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Array Int (Int, Int)
</span><a href="#local-6989586621679048172"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- essentially AllSubmatches applied to (MatchText b)</span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048543"><span id="local-6989586621679048544"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048543"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048543"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-type">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679048543"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679048163"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextSubmatches (Array Int) (b, (Int, Int))
</span><a href="#local-6989586621679048163"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048162"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048162"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048161"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048161"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048162"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048161"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679048156"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextSubmatches (Array Int) (b, (Int, Int)))
</span><a href="#local-6989586621679048156"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048155"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048155"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048154"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048154"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679048153"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048153"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048153"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048155"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048154"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-351"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048536"><span id="local-6989586621679048537"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048536"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048536"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-type">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679048536"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679048144"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextSubmatches [] (b, (Int, Int))
</span><a href="#local-6989586621679048144"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048143"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048143"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048142"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048142"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048143"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048142"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679048138"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextSubmatches [] (b, (Int, Int)))
</span><a href="#local-6989586621679048138"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048137"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048137"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048136"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048136"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679048135"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048135"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048135"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048137"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048136"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048531"><span id="local-6989586621679048532"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048531"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048531"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-type">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048531"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>  </span><span id="local-6989586621679048126"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextSubmatches [] b
</span><a href="#local-6989586621679048126"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048125"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048125"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048124"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048124"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048125"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048124"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621679048118"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextSubmatches [] b)
</span><a href="#local-6989586621679048118"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048117"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048117"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048116"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048116"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679048115"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048115"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048115"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048117"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048116"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-358"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048523"><span id="local-6989586621679048524"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048523"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048523"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-type">AllTextSubmatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679048523"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621679048106"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextSubmatches (Array Int) b
</span><a href="#local-6989586621679048106"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048105"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048105"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048104"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048104"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048105"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048104"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679048097"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextSubmatches (Array Int) b)
</span><a href="#local-6989586621679048097"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048096"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048096"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048095"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048095"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextSubmatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r s (m :: * -&gt; *) t.
(RegexLike r s, MonadFail m) =&gt;
((s, MatchText s, s) -&gt; t) -&gt; r -&gt; s -&gt; m t
</span><a href="Text.Regex.Base.Context.html#actOn"><span class="hs-identifier hs-var">actOn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679048094"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048094"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679048094"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048096"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048095"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- ** Instances based on matchAll,matchAllText</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048518"><span id="local-6989586621679048519"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048518"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048518"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679048084"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllMatches [] (Int, Int)
</span><a href="#local-6989586621679048084"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048083"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048083"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048082"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048082"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Array Int (Int, Int)
</span><a href="#local-6989586621679048081"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679048081"><span class="annot"><span class="annottext">Array Int (Int, Int)
</span><a href="#local-6989586621679048081"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [Array Int (Int, Int)]
</span><a href="Text.Regex.Base.RegexLike.html#matchAll"><span class="hs-identifier hs-var">matchAll</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048083"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048082"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679048076"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllMatches [] (Int, Int))
</span><a href="#local-6989586621679048076"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048075"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048075"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048074"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048074"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source (AllMatches [] target), MonadFail m) =&gt;
regex -&gt; source -&gt; m (AllMatches [] target)
</span><a href="Text.Regex.Base.Context.html#nullFail"><span class="hs-identifier hs-var">nullFail</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048075"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048074"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048511"><span id="local-6989586621679048512"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048511"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048511"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679048065"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllMatches (Array Int) (Int, Int)
</span><a href="#local-6989586621679048065"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048064"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048063"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048063"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048064"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048063"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679048051"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllMatches (Array Int) (Int, Int))
</span><a href="#local-6989586621679048051"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048050"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048050"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048049"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048049"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048050"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048049"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-371"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span id="local-6989586621679048048"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679048048"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679048048"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679048048"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">-- No AllMatches wrapper</span><span>
</span><span id="line-374"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048503"><span id="local-6989586621679048504"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048503"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048503"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier hs-type">MatchArray</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679048038"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; [Array Int (Int, Int)]
</span><a href="#local-6989586621679048038"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [Array Int (Int, Int)]
</span><a href="Text.Regex.Base.RegexLike.html#matchAll"><span class="hs-identifier hs-var">matchAll</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621679048034"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m [Array Int (Int, Int)]
</span><a href="#local-6989586621679048034"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source [target], MonadFail m) =&gt;
regex -&gt; source -&gt; m [target]
</span><a href="Text.Regex.Base.Context.html#nullFail%27"><span class="hs-identifier hs-var">nullFail'</span></a></span><span>
</span><span id="line-377"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048498"><span id="local-6989586621679048499"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048499"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048498"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048499"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048498"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-type">AllMatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier hs-type">MatchArray</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621679048025"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllMatches (Array Int) (Array Int (Int, Int))
</span><a href="#local-6989586621679048025"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679048024"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048024"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048023"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048023"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048024"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048023"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621679048013"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllMatches (Array Int) (Array Int (Int, Int)))
</span><a href="#local-6989586621679048013"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679048012"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048012"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679048011"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048011"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679048012"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679048011"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-380"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-381"></span><span>                 </span><span id="local-6989586621679048010"><span class="annot"><span class="annottext">[Array Int (Int, Int)]
</span><a href="#local-6989586621679048010"><span class="hs-identifier hs-var">mas</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Array Int (Int, Int)]
</span><a href="#local-6989586621679048010"><span class="hs-identifier hs-var">mas</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Array Int (Int, Int)]
</span><a href="#local-6989586621679048010"><span class="hs-identifier hs-var">mas</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- No AllTextMatches wrapper</span><span>
</span><span id="line-384"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048493"><span id="local-6989586621679048494"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048493"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048493"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-type">MatchText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048493"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-385"></span><span>  </span><span id="local-6989586621679048002"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; [MatchText b]
</span><a href="#local-6989586621679048002"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; [MatchText b]
</span><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-var">matchAllText</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621679047997"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m [MatchText b]
</span><a href="#local-6989586621679047997"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source [target], MonadFail m) =&gt;
regex -&gt; source -&gt; m [target]
</span><a href="Text.Regex.Base.Context.html#nullFail%27"><span class="hs-identifier hs-var">nullFail'</span></a></span><span>
</span><span id="line-387"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048488"><span id="local-6989586621679048489"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048489"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048488"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048489"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048488"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-type">MatchText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048488"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621679047988"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextMatches (Array Int) (MatchText b)
</span><a href="#local-6989586621679047988"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047987"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047987"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047986"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047986"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047987"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047986"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621679047976"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextMatches (Array Int) (MatchText b))
</span><a href="#local-6989586621679047976"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047975"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047975"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047974"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047974"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047975"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047974"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-390"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-391"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621679047973"><span class="annot"><span class="annottext">[MatchText b]
</span><a href="#local-6989586621679047973"><span class="hs-identifier hs-var">mts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[MatchText b]
</span><a href="#local-6989586621679047973"><span class="hs-identifier hs-var">mts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MatchText b]
</span><a href="#local-6989586621679047973"><span class="hs-identifier hs-var">mts</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048481"><span id="local-6989586621679048482"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048482"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048482"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048481"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679048481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679047963"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextMatches [] b
</span><a href="#local-6989586621679047963"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047962"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047962"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047961"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047961"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679047960"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047960"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679047960"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; [MatchText b]
</span><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-var">matchAllText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047962"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047961"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679047956"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextMatches [] b)
</span><a href="#local-6989586621679047956"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047955"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047955"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047954"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047954"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source (AllTextMatches [] target),
 MonadFail m) =&gt;
regex -&gt; source -&gt; m (AllTextMatches [] target)
</span><a href="Text.Regex.Base.Context.html#nullFailText"><span class="hs-identifier hs-var">nullFailText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047955"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047954"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-396"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048476"><span id="local-6989586621679048477"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048476"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048476"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679048476"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679047945"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextMatches (Array Int) b
</span><a href="#local-6989586621679047945"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047944"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047944"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047943"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047943"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047944"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047943"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679047933"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextMatches (Array Int) b)
</span><a href="#local-6989586621679047933"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047932"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047932"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047931"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047931"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047932"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047931"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-399"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-400"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span id="local-6989586621679047930"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679047930"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679047930"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679047930"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- No AllTextMatches wrapper</span><span>
</span><span id="line-403"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048471"><span id="local-6989586621679048472"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048471"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048471"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679048471"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679047922"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; [[b]]
</span><a href="#local-6989586621679047922"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047921"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047921"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047920"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047920"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679047919"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047919"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679047919"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; [MatchText b]
</span><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-var">matchAllText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047921"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047920"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679047915"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; a -&gt; b -&gt; m [[b]]
</span><a href="#local-6989586621679047915"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047914"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047914"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047913"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047913"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source [target], MonadFail m) =&gt;
regex -&gt; source -&gt; m [target]
</span><a href="Text.Regex.Base.Context.html#nullFail%27"><span class="hs-identifier hs-var">nullFail'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047914"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047913"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-406"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048466"><span id="local-6989586621679048467"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048466"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048466"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679048466"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679047904"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextMatches (Array Int) [b]
</span><a href="#local-6989586621679047904"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047903"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047902"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047902"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047903"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047902"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679047892"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextMatches (Array Int) [b])
</span><a href="#local-6989586621679047892"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047891"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047891"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047890"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047890"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047891"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047890"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-409"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-410"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621679047889"><span class="annot"><span class="annottext">[[b]]
</span><a href="#local-6989586621679047889"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[b]]
</span><a href="#local-6989586621679047889"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[b]]
</span><a href="#local-6989586621679047889"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-411"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048461"><span id="local-6989586621679048462"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048461"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048461"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679048461"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679047880"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextMatches [] (Array Int b)
</span><a href="#local-6989586621679047880"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047879"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047878"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047878"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679047877"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679047877"><span class="annot"><span class="annottext">MatchText b
</span><a href="#local-6989586621679047877"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. RegexLike a b =&gt; a -&gt; b -&gt; [MatchText b]
</span><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-var">matchAllText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047879"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047878"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679047873"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextMatches [] (Array Int b))
</span><a href="#local-6989586621679047873"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047872"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047872"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047871"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047871"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source (AllTextMatches [] target),
 MonadFail m) =&gt;
regex -&gt; source -&gt; m (AllTextMatches [] target)
</span><a href="Text.Regex.Base.Context.html#nullFailText"><span class="hs-identifier hs-var">nullFailText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047872"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047871"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-414"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679048456"><span id="local-6989586621679048457"><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048456"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-type">RegexContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679048456"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679048456"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621679047862"><span class="annot"><span class="annottext">match :: a -&gt; b -&gt; AllTextMatches (Array Int) (Array Int b)
</span><a href="#local-6989586621679047862"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679047861"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047861"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047860"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047860"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Array Int a
</span><a href="Text.Regex.Base.Context.html#nullArray"><span class="hs-identifier hs-var">nullArray</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
</span><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047861"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047860"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621679047850"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
a -&gt; b -&gt; m (AllTextMatches (Array Int) (Array Int b))
</span><a href="#local-6989586621679047850"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679047849"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047849"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679047848"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047848"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679047849"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679047848"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-417"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b. MonadFail m =&gt; m b
</span><a href="Text.Regex.Base.Context.html#regexFailed"><span class="hs-identifier hs-var">regexFailed</span></a></span><span>
</span><span id="line-418"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-type">AllTextMatches</span></a></span><span> </span><span id="local-6989586621679047847"><span class="annot"><span class="annottext">[Array Int b]
</span><a href="#local-6989586621679047847"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. f b -&gt; AllTextMatches f b
</span><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Array Int b]
</span><a href="#local-6989586621679047847"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Array Int b]
</span><a href="#local-6989586621679047847"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-419"></span></pre></body></html>