<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Unison.Syntax.TermPrinter</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#emptyAc"><span class="hs-identifier">emptyAc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty"><span class="hs-identifier">pretty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBlock"><span class="hs-identifier">prettyBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBlock%27"><span class="hs-identifier">prettyBlock'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty%27"><span class="hs-identifier">pretty'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding"><span class="hs-identifier">prettyBinding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding%27"><span class="hs-identifier">prettyBinding'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBindingWithoutTypeSignature"><span class="hs-identifier">prettyBindingWithoutTypeSignature</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier">pretty0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html#runPretty"><span class="hs-identifier">runPretty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier">prettyPattern</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsnoc</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isPrint</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEL</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Show.Unicode</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.ABT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">annotation</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reannotateUp</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-identifier">AbsN'</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.ABT</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ABT</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Blank</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Blank</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Builtin.Decls.html"><span class="hs-identifier">Unison.Builtin.Decls</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Unison.Builtin.Decls.html#TuplePattern"><span class="hs-identifier">TuplePattern</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Unison.Builtin.Decls.html#TupleTerm%27"><span class="hs-identifier">TupleTerm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Builtin.Decls.html"><span class="hs-identifier">Unison.Builtin.Decls</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DD</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.ConstructorReference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GConstructorReference</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.ConstructorReference</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ConstructorReference</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.ConstructorType</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CT</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.HashQualified</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HQ</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.HashQualified'</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HQ'</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Name</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Name</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.NameSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NameSegment</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Pattern</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Pattern</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Pattern</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pattern</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Prelude</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html"><span class="hs-identifier">Unison.PrettyPrintEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier">PrettyPrintEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html"><span class="hs-identifier">Unison.PrettyPrintEnv</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PrettyPrintEnv</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html"><span class="hs-identifier">Unison.PrettyPrintEnv.FQN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier">Imports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier">elideFQN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html"><span class="hs-identifier">Unison.PrettyPrintEnv.MonadPretty</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Reference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reference</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Reference</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Reference</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Referent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Referent</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Referent</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Referent</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Syntax.HashQualified</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeFromVar</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Syntax.Lexer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showEscapeChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Syntax.Name</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isSymboly</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseText</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseTextEither</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toText</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeParseText</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Syntax.NamePrinter.html"><span class="hs-identifier">Unison.Syntax.NamePrinter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier">styleHashQualified''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Syntax.NameSegment</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NameSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toEscapedText</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Syntax.TypePrinter.html"><span class="hs-identifier">Unison.Syntax.TypePrinter</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TypePrinter</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Term</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Type</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-identifier">ForallsNamed'</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Type</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Type</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Bytes</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bytes</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldMapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intercalateMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intercalateMapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ColorText</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Pretty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Width</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Pretty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PP</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.SyntaxText</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Var</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Var</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Var</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="SyntaxText"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-var">SyntaxText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SyntaxText'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621680951281"><span id="local-6989586621680951283"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951283"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680951283"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ColorText</span></span></span></span><span>
</span><span id="line-73"></span><span id="pretty"><span class="annot"><span class="annottext">pretty :: forall v a. Var v =&gt; PrettyPrintEnv -&gt; Term v a -&gt; Pretty ColorText
</span><a href="Unison.Syntax.TermPrinter.html#pretty"><span class="hs-identifier hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621680950353"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950353"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span id="local-6989586621680950352"><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950352"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Reader (PrettyPrintEnv, Set v) a -&gt; a
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#runPretty"><span class="hs-identifier hs-var">runPretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a.
(Var v, Var vt) =&gt;
Term2 vt at ap v a -&gt; PrettyPrintEnv -&gt; PrettyPrintEnv
</span><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-var">avoidShadowing</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950352"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950353"><span class="hs-identifier hs-var">ppe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#emptyAc"><span class="hs-identifier hs-var">emptyAc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v at ap a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Term2 v at ap v a -&gt; Term3 v PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-var">printAnnotate</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950353"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950352"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="local-6989586621680951240"><span id="local-6989586621680951241"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBlock"><span class="hs-identifier hs-type">prettyBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951241"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680951241"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ColorText</span></span></span></span><span>
</span><span id="line-77"></span><span id="prettyBlock"><span class="annot"><span class="annottext">prettyBlock :: forall v a.
Var v =&gt;
Bool -&gt; PrettyPrintEnv -&gt; Term v a -&gt; Pretty ColorText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBlock"><span class="hs-identifier hs-var hs-var">prettyBlock</span></a></span></span><span> </span><span id="local-6989586621680950345"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950345"><span class="hs-identifier hs-var">elideUnit</span></a></span></span><span> </span><span id="local-6989586621680950344"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950344"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
Bool -&gt; PrettyPrintEnv -&gt; Term v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBlock%27"><span class="hs-identifier hs-var">prettyBlock'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950345"><span class="hs-identifier hs-var">elideUnit</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950344"><span class="hs-identifier hs-var">ppe</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621680951236"><span id="local-6989586621680951237"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBlock%27"><span class="hs-identifier hs-type">prettyBlock'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951237"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680951237"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span></span></span><span>
</span><span id="line-80"></span><span id="prettyBlock%27"><span class="annot"><span class="annottext">prettyBlock' :: forall v a.
Var v =&gt;
Bool -&gt; PrettyPrintEnv -&gt; Term v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBlock%27"><span class="hs-identifier hs-var hs-var">prettyBlock'</span></a></span></span><span> </span><span id="local-6989586621680950332"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950332"><span class="hs-identifier hs-var">elideUnit</span></a></span></span><span> </span><span id="local-6989586621680950331"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950331"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span id="local-6989586621680950330"><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950330"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Reader (PrettyPrintEnv, Set v) a -&gt; a
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#runPretty"><span class="hs-identifier hs-var">runPretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a.
(Var v, Var vt) =&gt;
Term2 vt at ap v a -&gt; PrettyPrintEnv -&gt; PrettyPrintEnv
</span><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-var">avoidShadowing</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950330"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950331"><span class="hs-identifier hs-var">ppe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#emptyBlockAc"><span class="hs-identifier hs-var">emptyBlockAc</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:elideUnit:AmbientContext :: Bool
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AelideUnit%3AAmbientContext"><span class="hs-identifier hs-var">elideUnit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950332"><span class="hs-identifier hs-var">elideUnit</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v at ap a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Term2 v at ap v a -&gt; Term3 v PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-var">printAnnotate</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950331"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950330"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621680951231"><span id="local-6989586621680951233"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty%27"><span class="hs-identifier hs-type">pretty'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951233"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Width</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680951233"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ColorText</span></span></span></span><span>
</span><span id="line-84"></span><span id="pretty%27"><span class="annot"><span class="annottext">pretty' :: forall v a.
Var v =&gt;
Maybe Width -&gt; PrettyPrintEnv -&gt; Term v a -&gt; ColorText
</span><a href="Unison.Syntax.TermPrinter.html#pretty%27"><span class="hs-identifier hs-var hs-var">pretty'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680950304"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680950304"><span class="hs-identifier hs-var">width</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950303"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950303"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680950302"><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950302"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">forall s. (Monoid s, IsString s) =&gt; Width -&gt; Pretty s -&gt; s
</span><span class="hs-identifier hs-var">PP.render</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680950304"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Reader (PrettyPrintEnv, Set v) a -&gt; a
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#runPretty"><span class="hs-identifier hs-var">runPretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a.
(Var v, Var vt) =&gt;
Term2 vt at ap v a -&gt; PrettyPrintEnv -&gt; PrettyPrintEnv
</span><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-var">avoidShadowing</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950302"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950303"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#emptyAc"><span class="hs-identifier hs-var">emptyAc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v at ap a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Term2 v at ap v a -&gt; Term3 v PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-var">printAnnotate</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950303"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950302"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty%27"><span class="hs-identifier hs-var">pretty'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Width
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621680950300"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950300"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680950299"><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950299"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">forall s. (Monoid s, IsString s) =&gt; Pretty s -&gt; s
</span><span class="hs-identifier hs-var">PP.renderUnbroken</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Reader (PrettyPrintEnv, Set v) a -&gt; a
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#runPretty"><span class="hs-identifier hs-var">runPretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a.
(Var v, Var vt) =&gt;
Term2 vt at ap v a -&gt; PrettyPrintEnv -&gt; PrettyPrintEnv
</span><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-var">avoidShadowing</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950299"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950300"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#emptyAc"><span class="hs-identifier hs-var">emptyAc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v at ap a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Term2 v at ap v a -&gt; Term3 v PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-var">printAnnotate</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680950300"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680950299"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- Information about the context in which a term appears, which affects how the</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- term should be rendered.</span><span>
</span><span id="line-91"></span><span class="hs-keyword">data</span><span> </span><span id="AmbientContext"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-var">AmbientContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AmbientContext"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-var">AmbientContext</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- The operator precedence of the enclosing context (a number from 0 to 11,</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- or -1 to render without outer parentheses unconditionally).</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">-- Function application has precedence 10.</span><span>
</span><span id="line-95"></span><span>    </span><span id="%24sel%3Aprecedence%3AAmbientContext"><span class="annot"><span class="annottext">AmbientContext -&gt; Int
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aprecedence%3AAmbientContext"><span class="hs-identifier hs-var hs-var">precedence</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- -2 indicates top level binding, this is occasionally useful</span><span>
</span><span id="line-96"></span><span>    </span><span id="%24sel%3AblockContext%3AAmbientContext"><span class="annot"><span class="annottext">AmbientContext -&gt; BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AblockContext%3AAmbientContext"><span class="hs-identifier hs-var hs-var">blockContext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#BlockContext"><span class="hs-identifier hs-type">BlockContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span id="%24sel%3AinfixContext%3AAmbientContext"><span class="annot"><span class="annottext">AmbientContext -&gt; InfixContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AinfixContext%3AAmbientContext"><span class="hs-identifier hs-var hs-var">infixContext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#InfixContext"><span class="hs-identifier hs-type">InfixContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span id="%24sel%3Aimports%3AAmbientContext"><span class="annot"><span class="annottext">AmbientContext -&gt; Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var hs-var">imports</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span id="%24sel%3AdocContext%3AAmbientContext"><span class="annot"><span class="annottext">AmbientContext -&gt; DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AdocContext%3AAmbientContext"><span class="hs-identifier hs-var hs-var">docContext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DocLiteralContext"><span class="hs-identifier hs-type">DocLiteralContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>    </span><span id="%24sel%3AelideUnit%3AAmbientContext"><span class="annot"><span class="annottext">AmbientContext -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AelideUnit%3AAmbientContext"><span class="hs-identifier hs-var hs-var">elideUnit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- `True` if a `()` at the end of a block should be elided</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Description of the position of this ABT node, when viewed in the</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- surface syntax.</span><span>
</span><span id="line-105"></span><span class="hs-keyword">data</span><span> </span><span id="BlockContext"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#BlockContext"><span class="hs-identifier hs-var">BlockContext</span></a></span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- This ABT node is at the top level of a TermParser.block.</span><span>
</span><span id="line-107"></span><span>    </span><span id="Block"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Normal"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680950286"><span id="local-6989586621680950288"><span class="annot"><span class="annottext">BlockContext -&gt; BlockContext -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BlockContext -&gt; BlockContext -&gt; Bool
$c/= :: BlockContext -&gt; BlockContext -&gt; Bool
== :: BlockContext -&gt; BlockContext -&gt; Bool
$c== :: BlockContext -&gt; BlockContext -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680950279"><span id="local-6989586621680950281"><span id="local-6989586621680950283"><span class="annot"><span class="annottext">Int -&gt; BlockContext -&gt; ShowS
[BlockContext] -&gt; ShowS
BlockContext -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BlockContext] -&gt; ShowS
$cshowList :: [BlockContext] -&gt; ShowS
show :: BlockContext -&gt; String
$cshow :: BlockContext -&gt; String
showsPrec :: Int -&gt; BlockContext -&gt; ShowS
$cshowsPrec :: Int -&gt; BlockContext -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="InfixContext"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#InfixContext"><span class="hs-identifier hs-var">InfixContext</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- This ABT node is an infix operator being used in infix position.</span><span>
</span><span id="line-113"></span><span>    </span><span id="Infix"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#Infix"><span class="hs-identifier hs-var">Infix</span></a></span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NonInfix"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#NonInfix"><span class="hs-identifier hs-var">NonInfix</span></a></span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680950272"><span id="local-6989586621680950274"><span class="annot"><span class="annottext">InfixContext -&gt; InfixContext -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: InfixContext -&gt; InfixContext -&gt; Bool
$c/= :: InfixContext -&gt; InfixContext -&gt; Bool
== :: InfixContext -&gt; InfixContext -&gt; Bool
$c== :: InfixContext -&gt; InfixContext -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680950266"><span id="local-6989586621680950268"><span id="local-6989586621680950270"><span class="annot"><span class="annottext">Int -&gt; InfixContext -&gt; ShowS
[InfixContext] -&gt; ShowS
InfixContext -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [InfixContext] -&gt; ShowS
$cshowList :: [InfixContext] -&gt; ShowS
show :: InfixContext -&gt; String
$cshow :: InfixContext -&gt; String
showsPrec :: Int -&gt; InfixContext -&gt; ShowS
$cshowsPrec :: Int -&gt; InfixContext -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span id="DocLiteralContext"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DocLiteralContext"><span class="hs-identifier hs-var">DocLiteralContext</span></a></span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- We won't try and render this ABT node or anything under it as a [: @Doc literal :]</span><span>
</span><span id="line-119"></span><span>    </span><span id="NoDoc"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#NoDoc"><span class="hs-identifier hs-var">NoDoc</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- We'll keep checking as we recurse down</span><span>
</span><span id="line-121"></span><span>    </span><span id="MaybeDoc"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#MaybeDoc"><span class="hs-identifier hs-var">MaybeDoc</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680950260"><span id="local-6989586621680950262"><span class="annot"><span class="annottext">DocLiteralContext -&gt; DocLiteralContext -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DocLiteralContext -&gt; DocLiteralContext -&gt; Bool
$c/= :: DocLiteralContext -&gt; DocLiteralContext -&gt; Bool
== :: DocLiteralContext -&gt; DocLiteralContext -&gt; Bool
$c== :: DocLiteralContext -&gt; DocLiteralContext -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680950254"><span id="local-6989586621680950256"><span id="local-6989586621680950258"><span class="annot"><span class="annottext">Int -&gt; DocLiteralContext -&gt; ShowS
[DocLiteralContext] -&gt; ShowS
DocLiteralContext -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DocLiteralContext] -&gt; ShowS
$cshowList :: [DocLiteralContext] -&gt; ShowS
show :: DocLiteralContext -&gt; String
$cshow :: DocLiteralContext -&gt; String
showsPrec :: Int -&gt; DocLiteralContext -&gt; ShowS
$cshowsPrec :: Int -&gt; DocLiteralContext -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">{- Explanation of precedence handling

   We illustrate precedence rules as follows.

     &gt;=10
       10f 10x

   This example shows that a function application f x is enclosed in
   parentheses whenever the ambient precedence around it is &gt;= 10, and that
   when printing its two components, an ambient precedence of 10 is used in
   both places.

   The pretty-printer uses the following rules for printing terms.

     &gt;=12
       let x = (-1)y
           1z

     &gt;=11
       ! 11x
       ' 11x
       11x ?

     &gt;=10
       10f 10x 10y ...
       termLink t
       typeLink t

     &gt;=3
       x -&gt; 2y
       3x + 3y + ... 3z

     &gt;=2
       if 0a then 0b else 0c
       handle 0b with 0h
       case 2x of
         a | 2g -&gt; 0b

     &gt;=0
       10a : 0Int

   And the following for patterns.

     &gt;=11
       x@11p

     &gt;=10
       Con 10p 10q ...

     -- never any external parens added around the following
       { p }
       { Eff 10p 10q ... -&gt; 0k }

-}</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621680951218"><span id="local-6989586621680951219"><span id="local-6989586621680951220"><span id="local-6989586621680951221"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isBindingSoftHangable"><span class="hs-identifier hs-type">isBindingSoftHangable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951221"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680951221"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951220"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951219"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951221"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-180"></span><span id="isBindingSoftHangable"><span class="annot"><span class="annottext">isBindingSoftHangable :: forall v at ap a. Var v =&gt; Term2 v at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBindingSoftHangable"><span class="hs-identifier hs-var hs-var">isBindingSoftHangable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isBindingSoftHangable"><span class="hs-identifier hs-var">isBindingSoftHangable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s a. Snoc s s a a =&gt; s -&gt; Maybe (s, a)
</span><span class="hs-identifier hs-var">unsnoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Term2 v at ap v a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680950245"><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680950245"><span class="hs-identifier hs-var">last</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680950245"><span class="hs-identifier hs-var">last</span></a></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isBindingSoftHangable"><span class="hs-identifier hs-var">isBindingSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-type">pretty0</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680951249"><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680951248"><span class="annot"><a href="#local-6989586621680951248"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951248"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="#local-6989586621680951248"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span id="pretty0"><span class="annot"><span class="annottext">pretty0 :: forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var hs-var">pretty0</span></a></span></span><span> </span><span id="local-6989586621680949608"><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949608"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680949607"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949607"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isTopLevelPrecedence"><span class="hs-identifier hs-var">isTopLevelPrecedence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbientContext -&gt; Int
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aprecedence%3AAmbientContext"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949608"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v at ap a. Var v =&gt; Term2 v at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBindingSoftHangable"><span class="hs-identifier hs-var">isBindingSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949607"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-comment">-- we allow use clause insertion here even when it otherwise wouldn't be</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- (as long as the tm isn't soft hangable, if it gets soft hung then</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-comment">-- adding use clauses beforehand will mess things up)</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621680949603"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949603"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949608"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:imports:AmbientContext :: Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949602"><span class="hs-identifier hs-var">im</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:precedence:AmbientContext :: Int
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aprecedence%3AAmbientContext"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949607"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949600"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949603"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680949602"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949602"><span class="hs-identifier hs-var">im</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949600"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949600"><span class="hs-identifier hs-var">uses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
(Var v, Ord v) =&gt;
Imports
-&gt; Term3 v PrintAnnotation -&gt; (Imports, [Pretty SyntaxText])
</span><a href="Unison.Syntax.TermPrinter.html#calcImports"><span class="hs-identifier hs-var">calcImports</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbientContext -&gt; Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949608"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949607"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621680949598"><span class="annot"><span class="annottext">a :: AmbientContext
</span><a href="#local-6989586621680949598"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:precedence:AmbientContext :: AmbientContext -&gt; Int
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aprecedence%3AAmbientContext"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949597"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="annottext">$sel:blockContext:AmbientContext :: AmbientContext -&gt; BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AblockContext%3AAmbientContext"><span class="hs-identifier hs-var">blockContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949596"><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680949596"><span class="hs-identifier hs-var">bc</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="annottext">$sel:infixContext:AmbientContext :: AmbientContext -&gt; InfixContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AinfixContext%3AAmbientContext"><span class="hs-identifier hs-var">infixContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949595"><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680949595"><span class="hs-identifier hs-var">ic</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">$sel:imports:AmbientContext :: AmbientContext -&gt; Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949594"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="annottext">$sel:docContext:AmbientContext :: AmbientContext -&gt; DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AdocContext%3AAmbientContext"><span class="hs-identifier hs-var">docContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949593"><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>      </span><span class="annot"><span class="annottext">$sel:elideUnit:AmbientContext :: AmbientContext -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AelideUnit%3AAmbientContext"><span class="hs-identifier hs-var">elideUnit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949592"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949592"><span class="hs-identifier hs-var">elideUnit</span></a></span></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621680949591"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949591"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
-&gt; (Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText))
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949590"><span class="hs-identifier hs-var">specialCases</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949591"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Var'</span></span><span> </span><span id="local-6989586621680949588"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949588"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var">parenIfInfix</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949586"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680949595"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949586"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-comment">-- OK since all term vars are user specified, any freshening was just added during typechecking</span><span>
</span><span id="line-212"></span><span>          </span><span id="local-6989586621680949586"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949586"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; HashQualified Name
</span><span class="hs-identifier hs-var">HQ.unsafeFromVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; v
</span><span class="hs-identifier hs-var">Var.reset</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949588"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680949581"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949581"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621680949580"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949580"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949578"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949578"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949580"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949581"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var">parenIfInfix</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949578"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680949595"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949581"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949578"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span id="local-6989586621680949573"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949573"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>        </span><span id="local-6989586621680949572"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949572"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949571"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949571"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949572"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949573"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-221"></span><span>          </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.LinkKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;termLink &quot;</span></span><span>
</span><span id="line-222"></span><span>            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var">parenIfInfix</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949571"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680949595"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949573"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949571"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">TypeLink'</span></span><span> </span><span id="local-6989586621680949567"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949567"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621680949566"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949566"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949565"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949565"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Reference -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#typeName"><span class="hs-identifier hs-var">PrettyPrintEnv.typeName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949566"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949567"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-227"></span><span>          </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.LinkKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;typeLink &quot;</span></span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var">parenIfInfix</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949565"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680949595"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TypeReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949567"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949565"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span id="local-6989586621680949561"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949561"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621680949560"><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680949560"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>        </span><span id="local-6989586621680949559"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949559"><span class="hs-identifier hs-var">tm'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949561"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span id="local-6989586621680949557"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949557"><span class="hs-identifier hs-var">tp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v a (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports -&gt; Int -&gt; Type v a -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TypePrinter.html#pretty0"><span class="hs-identifier hs-var">TypePrinter.pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680949560"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949559"><span class="hs-identifier hs-var">tm'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.TypeAscriptionColon</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; :&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949557"><span class="hs-identifier hs-var">tp'</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Int'</span></span><span> </span><span id="local-6989586621680949552"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949552"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.NumericLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949552"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949552"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949552"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nat'</span></span><span> </span><span id="local-6989586621680949547"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680949547"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.NumericLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680949547"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Float'</span></span><span> </span><span id="local-6989586621680949545"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680949545"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.NumericLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680949545"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-comment">-- TODO How to handle Infinity, -Infinity and NaN?  Parser cannot parse</span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-comment">--      them.  Haskell doesn't have literals for them either.  Is this</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-comment">--      function only required to operate on terms produced by the parser?</span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-comment">--      In which case the code is fine as it stands.  If it can somehow run</span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-comment">--      on values produced by execution (or, one day, on terms produced by</span><span>
</span><span id="line-241"></span><span>      </span><span class="hs-comment">--      metaprograms), then it needs to be able to print them (and then the</span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-comment">--      parser ought to be able to parse them, to maintain symmetry.)</span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Boolean'</span></span><span> </span><span id="local-6989586621680949543"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949543"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BooleanLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949543"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Text'</span></span><span> </span><span id="local-6989586621680949540"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949540"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-245"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680949539"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949539"><span class="hs-identifier hs-var">quotes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
</span><a href="#local-6989586621680949538"><span class="hs-identifier hs-var">useRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949540"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.TextLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949539"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949540"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949539"><span class="hs-identifier hs-var">quotes</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>          </span><span class="hs-comment">-- we only use this syntax if we're not wrapped in something else,</span><span>
</span><span id="line-249"></span><span>          </span><span class="hs-comment">-- to avoid possible round trip issues if the text ends at an odd column</span><span>
</span><span id="line-250"></span><span>          </span><span id="local-6989586621680949538"><span class="annot"><span class="annottext">useRaw :: Text -&gt; Maybe Text
</span><a href="#local-6989586621680949538"><span class="hs-identifier hs-var hs-var">useRaw</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-251"></span><span>          </span><span class="annot"><a href="#local-6989586621680949538"><span class="hs-identifier hs-var">useRaw</span></a></span><span> </span><span id="local-6989586621680949535"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949535"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Maybe Char
</span><span class="hs-identifier hs-var">Text.find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949535"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">Text.all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621680949532"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949535"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Text
</span><a href="#local-6989586621680949531"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-252"></span><span>          </span><span class="annot"><a href="#local-6989586621680949538"><span class="hs-identifier hs-var">useRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-253"></span><span>          </span><span id="local-6989586621680949532"><span class="annot"><span class="annottext">ok :: Char -&gt; Bool
</span><a href="#local-6989586621680949532"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span id="local-6989586621680949528"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949528"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPrint</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949528"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949528"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949528"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span>
</span><span id="line-254"></span><span>          </span><span class="hs-comment">-- Picks smallest number of surrounding &quot;&quot;&quot; to be unique</span><span>
</span><span id="line-255"></span><span>          </span><span id="local-6989586621680949531"><span class="annot"><span class="annottext">n :: Int -&gt; Maybe Text
</span><a href="#local-6989586621680949531"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- bail at 10, avoiding quadratic behavior in weird cases</span><span>
</span><span id="line-256"></span><span>          </span><span class="annot"><a href="#local-6989586621680949531"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span id="local-6989586621680949526"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949526"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; [(Text, Text)]
</span><span class="hs-identifier hs-var">Text.breakOnAll</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949523"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949540"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949523"><span class="hs-identifier hs-var">quotes</span></a></span><span>
</span><span id="line-259"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Text
</span><a href="#local-6989586621680949531"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949526"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>              </span><span id="local-6989586621680949523"><span class="annot"><span class="annottext">quotes :: Text
</span><a href="#local-6989586621680949523"><span class="hs-identifier hs-var hs-var">quotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949526"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Text'</span></span><span> </span><span id="local-6989586621680949519"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949519"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.TextLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">U.ushow</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949519"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Char'</span></span><span> </span><span id="local-6989586621680949516"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949516"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.CharLiteral</span></span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
</span><span class="hs-identifier hs-var">showEscapeChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949516"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680949514"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949514"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949514"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949516"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Blank'</span></span><span> </span><span id="local-6989586621680949512"><span class="annot"><span class="annottext">Blank ()
</span><a href="#local-6989586621680949512"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Blank</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall loc. Blank loc -&gt; Maybe String
</span><span class="hs-identifier hs-var">Blank.nameb</span></span><span> </span><span class="annot"><span class="annottext">Blank ()
</span><a href="#local-6989586621680949512"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span id="local-6989586621680949507"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949507"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>        </span><span id="local-6989586621680949506"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949506"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949505"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949505"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949506"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949504"><span class="hs-identifier hs-var">conRef</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span id="local-6989586621680949504"><span class="annot"><span class="annottext">conRef :: Referent
</span><a href="#local-6989586621680949504"><span class="hs-identifier hs-var hs-var">conRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949507"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Data</span></span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949504"><span class="hs-identifier hs-var">conRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949505"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Request'</span></span><span> </span><span id="local-6989586621680949500"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949500"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>        </span><span id="local-6989586621680949499"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949499"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949498"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949498"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949499"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949497"><span class="hs-identifier hs-var">conRef</span></a></span><span>
</span><span id="line-278"></span><span>            </span><span id="local-6989586621680949497"><span class="annot"><span class="annottext">conRef :: Referent
</span><a href="#local-6989586621680949497"><span class="hs-identifier hs-var hs-var">conRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949500"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Effect</span></span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949497"><span class="hs-identifier hs-var">conRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949498"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Handle'</span></span><span> </span><span id="local-6989586621680949494"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949494"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680949493"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949493"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621680949492"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949492"><span class="hs-identifier hs-var">pb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949493"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span id="local-6989586621680949491"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949491"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949494"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949490"><span class="annot"><span class="annottext">hangHandler :: Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949490"><span class="hs-identifier hs-var hs-var">hangHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949494"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>              </span><span class="hs-comment">-- handle ... with cases</span><span>
</span><span id="line-285"></span><span>              </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LamsNamedMatch%27"><span class="hs-identifier hs-type">LamsNamedMatch'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[([Pattern ()], Maybe (Term2 v () () v PrintAnnotation),
  Term2 v () () v PrintAnnotation)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680949488"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949488"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680949487"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949487"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949488"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949487"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-286"></span><span>              </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-288"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949492"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949491"><span class="hs-identifier hs-var">ph</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-keyword">then</span><span>
</span><span id="line-290"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-291"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;handle&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949492"><span class="hs-identifier hs-var">pb</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>                  </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;with&quot;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949490"><span class="hs-operator hs-var">`hangHandler`</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949491"><span class="hs-identifier hs-var">ph</span></a></span><span>
</span><span id="line-293"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-295"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spaced</span></span><span>
</span><span id="line-296"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;handle&quot;</span></span><span>
</span><span id="line-297"></span><span>                    </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949492"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-298"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span>
</span><span id="line-299"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;with&quot;</span></span><span>
</span><span id="line-300"></span><span>                      </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949490"><span class="hs-operator hs-var">`hangHandler`</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949491"><span class="hs-identifier hs-var">ph</span></a></span><span>
</span><span id="line-301"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Delay'</span></span><span> </span><span id="local-6989586621680949481"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase () (Term2 v () () v PrintAnnotation)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>            </span><span id="local-6989586621680949479"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949479"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949478"><span class="annot"><span class="annottext">hang :: Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949478"><span class="hs-identifier hs-var hs-var">hang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softHang</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-307"></span><span>              </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949478"><span class="hs-operator hs-var">`hang`</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949479"><span class="hs-identifier hs-var">px</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949476"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949476"><span class="hs-identifier hs-var">im0'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949475"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949475"><span class="hs-identifier hs-var">uses0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
(Var v, Ord v) =&gt;
Imports
-&gt; Term3 v PrintAnnotation -&gt; (Imports, [Pretty SyntaxText])
</span><a href="Unison.Syntax.TermPrinter.html#calcImports"><span class="hs-identifier hs-var">calcImports</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949474"><span class="annot"><span class="annottext">allowUses :: Bool
</span><a href="#local-6989586621680949474"><span class="hs-identifier hs-var hs-var">allowUses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall vt at ap v a. Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-var">isLet</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-311"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949471"><span class="annot"><span class="annottext">im' :: Imports
</span><a href="#local-6989586621680949471"><span class="hs-identifier hs-var hs-var">im'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949474"><span class="hs-identifier hs-var">allowUses</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949476"><span class="hs-identifier hs-var">im0'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span>
</span><span id="line-312"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949470"><span class="annot"><span class="annottext">uses :: [Pretty SyntaxText]
</span><a href="#local-6989586621680949470"><span class="hs-identifier hs-var hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949474"><span class="hs-identifier hs-var">allowUses</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949475"><span class="hs-identifier hs-var">uses0</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949469"><span class="annot"><span class="annottext">soft :: Bool
</span><a href="#local-6989586621680949469"><span class="hs-identifier hs-var hs-var">soft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949470"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-314"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949468"><span class="annot"><span class="annottext">hang :: Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949468"><span class="hs-identifier hs-var hs-var">hang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949469"><span class="hs-identifier hs-var">soft</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softHang</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span>
</span><span id="line-315"></span><span>            </span><span id="local-6989586621680949467"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949467"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949471"><span class="hs-identifier hs-var">im'</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949481"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-316"></span><span>            </span><span class="hs-comment">-- this makes sure we get proper indentation if `px` spills onto</span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-comment">-- multiple lines, since `do` introduces layout block</span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949466"><span class="annot"><span class="annottext">indent :: Width
</span><a href="#local-6989586621680949466"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Width
</span><span class="hs-identifier hs-var">PP.Width</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949469"><span class="hs-identifier hs-var">soft</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949469"><span class="hs-identifier hs-var">soft</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-320"></span><span>              </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949468"><span class="hs-operator hs-var">`hang`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949470"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Width -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentNAfterNewline</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680949466"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949467"><span class="hs-identifier hs-var">px</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680949462"><span class="annot"><span class="annottext">Seq (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680949462"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949461"><span class="annot"><span class="annottext">listLink :: Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var hs-var">listLink</span></a></span></span><span> </span><span id="local-6989586621680949460"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949460"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TypeReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier hs-var">Type.listRef</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949460"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-323"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949453"><span class="annot"><span class="annottext">comma :: Pretty SyntaxText
</span><a href="#local-6989586621680949453"><span class="hs-identifier hs-var hs-var">comma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var">listLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var">listLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>        </span><span id="local-6989586621680949451"><span class="annot"><span class="annottext">Seq (Pretty SyntaxText)
</span><a href="#local-6989586621680949451"><span class="hs-identifier hs-var">pelems</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Width -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentNAfterNewline</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680949462"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-325"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949446"><span class="annot"><span class="annottext">open :: Pretty SyntaxText
</span><a href="#local-6989586621680949446"><span class="hs-identifier hs-var hs-var">open</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var">listLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var">listLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;[ &quot;</span></span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949440"><span class="annot"><span class="annottext">close :: Pretty SyntaxText
</span><a href="#local-6989586621680949440"><span class="hs-identifier hs-var hs-var">close</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var">listLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949461"><span class="hs-identifier hs-var">listLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949446"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949453"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Pretty SyntaxText)
</span><a href="#local-6989586621680949451"><span class="hs-identifier hs-var">pelems</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949440"><span class="hs-identifier hs-var">close</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">If'</span></span><span> </span><span id="local-6989586621680949436"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949436"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621680949435"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949435"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680949434"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949434"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>          </span><span id="local-6989586621680949433"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949433"><span class="hs-identifier hs-var">pcond</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949436"><span class="hs-identifier hs-var">cond</span></a></span><span>
</span><span id="line-331"></span><span>          </span><span id="local-6989586621680949432"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949432"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949435"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-332"></span><span>          </span><span id="local-6989586621680949431"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949431"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949434"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-333"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-334"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949433"><span class="hs-identifier hs-var">pcond</span></a></span><span>
</span><span id="line-335"></span><span>              </span><span class="hs-keyword">then</span><span>
</span><span id="line-336"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-337"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;if&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949433"><span class="hs-identifier hs-var">pcond</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-338"></span><span>                    </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;then&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949432"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-339"></span><span>                    </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;else&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949431"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-340"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>              </span><span class="hs-keyword">else</span><span>
</span><span id="line-342"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949432"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949431"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-343"></span><span>                  </span><span class="hs-keyword">then</span><span>
</span><span id="line-344"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-345"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;if &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949433"><span class="hs-identifier hs-var">pcond</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; then&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949432"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-346"></span><span>                        </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;else&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949431"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-347"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-349"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spaced</span></span><span>
</span><span id="line-350"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;if&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949433"><span class="hs-identifier hs-var">pcond</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; then&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949432"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>                        </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;else&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949431"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-352"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>      </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LetBlock"><span class="hs-identifier hs-type">LetBlock</span></a></span><span> </span><span id="local-6989586621680949429"><span class="annot"><span class="annottext">[(v, Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949429"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621680949428"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949428"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949427"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949427"><span class="hs-identifier hs-var">im'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949426"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949426"><span class="hs-identifier hs-var">uses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
(Var v, Ord v) =&gt;
Imports
-&gt; Term3 v PrintAnnotation -&gt; (Imports, [Pretty SyntaxText])
</span><a href="Unison.Syntax.TermPrinter.html#calcImports"><span class="hs-identifier hs-var">calcImports</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949591"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-355"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; BlockContext
-&gt; [(v, Term2 v () () v PrintAnnotation)]
-&gt; Term2 v () () v PrintAnnotation
-&gt; Imports
-&gt; [Pretty SyntaxText]
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949425"><span class="hs-identifier hs-var">printLet</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949592"><span class="hs-identifier hs-var">elideUnit</span></a></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680949596"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">[(v, Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949429"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949428"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949427"><span class="hs-identifier hs-var">im'</span></a></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949426"><span class="hs-identifier hs-var">uses</span></a></span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-comment">-- Some matches are rendered as a destructuring bind, like</span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-comment">--   match foo with (a,b) -&gt; blah</span><span>
</span><span id="line-358"></span><span>      </span><span class="hs-comment">-- becomes</span><span>
</span><span id="line-359"></span><span>      </span><span class="hs-comment">--   (a,b) = foo</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-comment">--   blah</span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-comment">-- See `isDestructuringBind` definition.</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span id="local-6989586621680949424"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949424"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span id="local-6989586621680949423"><span class="annot"><span class="annottext">cs :: [MatchCase () (Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949423"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span id="local-6989586621680949421"><span class="annot"><span class="annottext">Pattern ()
</span><a href="#local-6989586621680949421"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621680949420"><span class="annot"><span class="annottext">Maybe (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680949420"><span class="hs-identifier hs-var">guard</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AbsN'</span></span><span> </span><span id="local-6989586621680949419"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949419"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680949418"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949418"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) a loc.
Ord v =&gt;
Term f v a -&gt; [MatchCase loc (Term f v a)] -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isDestructuringBind"><span class="hs-identifier hs-var">isDestructuringBind</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949424"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchCase () (Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949423"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>            </span><span id="local-6989586621680949415"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949415"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-365"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949414"><span class="annot"><span class="annottext">letIntro :: Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949414"><span class="hs-identifier hs-var hs-var">letIntro</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680949596"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>                  </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-367"></span><span>                  </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680949412"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949412"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949412"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span id="local-6989586621680949411"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949411"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949410"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949410"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949415"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949419"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern ()
</span><a href="#local-6989586621680949421"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-370"></span><span>              </span><span id="local-6989586621680949409"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949409"><span class="hs-identifier hs-var">guard'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Term2 v () () v PrintAnnotation) -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949408"><span class="hs-identifier hs-var">printGuard</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680949420"><span class="hs-identifier hs-var">guard</span></a></span><span>
</span><span id="line-371"></span><span>              </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949410"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949409"><span class="hs-identifier hs-var">guard'</span></a></span><span>
</span><span id="line-372"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949405"><span class="annot"><span class="annottext">eq :: Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949405"><span class="hs-identifier hs-var hs-var">eq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BindingEquals</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;=&quot;</span></span><span>
</span><span id="line-373"></span><span>            </span><span id="local-6989586621680949403"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949403"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949424"><span class="hs-identifier hs-var">scrutinee</span></a></span><span>
</span><span id="line-374"></span><span>            </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949414"><span class="hs-identifier hs-var">letIntro</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-375"></span><span>              </span><span id="local-6989586621680949401"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949401"><span class="hs-identifier hs-var">prettyBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949418"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-376"></span><span>              </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-377"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-378"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949411"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949405"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949403"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-379"></span><span>                    </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949401"><span class="hs-identifier hs-var">prettyBody</span></a></span><span>
</span><span id="line-380"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>          </span><span id="local-6989586621680949408"><span class="annot"><span class="annottext">printGuard :: Maybe (Term2 v () () v PrintAnnotation) -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949408"><span class="hs-identifier hs-var hs-var">printGuard</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Term2 v () () v PrintAnnotation)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-383"></span><span>          </span><span class="annot"><a href="#local-6989586621680949408"><span class="hs-identifier hs-var">printGuard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680949400"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949400"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949399"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949399"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; ([v], Term f v a)
</span><span class="hs-identifier hs-var">ABT.unabs</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949400"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-385"></span><span>            </span><span id="local-6989586621680949397"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949397"><span class="hs-identifier hs-var">prettyg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949399"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;| &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949397"><span class="hs-identifier hs-var">prettyg</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span id="local-6989586621680949395"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949395"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span id="local-6989586621680949394"><span class="annot"><span class="annottext">[MatchCase () (Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949394"><span class="hs-identifier hs-var">branches</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>          </span><span id="local-6989586621680949393"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949393"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949395"><span class="hs-identifier hs-var">scrutinee</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span id="local-6989586621680949392"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949392"><span class="hs-identifier hs-var">pbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports
-&gt; DocLiteralContext
-&gt; [MatchCase' () (Term3 v PrintAnnotation)]
-&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#printCase"><span class="hs-identifier hs-var">printCase</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann tm. [MatchCase ann tm] -&gt; [MatchCase' ann tm]
</span><a href="Unison.Syntax.TermPrinter.html#arity1Branches"><span class="hs-identifier hs-var">arity1Branches</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchCase () (Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949394"><span class="hs-identifier hs-var">branches</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- don't print with `cases` syntax</span><span>
</span><span id="line-391"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949393"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-393"></span><span>              </span><span class="hs-keyword">then</span><span>
</span><span id="line-394"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-395"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;match &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949393"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-396"></span><span>                    </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; with&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949392"><span class="hs-identifier hs-var">pbs</span></a></span><span>
</span><span id="line-397"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;match &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949393"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; with&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949392"><span class="hs-identifier hs-var">pbs</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span id="local-6989586621680949389"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949389"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680949388"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949388"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949389"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s (m :: * -&gt; *) a.
(Traversable f, IsString s, Applicative m) =&gt;
(a -&gt; m (Pretty s)) -&gt; f a -&gt; m (Pretty s)
</span><span class="hs-identifier hs-var">PP.spacedTraverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949388"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>      </span><span id="local-6989586621680949385"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949385"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949385"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>      </span><span id="local-6989586621680949387"><span class="annot"><span class="annottext">goNormal :: Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var hs-var">goNormal</span></a></span></span><span> </span><span id="local-6989586621680949384"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949384"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621680949383"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949383"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949384"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949383"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span id="local-6989586621680949590"><span class="annot"><span class="annottext">specialCases :: Term2 v () () v PrintAnnotation
-&gt; (Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText))
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949590"><span class="hs-identifier hs-var hs-var">specialCases</span></a></span></span><span> </span><span id="local-6989586621680949382"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621680949381"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949381"><span class="hs-identifier hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>        </span><span id="local-6989586621680949380"><span class="annot"><span class="annottext">Maybe (Pretty SyntaxText)
</span><a href="#local-6989586621680949380"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext
-&gt; Term3 v PrintAnnotation -&gt; m (Maybe (Pretty SyntaxText))
</span><a href="Unison.Syntax.TermPrinter.html#prettyDoc2"><span class="hs-identifier hs-var">prettyDoc2</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949598"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Pretty SyntaxText)
</span><a href="#local-6989586621680949380"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-406"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680949378"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949378"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949378"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-407"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Pretty SyntaxText)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText))
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949377"><span class="hs-identifier hs-var">notDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949381"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-408"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>          </span><span id="local-6989586621680949377"><span class="annot"><span class="annottext">notDoc :: (Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText))
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949377"><span class="hs-identifier hs-var hs-var">notDoc</span></a></span></span><span> </span><span id="local-6989586621680949376"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949376"><span class="hs-identifier hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-410"></span><span>            </span><span id="local-6989586621680949375"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949375"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-411"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- This predicate controls which binary functions we render as infix</span><span>
</span><span id="line-412"></span><span>                </span><span class="hs-comment">-- operators. At the moment the policy is just to render symbolic</span><span>
</span><span id="line-413"></span><span>                </span><span class="hs-comment">-- operators as infix.</span><span>
</span><span id="line-414"></span><span>                </span><span class="annot"><a href="#local-6989586621680949374"><span class="hs-identifier hs-type">binaryOpsPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-415"></span><span>                </span><span id="local-6989586621680949374"><span class="annot"><span class="annottext">binaryOpsPred :: Term2 v () () v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680949374"><span class="hs-identifier hs-var hs-var">binaryOpsPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-416"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680949373"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949373"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSymbolic"><span class="hs-identifier hs-var">isSymbolic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949375"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680949373"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Var'</span></span><span> </span><span id="local-6989586621680949371"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949371"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSymbolic"><span class="hs-identifier hs-var">isSymbolic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; HashQualified Name
</span><span class="hs-identifier hs-var">HQ.unsafeFromVar</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949371"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-418"></span><span>                  </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-419"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680949374"><span class="hs-identifier hs-var">binaryOpsPred</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-420"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="Unison.Builtin.Decls.html#Doc"><span class="hs-identifier hs-var">DD.Doc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#MaybeDoc"><span class="hs-identifier hs-var">MaybeDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-422"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v. Term3 v PrintAnnotation -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isDocLiteral"><span class="hs-identifier hs-var">isDocLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-423"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *) a b c.
MonadPretty v m =&gt;
(PrettyPrintEnv -&gt; a -&gt; b -&gt; c) -&gt; a -&gt; b -&gt; m c
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#applyPPE3"><span class="hs-identifier hs-var">applyPPE3</span></a></span><span> </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Imports -&gt; Term3 v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyDoc"><span class="hs-identifier hs-var">prettyDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-424"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949598"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:docContext:AmbientContext :: DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AdocContext%3AAmbientContext"><span class="hs-identifier hs-var">docContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#NoDoc"><span class="hs-identifier hs-var">NoDoc</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-425"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#TupleTerm%27"><span class="hs-identifier hs-type">TupleTerm'</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680949366"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949366"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949365"><span class="annot"><span class="annottext">conRef :: Referent
</span><a href="#local-6989586621680949365"><span class="hs-identifier hs-var hs-var">conRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="Unison.Builtin.Decls.html#pairCtorRef"><span class="hs-identifier hs-var">DD.pairCtorRef</span></a></span><span>
</span><span id="line-427"></span><span>                </span><span id="local-6989586621680949363"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949363"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *) a b.
MonadPretty v m =&gt;
(PrettyPrintEnv -&gt; a -&gt; b) -&gt; a -&gt; m b
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#applyPPE2"><span class="hs-identifier hs-var">applyPPE2</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949365"><span class="hs-identifier hs-var">conRef</span></a></span><span>
</span><span id="line-428"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949361"><span class="annot"><span class="annottext">pair :: Pretty SyntaxText
</span><a href="#local-6989586621680949361"><span class="hs-identifier hs-var hs-var">pair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var">parenIfInfix</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949363"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680949595"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949365"><span class="hs-identifier hs-var">conRef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949363"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-429"></span><span>                </span><span id="local-6989586621680949360"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949360"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949366"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-430"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-431"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949361"><span class="hs-identifier hs-var">pair</span></a></span><span>
</span><span id="line-432"></span><span>                    </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spaced</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949360"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="Unison.Builtin.Decls.html#unitCtorRef"><span class="hs-identifier hs-var">DD.unitCtorRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;()&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#TupleTerm%27"><span class="hs-identifier hs-type">TupleTerm'</span></a></span><span> </span><span id="local-6989586621680949358"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949358"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949357"><span class="annot"><span class="annottext">tupleLink :: Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var hs-var">tupleLink</span></a></span></span><span> </span><span id="local-6989586621680949356"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949356"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TypeReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#pairRef"><span class="hs-identifier hs-var">DD.pairRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949356"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-435"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949349"><span class="annot"><span class="annottext">comma :: Pretty SyntaxText
</span><a href="#local-6989586621680949349"><span class="hs-identifier hs-var hs-var">comma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var">tupleLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var">tupleLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>                </span><span id="local-6989586621680949348"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949348"><span class="hs-identifier hs-var">pelems</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Width -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentNAfterNewline</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949358"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-437"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949347"><span class="annot"><span class="annottext">clist :: Pretty SyntaxText
</span><a href="#local-6989586621680949347"><span class="hs-identifier hs-var hs-var">clist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949349"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949348"><span class="hs-identifier hs-var">pelems</span></a></span><span>
</span><span id="line-438"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949343"><span class="annot"><span class="annottext">open :: Pretty SyntaxText
</span><a href="#local-6989586621680949343"><span class="hs-identifier hs-var hs-var">open</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var">tupleLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var">tupleLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;( &quot;</span></span><span>
</span><span id="line-439"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949337"><span class="annot"><span class="annottext">close :: Pretty SyntaxText
</span><a href="#local-6989586621680949337"><span class="hs-identifier hs-var hs-var">close</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var">tupleLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949357"><span class="hs-identifier hs-var">tupleLink</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949343"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949347"><span class="hs-identifier hs-var">clist</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949337"><span class="hs-identifier hs-var">close</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span id="local-6989586621680949335"><span class="annot"><span class="annottext">f :: Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949335"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Builtin'</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Any.Any&quot;</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680949333"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949333"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-442"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949335"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949333"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#Rewrites%27"><span class="hs-identifier hs-type">DD.Rewrites'</span></a></span><span> </span><span id="local-6989586621680949331"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949331"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949328"><span class="annot"><span class="annottext">kw :: Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949328"><span class="hs-identifier hs-var hs-var">kw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;@rewrite&quot;</span></span><span>
</span><span id="line-445"></span><span>                    </span><span id="local-6989586621680949325"><span class="annot"><span class="annottext">arr :: Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949325"><span class="hs-identifier hs-var hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;==&gt;&quot;</span></span><span>
</span><span id="line-446"></span><span>                    </span><span id="local-6989586621680949324"><span class="annot"><span class="annottext">control :: Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949324"><span class="hs-identifier hs-var hs-var">control</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span>
</span><span id="line-447"></span><span>                    </span><span id="local-6989586621680949323"><span class="annot"><span class="annottext">sub :: Pretty SyntaxText
-&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949323"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621680949322"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949322"><span class="hs-identifier hs-var">kw</span></a></span></span><span> </span><span id="local-6989586621680949321"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949321"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949324"><span class="hs-identifier hs-var">control</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949322"><span class="hs-identifier hs-var">kw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949321"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949325"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>                    </span><span id="local-6989586621680949319"><span class="annot"><span class="annottext">go :: Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949319"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#RewriteTerm%27"><span class="hs-identifier hs-type">DD.RewriteTerm'</span></a></span><span> </span><span id="local-6989586621680949317"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949317"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680949316"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949316"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
-&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949323"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;term&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949317"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949316"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-449"></span><span>                    </span><span class="annot"><a href="#local-6989586621680949319"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#RewriteCase%27"><span class="hs-identifier hs-type">DD.RewriteCase'</span></a></span><span> </span><span id="local-6989586621680949314"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949314"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680949313"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949313"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
-&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949323"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;case&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949314"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949313"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-450"></span><span>                    </span><span class="annot"><a href="#local-6989586621680949319"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#RewriteSignature%27"><span class="hs-identifier hs-type">DD.RewriteSignature'</span></a></span><span> </span><span id="local-6989586621680949311"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949311"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680949310"><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680949310"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680949309"><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680949309"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-451"></span><span>                      </span><span id="local-6989586621680949308"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949308"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v a (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports -&gt; Int -&gt; Type v a -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TypePrinter.html#pretty0"><span class="hs-identifier hs-var">TypePrinter.pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680949310"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-452"></span><span>                      </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; [Pretty SyntaxText]
</span><a href="#local-6989586621680949307"><span class="hs-identifier hs-var">stuff</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949308"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v a (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports -&gt; Int -&gt; Type v a -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TypePrinter.html#pretty0"><span class="hs-identifier hs-var">TypePrinter.pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680949309"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-453"></span><span>                      </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>                        </span><span id="local-6989586621680949307"><span class="annot"><span class="annottext">stuff :: Pretty SyntaxText -&gt; [Pretty SyntaxText]
</span><a href="#local-6989586621680949307"><span class="hs-identifier hs-var hs-var">stuff</span></a></span></span><span> </span><span id="local-6989586621680949306"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949306"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>                          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949324"><span class="hs-identifier hs-var">control</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;signature&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>                            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949304"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680949304"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949304"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949311"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>                            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949311"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.TypeOperator</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949306"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949325"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-459"></span><span>                    </span><span class="annot"><a href="#local-6989586621680949319"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680949302"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949302"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949302"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-460"></span><span>                </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r)
</span><a href="#local-6989586621680949328"><span class="hs-identifier hs-var">kw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949319"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949331"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#Bytes%27"><span class="hs-identifier hs-type">Bytes'</span></a></span><span> </span><span id="local-6989586621680949300"><span class="annot"><span class="annottext">[ConstructorId]
</span><a href="#local-6989586621680949300"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BytesLiteral</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;0xs&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a s. (Show a, IsString s) =&gt; a -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.shown</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; Bytes
</span><span class="hs-identifier hs-var">Bytes.fromWord8s</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">[ConstructorId]
</span><a href="#local-6989586621680949300"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">BinaryAppsPred'</span></span><span> </span><span id="local-6989586621680949295"><span class="annot"><span class="annottext">[(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949295"><span class="hs-identifier hs-var">apps</span></a></span></span><span> </span><span id="local-6989586621680949294"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949294"><span class="hs-identifier hs-var">lastArg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>                </span><span id="local-6989586621680949293"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949293"><span class="hs-identifier hs-var">prettyLast</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949294"><span class="hs-identifier hs-var">lastArg</span></a></span><span>
</span><span id="line-465"></span><span>                </span><span id="local-6989586621680949292"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949292"><span class="hs-identifier hs-var">prettyApps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
-&gt; Pretty SyntaxText -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949291"><span class="hs-identifier hs-var">binaryApps</span></a></span><span> </span><span class="annot"><span class="annottext">[(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949295"><span class="hs-identifier hs-var">apps</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949293"><span class="hs-identifier hs-var">prettyLast</span></a></span><span>
</span><span id="line-466"></span><span>                </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949292"><span class="hs-identifier hs-var">prettyApps</span></a></span><span>
</span><span id="line-467"></span><span>              </span><span class="hs-comment">-- Note that &amp;&amp; and || are at the same precedence, which can cause</span><span>
</span><span id="line-468"></span><span>              </span><span class="hs-comment">-- confusion, so for clarity we do not want to elide the parentheses in a</span><span>
</span><span id="line-469"></span><span>              </span><span class="hs-comment">-- case like `(x || y) &amp;&amp; z`.</span><span>
</span><span id="line-470"></span><span>              </span><span class="hs-comment">{-
              When a delayed computation block is passed to a function as the last argument
              in a context where the ambient precedence is low enough, we can elide parentheses
              around it and use a &quot;soft hang&quot; to put the `'let` on the same line as the function call.
              This looks nice.

                forkAt usEast 'let
                  x = thing1
                  y = thing2
                  ...

              instead of the ugly but effective

                forkAt
                  usEast
                  ('let
                    x = thing1
                    y = thing2
                    ...)
              -}</span><span>
</span><span id="line-490"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span id="local-6989586621680949290"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949290"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#UnitRef"><span class="hs-identifier hs-var">DD.UnitRef</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall vt at ap v a. Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949290"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-491"></span><span>                </span><span id="local-6989586621680949286"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949286"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Ord v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBlock"><span class="hs-identifier hs-var">isBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949290"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949290"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-492"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Ord v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBlock"><span class="hs-identifier hs-var">isBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949290"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-493"></span><span>                  </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelayForceChar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Width -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentNAfterNewline</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949286"><span class="hs-identifier hs-var">px</span></a></span><span>
</span><span id="line-494"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span id="local-6989586621680949283"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949283"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s a. Snoc s s a a =&gt; s -&gt; Maybe (s, a)
</span><span class="hs-identifier hs-var">unsnoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949282"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949282"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949281"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949281"><span class="hs-identifier hs-var">lastArg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949281"><span class="hs-identifier hs-var">lastArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>                    </span><span id="local-6989586621680949280"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949280"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949283"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-497"></span><span>                    </span><span id="local-6989586621680949279"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949279"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949282"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-498"></span><span>                    </span><span id="local-6989586621680949278"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949278"><span class="hs-identifier hs-var">lastArg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949387"><span class="hs-identifier hs-var">goNormal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949281"><span class="hs-identifier hs-var">lastArg</span></a></span><span>
</span><span id="line-499"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949273"><span class="annot"><span class="annottext">softTab :: Pretty SyntaxText
</span><a href="#local-6989586621680949273"><span class="hs-identifier hs-var hs-var">softTab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;  &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-501"></span><span>                      </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949273"><span class="hs-identifier hs-var">softTab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949280"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949279"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949273"><span class="hs-identifier hs-var">softTab</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949278"><span class="hs-identifier hs-var">lastArg'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ands'</span></span><span> </span><span id="local-6989586621680949271"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949271"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680949270"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949270"><span class="hs-identifier hs-var">lastArg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-503"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-504"></span><span>                  </span><span id="local-6989586621680949269"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949269"><span class="hs-identifier hs-var">lastArg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949270"><span class="hs-identifier hs-var">lastArg</span></a></span><span>
</span><span id="line-505"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
-&gt; [Term2 v () () v PrintAnnotation]
-&gt; Pretty SyntaxText
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949268"><span class="hs-identifier hs-var">booleanOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;&amp;&amp;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949271"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949269"><span class="hs-identifier hs-var">lastArg'</span></a></span><span>
</span><span id="line-506"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ors'</span></span><span> </span><span id="local-6989586621680949266"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949266"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680949265"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949265"><span class="hs-identifier hs-var">lastArg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-507"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>                  </span><span id="local-6989586621680949264"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949264"><span class="hs-identifier hs-var">lastArg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949265"><span class="hs-identifier hs-var">lastArg</span></a></span><span>
</span><span id="line-509"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
-&gt; [Term2 v () () v PrintAnnotation]
-&gt; Pretty SyntaxText
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949268"><span class="hs-identifier hs-var">booleanOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949266"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949264"><span class="hs-identifier hs-var">lastArg'</span></a></span><span>
</span><span id="line-510"></span><span>              </span><span id="local-6989586621680949263"><span class="annot"><span class="annottext">(Term2 v () () v PrintAnnotation,
 Term2 v () () v PrintAnnotation -&gt; Bool)
</span><a href="#local-6989586621680949263"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680949262"><span class="hs-identifier hs-var">nonForcePred</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-511"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OverappliedBinaryAppPred'</span></span><span> </span><span id="local-6989586621680949260"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680949259"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949259"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680949258"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949258"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680949257"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949257"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-512"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680949374"><span class="hs-identifier hs-var">binaryOpsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949260"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>                      </span><span class="hs-comment">-- Special case for overapplied binary op</span><span>
</span><span id="line-514"></span><span>                      </span><span class="hs-keyword">do</span><span>
</span><span id="line-515"></span><span>                        </span><span id="local-6989586621680949256"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949256"><span class="hs-identifier hs-var">prettyB</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949258"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-516"></span><span>                        </span><span id="local-6989586621680949255"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949255"><span class="hs-identifier hs-var">prettyR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s (m :: * -&gt; *) a.
(Traversable f, IsString s, Applicative m) =&gt;
(a -&gt; m (Pretty s)) -&gt; f a -&gt; m (Pretty s)
</span><span class="hs-identifier hs-var">PP.spacedTraverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949257"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-517"></span><span>                        </span><span id="local-6989586621680949254"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949254"><span class="hs-identifier hs-var">prettyA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
-&gt; Pretty SyntaxText -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949291"><span class="hs-identifier hs-var">binaryApps</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949260"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949259"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949256"><span class="hs-identifier hs-var">prettyB</span></a></span><span>
</span><span id="line-518"></span><span>                        </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949254"><span class="hs-identifier hs-var">prettyA</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949255"><span class="hs-identifier hs-var">prettyR</span></a></span><span>
</span><span id="line-519"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">AppsPred'</span></span><span> </span><span id="local-6989586621680949252"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949252"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680949251"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949251"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-520"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>                    </span><span id="local-6989586621680949250"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949250"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949252"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-522"></span><span>                    </span><span id="local-6989586621680949249"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949249"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s (m :: * -&gt; *) a.
(Traversable f, IsString s, Applicative m) =&gt;
(a -&gt; m (Pretty s)) -&gt; f a -&gt; m (Pretty s)
</span><span class="hs-identifier hs-var">PP.spacedTraverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949251"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-523"></span><span>                    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949250"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949249"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-524"></span><span>                </span><span id="local-6989586621680949248"><span class="annot"><span class="annottext">(Term2 v () () v PrintAnnotation,
 Term2 v () () v PrintAnnotation -&gt; Bool)
</span><a href="#local-6989586621680949248"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680949247"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949247"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var v =&gt; v -&gt; Bool
</span><a href="#local-6989586621680949246"><span class="hs-identifier hs-var">nonUnitArgPred</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949247"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="#local-6989586621680949245"><span class="hs-identifier hs-var">isDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-525"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LamsNamedMatch%27"><span class="hs-identifier hs-type">LamsNamedMatch'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680949244"><span class="annot"><span class="annottext">[([Pattern ()], Maybe (Term2 v () () v PrintAnnotation),
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949244"><span class="hs-identifier hs-var">branches</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>                    </span><span id="local-6989586621680949243"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949243"><span class="hs-identifier hs-var">pbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports
-&gt; DocLiteralContext
-&gt; [MatchCase' () (Term3 v PrintAnnotation)]
-&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#printCase"><span class="hs-identifier hs-var">printCase</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">[([Pattern ()], Maybe (Term2 v () () v PrintAnnotation),
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949244"><span class="hs-identifier hs-var">branches</span></a></span><span>
</span><span id="line-527"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-528"></span><span>                      </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;cases&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949243"><span class="hs-identifier hs-var">pbs</span></a></span><span>
</span><span id="line-529"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">LamsNamedPred'</span></span><span> </span><span id="local-6989586621680949241"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949241"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680949240"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949240"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>                    </span><span id="local-6989586621680949239"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949239"><span class="hs-identifier hs-var">prettyBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949240"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-531"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949238"><span class="annot"><span class="annottext">hang :: Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949238"><span class="hs-identifier hs-var hs-var">hang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949240"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-532"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Delay'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lets'</span></span><span> </span><span class="annot"><span class="annottext">[(Bool, v, Term2 v () () v PrintAnnotation)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softHang</span></span><span>
</span><span id="line-533"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Lets'</span></span><span> </span><span class="annot"><span class="annottext">[(Bool, v, Term2 v () () v PrintAnnotation)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softHang</span></span><span>
</span><span id="line-534"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase () (Term2 v () () v PrintAnnotation)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softHang</span></span><span>
</span><span id="line-535"></span><span>                          </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span>
</span><span id="line-536"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-537"></span><span>                      </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[v] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949236"><span class="hs-identifier hs-var">varList</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949241"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; -&gt;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949238"><span class="hs-operator hs-var">`hang`</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949239"><span class="hs-identifier hs-var">prettyBody</span></a></span><span>
</span><span id="line-538"></span><span>                  </span><span id="local-6989586621680949235"><span class="annot"><span class="annottext">(Term2 v () () v PrintAnnotation, v -&gt; Bool)
</span><a href="#local-6989586621680949235"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949376"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949382"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span>      </span><span id="local-6989586621680949245"><span class="annot"><span class="annottext">isDelay :: Term2 vt at ap v a -&gt; Bool
</span><a href="#local-6989586621680949245"><span class="hs-identifier hs-var hs-var">isDelay</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Delay'</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="#local-6989586621680949245"><span class="hs-identifier hs-var">isDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-542"></span><span>      </span><span id="local-6989586621680949224"><span class="annot"><span class="annottext">sepList' :: (a -&gt; f b) -&gt; b -&gt; [a] -&gt; f b
</span><a href="#local-6989586621680949224"><span class="hs-identifier hs-var hs-var">sepList'</span></a></span></span><span> </span><span id="local-6989586621680949223"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621680949223"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680949222"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680949222"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621680949221"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949221"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680949222"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621680949223"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949221"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-543"></span><span>      </span><span id="local-6989586621680949236"><span class="annot"><span class="annottext">varList :: [v] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949236"><span class="hs-identifier hs-var hs-var">varList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {b} {a}.
(Monoid b, Applicative f) =&gt;
(a -&gt; f b) -&gt; b -&gt; [a] -&gt; f b
</span><a href="#local-6989586621680949224"><span class="hs-identifier hs-var">sepList'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><a href="#local-6989586621680949425"><span class="hs-identifier hs-type">printLet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-546"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- elideUnit</span><span>
</span><span id="line-547"></span><span>        </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#BlockContext"><span class="hs-identifier hs-type">BlockContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-550"></span><span>        </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-551"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><a href="#local-6989586621680951248"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>      </span><span id="local-6989586621680949425"><span class="annot"><span class="annottext">printLet :: Bool
-&gt; BlockContext
-&gt; [(v, Term2 v () () v PrintAnnotation)]
-&gt; Term2 v () () v PrintAnnotation
-&gt; Imports
-&gt; [Pretty SyntaxText]
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949425"><span class="hs-identifier hs-var hs-var">printLet</span></a></span></span><span> </span><span id="local-6989586621680949210"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949210"><span class="hs-identifier hs-var">elideUnit</span></a></span></span><span> </span><span id="local-6989586621680949209"><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680949209"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621680949208"><span class="annot"><span class="annottext">[(v, Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949208"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621680949207"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949207"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680949206"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949206"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621680949205"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949205"><span class="hs-identifier hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-554"></span><span>        </span><span id="local-6989586621680949204"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949204"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(v, Term2 v () () v PrintAnnotation) -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949203"><span class="hs-identifier hs-var">printBinding</span></a></span><span> </span><span class="annot"><span class="annottext">[(v, Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949208"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621680949202"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949202"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m [Pretty SyntaxText]
</span><a href="#local-6989586621680949201"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949207"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-556"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680949209"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949597"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949199"><span class="hs-identifier hs-var">letIntro</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949205"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949204"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949202"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>          </span><span id="local-6989586621680949201"><span class="annot"><span class="annottext">body :: Term2 v () () v PrintAnnotation -&gt; m [Pretty SyntaxText]
</span><a href="#local-6989586621680949201"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#UnitRef"><span class="hs-identifier hs-var">DD.UnitRef</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949210"><span class="hs-identifier hs-var">elideUnit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span>          </span><span class="annot"><a href="#local-6989586621680949201"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span id="local-6989586621680949198"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949198"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949206"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949198"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-560"></span><span>          </span><span id="local-6989586621680949203"><span class="annot"><span class="annottext">printBinding :: (v, Term2 v () () v PrintAnnotation) -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949203"><span class="hs-identifier hs-var hs-var">printBinding</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949197"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949197"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949196"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949196"><span class="hs-identifier hs-var">binding</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Bool
</span><span class="hs-identifier hs-var">Var.isAction</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949197"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-562"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949206"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949196"><span class="hs-identifier hs-var">binding</span></a></span><span>
</span><span id="line-563"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#renderPrettyBinding"><span class="hs-identifier hs-var">renderPrettyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext
-&gt; HashQualified Name -&gt; Term3 v PrintAnnotation -&gt; m PrettyBinding
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding0%27"><span class="hs-identifier hs-var">prettyBinding0'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949206"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; HashQualified Name
</span><span class="hs-identifier hs-var">HQ.unsafeFromVar</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949197"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949196"><span class="hs-identifier hs-var">binding</span></a></span><span>
</span><span id="line-564"></span><span>          </span><span id="local-6989586621680949199"><span class="annot"><span class="annottext">letIntro :: Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680949199"><span class="hs-identifier hs-var hs-var">letIntro</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680949209"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-565"></span><span>            </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-566"></span><span>            </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680949192"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949192"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949192"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><a href="#local-6989586621680949262"><span class="hs-identifier hs-type">nonForcePred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-569"></span><span>      </span><span id="local-6989586621680949262"><span class="annot"><span class="annottext">nonForcePred :: Term2 v () () v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680949262"><span class="hs-identifier hs-var hs-var">nonForcePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-570"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#DocRef"><span class="hs-identifier hs-var">DD.DocRef</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-571"></span><span>        </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><a href="#local-6989586621680949246"><span class="hs-identifier hs-type">nonUnitArgPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-574"></span><span>      </span><span id="local-6989586621680949246"><span class="annot"><span class="annottext">nonUnitArgPred :: Var v =&gt; v -&gt; Bool
</span><a href="#local-6989586621680949246"><span class="hs-identifier hs-var hs-var">nonUnitArgPred</span></a></span></span><span> </span><span id="local-6989586621680949186"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949186"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949186"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-comment">-- Render a binary infix operator sequence, like [(a2, f2), (a1, f1)],</span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-comment">-- meaning (a1 `f1` a2) `f2` (a3 rendered by the caller), producing</span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-comment">-- &quot;a1 `f1` a2 `f2`&quot;.  Except the operators are all symbolic, so we won't</span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-comment">-- produce any backticks.  We build the result out from the right,</span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-comment">-- starting at `f2`.</span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><a href="#local-6989586621680949291"><span class="hs-identifier hs-type">binaryApps</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-582"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-583"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><a href="#local-6989586621680951248"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>      </span><span id="local-6989586621680949291"><span class="annot"><span class="annottext">binaryApps :: [(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
-&gt; Pretty SyntaxText -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949291"><span class="hs-identifier hs-var hs-var">binaryApps</span></a></span></span><span> </span><span id="local-6989586621680949185"><span class="annot"><span class="annottext">[(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949185"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680949184"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949184"><span class="hs-identifier hs-var">last</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-586"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-587"></span><span>          </span><span id="local-6989586621680949183"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949183"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
-&gt; Term2 v () () v PrintAnnotation -&gt; m [Pretty SyntaxText]
</span><a href="#local-6989586621680949181"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(Term2 v () () v PrintAnnotation,
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680949185"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949179"><span class="annot"><span class="annottext">unbroken :: Pretty SyntaxText
</span><a href="#local-6989586621680949179"><span class="hs-identifier hs-var hs-var">unbroken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spaced</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949183"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949184"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>              </span><span id="local-6989586621680949178"><span class="annot"><span class="annottext">broken :: Pretty SyntaxText
</span><a href="#local-6989586621680949178"><span class="hs-identifier hs-var hs-var">broken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949183"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
[(Pretty s, Pretty s)] -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.column2</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. IsString a =&gt; [a] -&gt; [(a, a)]
</span><a href="#local-6989586621680949175"><span class="hs-identifier hs-var">psCols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949183"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949184"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-590"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949179"><span class="hs-identifier hs-var">unbroken</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949178"><span class="hs-identifier hs-var">broken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-592"></span><span>          </span><span id="local-6989586621680949175"><span class="annot"><span class="annottext">psCols :: [a] -&gt; [(a, a)]
</span><a href="#local-6989586621680949175"><span class="hs-identifier hs-var hs-var">psCols</span></a></span></span><span> </span><span id="local-6989586621680949169"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949169"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949169"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-593"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621680949167"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949167"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949166"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949166"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949167"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949166"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [(a, a)]
</span><a href="#local-6989586621680949175"><span class="hs-identifier hs-var">psCols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949169"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621680949164"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949164"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949164"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span>            </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-597"></span><span>          </span><span id="local-6989586621680949181"><span class="annot"><span class="annottext">r :: Term2 v () () v PrintAnnotation
-&gt; Term2 v () () v PrintAnnotation -&gt; m [Pretty SyntaxText]
</span><a href="#local-6989586621680949181"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680949162"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949162"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680949161"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949161"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-598"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span>
</span><span id="line-599"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Ord v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBlock"><span class="hs-identifier hs-var">isBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949162"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949162"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-600"></span><span>                </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext
-&gt; InfixContext
-&gt; Imports
-&gt; DocLiteralContext
-&gt; Bool
-&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-var">AmbientContext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="Unison.Syntax.TermPrinter.html#Infix"><span class="hs-identifier hs-var">Infix</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949161"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-601"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-comment">-- Render sequence of infix &amp;&amp;s or ||s, like [x2, x1],</span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-comment">-- meaning (x1 &amp;&amp; x2) &amp;&amp; (x3 rendered by the caller), producing</span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-comment">-- &quot;x1 &amp;&amp; x2 &amp;&amp;&quot;. The result is built from the right.</span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><a href="#local-6989586621680949268"><span class="hs-identifier hs-type">booleanOps</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-607"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-608"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-609"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-610"></span><span>        </span><span class="annot"><a href="#local-6989586621680951248"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>      </span><span id="local-6989586621680949268"><span class="annot"><span class="annottext">booleanOps :: Pretty SyntaxText
-&gt; [Term2 v () () v PrintAnnotation]
-&gt; Pretty SyntaxText
-&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680949268"><span class="hs-identifier hs-var hs-var">booleanOps</span></a></span></span><span> </span><span id="local-6989586621680949159"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949159"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680949158"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949158"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621680949157"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949157"><span class="hs-identifier hs-var">last</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>        </span><span id="local-6989586621680949156"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949156"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation -&gt; m [Pretty SyntaxText]
</span><a href="#local-6989586621680949155"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680949158"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680949154"><span class="annot"><span class="annottext">unbroken :: Pretty SyntaxText
</span><a href="#local-6989586621680949154"><span class="hs-identifier hs-var hs-var">unbroken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spaced</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949156"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949157"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>            </span><span id="local-6989586621680949153"><span class="annot"><span class="annottext">broken :: Pretty SyntaxText
</span><a href="#local-6989586621680949153"><span class="hs-identifier hs-var hs-var">broken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949156"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
[(Pretty s, Pretty s)] -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.column2</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. IsString a =&gt; [a] -&gt; [(a, a)]
</span><a href="#local-6989586621680949152"><span class="hs-identifier hs-var">psCols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949156"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949157"><span class="hs-identifier hs-var">last</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-615"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949154"><span class="hs-identifier hs-var">unbroken</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949153"><span class="hs-identifier hs-var">broken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-617"></span><span>          </span><span id="local-6989586621680949152"><span class="annot"><span class="annottext">psCols :: [a] -&gt; [(a, a)]
</span><a href="#local-6989586621680949152"><span class="hs-identifier hs-var hs-var">psCols</span></a></span></span><span> </span><span id="local-6989586621680949147"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949147"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949147"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-618"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621680949146"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949146"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949145"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949145"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949146"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949145"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [(a, a)]
</span><a href="#local-6989586621680949152"><span class="hs-identifier hs-var">psCols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680949147"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621680949144"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949144"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680949144"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-621"></span><span>            </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-622"></span><span>          </span><span id="local-6989586621680949155"><span class="annot"><span class="annottext">r :: Term2 v () () v PrintAnnotation -&gt; m [Pretty SyntaxText]
</span><a href="#local-6989586621680949155"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680949143"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949143"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-623"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span>
</span><span id="line-624"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Ord v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBlock"><span class="hs-identifier hs-var">isBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949143"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949594"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680949593"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680949143"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-625"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949159"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-626"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-type">prettyPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680951121"><span class="annot"><a href="#local-6989586621680951121"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680951120"><span class="annot"><a href="#local-6989586621680951120"><span class="hs-identifier hs-type">loc</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-630"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951121"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-632"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-633"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680951121"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="annot"><a href="#local-6989586621680951120"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680951121"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- vs is the list of pattern variables used by the pattern, plus possibly a</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- tail of variables it doesn't use.  This tail is the second component of</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- the return value.</span><span>
</span><span id="line-640"></span><span id="prettyPattern"><span class="annot"><span class="annottext">prettyPattern :: forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var hs-var">prettyPattern</span></a></span></span><span> </span><span id="local-6989586621680949049"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680949048"><span class="annot"><span class="annottext">c :: AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:imports:AmbientContext :: AmbientContext -&gt; Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680949047"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949047"><span class="hs-identifier hs-var">im</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680949046"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949046"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680949045"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680949044"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680949044"><span class="hs-identifier hs-var">patt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680949044"><span class="hs-identifier hs-var">patt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-641"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Char</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949042"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949042"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.CharLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
</span><span class="hs-identifier hs-var">showEscapeChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949042"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680949040"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949040"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949040"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-645"></span><span>          </span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680949042"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-646"></span><span>      </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Unbound</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Var</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680949037"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949037"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680949036"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949036"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; String
</span><span class="hs-identifier hs-var">Var.nameStr</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949037"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949036"><span class="hs-identifier hs-var">tail_vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>      </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;prettyPattern: Expected at least one var&quot;</span></span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Boolean</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949032"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949032"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BooleanLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680949032"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;false&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Int</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949030"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949030"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.NumericLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949030"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680949030"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Nat</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949028"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680949028"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.NumericLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680949028"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Float</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949026"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680949026"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.NumericLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680949026"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Text</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949024"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949024"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.TextLiteral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680949024"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#TuplePattern"><span class="hs-identifier hs-type">TuplePattern</span></a></span><span> </span><span id="local-6989586621680949023"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680949023"><span class="hs-identifier hs-var">pats</span></a></span></span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680949023"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-660"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949021"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949021"><span class="hs-identifier hs-var">pats_printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949020"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949020"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [v] -&gt; [Pattern loc] -&gt; ([Pretty SyntaxText], [v])
</span><a href="#local-6989586621680949019"><span class="hs-identifier hs-var">patterns</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680949023"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-661"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.parenthesizeCommas</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680949021"><span class="hs-identifier hs-var">pats_printed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949020"><span class="hs-identifier hs-var">tail_vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Constructor</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949016"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949016"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949015"><span class="hs-identifier hs-var">conRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949014"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-665"></span><span>      </span><span id="local-6989586621680949014"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949014"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949047"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949015"><span class="hs-identifier hs-var">conRef</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span id="local-6989586621680949015"><span class="annot"><span class="annottext">conRef :: Referent
</span><a href="#local-6989586621680949015"><span class="hs-identifier hs-var hs-var">conRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949016"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Data</span></span><span>
</span><span id="line-667"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Constructor</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949013"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949013"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621680949012"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680949012"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949011"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949011"><span class="hs-identifier hs-var">pats_printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949010"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949010"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Pretty SyntaxText
-&gt; [v]
-&gt; [Pattern loc]
-&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680949009"><span class="hs-identifier hs-var">patternsSep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680949012"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span id="local-6989586621680949008"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680949008"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949047"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949007"><span class="hs-identifier hs-var">conRef</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span id="local-6989586621680949007"><span class="annot"><span class="annottext">conRef :: Referent
</span><a href="#local-6989586621680949007"><span class="hs-identifier hs-var hs-var">conRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680949013"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Data</span></span><span>
</span><span id="line-671"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949046"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-672"></span><span>            </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680949007"><span class="hs-identifier hs-var">conRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680949008"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-673"></span><span>              </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949011"><span class="hs-identifier hs-var">pats_printed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-674"></span><span>          </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949010"><span class="hs-identifier hs-var">tail_vs</span></a></span><span>
</span><span id="line-675"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.As</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680949005"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680949005"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-678"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680949004"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949004"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680949003"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949003"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680949002"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949002"><span class="hs-identifier hs-var">printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680949001"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949001"><span class="hs-identifier hs-var">eventual_tail</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949003"><span class="hs-identifier hs-var">tail_vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680949005"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-680"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949046"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; String
</span><span class="hs-identifier hs-var">Var.nameStr</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680949004"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680949002"><span class="hs-identifier hs-var">printed</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949001"><span class="hs-identifier hs-var">eventual_tail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>      </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;prettyPattern: Expected at least one var&quot;</span></span><span>
</span><span id="line-682"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.EffectPure</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948999"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948999"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948998"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948998"><span class="hs-identifier hs-var">printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948997"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948997"><span class="hs-identifier hs-var">eventual_tail</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948999"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-684"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948998"><span class="hs-identifier hs-var">printed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948997"><span class="hs-identifier hs-var">eventual_tail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.EffectBind</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948995"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948995"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621680948994"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948994"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621680948993"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948993"><span class="hs-identifier hs-var">k_pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948992"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948992"><span class="hs-identifier hs-var">pats_printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948991"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948991"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Pretty SyntaxText
-&gt; [v]
-&gt; [Pattern loc]
-&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680949009"><span class="hs-identifier hs-var">patternsSep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948994"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-687"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680948990"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948990"><span class="hs-identifier hs-var">k_pat_printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948989"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948989"><span class="hs-identifier hs-var">eventual_tail</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948991"><span class="hs-identifier hs-var">tail_vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948993"><span class="hs-identifier hs-var">k_pat</span></a></span><span>
</span><span id="line-688"></span><span>        </span><span id="local-6989586621680948988"><span class="annot"><span class="annottext">name :: HashQualified Name
</span><a href="#local-6989586621680948988"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680949047"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948987"><span class="hs-identifier hs-var">conRef</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span id="local-6989586621680948987"><span class="annot"><span class="annottext">conRef :: Referent
</span><a href="#local-6989586621680948987"><span class="hs-identifier hs-var hs-var">conRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948995"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Effect</span></span><span>
</span><span id="line-690"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span>
</span><span id="line-691"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; [Pretty s]
</span><span class="hs-identifier hs-var">PP.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-692"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-693"></span><span>                  </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948987"><span class="hs-identifier hs-var">conRef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948988"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-694"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948992"><span class="hs-identifier hs-var">pats_printed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-695"></span><span>                  </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-696"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948990"><span class="hs-identifier hs-var">k_pat_printed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-697"></span><span>                  </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-698"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>            </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-700"></span><span>          </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948989"><span class="hs-identifier hs-var">eventual_tail</span></a></span><span>
</span><span id="line-701"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.SequenceLiteral</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948984"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948984"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948983"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948983"><span class="hs-identifier hs-var">pats_printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948982"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948982"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Pretty SyntaxText
-&gt; [v]
-&gt; [Pattern loc]
-&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680949009"><span class="hs-identifier hs-var">patternsSep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948984"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-704"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948983"><span class="hs-identifier hs-var">pats_printed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948982"><span class="hs-identifier hs-var">tail_vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pattern.SequenceOp</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948980"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948980"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680948979"><span class="annot"><span class="annottext">SeqOp
</span><a href="#local-6989586621680948979"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680948978"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948978"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948977"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948977"><span class="hs-identifier hs-var">pl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948976"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948976"><span class="hs-identifier hs-var">lvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949046"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680949045"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948980"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-707"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680948975"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948975"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948974"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948974"><span class="hs-identifier hs-var">rvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949046"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948976"><span class="hs-identifier hs-var">lvs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948978"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-708"></span><span>        </span><span id="local-6989586621680948973"><span class="annot"><span class="annottext">f :: Int -&gt; Pretty SyntaxText -&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680948973"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680948972"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948972"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680948971"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948971"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680949046"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948972"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948977"><span class="hs-identifier hs-var">pl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. SeqOp -&gt; Element r
</span><span class="hs-identifier hs-var">S.Op</span></span><span> </span><span class="annot"><span class="annottext">SeqOp
</span><a href="#local-6989586621680948979"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948971"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948975"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948974"><span class="hs-identifier hs-var">rvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SeqOp
</span><a href="#local-6989586621680948979"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-710"></span><span>          </span><span class="annot"><span class="annottext">SeqOp
</span><span class="hs-identifier hs-var">Pattern.Cons</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Pretty SyntaxText -&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680948973"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;+:&quot;</span></span><span>
</span><span id="line-711"></span><span>          </span><span class="annot"><span class="annottext">SeqOp
</span><span class="hs-identifier hs-var">Pattern.Snoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Pretty SyntaxText -&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680948973"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;:+&quot;</span></span><span>
</span><span id="line-712"></span><span>          </span><span class="annot"><span class="annottext">SeqOp
</span><span class="hs-identifier hs-var">Pattern.Concat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Pretty SyntaxText -&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680948973"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;++&quot;</span></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-714"></span><span>    </span><span id="local-6989586621680951037"><span class="annot"><a href="#local-6989586621680949041"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621680951037"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680951037"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621680949041"><span class="annot"><span class="annottext">l :: forall s. IsString s =&gt; String -&gt; s
</span><a href="#local-6989586621680949041"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><span class="hs-identifier hs-var">fromString</span></span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621680949019"><span class="annot"><span class="annottext">patterns :: Int -&gt; [v] -&gt; [Pattern loc] -&gt; ([Pretty SyntaxText], [v])
</span><a href="#local-6989586621680949019"><span class="hs-identifier hs-var hs-var">patterns</span></a></span></span><span> </span><span id="local-6989586621680948964"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948964"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680948963"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948963"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948962"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948962"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680948961"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948961"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-717"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948960"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948960"><span class="hs-identifier hs-var">printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948959"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948959"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-718"></span><span>            </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680949049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680949048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948964"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948963"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948962"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-719"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680948958"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948958"><span class="hs-identifier hs-var">rest_printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948957"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948957"><span class="hs-identifier hs-var">eventual_tail</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [v] -&gt; [Pattern loc] -&gt; ([Pretty SyntaxText], [v])
</span><a href="#local-6989586621680949019"><span class="hs-identifier hs-var">patterns</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948964"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948959"><span class="hs-identifier hs-var">tail_vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948961"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-720"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948960"><span class="hs-identifier hs-var">printed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948958"><span class="hs-identifier hs-var">rest_printed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948957"><span class="hs-identifier hs-var">eventual_tail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>    </span><span class="annot"><a href="#local-6989586621680949019"><span class="hs-identifier hs-var">patterns</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948956"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948956"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948956"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>    </span><span id="local-6989586621680949009"><span class="annot"><span class="annottext">patternsSep :: Int
-&gt; Pretty SyntaxText
-&gt; [v]
-&gt; [Pattern loc]
-&gt; (Pretty SyntaxText, [v])
</span><a href="#local-6989586621680949009"><span class="hs-identifier hs-var hs-var">patternsSep</span></a></span></span><span> </span><span id="local-6989586621680948955"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948955"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680948954"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948954"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621680948953"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948953"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680948952"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948952"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [v] -&gt; [Pattern loc] -&gt; ([Pretty SyntaxText], [v])
</span><a href="#local-6989586621680949019"><span class="hs-identifier hs-var">patterns</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948955"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948953"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680948952"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-723"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680948951"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948951"><span class="hs-identifier hs-var">printed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948950"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948950"><span class="hs-identifier hs-var">tail_vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948954"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948951"><span class="hs-identifier hs-var">printed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948950"><span class="hs-identifier hs-var">tail_vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span class="hs-keyword">type</span><span> </span><span id="MatchCase%27"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#MatchCase%27"><span class="hs-identifier hs-var">MatchCase'</span></a></span></span><span> </span><span id="local-6989586621680948949"><span class="annot"><a href="#local-6989586621680948949"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621680948948"><span class="annot"><a href="#local-6989586621680948948"><span class="hs-identifier hs-type">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="annot"><a href="#local-6989586621680948949"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680948948"><span class="hs-identifier hs-type">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680948948"><span class="hs-identifier hs-type">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span id="local-6989586621680951107"><span id="local-6989586621680951108"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#arity1Branches"><span class="hs-identifier hs-type">arity1Branches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span class="annot"><a href="#local-6989586621680951108"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951107"><span class="hs-identifier hs-type">tm</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#MatchCase%27"><span class="hs-identifier hs-type">MatchCase'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951108"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951107"><span class="hs-identifier hs-type">tm</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-728"></span><span id="arity1Branches"><span class="annot"><span class="annottext">arity1Branches :: forall ann tm. [MatchCase ann tm] -&gt; [MatchCase' ann tm]
</span><a href="Unison.Syntax.TermPrinter.html#arity1Branches"><span class="hs-identifier hs-var hs-var">arity1Branches</span></a></span></span><span> </span><span id="local-6989586621680948947"><span class="annot"><span class="annottext">[MatchCase ann tm]
</span><a href="#local-6989586621680948947"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern ann
</span><a href="#local-6989586621680948946"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe tm
</span><a href="#local-6989586621680948945"><span class="hs-identifier hs-var">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tm
</span><a href="#local-6989586621680948944"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span id="local-6989586621680948946"><span class="annot"><span class="annottext">Pattern ann
</span><a href="#local-6989586621680948946"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621680948945"><span class="annot"><span class="annottext">Maybe tm
</span><a href="#local-6989586621680948945"><span class="hs-identifier hs-var">guard</span></a></span></span><span> </span><span id="local-6989586621680948944"><span class="annot"><span class="annottext">tm
</span><a href="#local-6989586621680948944"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MatchCase ann tm]
</span><a href="#local-6989586621680948947"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span class="hs-comment">-- Groups adjacent cases with the same pattern together,</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- for easier pretty-printing, for instance:</span><span>
</span><span id="line-732"></span><span class="hs-comment">--</span><span>
</span><span id="line-733"></span><span class="hs-comment">--   Foo x y | blah1 x -&gt; body1</span><span>
</span><span id="line-734"></span><span class="hs-comment">--   Foo x y | blah2 y -&gt; body2</span><span>
</span><span id="line-735"></span><span class="hs-comment">--</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- becomes</span><span>
</span><span id="line-737"></span><span class="hs-comment">--</span><span>
</span><span id="line-738"></span><span class="hs-comment">--   Foo x y, [x,y], [(blah1 x, body1), (blah2 y, body2)]</span><span>
</span><span id="line-739"></span><span id="local-6989586621680951025"><span id="local-6989586621680951026"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#groupCases"><span class="hs-identifier hs-type">groupCases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-740"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680951026"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-741"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#MatchCase%27"><span class="hs-identifier hs-type">MatchCase'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951026"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951025"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680951026"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951026"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951025"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951026"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951025"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-743"></span><span id="groupCases"><span class="annot"><span class="annottext">groupCases :: forall v ann.
Ord v =&gt;
[MatchCase' () (Term3 v ann)]
-&gt; [([Pattern ()], [v], [(Maybe (Term3 v ann), Term3 v ann)])]
</span><a href="Unison.Syntax.TermPrinter.html#groupCases"><span class="hs-identifier hs-var hs-var">groupCases</span></a></span></span><span> </span><span id="local-6989586621680948934"><span class="annot"><span class="annottext">[MatchCase' () (Term3 v ann)]
</span><a href="#local-6989586621680948934"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {v} {a} {f :: * -&gt; *} {a}.
(Eq a, Eq v) =&gt;
[(a, a, Term f v a)] -&gt; [(a, [v], [(a, Term f v a)])]
</span><a href="#local-6989586621680948933"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchCase' () (Term3 v ann)]
</span><a href="#local-6989586621680948934"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-745"></span><span>    </span><span id="local-6989586621680948933"><span class="annot"><span class="annottext">go0 :: [(a, a, Term f v a)] -&gt; [(a, [v], [(a, Term f v a)])]
</span><a href="#local-6989586621680948933"><span class="hs-identifier hs-var hs-var">go0</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-746"></span><span>    </span><span class="annot"><a href="#local-6989586621680948933"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span id="local-6989586621680948927"><span class="annot"><span class="annottext">ms :: [(a, a, Term f v a)]
</span><a href="#local-6989586621680948927"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680948926"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948926"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AbsN'</span></span><span> </span><span id="local-6989586621680948925"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948925"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term f v a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, a, Term f v a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, [v])
-&gt; [(a, Term f v a)]
-&gt; [(a, a, Term f v a)]
-&gt; [(a, [v], [(a, Term f v a)])]
</span><a href="#local-6989586621680948924"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948926"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948925"><span class="hs-identifier hs-var">vs1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(a, a, Term f v a)]
</span><a href="#local-6989586621680948927"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-747"></span><span>    </span><span id="local-6989586621680948924"><span class="annot"><span class="annottext">go2 :: (a, [v])
-&gt; [(a, Term f v a)]
-&gt; [(a, a, Term f v a)]
-&gt; [(a, [v], [(a, Term f v a)])]
</span><a href="#local-6989586621680948924"><span class="hs-identifier hs-var hs-var">go2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948923"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948923"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948922"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948922"><span class="hs-identifier hs-var">vs0</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680948921"><span class="annot"><span class="annottext">[(a, Term f v a)]
</span><a href="#local-6989586621680948921"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948923"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948922"><span class="hs-identifier hs-var">vs0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(a, Term f v a)]
</span><a href="#local-6989586621680948921"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><a href="#local-6989586621680948924"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948920"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948920"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948919"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948919"><span class="hs-identifier hs-var">vs0</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680948918"><span class="annot"><span class="annottext">[(a, Term f v a)]
</span><a href="#local-6989586621680948918"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621680948917"><span class="annot"><span class="annottext">ms :: [(a, a, Term f v a)]
</span><a href="#local-6989586621680948917"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680948916"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948916"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948915"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948915"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AbsN'</span></span><span> </span><span id="local-6989586621680948914"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948914"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680948913"><span class="annot"><span class="annottext">Term f v a
</span><a href="#local-6989586621680948913"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680948912"><span class="annot"><span class="annottext">[(a, a, Term f v a)]
</span><a href="#local-6989586621680948912"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948920"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948916"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948914"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948919"><span class="hs-identifier hs-var">vs0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, [v])
-&gt; [(a, Term f v a)]
-&gt; [(a, a, Term f v a)]
-&gt; [(a, [v], [(a, Term f v a)])]
</span><a href="#local-6989586621680948924"><span class="hs-identifier hs-var">go2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948920"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948919"><span class="hs-identifier hs-var">vs0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948915"><span class="hs-identifier hs-var">g1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term f v a
</span><a href="#local-6989586621680948913"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, Term f v a)]
</span><a href="#local-6989586621680948918"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, a, Term f v a)]
</span><a href="#local-6989586621680948912"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-750"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948920"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948919"><span class="hs-identifier hs-var">vs0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(a, Term f v a)]
</span><a href="#local-6989586621680948918"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, a, Term f v a)] -&gt; [(a, [v], [(a, Term f v a)])]
</span><a href="#local-6989586621680948933"><span class="hs-identifier hs-var">go0</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a, Term f v a)]
</span><a href="#local-6989586621680948917"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span id="local-6989586621680951110"><span id="local-6989586621680951111"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#printCase"><span class="hs-identifier hs-type">printCase</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951111"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951110"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-754"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-755"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DocLiteralContext"><span class="hs-identifier hs-type">DocLiteralContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#MatchCase%27"><span class="hs-identifier hs-type">MatchCase'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951111"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-757"></span><span>  </span><span class="annot"><a href="#local-6989586621680951110"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-758"></span><span id="printCase"><span class="annot"><span class="annottext">printCase :: forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports
-&gt; DocLiteralContext
-&gt; [MatchCase' () (Term3 v PrintAnnotation)]
-&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#printCase"><span class="hs-identifier hs-var hs-var">printCase</span></a></span></span><span> </span><span id="local-6989586621680948827"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948827"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621680948826"><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948826"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621680948825"><span class="annot"><span class="annottext">[MatchCase' () (Term (F v () ()) v PrintAnnotation)]
</span><a href="#local-6989586621680948825"><span class="hs-identifier hs-var">ms0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-759"></span><span>  </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.orElse</span></span><span>
</span><span id="line-760"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {r}.
Eq r =&gt;
Bool
-&gt; [(Pretty (SyntaxText' r), [Pretty (SyntaxText' r)],
     [Pretty (SyntaxText' r)])]
-&gt; [Pretty (SyntaxText' r)]
</span><a href="#local-6989586621680948824"><span class="hs-identifier hs-var">alignGrid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m [(Pretty SyntaxText, [Pretty SyntaxText], [Pretty SyntaxText])]
</span><a href="#local-6989586621680948823"><span class="hs-identifier hs-var">grid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {r}.
Eq r =&gt;
Bool
-&gt; [(Pretty (SyntaxText' r), [Pretty (SyntaxText' r)],
     [Pretty (SyntaxText' r)])]
-&gt; [Pretty (SyntaxText' r)]
</span><a href="#local-6989586621680948824"><span class="hs-identifier hs-var">alignGrid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m [(Pretty SyntaxText, [Pretty SyntaxText], [Pretty SyntaxText])]
</span><a href="#local-6989586621680948823"><span class="hs-identifier hs-var">grid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-763"></span><span>    </span><span id="local-6989586621680948822"><span class="annot"><span class="annottext">ms :: [([Pattern ()], [v],
  [(Maybe (Term (F v () ()) v PrintAnnotation),
    Term (F v () ()) v PrintAnnotation)])]
</span><a href="#local-6989586621680948822"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v ann.
Ord v =&gt;
[MatchCase' () (Term3 v ann)]
-&gt; [([Pattern ()], [v], [(Maybe (Term3 v ann), Term3 v ann)])]
</span><a href="Unison.Syntax.TermPrinter.html#groupCases"><span class="hs-identifier hs-var">groupCases</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchCase' () (Term (F v () ()) v PrintAnnotation)]
</span><a href="#local-6989586621680948825"><span class="hs-identifier hs-var">ms0</span></a></span><span>
</span><span id="line-764"></span><span>    </span><span id="local-6989586621680948812"><span class="annot"><span class="annottext">justify :: [(Pretty s, [a], [b])] -&gt; [(Pretty s, [(a, b)])]
</span><a href="#local-6989586621680948812"><span class="hs-identifier hs-var hs-var">justify</span></a></span></span><span> </span><span id="local-6989586621680948811"><span class="annot"><span class="annottext">[(Pretty s, [a], [b])]
</span><a href="#local-6989586621680948811"><span class="hs-identifier hs-var">rows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-765"></span><span>      </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
[(Pretty s, Maybe (Pretty s))] -&gt; [(Pretty s, Pretty s)]
</span><span class="hs-identifier hs-var">PP.align'</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {b} {c}. IsString a =&gt; (a, b, c) -&gt; (a, Maybe a)
</span><a href="#local-6989586621680948809"><span class="hs-identifier hs-var">alignPatterns</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pretty s, [a], [b])]
</span><a href="#local-6989586621680948811"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {b}. (a, [a], [b]) -&gt; [(a, b)]
</span><a href="#local-6989586621680948808"><span class="hs-identifier hs-var">gbs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pretty s, [a], [b])]
</span><a href="#local-6989586621680948811"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-766"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-767"></span><span>        </span><span id="local-6989586621680948809"><span class="annot"><span class="annottext">alignPatterns :: (a, b, c) -&gt; (a, Maybe a)
</span><a href="#local-6989586621680948809"><span class="hs-identifier hs-var hs-var">alignPatterns</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948805"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948805"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948805"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>        </span><span id="local-6989586621680948808"><span class="annot"><span class="annottext">gbs :: (a, [a], [b]) -&gt; [(a, b)]
</span><a href="#local-6989586621680948808"><span class="hs-identifier hs-var hs-var">gbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948804"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680948804"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948803"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680948803"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680948804"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680948803"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-769"></span><span>    </span><span id="local-6989586621680948802"><span class="annot"><span class="annottext">nojustify :: [(a, [a], [b])] -&gt; [(a, [(a, b)])]
</span><a href="#local-6989586621680948802"><span class="hs-identifier hs-var hs-var">nojustify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {b}. (a, [a], [b]) -&gt; (a, [(a, b)])
</span><a href="#local-6989586621680948801"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-770"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-771"></span><span>        </span><span id="local-6989586621680948801"><span class="annot"><span class="annottext">f :: (a, [a], [b]) -&gt; (a, [(a, b)])
</span><a href="#local-6989586621680948801"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948800"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948800"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948799"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680948799"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948798"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680948798"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948800"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680948799"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680948798"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>    </span><span id="local-6989586621680948824"><span class="annot"><span class="annottext">alignGrid :: Bool
-&gt; [(Pretty (SyntaxText' r), [Pretty (SyntaxText' r)],
     [Pretty (SyntaxText' r)])]
-&gt; [Pretty (SyntaxText' r)]
</span><a href="#local-6989586621680948824"><span class="hs-identifier hs-var hs-var">alignGrid</span></a></span></span><span> </span><span id="local-6989586621680948774"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948774"><span class="hs-identifier hs-var">alignArrows</span></a></span></span><span> </span><span id="local-6989586621680948773"><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r), [Pretty (SyntaxText' r)],
  [Pretty (SyntaxText' r)])]
</span><a href="#local-6989586621680948773"><span class="hs-identifier hs-var">grid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-773"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Pretty (SyntaxText' r),
 [(Pretty (SyntaxText' r), Pretty (SyntaxText' r))])
-&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948772"><span class="hs-identifier hs-var">alignCase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948774"><span class="hs-identifier hs-var">alignArrows</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall {s} {a} {b}.
(ListLike s Char, IsString s) =&gt;
[(Pretty s, [a], [b])] -&gt; [(Pretty s, [(a, b)])]
</span><a href="#local-6989586621680948812"><span class="hs-identifier hs-var">justify</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r), [Pretty (SyntaxText' r)],
  [Pretty (SyntaxText' r)])]
</span><a href="#local-6989586621680948773"><span class="hs-identifier hs-var">grid</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {b}. [(a, [a], [b])] -&gt; [(a, [(a, b)])]
</span><a href="#local-6989586621680948802"><span class="hs-identifier hs-var">nojustify</span></a></span><span> </span><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r), [Pretty (SyntaxText' r)],
  [Pretty (SyntaxText' r)])]
</span><a href="#local-6989586621680948773"><span class="hs-identifier hs-var">grid</span></a></span><span>
</span><span id="line-774"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-775"></span><span>        </span><span id="local-6989586621680948772"><span class="annot"><span class="annottext">alignCase :: (Pretty (SyntaxText' r),
 [(Pretty (SyntaxText' r), Pretty (SyntaxText' r))])
-&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948772"><span class="hs-identifier hs-var hs-var">alignCase</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948771"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948771"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948770"><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r), Pretty (SyntaxText' r))]
</span><a href="#local-6989586621680948770"><span class="hs-identifier hs-var">gbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-776"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r), Pretty (SyntaxText' r))]
</span><a href="#local-6989586621680948770"><span class="hs-identifier hs-var">gbs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948771"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948769"><span class="hs-identifier hs-var">guardBlock</span></a></span><span>
</span><span id="line-778"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948771"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948769"><span class="hs-identifier hs-var">guardBlock</span></a></span><span>
</span><span id="line-779"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-780"></span><span>            </span><span id="local-6989586621680948769"><span class="annot"><span class="annottext">guardBlock :: Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948769"><span class="hs-identifier hs-var hs-var">guardBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-781"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-782"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-783"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680948768"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948768"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948767"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948767"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948766"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948766"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-784"></span><span>                      </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span>
</span><span id="line-785"></span><span>                        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span>
</span><span id="line-786"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948768"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948774"><span class="hs-identifier hs-var">alignArrows</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948767"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>                        </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948766"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-789"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>                  </span><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r),
  (Pretty (SyntaxText' r), Pretty (SyntaxText' r)))]
</span><a href="#local-6989586621680948765"><span class="hs-identifier hs-var">justified</span></a></span><span>
</span><span id="line-791"></span><span>            </span><span id="local-6989586621680948765"><span class="annot"><span class="annottext">justified :: [(Pretty (SyntaxText' r),
  (Pretty (SyntaxText' r), Pretty (SyntaxText' r)))]
</span><a href="#local-6989586621680948765"><span class="hs-identifier hs-var hs-var">justified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s a.
(Eq s, ListLike s Char, IsString s) =&gt;
[(Pretty s, a)] -&gt; [(Pretty s, a)]
</span><span class="hs-identifier hs-var">PP.leftJustify</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680948763"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948763"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948762"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948762"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948763"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948761"><span class="hs-identifier hs-var">arrow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948762"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Pretty (SyntaxText' r), Pretty (SyntaxText' r))]
</span><a href="#local-6989586621680948770"><span class="hs-identifier hs-var">gbs</span></a></span><span>
</span><span id="line-792"></span><span>    </span><span id="local-6989586621680948823"><span class="annot"><span class="annottext">grid :: m [(Pretty SyntaxText, [Pretty SyntaxText], [Pretty SyntaxText])]
</span><a href="#local-6989586621680948823"><span class="hs-identifier hs-var hs-var">grid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">([Pattern ()], [v],
 [(Maybe (Term (F v () ()) v PrintAnnotation),
   Term (F v () ()) v PrintAnnotation)])
-&gt; m (Pretty SyntaxText, [Pretty SyntaxText], [Pretty SyntaxText])
</span><a href="#local-6989586621680948760"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[([Pattern ()], [v],
  [(Maybe (Term (F v () ()) v PrintAnnotation),
    Term (F v () ()) v PrintAnnotation)])]
</span><a href="#local-6989586621680948822"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-793"></span><span>    </span><span id="local-6989586621680948759"><span class="annot"><span class="annottext">patLhs :: PrettyPrintEnv -&gt; [v] -&gt; [Pattern ()] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948759"><span class="hs-identifier hs-var hs-var">patLhs</span></a></span></span><span> </span><span id="local-6989586621680948758"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948758"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680948757"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948757"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680948756"><span class="annot"><span class="annottext">[Pattern ()]
</span><a href="#local-6989586621680948756"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Pattern ()]
</span><a href="#local-6989586621680948756"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-795"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621680948755"><span class="annot"><span class="annottext">Pattern ()
</span><a href="#local-6989586621680948755"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948758"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948827"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948826"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948757"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern ()
</span><a href="#local-6989586621680948755"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>        </span><span id="local-6989586621680948754"><span class="annot"><span class="annottext">[Pattern ()]
</span><a href="#local-6989586621680948754"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span>
</span><span id="line-797"></span><span>          </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentAfterNewline</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>          </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-operator hs-var">`evalState`</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948757"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>          </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[Pattern ()]
</span><a href="#local-6989586621680948754"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-800"></span><span>          </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680948751"><span class="annot"><span class="annottext">Pattern ()
</span><a href="#local-6989586621680948751"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-801"></span><span>            </span><span id="local-6989586621680948750"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948750"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">State.get</span></span><span>
</span><span id="line-802"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948748"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948748"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948747"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948747"><span class="hs-identifier hs-var">rem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v loc.
Var v =&gt;
PrettyPrintEnv
-&gt; AmbientContext
-&gt; Int
-&gt; [v]
-&gt; Pattern loc
-&gt; (Pretty SyntaxText, [v])
</span><a href="Unison.Syntax.TermPrinter.html#prettyPattern"><span class="hs-identifier hs-var">prettyPattern</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948758"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948827"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948826"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948750"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern ()
</span><a href="#local-6989586621680948751"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-803"></span><span>            </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">State.put</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948747"><span class="hs-identifier hs-var">rem</span></a></span><span>
</span><span id="line-804"></span><span>            </span><span class="hs-identifier">pure</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948748"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-805"></span><span>    </span><span id="local-6989586621680948761"><span class="annot"><span class="annottext">arrow :: Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948761"><span class="hs-identifier hs-var hs-var">arrow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span>
</span><span id="line-806"></span><span>    </span><span class="hs-comment">-- If there's multiple guarded cases for this pattern, prints as:</span><span>
</span><span id="line-807"></span><span>    </span><span class="hs-comment">-- MyPattern x y</span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-comment">--   | guard 1        -&gt; 1</span><span>
</span><span id="line-809"></span><span>    </span><span class="hs-comment">--   | otherguard x y -&gt; 2</span><span>
</span><span id="line-810"></span><span>    </span><span class="hs-comment">--   | otherwise      -&gt; 3</span><span>
</span><span id="line-811"></span><span>    </span><span id="local-6989586621680948760"><span class="annot"><span class="annottext">go :: ([Pattern ()], [v],
 [(Maybe (Term (F v () ()) v PrintAnnotation),
   Term (F v () ()) v PrintAnnotation)])
-&gt; m (Pretty SyntaxText, [Pretty SyntaxText], [Pretty SyntaxText])
</span><a href="#local-6989586621680948760"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948743"><span class="annot"><span class="annottext">[Pattern ()]
</span><a href="#local-6989586621680948743"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948742"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948742"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948740"><span class="annot"><span class="annottext">[Maybe (Term (F v () ()) v PrintAnnotation)]
</span><a href="#local-6989586621680948740"><span class="hs-identifier hs-var">guards</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948739"><span class="annot"><span class="annottext">[Term (F v () ()) v PrintAnnotation]
</span><a href="#local-6989586621680948739"><span class="hs-identifier hs-var">bodies</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-812"></span><span>      </span><span id="local-6989586621680948738"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948738"><span class="hs-identifier hs-var">guards'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Term (F v () ()) v PrintAnnotation) -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680948737"><span class="hs-identifier hs-var">printGuard</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (Term (F v () ()) v PrintAnnotation)]
</span><a href="#local-6989586621680948740"><span class="hs-identifier hs-var">guards</span></a></span><span>
</span><span id="line-813"></span><span>      </span><span id="local-6989586621680948736"><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948736"><span class="hs-identifier hs-var">bodies'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680948735"><span class="hs-identifier hs-var">printBody</span></a></span><span> </span><span class="annot"><span class="annottext">[Term (F v () ()) v PrintAnnotation]
</span><a href="#local-6989586621680948739"><span class="hs-identifier hs-var">bodies</span></a></span><span>
</span><span id="line-814"></span><span>      </span><span id="local-6989586621680948734"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948734"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-815"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; [v] -&gt; [Pattern ()] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948759"><span class="hs-identifier hs-var">patLhs</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948734"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948742"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern ()]
</span><a href="#local-6989586621680948743"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948738"><span class="hs-identifier hs-var">guards'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Pretty SyntaxText]
</span><a href="#local-6989586621680948736"><span class="hs-identifier hs-var">bodies'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-817"></span><span>        </span><span id="local-6989586621680948733"><span class="annot"><span class="annottext">noGuards :: Bool
</span><a href="#local-6989586621680948733"><span class="hs-identifier hs-var hs-var">noGuards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe (Term (F v () ()) v PrintAnnotation)]
</span><a href="#local-6989586621680948740"><span class="hs-identifier hs-var">guards</span></a></span><span>
</span><span id="line-818"></span><span>        </span><span id="local-6989586621680948737"><span class="annot"><span class="annottext">printGuard :: Maybe (Term (F v () ()) v PrintAnnotation) -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680948737"><span class="hs-identifier hs-var hs-var">printGuard</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Term (F v () ()) v PrintAnnotation)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948733"><span class="hs-identifier hs-var">noGuards</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-819"></span><span>        </span><span class="annot"><a href="#local-6989586621680948737"><span class="hs-identifier hs-var">printGuard</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Term (F v () ()) v PrintAnnotation)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-820"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;|&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;otherwise&quot;</span></span><span>
</span><span id="line-821"></span><span>        </span><span class="annot"><a href="#local-6989586621680948737"><span class="hs-identifier hs-var">printGuard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ABT.AbsN'</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948731"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680948731"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-822"></span><span>          </span><span class="hs-comment">-- strip off any Abs-chain around the guard, guard variables are rendered</span><span>
</span><span id="line-823"></span><span>          </span><span class="hs-comment">-- like any other variable, ex: case Foo x y | x &lt; y -&gt; ...</span><span>
</span><span id="line-824"></span><span>          </span><span class="annot"><span class="annottext">forall s. (Eq s, IsString s) =&gt; Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spaceIfNeeded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DelimiterChar</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948827"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948826"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680948731"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-826"></span><span>        </span><span id="local-6989586621680948735"><span class="annot"><span class="annottext">printBody :: Term (F v () ()) v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680948735"><span class="hs-identifier hs-var hs-var">printBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948827"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948826"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span class="hs-comment">-- A pretty term binding, split into the type signature (possibly empty) and the term.</span><span>
</span><span id="line-829"></span><span class="hs-keyword">data</span><span> </span><span id="PrettyBinding"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-var">PrettyBinding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PrettyBinding"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-var">PrettyBinding</span></a></span></span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AtypeSignature%3APrettyBinding"><span class="annot"><span class="annottext">PrettyBinding -&gt; Maybe (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AtypeSignature%3APrettyBinding"><span class="hs-identifier hs-var hs-var">typeSignature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-831"></span><span>    </span><span id="%24sel%3Aterm%3APrettyBinding"><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aterm%3APrettyBinding"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="hs-comment">-- Render a pretty binding.</span><span>
</span><span id="line-835"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#renderPrettyBinding"><span class="hs-identifier hs-type">renderPrettyBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span>
</span><span id="line-836"></span><span id="renderPrettyBinding"><span class="annot"><span class="annottext">renderPrettyBinding :: PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#renderPrettyBinding"><span class="hs-identifier hs-var hs-var">renderPrettyBinding</span></a></span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680948726"><span class="annot"><span class="annottext">Maybe (Pretty SyntaxText)
typeSignature :: Maybe (Pretty SyntaxText)
$sel:typeSignature:PrettyBinding :: PrettyBinding -&gt; Maybe (Pretty SyntaxText)
</span><a href="#local-6989586621680948726"><span class="hs-identifier hs-var hs-var">typeSignature</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948725"><span class="annot"><span class="annottext">Pretty SyntaxText
term :: Pretty SyntaxText
$sel:term:PrettyBinding :: PrettyBinding -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948725"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Pretty SyntaxText)
</span><a href="#local-6989586621680948726"><span class="hs-identifier hs-var">typeSignature</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-838"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Pretty SyntaxText)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948725"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680948724"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948724"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948724"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948725"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span class="hs-comment">-- Render a pretty binding without a type signature.</span><span>
</span><span id="line-842"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#renderPrettyBindingWithoutTypeSignature"><span class="hs-identifier hs-type">renderPrettyBindingWithoutTypeSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span>
</span><span id="line-843"></span><span id="renderPrettyBindingWithoutTypeSignature"><span class="annot"><span class="annottext">renderPrettyBindingWithoutTypeSignature :: PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#renderPrettyBindingWithoutTypeSignature"><span class="hs-identifier hs-var hs-var">renderPrettyBindingWithoutTypeSignature</span></a></span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680948722"><span class="annot"><span class="annottext">Pretty SyntaxText
term :: Pretty SyntaxText
$sel:term:PrettyBinding :: PrettyBinding -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948722"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-844"></span><span>  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948722"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="hs-comment">-- | Render a binding, producing output of the form</span><span>
</span><span id="line-847"></span><span class="hs-comment">--</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- foo : t -&gt; u</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- foo a = ...</span><span>
</span><span id="line-850"></span><span class="hs-comment">--</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- The first line is only output if the term has a type annotation as the</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- outermost constructor.</span><span>
</span><span id="line-853"></span><span class="hs-comment">--</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- Binary functions with symbolic names are output infix, as follows:</span><span>
</span><span id="line-855"></span><span class="hs-comment">--</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- (+) : t -&gt; t -&gt; t</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- a + b = ...</span><span>
</span><span id="line-858"></span><span id="local-6989586621680950949"><span id="local-6989586621680950950"><span id="local-6989586621680950951"><span id="local-6989586621680950952"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding"><span class="hs-identifier hs-type">prettyBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-859"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950952"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-860"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-861"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-862"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950952"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950951"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950950"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950952"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950949"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-863"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span></span></span></span></span><span>
</span><span id="line-864"></span><span id="prettyBinding"><span class="annot"><span class="annottext">prettyBinding :: forall v at ap a.
Var v =&gt;
PrettyPrintEnv
-&gt; HashQualified Name -&gt; Term2 v at ap v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding"><span class="hs-identifier hs-var hs-var">prettyBinding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-865"></span><span>  </span><span class="annot"><span class="annottext">forall v at ap a.
Var v =&gt;
(PrettyBinding -&gt; Pretty SyntaxText)
-&gt; PrettyPrintEnv
-&gt; HashQualified Name
-&gt; Term2 v at ap v a
-&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding_"><span class="hs-identifier hs-var">prettyBinding_</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#renderPrettyBinding"><span class="hs-identifier hs-var">renderPrettyBinding</span></a></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="hs-comment">-- | Like 'prettyBinding', but elides the type signature (if any).</span><span>
</span><span id="line-868"></span><span id="local-6989586621680948715"><span id="local-6989586621680948716"><span id="local-6989586621680948717"><span id="local-6989586621680948718"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBindingWithoutTypeSignature"><span class="hs-identifier hs-type">prettyBindingWithoutTypeSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680948718"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-870"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-871"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-872"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680948718"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680948717"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680948716"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680948718"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680948715"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-873"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span></span></span></span></span><span>
</span><span id="line-874"></span><span id="prettyBindingWithoutTypeSignature"><span class="annot"><span class="annottext">prettyBindingWithoutTypeSignature :: forall v at ap a.
Var v =&gt;
PrettyPrintEnv
-&gt; HashQualified Name -&gt; Term2 v at ap v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBindingWithoutTypeSignature"><span class="hs-identifier hs-var hs-var">prettyBindingWithoutTypeSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><span class="annottext">forall v at ap a.
Var v =&gt;
(PrettyBinding -&gt; Pretty SyntaxText)
-&gt; PrettyPrintEnv
-&gt; HashQualified Name
-&gt; Term2 v at ap v a
-&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding_"><span class="hs-identifier hs-var">prettyBinding_</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#renderPrettyBindingWithoutTypeSignature"><span class="hs-identifier hs-var">renderPrettyBindingWithoutTypeSignature</span></a></span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span id="local-6989586621680950944"><span id="local-6989586621680950945"><span id="local-6989586621680950946"><span id="local-6989586621680950947"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding_"><span class="hs-identifier hs-type">prettyBinding_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-878"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950947"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-879"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-880"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-881"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-882"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950946"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950945"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950947"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950944"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-883"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span></span></span></span></span><span>
</span><span id="line-884"></span><span id="prettyBinding_"><span class="annot"><span class="annottext">prettyBinding_ :: forall v at ap a.
Var v =&gt;
(PrettyBinding -&gt; Pretty SyntaxText)
-&gt; PrettyPrintEnv
-&gt; HashQualified Name
-&gt; Term2 v at ap v a
-&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding_"><span class="hs-identifier hs-var hs-var">prettyBinding_</span></a></span></span><span> </span><span id="local-6989586621680948700"><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948700"><span class="hs-identifier hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680948699"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948699"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span id="local-6989586621680948698"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948698"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948697"><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948697"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Reader (PrettyPrintEnv, Set v) a -&gt; a
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#runPretty"><span class="hs-identifier hs-var">runPretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v vt at ap a.
(Var v, Var vt) =&gt;
Term2 vt at ap v a -&gt; PrettyPrintEnv -&gt; PrettyPrintEnv
</span><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-var">avoidShadowing</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948697"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948699"><span class="hs-identifier hs-var">ppe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948700"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *) at ap a.
MonadPretty v m =&gt;
AmbientContext
-&gt; HashQualified Name -&gt; Term2 v at ap v a -&gt; m PrettyBinding
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding0"><span class="hs-identifier hs-var">prettyBinding0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#MaybeDoc"><span class="hs-identifier hs-var">MaybeDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948698"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948697"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span id="local-6989586621680950927"><span id="local-6989586621680950928"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding%27"><span class="hs-identifier hs-type">prettyBinding'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-888"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950928"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-889"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-890"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Width</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-891"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-892"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680950928"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950927"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-893"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ColorText</span></span></span></span><span>
</span><span id="line-894"></span><span id="prettyBinding%27"><span class="annot"><span class="annottext">prettyBinding' :: forall v a.
Var v =&gt;
PrettyPrintEnv
-&gt; Width -&gt; HashQualified Name -&gt; Term v a -&gt; ColorText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding%27"><span class="hs-identifier hs-var hs-var">prettyBinding'</span></a></span></span><span> </span><span id="local-6989586621680948690"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948690"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span id="local-6989586621680948689"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680948689"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621680948688"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948688"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680948687"><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680948687"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-895"></span><span>  </span><span class="annot"><span class="annottext">forall s. (Monoid s, IsString s) =&gt; Width -&gt; Pretty s -&gt; s
</span><span class="hs-identifier hs-var">PP.render</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680948689"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v at ap a.
Var v =&gt;
PrettyPrintEnv
-&gt; HashQualified Name -&gt; Term2 v at ap v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding"><span class="hs-identifier hs-var">prettyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948690"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948688"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Term v a
</span><a href="#local-6989586621680948687"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span id="local-6989586621680950932"><span id="local-6989586621680950933"><span id="local-6989586621680950934"><span id="local-6989586621680950935"><span id="local-6989586621680950936"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding0"><span class="hs-identifier hs-type">prettyBinding0</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950936"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950935"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-899"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-900"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-901"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950936"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950934"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950933"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950936"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950932"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-902"></span><span>  </span><span class="annot"><a href="#local-6989586621680950935"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span></span></span></span></span></span><span>
</span><span id="line-903"></span><span id="prettyBinding0"><span class="annot"><span class="annottext">prettyBinding0 :: forall v (m :: * -&gt; *) at ap a.
MonadPretty v m =&gt;
AmbientContext
-&gt; HashQualified Name -&gt; Term2 v at ap v a -&gt; m PrettyBinding
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding0"><span class="hs-identifier hs-var hs-var">prettyBinding0</span></a></span></span><span> </span><span id="local-6989586621680948673"><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680948673"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621680948672"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948672"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680948671"><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948671"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-904"></span><span>  </span><span id="local-6989586621680948670"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948670"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-905"></span><span>  </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext
-&gt; HashQualified Name -&gt; Term3 v PrintAnnotation -&gt; m PrettyBinding
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding0%27"><span class="hs-identifier hs-var">prettyBinding0'</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680948673"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948672"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v at ap a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Term2 v at ap v a -&gt; Term3 v PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-var">printAnnotate</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948670"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948671"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span id="local-6989586621680951055"><span id="local-6989586621680951056"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyBinding0%27"><span class="hs-identifier hs-type">prettyBinding0'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951055"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-909"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-910"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-911"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951056"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-912"></span><span>  </span><span class="annot"><a href="#local-6989586621680951055"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span></span></span><span>
</span><span id="line-913"></span><span id="prettyBinding0%27"><span class="annot"><span class="annottext">prettyBinding0' :: forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext
-&gt; HashQualified Name -&gt; Term3 v PrintAnnotation -&gt; m PrettyBinding
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding0%27"><span class="hs-identifier hs-var hs-var">prettyBinding0'</span></a></span></span><span> </span><span id="local-6989586621680948596"><span class="annot"><span class="annottext">a :: AmbientContext
</span><a href="#local-6989586621680948596"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:imports:AmbientContext :: AmbientContext -&gt; Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680948595"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948595"><span class="hs-identifier hs-var">im</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:docContext:AmbientContext :: AmbientContext -&gt; DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AdocContext%3AAmbientContext"><span class="hs-identifier hs-var">docContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680948594"><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948594"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680948593"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680948592"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948592"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-914"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Term2 v () () v PrintAnnotation -&gt; m PrettyBinding
</span><a href="#local-6989586621680948591"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948590"><span class="hs-identifier hs-var">symbolic</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall {typeVar} {typeAnn} {patternAnn} {a}.
Term (F typeVar typeAnn patternAnn) v a -&gt; Bool
</span><a href="#local-6989586621680948589"><span class="hs-identifier hs-var">isBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948592"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948592"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-915"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-916"></span><span>    </span><span id="local-6989586621680948591"><span class="annot"><span class="annottext">go :: Bool -&gt; Term2 v () () v PrintAnnotation -&gt; m PrettyBinding
</span><a href="#local-6989586621680948591"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680948588"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948588"><span class="hs-identifier hs-var">infix'</span></a></span></span><span> </span><span id="local-6989586621680948587"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948587"><span class="hs-identifier hs-var">binding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-917"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948587"><span class="hs-identifier hs-var">binding</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-918"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span id="local-6989586621680948586"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948586"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621680948585"><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680948585"><span class="hs-identifier hs-var">tp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-919"></span><span>          </span><span class="hs-comment">-- If the term is an annotated function,</span><span>
</span><span id="line-920"></span><span>          </span><span class="hs-comment">-- we want to print the type signature on the previous line.</span><span>
</span><span id="line-921"></span><span>          </span><span class="hs-comment">-- The TypePrinter.pretty0 function prints the type, and uses a</span><span>
</span><span id="line-922"></span><span>          </span><span class="hs-comment">-- Reader monad with (Set v) in it to track which type variables are</span><span>
</span><span id="line-923"></span><span>          </span><span class="hs-comment">-- bound in the outer scope. We use that to determine if the type</span><span>
</span><span id="line-924"></span><span>          </span><span class="hs-comment">-- printer should avoid capture of those variables.</span><span>
</span><span id="line-925"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948584"><span class="annot"><span class="annottext">avoidCapture :: m PrettyBinding -&gt; m PrettyBinding
</span><a href="#local-6989586621680948584"><span class="hs-identifier hs-var hs-var">avoidCapture</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680948585"><span class="hs-identifier hs-var">tp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-926"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">ForallsNamed'</span></span><span> </span><span id="local-6989586621680948583"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948583"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type v ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *) a. MonadPretty v m =&gt; [v] -&gt; m a -&gt; m a
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#addTypeVars"><span class="hs-identifier hs-var">addTypeVars</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948583"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-927"></span><span>                </span><span class="annot"><span class="annottext">Type v ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-928"></span><span>          </span><span id="local-6989586621680948581"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948581"><span class="hs-identifier hs-var">tp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v a (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports -&gt; Int -&gt; Type v a -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TypePrinter.html#pretty0"><span class="hs-identifier hs-var">TypePrinter.pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948595"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type v ()
</span><a href="#local-6989586621680948585"><span class="hs-identifier hs-var">tp</span></a></span><span>
</span><span id="line-929"></span><span>          </span><span id="local-6989586621680948580"><span class="annot"><span class="annottext">PrettyBinding
</span><a href="#local-6989586621680948580"><span class="hs-identifier hs-var">tm'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m PrettyBinding -&gt; m PrettyBinding
</span><a href="#local-6989586621680948584"><span class="hs-identifier hs-var">avoidCapture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext
-&gt; HashQualified Name -&gt; Term3 v PrintAnnotation -&gt; m PrettyBinding
</span><a href="Unison.Syntax.TermPrinter.html#prettyBinding0%27"><span class="hs-identifier hs-var">prettyBinding0'</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680948596"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948586"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>          </span><span class="hs-identifier">pure</span><span>
</span><span id="line-931"></span><span>            </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span>
</span><span id="line-932"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:typeSignature:PrettyBinding :: Maybe (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AtypeSignature%3APrettyBinding"><span class="hs-identifier hs-var">typeSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948579"><span class="hs-identifier hs-var">renderName</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.TypeAscriptionColon</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; :&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948581"><span class="hs-identifier hs-var">tp'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-933"></span><span>                </span><span class="annot"><span class="annottext">$sel:term:PrettyBinding :: Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aterm%3APrettyBinding"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyBinding -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#renderPrettyBinding"><span class="hs-identifier hs-var">renderPrettyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyBinding
</span><a href="#local-6989586621680948580"><span class="hs-identifier hs-var">tm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-935"></span><span>        </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LamsNamedMatch%27"><span class="hs-identifier hs-type">LamsNamedMatch'</span></a></span><span> </span><span id="local-6989586621680948578"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948578"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680948577"><span class="annot"><span class="annottext">[([Pattern ()], Maybe (Term2 v () () v PrintAnnotation),
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680948577"><span class="hs-identifier hs-var">branches</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>          </span><span id="local-6989586621680948576"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948576"><span class="hs-identifier hs-var">branches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
Imports
-&gt; DocLiteralContext
-&gt; [MatchCase' () (Term3 v PrintAnnotation)]
-&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#printCase"><span class="hs-identifier hs-var">printCase</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948595"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948594"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">[([Pattern ()], Maybe (Term2 v () () v PrintAnnotation),
  Term2 v () () v PrintAnnotation)]
</span><a href="#local-6989586621680948577"><span class="hs-identifier hs-var">branches</span></a></span><span>
</span><span id="line-937"></span><span>          </span><span class="hs-identifier">pure</span><span>
</span><span id="line-938"></span><span>            </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span>
</span><span id="line-939"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:typeSignature:PrettyBinding :: Maybe (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AtypeSignature%3APrettyBinding"><span class="hs-identifier hs-var">typeSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-940"></span><span>                </span><span class="annot"><span class="annottext">$sel:term:PrettyBinding :: Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aterm%3APrettyBinding"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-941"></span><span>                  </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-942"></span><span>                    </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span>
</span><span id="line-943"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; [v] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948575"><span class="hs-identifier hs-var">defnLhs</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948578"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-944"></span><span>                          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BindingEquals</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; =&quot;</span></span><span>
</span><span id="line-945"></span><span>                          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-946"></span><span>                          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span>
</span><span id="line-947"></span><span>                            </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.ControlKeyword</span></span><span>
</span><span id="line-948"></span><span>                            </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;cases&quot;</span></span><span>
</span><span id="line-949"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>                      </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948576"><span class="hs-identifier hs-var">branches'</span></a></span><span>
</span><span id="line-951"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-952"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LamsNamedOrDelay'</span></span><span> </span><span id="local-6989586621680948573"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948573"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680948572"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948572"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-953"></span><span>          </span><span id="local-6989586621680948571"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948571"><span class="hs-identifier hs-var">prettyBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AmbientContext -&gt; Int
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aprecedence%3AAmbientContext"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680948596"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948595"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948594"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948572"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-954"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948572"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-955"></span><span>            </span><span class="hs-comment">-- allow soft hangs when first line is a function application</span><span>
</span><span id="line-956"></span><span>            </span><span class="hs-comment">-- that ends in a delay or other soft-hangable element</span><span>
</span><span id="line-957"></span><span>            </span><span class="hs-comment">--   foo = fork loc do</span><span>
</span><span id="line-958"></span><span>            </span><span class="hs-comment">--     ...</span><span>
</span><span id="line-959"></span><span>            </span><span class="hs-comment">--   foo =</span><span>
</span><span id="line-960"></span><span>            </span><span class="hs-comment">--     fork loc do</span><span>
</span><span id="line-961"></span><span>            </span><span class="hs-comment">--       ...</span><span>
</span><span id="line-962"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span id="local-6989586621680948570"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948570"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span id="local-6989586621680948569"><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680948569"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-963"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948568"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948568"><span class="hs-identifier hs-var">last</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s a. Snoc s s a a =&gt; s -&gt; Maybe (s, a)
</span><span class="hs-identifier hs-var">unsnoc</span></span><span> </span><span class="annot"><span class="annottext">[Term2 v () () v PrintAnnotation]
</span><a href="#local-6989586621680948569"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-964"></span><span>                </span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948568"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-965"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-966"></span><span>                    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span>
</span><span id="line-967"></span><span>                      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:typeSignature:PrettyBinding :: Maybe (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AtypeSignature%3APrettyBinding"><span class="hs-identifier hs-var">typeSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-968"></span><span>                        </span><span class="annot"><span class="annottext">$sel:term:PrettyBinding :: Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aterm%3APrettyBinding"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-969"></span><span>                          </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-970"></span><span>                            </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashQualified Name -&gt; [v] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948575"><span class="hs-identifier hs-var">defnLhs</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948573"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BindingEquals</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; = &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>                              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948571"><span class="hs-identifier hs-var">prettyBody</span></a></span><span>
</span><span id="line-972"></span><span>                              </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.orElse`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Width -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentN</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948571"><span class="hs-identifier hs-var">prettyBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-974"></span><span>            </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-975"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-976"></span><span>                </span><span class="hs-comment">-- Special case for 'let being on the same line</span><span>
</span><span id="line-977"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948566"><span class="annot"><span class="annottext">hang :: Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948566"><span class="hs-identifier hs-var hs-var">hang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948572"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softHang</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.hang</span></span><span>
</span><span id="line-978"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrettyBinding"><span class="hs-identifier hs-type">PrettyBinding</span></a></span><span>
</span><span id="line-979"></span><span>                      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:typeSignature:PrettyBinding :: Maybe (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AtypeSignature%3APrettyBinding"><span class="hs-identifier hs-var">typeSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-980"></span><span>                        </span><span class="annot"><span class="annottext">$sel:term:PrettyBinding :: Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aterm%3APrettyBinding"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-981"></span><span>                          </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-982"></span><span>                            </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashQualified Name -&gt; [v] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948575"><span class="hs-identifier hs-var">defnLhs</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948573"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.BindingEquals</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; =&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948566"><span class="hs-operator hs-var">`hang`</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948571"><span class="hs-identifier hs-var">prettyBody</span></a></span><span>
</span><span id="line-983"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-984"></span><span>        </span><span id="local-6989586621680948565"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948565"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;prettyBinding0: unexpected term: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680948565"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-986"></span><span>        </span><span id="local-6989586621680948575"><span class="annot"><span class="annottext">defnLhs :: HashQualified Name -&gt; [v] -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948575"><span class="hs-identifier hs-var hs-var">defnLhs</span></a></span></span><span> </span><span id="local-6989586621680948564"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948564"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680948563"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948563"><span class="hs-identifier hs-var">vs</span></a></span></span><span>
</span><span id="line-987"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948588"><span class="hs-identifier hs-var">infix'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948563"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-988"></span><span>              </span><span id="local-6989586621680948562"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948562"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680948561"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948561"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-989"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span>
</span><span id="line-990"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-991"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948562"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-992"></span><span>                    </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. HashQualified Name -&gt; Element r
</span><span class="hs-identifier hs-var">S.HashQualifier</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948564"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948595"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948564"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-993"></span><span>                    </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948561"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-994"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-995"></span><span>              </span><span class="hs-special">[</span><span id="local-6989586621680948559"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948559"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-996"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
Pretty s -&gt; f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.sep</span></span><span>
</span><span id="line-997"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-998"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948579"><span class="hs-identifier hs-var">renderName</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948564"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-999"></span><span>                    </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948559"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-1001"></span><span>              </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error&quot;</span></span><span>
</span><span id="line-1002"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948563"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948579"><span class="hs-identifier hs-var">renderName</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948564"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1003"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948579"><span class="hs-identifier hs-var">renderName</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948564"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-operator hs-var">`PP.hang`</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. [v] -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948558"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948563"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1004"></span><span>        </span><span id="local-6989586621680948558"><span class="annot"><span class="annottext">args :: [v] -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948558"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s a.
(Foldable f, IsString s) =&gt;
(a -&gt; Pretty s) -&gt; f a -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.spacedMap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Var</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span>
</span><span id="line-1005"></span><span>        </span><span id="local-6989586621680948579"><span class="annot"><span class="annottext">renderName :: HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948579"><span class="hs-identifier hs-var hs-var">renderName</span></a></span></span><span> </span><span id="local-6989586621680948552"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948552"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1006"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948551"><span class="annot"><span class="annottext">n' :: HashQualified Name
</span><a href="#local-6989586621680948551"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948595"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948552"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1007"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var">parenIfInfix</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948551"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="Unison.Syntax.TermPrinter.html#NonInfix"><span class="hs-identifier hs-var">NonInfix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. HashQualified Name -&gt; Element r
</span><span class="hs-identifier hs-var">S.HashQualifier</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948551"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948551"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-1008"></span><span>    </span><span id="local-6989586621680948590"><span class="annot"><span class="annottext">symbolic :: Bool
</span><a href="#local-6989586621680948590"><span class="hs-identifier hs-var hs-var">symbolic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSymbolic"><span class="hs-identifier hs-var">isSymbolic</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948593"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1009"></span><span>    </span><span id="local-6989586621680948589"><span class="annot"><span class="annottext">isBinary :: Term (F typeVar typeAnn patternAnn) v a -&gt; Bool
</span><a href="#local-6989586621680948589"><span class="hs-identifier hs-var hs-var">isBinary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1010"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span id="local-6989586621680948542"><span class="annot"><span class="annottext">Term (F typeVar typeAnn patternAnn) v a
</span><a href="#local-6989586621680948542"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type typeVar typeAnn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term (F typeVar typeAnn patternAnn) v a -&gt; Bool
</span><a href="#local-6989586621680948589"><span class="hs-identifier hs-var">isBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Term (F typeVar typeAnn patternAnn) v a
</span><a href="#local-6989586621680948542"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1011"></span><span>      </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LamsNamedMatch%27"><span class="hs-identifier hs-type">LamsNamedMatch'</span></a></span><span> </span><span id="local-6989586621680948541"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948541"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[([Pattern patternAnn],
  Maybe (Term (F typeVar typeAnn patternAnn) v a),
  Term (F typeVar typeAnn patternAnn) v a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948541"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1012"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">LamsNamedOrDelay'</span></span><span> </span><span id="local-6989586621680948540"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948540"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term (F typeVar typeAnn patternAnn) v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680948540"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1013"></span><span>      </span><span class="annot"><span class="annottext">Term (F typeVar typeAnn patternAnn) v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- unhittable</span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span id="local-6989586621680951098"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isDocLiteral"><span class="hs-identifier hs-type">isDocLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951098"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1016"></span><span id="isDocLiteral"><span class="annot"><span class="annottext">isDocLiteral :: forall v. Term3 v PrintAnnotation -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isDocLiteral"><span class="hs-identifier hs-var hs-var">isDocLiteral</span></a></span></span><span> </span><span id="local-6989586621680948538"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948538"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948538"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1017"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocJoin"><span class="hs-identifier hs-type">DD.DocJoin</span></a></span><span> </span><span id="local-6989586621680948536"><span class="annot"><span class="annottext">Seq (Term3 v PrintAnnotation)
</span><a href="#local-6989586621680948536"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">forall v. Term3 v PrintAnnotation -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isDocLiteral"><span class="hs-identifier hs-var">isDocLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Term3 v PrintAnnotation)
</span><a href="#local-6989586621680948536"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1018"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocBlob"><span class="hs-identifier hs-type">DD.DocBlob</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1019"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocLink"><span class="hs-identifier hs-type">DD.DocLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkTerm"><span class="hs-identifier hs-type">DD.LinkTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1020"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocLink"><span class="hs-identifier hs-type">DD.DocLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkType"><span class="hs-identifier hs-type">DD.LinkType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeLink'</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1021"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocSource"><span class="hs-identifier hs-type">DD.DocSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkTerm"><span class="hs-identifier hs-type">DD.LinkTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1022"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocSource"><span class="hs-identifier hs-type">DD.DocSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkType"><span class="hs-identifier hs-type">DD.LinkType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeLink'</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1023"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocSignature"><span class="hs-identifier hs-type">DD.DocSignature</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1024"></span><span>  </span><span class="annot"><a href="Unison.Builtin.Decls.html#DocEvaluate"><span class="hs-identifier hs-type">DD.DocEvaluate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1025"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- @[include]</span><span>
</span><span id="line-1026"></span><span>  </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1027"></span><span>
</span><span id="line-1028"></span><span class="hs-comment">-- Similar to DisplayValues.displayDoc, but does not follow and expand references.</span><span>
</span><span id="line-1029"></span><span id="local-6989586621680951091"><span id="local-6989586621680951092"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyDoc"><span class="hs-identifier hs-type">prettyDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951092"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951092"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951091"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span></span></span><span>
</span><span id="line-1030"></span><span id="prettyDoc"><span class="annot"><span class="annottext">prettyDoc :: forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Imports -&gt; Term3 v a -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#prettyDoc"><span class="hs-identifier hs-var hs-var">prettyDoc</span></a></span></span><span> </span><span id="local-6989586621680948504"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948504"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948503"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948503"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621680948502"><span class="annot"><span class="annottext">Term3 v a
</span><a href="#local-6989586621680948502"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1031"></span><span>  </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-1032"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-1033"></span><span>      </span><span class="annot"><span class="annottext">Term3 v a -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v a
</span><a href="#local-6989586621680948502"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1034"></span><span>      </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948499"><span class="hs-identifier hs-var">spaceUnlessBroken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1035"></span><span>      </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:]&quot;</span></span><span>
</span><span id="line-1036"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1037"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1038"></span><span>    </span><span id="local-6989586621680948500"><span class="annot"><span class="annottext">go :: Term3 v a -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948500"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocJoin"><span class="hs-identifier hs-type">DD.DocJoin</span></a></span><span> </span><span id="local-6989586621680948498"><span class="annot"><span class="annottext">Seq (Term3 v a)
</span><a href="#local-6989586621680948498"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Term3 v a -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Term3 v a)
</span><a href="#local-6989586621680948498"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-1039"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocBlob"><span class="hs-identifier hs-type">DD.DocBlob</span></a></span><span> </span><span id="local-6989586621680948496"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948496"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. (ListLike s Char, IsString s) =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.paragraphyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621680948494"><span class="hs-identifier hs-var">escaped</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948496"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocLink"><span class="hs-identifier hs-type">DD.DocLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkTerm"><span class="hs-identifier hs-type">DD.LinkTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span id="local-6989586621680948493"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948493"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1041"></span><span>      </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948493"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948492"><span class="hs-identifier hs-var">fmtTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948493"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocLink"><span class="hs-identifier hs-type">DD.DocLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkType"><span class="hs-identifier hs-type">DD.LinkType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeLink'</span></span><span> </span><span id="local-6989586621680948491"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948491"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1043"></span><span>      </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TypeReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948491"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948490"><span class="hs-identifier hs-var">fmtType</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948491"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocSource"><span class="hs-identifier hs-type">DD.DocSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkTerm"><span class="hs-identifier hs-type">DD.LinkTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span id="local-6989586621680948489"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948489"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1045"></span><span>      </span><span class="annot"><span class="annottext">forall {r}. String -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948488"><span class="hs-identifier hs-var">atKeyword</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;source&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948492"><span class="hs-identifier hs-var">fmtTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948489"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1046"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocSource"><span class="hs-identifier hs-type">DD.DocSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#LinkType"><span class="hs-identifier hs-type">DD.LinkType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeLink'</span></span><span> </span><span id="local-6989586621680948487"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948487"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1047"></span><span>      </span><span class="annot"><span class="annottext">forall {r}. String -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948488"><span class="hs-identifier hs-var">atKeyword</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;source&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948490"><span class="hs-identifier hs-var">fmtType</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948487"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1048"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocSignature"><span class="hs-identifier hs-type">DD.DocSignature</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span id="local-6989586621680948486"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948486"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1049"></span><span>      </span><span class="annot"><span class="annottext">forall {r}. String -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948488"><span class="hs-identifier hs-var">atKeyword</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;signature&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948492"><span class="hs-identifier hs-var">fmtTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948486"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1050"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#DocEvaluate"><span class="hs-identifier hs-type">DD.DocEvaluate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TermLink'</span></span><span> </span><span id="local-6989586621680948485"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948485"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1051"></span><span>      </span><span class="annot"><span class="annottext">forall {r}. String -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948488"><span class="hs-identifier hs-var">atKeyword</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;evaluate&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948492"><span class="hs-identifier hs-var">fmtTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948485"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1052"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680948484"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948484"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {r}. String -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948488"><span class="hs-identifier hs-var">atKeyword</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;include&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948492"><span class="hs-identifier hs-var">fmtTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948484"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1053"></span><span>    </span><span class="annot"><a href="#local-6989586621680948500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(invalid doc literal: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Term3 v a
</span><a href="#local-6989586621680948502"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1054"></span><span>    </span><span id="local-6989586621680948483"><span class="annot"><span class="annottext">fmtName :: HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948483"><span class="hs-identifier hs-var hs-var">fmtName</span></a></span></span><span> </span><span id="local-6989586621680948482"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948482"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. HashQualified Name -&gt; Element r
</span><span class="hs-identifier hs-var">S.HashQualifier</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948482"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948503"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948482"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1055"></span><span>    </span><span id="local-6989586621680948492"><span class="annot"><span class="annottext">fmtTerm :: Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948492"><span class="hs-identifier hs-var hs-var">fmtTerm</span></a></span></span><span> </span><span id="local-6989586621680948481"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948481"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948483"><span class="hs-identifier hs-var">fmtName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948504"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680948481"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1056"></span><span>    </span><span id="local-6989586621680948490"><span class="annot"><span class="annottext">fmtType :: Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948490"><span class="hs-identifier hs-var hs-var">fmtType</span></a></span></span><span> </span><span id="local-6989586621680948480"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948480"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680948483"><span class="hs-identifier hs-var">fmtName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Reference -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#typeName"><span class="hs-identifier hs-var">PrettyPrintEnv.typeName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948504"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948480"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1057"></span><span>    </span><span id="local-6989586621680948488"><span class="annot"><span class="annottext">atKeyword :: String -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680948488"><span class="hs-identifier hs-var hs-var">atKeyword</span></a></span></span><span> </span><span id="local-6989586621680948474"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680948474"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1058"></span><span>      </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@[&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocKeyword</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680948474"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1060"></span><span>        </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;] &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span>    </span><span id="local-6989586621680948494"><span class="annot"><span class="annottext">escaped :: Text -&gt; Text
</span><a href="#local-6989586621680948494"><span class="hs-identifier hs-var hs-var">escaped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.replace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\\@&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.replace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:]&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\\:]&quot;</span></span><span>
</span><span id="line-1062"></span><span>    </span><span id="local-6989586621680948499"><span class="annot"><span class="annottext">spaceUnlessBroken :: Pretty SyntaxText
</span><a href="#local-6989586621680948499"><span class="hs-identifier hs-var hs-var">spaceUnlessBroken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.orElse</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-1063"></span><span>
</span><span id="line-1064"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-type">paren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span>
</span><span id="line-1065"></span><span id="paren"><span class="annot"><span class="annottext">paren :: Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var hs-var">paren</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621680948464"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948464"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Parenthesis</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948464"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.Parenthesis</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1066"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621680948462"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948462"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680948462"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-type">parenIfInfix</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1069"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1070"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#InfixContext"><span class="hs-identifier hs-type">InfixContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1071"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span id="parenIfInfix"><span class="annot"><span class="annottext">parenIfInfix :: HashQualified Name
-&gt; InfixContext -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#parenIfInfix"><span class="hs-identifier hs-var hs-var">parenIfInfix</span></a></span></span><span> </span><span id="local-6989586621680948461"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948461"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680948460"><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680948460"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1073"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">HashQualified Name -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSymbolic"><span class="hs-identifier hs-var">isSymbolic</span></a></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948461"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="#local-6989586621680948460"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="Unison.Syntax.TermPrinter.html#NonInfix"><span class="hs-identifier hs-var">NonInfix</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pretty SyntaxText -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.TermPrinter.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-1074"></span><span>
</span><span id="line-1075"></span><span id="local-6989586621680951159"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621680951159"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621680951159"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-1076"></span><span id="l"><span class="annot"><span class="annottext">l :: forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; s
</span><span class="hs-identifier hs-var">fromString</span></span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isSymbolic"><span class="hs-identifier hs-type">isSymbolic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1079"></span><span id="isSymbolic"><span class="annot"><span class="annottext">isSymbolic :: HashQualified Name -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSymbolic"><span class="hs-identifier hs-var hs-var">isSymbolic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1080"></span><span>  </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><span class="hs-identifier hs-var">Name.isSymboly</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall n. HashQualified n -&gt; Maybe n
</span><span class="hs-identifier hs-var">HQ.toName</span></span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#emptyAc"><span class="hs-identifier hs-type">emptyAc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span>
</span><span id="line-1083"></span><span id="emptyAc"><span class="annot"><span class="annottext">emptyAc :: AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#emptyAc"><span class="hs-identifier hs-var hs-var">emptyAc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#MaybeDoc"><span class="hs-identifier hs-var">MaybeDoc</span></a></span><span>
</span><span id="line-1084"></span><span>
</span><span id="line-1085"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#emptyBlockAc"><span class="hs-identifier hs-type">emptyBlockAc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span>
</span><span id="line-1086"></span><span id="emptyBlockAc"><span class="annot"><span class="annottext">emptyBlockAc :: AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#emptyBlockAc"><span class="hs-identifier hs-var hs-var">emptyBlockAc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="Unison.Syntax.TermPrinter.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="Unison.Syntax.TermPrinter.html#MaybeDoc"><span class="hs-identifier hs-var">MaybeDoc</span></a></span><span>
</span><span id="line-1087"></span><span>
</span><span id="line-1088"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-type">ac</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#BlockContext"><span class="hs-identifier hs-type">BlockContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DocLiteralContext"><span class="hs-identifier hs-type">DocLiteralContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span>
</span><span id="line-1089"></span><span id="ac"><span class="annot"><span class="annottext">ac :: Int
-&gt; BlockContext -&gt; Imports -&gt; DocLiteralContext -&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#ac"><span class="hs-identifier hs-var hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621680948455"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948455"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621680948454"><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680948454"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span id="local-6989586621680948453"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948453"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621680948452"><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948452"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; BlockContext
-&gt; InfixContext
-&gt; Imports
-&gt; DocLiteralContext
-&gt; Bool
-&gt; AmbientContext
</span><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-var">AmbientContext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948455"><span class="hs-identifier hs-var">prec</span></a></span><span> </span><span class="annot"><span class="annottext">BlockContext
</span><a href="#local-6989586621680948454"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">InfixContext
</span><a href="Unison.Syntax.TermPrinter.html#NonInfix"><span class="hs-identifier hs-var">NonInfix</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948453"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">DocLiteralContext
</span><a href="#local-6989586621680948452"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span id="local-6989586621680951174"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-type">fmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Element</span></span><span> </span><span class="annot"><a href="#local-6989586621680951174"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.SyntaxText'</span></span><span> </span><span class="annot"><a href="#local-6989586621680951174"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.SyntaxText'</span></span><span> </span><span class="annot"><a href="#local-6989586621680951174"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1092"></span><span id="fmt"><span class="annot"><span class="annottext">fmt :: forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><span class="hs-identifier hs-var">PP.withSyntax</span></span><span>
</span><span id="line-1093"></span><span>
</span><span id="line-1094"></span><span class="hs-comment">{-
   # FQN elision

   The term pretty-printer inserts `use` statements in some circumstances, to
   avoid the need for using fully-qualified names (FQNs) everywhere.  The
   following is an explanation and specification, as developed in issue #285.

   As an example, instead of

     foo p q r =
       if p then Util.bar q else Util.bar r

   we actually output the following.

     foo p q r =
       use Util bar
       if p then bar q else bar r

   Here, the `use` statement `use Util bar` has been inserted at the start of
   the block statement containing the `if`.  Within that scope, `Util.bar` can
   be referred to just with `bar`.  We say `Util` is the prefix, and `bar` is
   the suffix.

   When choosing where to place `use` statements, the pretty-printer tries to
   - float them down, deeper into the syntax tree, to keep them visually close
     to the use sites ('usages') of the names involved, but also tries to
   - minimize the number of repetitions of `use` statements for the same names
     by floating them up, towards the top of the syntax tree, so that one
     `use` statement takes effect over more name usages.

   It avoids producing output like the following.

     foo p q r =
       use My bar
       if p then bar q else Your.bar r

   Here `My.bar` is imported with a `use` statement, but `Your.bar` is not.
   We avoid this because it would be easy to misread `bar` as meaning
   `Your.bar`.  Instead both names are output fully qualified.

   This means that a `use` statement is only emitted for a name
   when the suffix is unique, across all the names referenced in the scope of
   the `use` statement.

   We don't emit a `use` statement for a name if it only occurs once within
   the scope (unless it's an infix operator, since they look nicer without
   a namespace qualifier.)

   The emitted code does not depend on Type-Driven Name Resolution (TDNR).
   For example, we emit
     foo =
       use Nat +
       1 + 2
   even though TDNR means that `foo = 1 + 2` would have had the same
   meaning.  That avoids the reader having to run typechecker logic in their
   head in order to know what functions are being called.

   Multi-level name qualification is allowed - like `Foo.Bar.baz`.  The
   pretty-printer tries to strip off as many sections of the prefix as
   possible, without causing a clash with other names.  If more sections
   can be stripped off, further down the tree, then it does this too.

   ## Specification

   We output a `use` statement for prefix P and suffix S at a given scope if
     - the scope is a block statement (so the `use` is syntactically valid)
     - the number of usages of the thing referred to by P.S within the scope
       - is &gt; 1, or
       - is 1, and S is an infix operator
     - [uniqueness] there is no other Q with Q.S used in that scope
     - there is no longer prefix PP (and suffix s, with PP.s == P.S) which
       satisfies uniqueness
     - [narrowness] there is no block statement further down inside this one
       which contains all of the usages.

   Use statements in a block statement are sorted alphabetically by prefix.
   Suffixes covered by a single use statement are sorted alphabetically.
   Note that each `use` line cannot be line-broken.  Ideally they would
   fit the available space by splitting into multiple separate `use` lines.

   ## Algorithm

   Bubbling up from the leaves of the syntax tree, we calculate for each
   node, a `Map Suffix (Map Prefix Int)` (the 'usages map'), where the `Int`
   is the number of usages of Prefix.Suffix at/under that node.  (Note that
   a usage of `A.B.c` corresponds to two entries in the outer map.)  See
   `printAnnotate`.

   Once we have this decoration on all the terms, we start pretty-printing.
   As we recurse back down through the tree, we keep a `Map Name Suffix` (the
   'imports map'), to record the effect of all the `use` statements we've added
   in the nodes above.  When outputting names, we check this map to work out
   how to render them, using any suffix we find, or else falling back to the
   FQN.  At each block statement, each suffix in that term's usages map is a
   candidate to be imported with a use statement, subject to the various
   rules in the specification.

   # Debugging

   Start by enabling the tracing in elideFQN in PrettyPrintEnv.hs.

   There's also tracing in allInSubBlock to help when the narrowness check
   is playing up.

   # Semantics of imports

   Here is some background on how imports work.

   `use XYZ blah` brings `XYZ.blah` into scope, bound to the name `blah`. More
   generally, `use` is followed by a FQN prefix, then the local suffix.
   Concatenate the FQN prefix with the local suffix, with a dot between them,
   and you get the FQN, which is bound to the name equal to the local suffix.

   `use XYZ blah qux` is equivalent to the two statements (and this
   generalizes for any N symbols):
     use XYZ blah
     use XYZ qux

   This syntax works the same even if XYZ or blah have dots in them, so:
   `use Util.External My.Foo` brings `Util.External.My.Foo` into scope, bound
   to the name `My.Foo`.

   That's it. No wildcard imports, imports that do renaming, etc. We can
   consider adding some features like this later.
-}</span><span>
</span><span id="line-1219"></span><span>
</span><span id="line-1220"></span><span class="hs-keyword">newtype</span><span> </span><span id="PrintAnnotation"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-var">PrintAnnotation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PrintAnnotation"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-var">PrintAnnotation</span></a></span></span><span>
</span><span id="line-1221"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- For each suffix that appears in/under this term, the set of prefixes</span><span>
</span><span id="line-1222"></span><span>    </span><span class="hs-comment">-- used with that suffix, and how many times each occurs.</span><span>
</span><span id="line-1223"></span><span>    </span><span id="%24sel%3Ausages%3APrintAnnotation"><span class="annot"><span class="annottext">PrintAnnotation -&gt; Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var hs-var">usages</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1224"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1225"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948438"><span id="local-6989586621680948440"><span id="local-6989586621680948447"><span class="annot"><span class="annottext">Int -&gt; PrintAnnotation -&gt; ShowS
[PrintAnnotation] -&gt; ShowS
PrintAnnotation -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PrintAnnotation] -&gt; ShowS
$cshowList :: [PrintAnnotation] -&gt; ShowS
show :: PrintAnnotation -&gt; String
$cshow :: PrintAnnotation -&gt; String
showsPrec :: Int -&gt; PrintAnnotation -&gt; ShowS
$cshowsPrec :: Int -&gt; PrintAnnotation -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1226"></span><span>
</span><span id="line-1227"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680948429"><span id="local-6989586621680948431"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1228"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:usages:PrintAnnotation :: PrintAnnotation -&gt; Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680948423"><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948423"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680948422"><span class="annot"><span class="annottext">&lt;&gt; :: PrintAnnotation -&gt; PrintAnnotation -&gt; PrintAnnotation
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:usages:PrintAnnotation :: PrintAnnotation -&gt; Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680948421"><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948421"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1229"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:usages:PrintAnnotation :: Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="annot"><span class="annottext">forall {k} {a}. (Ord k, Num a) =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621680948419"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948423"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948421"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1230"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1231"></span><span>      </span><span id="local-6989586621680948419"><span class="annot"><span class="annottext">f :: Map k a -&gt; Map k a -&gt; Map k a
</span><a href="#local-6989586621680948419"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680948414"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948414"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621680948413"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948413"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948414"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948413"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-1232"></span><span>
</span><span id="line-1233"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680948406"><span id="local-6989586621680948408"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1234"></span><span>  </span><span id="local-6989586621680948404"><span class="annot"><span class="annottext">mempty :: PrintAnnotation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:usages:PrintAnnotation :: Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">}</span><span>
</span><span id="line-1235"></span><span>
</span><span id="line-1236"></span><span id="local-6989586621680950882"><span id="local-6989586621680950883"><span id="local-6989586621680950884"><span id="local-6989586621680950885"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#suffixCounterTerm"><span class="hs-identifier hs-type">suffixCounterTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950885"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950885"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950884"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950883"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950885"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950882"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span></span></span></span><span>
</span><span id="line-1237"></span><span id="suffixCounterTerm"><span class="annot"><span class="annottext">suffixCounterTerm :: forall v at ap a.
Var v =&gt;
PrettyPrintEnv
-&gt; Set Name -&gt; Set Name -&gt; Term2 v at ap v a -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#suffixCounterTerm"><span class="hs-identifier hs-var hs-var">suffixCounterTerm</span></a></span></span><span> </span><span id="local-6989586621680948388"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948388"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948387"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948387"><span class="hs-identifier hs-var">usedTm</span></a></span></span><span> </span><span id="local-6989586621680948386"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948386"><span class="hs-identifier hs-var">usedTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1238"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Var'</span></span><span> </span><span id="local-6989586621680948385"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948385"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; HashQualified Name
</span><span class="hs-identifier hs-var">HQ.unsafeFromVar</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948385"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680948383"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948383"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948387"><span class="hs-identifier hs-var">usedTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948388"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948383"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1240"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span id="local-6989586621680948382"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948382"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#noImportRefs"><span class="hs-identifier hs-var">noImportRefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948382"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall r s.
Lens (GConstructorReference r) (GConstructorReference s) r s
</span><span class="hs-identifier hs-var">ConstructorReference.reference_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1241"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span id="local-6989586621680948378"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948378"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948387"><span class="hs-identifier hs-var">usedTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948388"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948378"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Data</span></span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Request'</span></span><span> </span><span id="local-6989586621680948377"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948377"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948387"><span class="hs-identifier hs-var">usedTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948388"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstructorReference -&gt; ConstructorType -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948377"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">CT.Effect</span></span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948376"><span class="annot"><span class="annottext">Type v at
</span><a href="#local-6989586621680948376"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall v a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Set Name -&gt; Type v a -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countTypeUsages"><span class="hs-identifier hs-var">countTypeUsages</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948388"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948386"><span class="hs-identifier hs-var">usedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type v at
</span><a href="#local-6989586621680948376"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1244"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948374"><span class="annot"><span class="annottext">[MatchCase ap (Term2 v at ap v a)]
</span><a href="#local-6989586621680948374"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1245"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948373"><span class="annot"><span class="annottext">pat :: MatchCase loc a -&gt; Pattern loc
</span><a href="#local-6989586621680948373"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span id="local-6989586621680948372"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948372"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680948372"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1246"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall loc.
PrettyPrintEnv -&gt; Set Name -&gt; Pattern loc -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countPatternUsages"><span class="hs-identifier hs-var">countPatternUsages</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948388"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948387"><span class="hs-identifier hs-var">usedTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {loc} {a}. MatchCase loc a -&gt; Pattern loc
</span><a href="#local-6989586621680948373"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 v at ap v a)]
</span><a href="#local-6989586621680948374"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1247"></span><span>  </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1248"></span><span>
</span><span id="line-1249"></span><span id="local-6989586621680950861"><span id="local-6989586621680950862"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#suffixCounterType"><span class="hs-identifier hs-type">suffixCounterType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950862"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="annot"><a href="#local-6989586621680950862"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span></span><span>
</span><span id="line-1250"></span><span id="suffixCounterType"><span class="annot"><span class="annottext">suffixCounterType :: forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Set Name -&gt; Type v a -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#suffixCounterType"><span class="hs-identifier hs-var hs-var">suffixCounterType</span></a></span></span><span> </span><span id="local-6989586621680948364"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948364"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948363"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948363"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1251"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Type.Var'</span></span><span> </span><span id="local-6989586621680948361"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948361"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948363"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; HashQualified Name
</span><span class="hs-identifier hs-var">HQ.unsafeFromVar</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948361"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1252"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Type.Ref'</span></span><span> </span><span id="local-6989586621680948359"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948359"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#noImportRefs"><span class="hs-identifier hs-var">noImportRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948359"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948359"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier hs-var">Type.listRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1253"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Type.Ref'</span></span><span> </span><span id="local-6989586621680948358"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948358"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948363"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Reference -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#typeName"><span class="hs-identifier hs-var">PrettyPrintEnv.typeName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948364"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948358"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1254"></span><span>  </span><span class="annot"><span class="annottext">Type v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1255"></span><span>
</span><span id="line-1256"></span><span id="local-6989586621680951242"><span id="local-6989586621680951243"><span id="local-6989586621680951244"><span id="local-6989586621680951245"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-type">printAnnotate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951245"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680951245"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680951245"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951244"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951243"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951245"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951245"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span></span></span></span><span>
</span><span id="line-1257"></span><span id="printAnnotate"><span class="annot"><span class="annottext">printAnnotate :: forall v at ap a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Term2 v at ap v a -&gt; Term3 v PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#printAnnotate"><span class="hs-identifier hs-var hs-var">printAnnotate</span></a></span></span><span> </span><span id="local-6989586621680948336"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948336"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948335"><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948335"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1258"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v at ap b. Ord v =&gt; Term2 v at ap v b -&gt; Term2 v () () v b
</span><a href="#local-6989586621680948334"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) b a.
(Ord v, Foldable f, Functor f, Monoid b) =&gt;
(Term f v a -&gt; b) -&gt; Term f v a -&gt; Term f v (a, b)
</span><span class="hs-identifier hs-var">reannotateUp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v at ap a.
Var v =&gt;
PrettyPrintEnv
-&gt; Set Name -&gt; Set Name -&gt; Term2 v at ap v a -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#suffixCounterTerm"><span class="hs-identifier hs-var">suffixCounterTerm</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948336"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948333"><span class="hs-identifier hs-var">usedTermNames</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948332"><span class="hs-identifier hs-var">usedTypeNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1260"></span><span>    </span><span class="hs-comment">-- See `countHQ` to see how these are used to make sure that</span><span>
</span><span id="line-1261"></span><span>    </span><span class="hs-comment">-- a `use` clause doesn't introduce shadowing of a local variable</span><span>
</span><span id="line-1262"></span><span>    </span><span id="local-6989586621680948333"><span class="annot"><span class="annottext">usedTermNames :: Set Name
</span><a href="#local-6989586621680948333"><span class="hs-identifier hs-var hs-var">usedTermNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1263"></span><span>      </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948330"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680948329"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948329"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Foldable f =&gt; Term f v a -&gt; [v]
</span><span class="hs-identifier hs-var">ABT.allVars</span></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948330"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948330"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {v}. Var v =&gt; v -&gt; [Name]
</span><a href="#local-6989586621680948327"><span class="hs-identifier hs-var">varToName</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948329"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1264"></span><span>    </span><span id="local-6989586621680948332"><span class="annot"><span class="annottext">usedTypeNames :: Set Name
</span><a href="#local-6989586621680948332"><span class="hs-identifier hs-var hs-var">usedTypeNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1265"></span><span>      </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948326"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948325"><span class="annot"><span class="annottext">Type v at
</span><a href="#local-6989586621680948325"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) a.
(Ord v, Traversable f) =&gt;
Term f v a -&gt; [Term f v a]
</span><span class="hs-identifier hs-var">ABT.subterms</span></span><span> </span><span class="annot"><span class="annottext">Term2 v at ap v a
</span><a href="#local-6989586621680948335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948323"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948323"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Foldable f =&gt; Term f v a -&gt; [v]
</span><span class="hs-identifier hs-var">ABT.allVars</span></span><span> </span><span class="annot"><span class="annottext">Type v at
</span><a href="#local-6989586621680948325"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948326"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948326"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {v}. Var v =&gt; v -&gt; [Name]
</span><a href="#local-6989586621680948327"><span class="hs-identifier hs-var">varToName</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948323"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1266"></span><span>    </span><span id="local-6989586621680948327"><span class="annot"><span class="annottext">varToName :: v -&gt; [Name]
</span><a href="#local-6989586621680948327"><span class="hs-identifier hs-var hs-var">varToName</span></a></span></span><span> </span><span id="local-6989586621680948319"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948319"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Name
</span><span class="hs-identifier hs-var">Name.parseText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948319"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1267"></span><span>    </span><span id="local-6989586621680950843"><span id="local-6989586621680950844"><span id="local-6989586621680950845"><span id="local-6989586621680950846"><span class="annot"><a href="#local-6989586621680948334"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680950846"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950846"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950845"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950844"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950846"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950843"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950846"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680950846"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950843"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-1268"></span><span>    </span><span id="local-6989586621680948334"><span class="annot"><span class="annottext">go :: forall v at ap b. Ord v =&gt; Term2 v at ap v b -&gt; Term2 v () () v b
</span><a href="#local-6989586621680948334"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall vt vt' at at' ap ap' v a.
(Ord vt, Ord vt') =&gt;
(vt -&gt; vt')
-&gt; (at -&gt; at')
-&gt; (ap -&gt; ap')
-&gt; Term2 vt at ap v a
-&gt; Term2 vt' at' ap' v a
</span><span class="hs-identifier hs-var">extraMap'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span id="local-6989586621680950866"><span id="local-6989586621680950867"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#countTypeUsages"><span class="hs-identifier hs-type">countTypeUsages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950867"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680950867"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="annot"><a href="#local-6989586621680950867"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950866"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span></span><span>
</span><span id="line-1271"></span><span id="countTypeUsages"><span class="annot"><span class="annottext">countTypeUsages :: forall v a.
(Var v, Ord v) =&gt;
PrettyPrintEnv -&gt; Set Name -&gt; Type v a -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countTypeUsages"><span class="hs-identifier hs-var hs-var">countTypeUsages</span></a></span></span><span> </span><span id="local-6989586621680948304"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948304"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948303"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948303"><span class="hs-identifier hs-var">usedTy</span></a></span></span><span> </span><span id="local-6989586621680948302"><span class="annot"><span class="annottext">Type v a
</span><a href="#local-6989586621680948302"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; a
</span><span class="hs-identifier hs-var">annotation</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) b a.
(Ord v, Foldable f, Functor f, Monoid b) =&gt;
(Term f v a -&gt; b) -&gt; Term f v a -&gt; Term f v (a, b)
</span><span class="hs-identifier hs-var">reannotateUp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v a.
Var v =&gt;
PrettyPrintEnv -&gt; Set Name -&gt; Type v a -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#suffixCounterType"><span class="hs-identifier hs-var">suffixCounterType</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948304"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948303"><span class="hs-identifier hs-var">usedTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type v a
</span><a href="#local-6989586621680948302"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1272"></span><span>
</span><span id="line-1273"></span><span id="local-6989586621680950863"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#countPatternUsages"><span class="hs-identifier hs-type">countPatternUsages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="annot"><a href="#local-6989586621680950863"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span><span>
</span><span id="line-1274"></span><span id="countPatternUsages"><span class="annot"><span class="annottext">countPatternUsages :: forall loc.
PrettyPrintEnv -&gt; Set Name -&gt; Pattern loc -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countPatternUsages"><span class="hs-identifier hs-var hs-var">countPatternUsages</span></a></span></span><span> </span><span id="local-6989586621680948286"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948286"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680948285"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948285"><span class="hs-identifier hs-var">usedTm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall m loc. Monoid m =&gt; (Pattern loc -&gt; m) -&gt; Pattern loc -&gt; m
</span><span class="hs-identifier hs-var">Pattern.foldMap'</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; PrintAnnotation
</span><a href="#local-6989586621680948283"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1275"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1276"></span><span>    </span><span id="local-6989586621680948283"><span class="annot"><span class="annottext">f :: Pattern loc -&gt; PrintAnnotation
</span><a href="#local-6989586621680948283"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1277"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Unbound</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1278"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Var</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1279"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Boolean</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1280"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Int</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1281"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Nat</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1282"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Float</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1283"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Text</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1284"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Char</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1285"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.As</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1286"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.SequenceLiteral</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1287"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.SequenceOp</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1288"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.EffectPure</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1289"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.EffectBind</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948282"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948282"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948285"><span class="hs-identifier hs-var">usedTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; ConstructorReference -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#patternName"><span class="hs-identifier hs-var">PrettyPrintEnv.patternName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948286"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948282"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1290"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Constructor</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948280"><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948280"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1291"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#noImportRefs"><span class="hs-identifier hs-var">noImportRefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948280"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall r s.
Lens (GConstructorReference r) (GConstructorReference s) r s
</span><span class="hs-identifier hs-var">ConstructorReference.reference_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1293"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948285"><span class="hs-identifier hs-var">usedTm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; ConstructorReference -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#patternName"><span class="hs-identifier hs-var">PrettyPrintEnv.patternName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680948286"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><a href="#local-6989586621680948280"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-type">countHQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HQ.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span>
</span><span id="line-1296"></span><span id="countHQ"><span class="annot"><span class="annottext">countHQ :: Set Name -&gt; HashQualified Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var hs-var">countHQ</span></a></span></span><span> </span><span id="local-6989586621680948279"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948279"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HQ.NameOnly</span></span><span> </span><span id="local-6989586621680948277"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948277"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span>  </span><span class="hs-comment">-- Names that are marked 'used' aren't considered for `use` clause insertion</span><span>
</span><span id="line-1298"></span><span>  </span><span class="hs-comment">-- So if a variable 'foo' is used, then we won't insert a `use` clause for</span><span>
</span><span id="line-1299"></span><span>  </span><span class="hs-comment">-- the reference `Qux.quaffle.foo`.</span><span>
</span><span id="line-1300"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680948276"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948276"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Set.lookupLE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948277"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680948279"><span class="hs-identifier hs-var">used</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><span class="hs-identifier hs-var">Name.endsWith</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948277"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948276"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1301"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#countHQ"><span class="hs-identifier hs-var">countHQ</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948273"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948273"><span class="hs-identifier hs-var">hq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countName"><span class="hs-identifier hs-var">countName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n. HashQualified n -&gt; Maybe n
</span><span class="hs-identifier hs-var">HQ.toName</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680948273"><span class="hs-identifier hs-var">hq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1302"></span><span>
</span><span id="line-1303"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#countName"><span class="hs-identifier hs-type">countName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span>
</span><span id="line-1304"></span><span id="countName"><span class="annot"><span class="annottext">countName :: Name -&gt; PrintAnnotation
</span><a href="Unison.Syntax.TermPrinter.html#countName"><span class="hs-identifier hs-var hs-var">countName</span></a></span></span><span> </span><span id="local-6989586621680948271"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948271"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1305"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span>
</span><span id="line-1306"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:usages:PrintAnnotation :: Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1307"></span><span>        </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1308"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680948269"><span class="annot"><span class="annottext">[NameSegment]
</span><a href="#local-6989586621680948269"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948268"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948268"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Name -&gt; [([NameSegment], Name)]
</span><span class="hs-identifier hs-var">Name.splits</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948271"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1309"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var">Name.toText</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NameSegment -&gt; Text
</span><span class="hs-identifier hs-var">NameSegment.toEscapedText</span></span><span> </span><span class="annot"><span class="annottext">[NameSegment]
</span><a href="#local-6989586621680948269"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1310"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1311"></span><span>
</span><span id="line-1312"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#joinName"><span class="hs-identifier hs-type">joinName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1313"></span><span id="joinName"><span class="annot"><span class="annottext">joinName :: Prefix -&gt; Text -&gt; Name
</span><a href="Unison.Syntax.TermPrinter.html#joinName"><span class="hs-identifier hs-var hs-var">joinName</span></a></span></span><span> </span><span id="local-6989586621680948264"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948264"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680948263"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948263"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Text -&gt; Name
</span><span class="hs-identifier hs-var">Name.unsafeParseText</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prefix -&gt; Text
</span><a href="Unison.Syntax.TermPrinter.html#dotConcat"><span class="hs-identifier hs-var">dotConcat</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948264"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948263"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1314"></span><span>
</span><span id="line-1315"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#dotConcat"><span class="hs-identifier hs-type">dotConcat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-1316"></span><span id="dotConcat"><span class="annot"><span class="annottext">dotConcat :: Prefix -&gt; Text
</span><a href="Unison.Syntax.TermPrinter.html#dotConcat"><span class="hs-identifier hs-var hs-var">dotConcat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prefix -&gt; Text
</span><span class="hs-identifier hs-var">Text.concat</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span class="hs-comment">-- This predicate is used to keep certain refs out of the FQN elision annotations,</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- so that we don't get `use` statements for them.</span><span>
</span><span id="line-1320"></span><span class="hs-comment">--</span><span>
</span><span id="line-1321"></span><span class="hs-comment">-- Don't do `use () ()` or `use Pair Pair`.  Tuple syntax generates ().() and Pair.Pair</span><span>
</span><span id="line-1322"></span><span class="hs-comment">-- under the covers anyway.  This does mean that if someone is using Pair.Pair directly,</span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- then they'll miss out on FQN elision for that.</span><span>
</span><span id="line-1324"></span><span class="hs-comment">--</span><span>
</span><span id="line-1325"></span><span class="hs-comment">-- Don't do `use builtin.Doc Blob`, `use builtin.Link Term`, or similar.  That avoids</span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- unnecessary use statements above Doc literals and termLink/typeLink.</span><span>
</span><span id="line-1327"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#noImportRefs"><span class="hs-identifier hs-type">noImportRefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1328"></span><span id="noImportRefs"><span class="annot"><span class="annottext">noImportRefs :: Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#noImportRefs"><span class="hs-identifier hs-var hs-var">noImportRefs</span></a></span></span><span> </span><span id="local-6989586621680948260"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948260"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1329"></span><span>  </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680948260"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1330"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#pairRef"><span class="hs-identifier hs-var">DD.pairRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1331"></span><span>             </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#unitRef"><span class="hs-identifier hs-var">DD.unitRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1332"></span><span>             </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#docRef"><span class="hs-identifier hs-var">DD.docRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1333"></span><span>             </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Builtin.Decls.html#linkRef"><span class="hs-identifier hs-var">DD.linkRef</span></a></span><span>
</span><span id="line-1334"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-type">|&gt;</span></a></span><span>
</span><span id="line-1337"></span><span>
</span><span id="line-1338"></span><span id="local-6989586621680950802"><span id="local-6989586621680950803"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-type">(|&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680950803"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680950803"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680950802"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680950802"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-1339"></span><span id="local-6989586621680948254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948254"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="%7C%3E"><span class="annot"><span class="annottext">|&gt; :: forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var hs-var">|&gt;</span></a></span></span><span> </span><span id="local-6989586621680948253"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680948253"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621680948253"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948254"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1340"></span><span>
</span><span id="line-1341"></span><span class="hs-comment">-- This function gets used each time we start printing a new block statement.</span><span>
</span><span id="line-1342"></span><span class="hs-comment">-- It decides what extra imports to introduce (returning the full new set), and</span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- determines some pretty-printed lines that looks like</span><span>
</span><span id="line-1344"></span><span class="hs-comment">--    use A x</span><span>
</span><span id="line-1345"></span><span class="hs-comment">--    use B y</span><span>
</span><span id="line-1346"></span><span class="hs-comment">-- providing a `[Pretty SyntaxText] -&gt; Pretty SyntaxText` that prepends those</span><span>
</span><span id="line-1347"></span><span class="hs-comment">-- lines to the list of lines provided, and then concatenates them.</span><span>
</span><span id="line-1348"></span><span id="local-6989586621680951177"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#calcImports"><span class="hs-identifier hs-type">calcImports</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1349"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951177"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680951177"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1350"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1351"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951177"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1352"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Imports"><span class="hs-identifier hs-type">Imports</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-1353"></span><span id="calcImports"><span class="annot"><span class="annottext">calcImports :: forall v.
(Var v, Ord v) =&gt;
Imports
-&gt; Term3 v PrintAnnotation -&gt; (Imports, [Pretty SyntaxText])
</span><a href="Unison.Syntax.TermPrinter.html#calcImports"><span class="hs-identifier hs-var hs-var">calcImports</span></a></span></span><span> </span><span id="local-6989586621680948219"><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948219"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621680948218"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948218"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948217"><span class="hs-identifier hs-var">im'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {r}.
Foldable t =&gt;
Map (t Text) (Set Text) -&gt; [Pretty (SyntaxText' r)]
</span><a href="#local-6989586621680948216"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int) -&gt; Map Prefix (Set Text)
</span><a href="#local-6989586621680948215"><span class="hs-identifier hs-var">getUses</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948214"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1354"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1355"></span><span>    </span><span class="hs-comment">-- The guts of this function is a pipeline of transformations and filters, starting from the</span><span>
</span><span id="line-1356"></span><span>    </span><span class="hs-comment">-- PrintAnnotation we built up in printAnnotate.</span><span>
</span><span id="line-1357"></span><span>    </span><span class="hs-comment">-- In `result`, the Name matches Prefix ++ Suffix; and the Int is the number of usages in this scope.</span><span>
</span><span id="line-1358"></span><span>    </span><span class="hs-comment">-- `result` lists all the names we're going to import, and what Prefix we'll use for each.</span><span>
</span><span id="line-1359"></span><span>    </span><span class="annot"><a href="#local-6989586621680948214"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1360"></span><span>    </span><span id="local-6989586621680948214"><span class="annot"><span class="annottext">result :: Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948214"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1361"></span><span>      </span><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948213"><span class="hs-identifier hs-var">usages'</span></a></span><span>
</span><span id="line-1362"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Map Prefix Int) -&gt; Map Text (Prefix, Int)
</span><a href="#local-6989586621680948212"><span class="hs-identifier hs-var">uniqueness</span></a></span><span>
</span><span id="line-1363"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Prefix, Int) -&gt; Map Text (Prefix, Int)
</span><a href="#local-6989586621680948211"><span class="hs-identifier hs-var">enoughUsages</span></a></span><span>
</span><span id="line-1364"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Prefix, Int) -&gt; Map (Name, Int) (Prefix, Text, Int)
</span><a href="#local-6989586621680948210"><span class="hs-identifier hs-var">groupAndCountLength</span></a></span><span>
</span><span id="line-1365"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k1 k2 v.
(Show k1, Show k2, Ord k1, Ord k2) =&gt;
Map (k1, k2) v -&gt; Map k1 v
</span><a href="#local-6989586621680948209"><span class="hs-identifier hs-var">longestPrefix</span></a></span><span>
</span><span id="line-1366"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int) -&gt; Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948208"><span class="hs-identifier hs-var">avoidRepeatsAndClashes</span></a></span><span>
</span><span id="line-1367"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int) -&gt; Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948207"><span class="hs-identifier hs-var">narrowestPossible</span></a></span><span>
</span><span id="line-1368"></span><span>    </span><span class="annot"><a href="#local-6989586621680948213"><span class="hs-identifier hs-type">usages'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1369"></span><span>    </span><span id="local-6989586621680948213"><span class="annot"><span class="annottext">usages' :: Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948213"><span class="hs-identifier hs-var hs-var">usages'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrintAnnotation -&gt; Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; a
</span><span class="hs-identifier hs-var">annotation</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948218"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1370"></span><span>    </span><span class="hs-comment">-- Keep only names P.S where there is no other Q with Q.S also used in this scope.</span><span>
</span><span id="line-1371"></span><span>    </span><span class="annot"><a href="#local-6989586621680948212"><span class="hs-identifier hs-type">uniqueness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1372"></span><span>    </span><span id="local-6989586621680948212"><span class="annot"><span class="annottext">uniqueness :: Map Text (Map Prefix Int) -&gt; Map Text (Prefix, Int)
</span><a href="#local-6989586621680948212"><span class="hs-identifier hs-var hs-var">uniqueness</span></a></span></span><span> </span><span id="local-6989586621680948206"><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948206"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1373"></span><span>      </span><span class="annot"><span class="annottext">Map Text (Map Prefix Int)
</span><a href="#local-6989586621680948206"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1374"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680948204"><span class="annot"><span class="annottext">Map Prefix Int
</span><a href="#local-6989586621680948204"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map Prefix Int
</span><a href="#local-6989586621680948204"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1375"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-1376"></span><span>    </span><span class="hs-comment">-- Keep only names where the number of usages in this scope</span><span>
</span><span id="line-1377"></span><span>    </span><span class="hs-comment">--   - is &gt; 1, or</span><span>
</span><span id="line-1378"></span><span>    </span><span class="hs-comment">--   - is 1, and S is an infix operator.</span><span>
</span><span id="line-1379"></span><span>    </span><span class="hs-comment">-- Also drop names with an empty prefix.</span><span>
</span><span id="line-1380"></span><span>    </span><span id="local-6989586621680948187"><span class="annot"><span class="annottext">lookupOrDie :: k -&gt; Map k a -&gt; a
</span><a href="#local-6989586621680948187"><span class="hs-identifier hs-var hs-var">lookupOrDie</span></a></span></span><span> </span><span id="local-6989586621680948186"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680948186"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680948185"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948185"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680948184"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680948186"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948185"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1381"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1382"></span><span>        </span><span id="local-6989586621680948184"><span class="annot"><span class="annottext">msg :: a
</span><a href="#local-6989586621680948184"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TermPrinter.enoughUsages &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680948186"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621680948185"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1383"></span><span>
</span><span id="line-1384"></span><span>    </span><span class="annot"><a href="#local-6989586621680948211"><span class="hs-identifier hs-type">enoughUsages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1385"></span><span>    </span><span id="local-6989586621680948211"><span class="annot"><span class="annottext">enoughUsages :: Map Text (Prefix, Int) -&gt; Map Text (Prefix, Int)
</span><a href="#local-6989586621680948211"><span class="hs-identifier hs-var hs-var">enoughUsages</span></a></span></span><span> </span><span id="local-6989586621680948182"><span class="annot"><span class="annottext">Map Text (Prefix, Int)
</span><a href="#local-6989586621680948182"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1386"></span><span>      </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Map Text (Prefix, Int)
</span><a href="#local-6989586621680948182"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1387"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span>
</span><span id="line-1388"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680948180"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948180"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1389"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948179"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948179"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948178"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {a}. (Show k, Show a, Ord k) =&gt; k -&gt; Map k a -&gt; a
</span><a href="#local-6989586621680948187"><span class="hs-identifier hs-var">lookupOrDie</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948180"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Prefix, Int)
</span><a href="#local-6989586621680948182"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1390"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948178"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><span class="hs-identifier hs-var">Name.isSymboly</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Either Text Name
</span><span class="hs-identifier hs-var">Name.parseTextEither</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948180"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948179"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1391"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1392"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680948175"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948175"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948175"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {k} {a}. (Show k, Show a, Ord k) =&gt; k -&gt; Map k a -&gt; a
</span><a href="#local-6989586621680948187"><span class="hs-identifier hs-var">lookupOrDie</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948175"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text (Prefix, Int)
</span><a href="#local-6989586621680948182"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-1394"></span><span>    </span><span class="hs-comment">-- Group by `Prefix ++ Suffix`, and then by `length Prefix`</span><span>
</span><span id="line-1395"></span><span>    </span><span class="annot"><a href="#local-6989586621680948210"><span class="hs-identifier hs-type">groupAndCountLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1396"></span><span>    </span><span id="local-6989586621680948210"><span class="annot"><span class="annottext">groupAndCountLength :: Map Text (Prefix, Int) -&gt; Map (Name, Int) (Prefix, Text, Int)
</span><a href="#local-6989586621680948210"><span class="hs-identifier hs-var hs-var">groupAndCountLength</span></a></span></span><span> </span><span id="local-6989586621680948174"><span class="annot"><span class="annottext">Map Text (Prefix, Int)
</span><a href="#local-6989586621680948174"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1397"></span><span>      </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map Text (Prefix, Int)
</span><a href="#local-6989586621680948174"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1398"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-1399"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680948173"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948173"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948172"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948172"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948171"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948171"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1400"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948170"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621680948170"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prefix -&gt; Text -&gt; Name
</span><a href="Unison.Syntax.TermPrinter.html#joinName"><span class="hs-identifier hs-var">joinName</span></a></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948172"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948173"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1401"></span><span>                  </span><span id="local-6989586621680948169"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621680948169"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948172"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1402"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948170"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948169"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948172"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948173"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948171"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1403"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1404"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-1405"></span><span>    </span><span class="hs-comment">-- For each k1, choose the v with the largest k2.</span><span>
</span><span id="line-1406"></span><span>    </span><span id="local-6989586621680950790"><span id="local-6989586621680950791"><span id="local-6989586621680950792"><span class="annot"><a href="#local-6989586621680948209"><span class="hs-identifier hs-type">longestPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680950792"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680950791"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680950792"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680950791"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680950792"><span class="hs-identifier hs-type">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680950791"><span class="hs-identifier hs-type">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680950790"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680950792"><span class="hs-identifier hs-type">k1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950790"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-1407"></span><span>    </span><span id="local-6989586621680948209"><span class="annot"><span class="annottext">longestPrefix :: forall k1 k2 v.
(Show k1, Show k2, Ord k1, Ord k2) =&gt;
Map (k1, k2) v -&gt; Map k1 v
</span><a href="#local-6989586621680948209"><span class="hs-identifier hs-var hs-var">longestPrefix</span></a></span></span><span> </span><span id="local-6989586621680948146"><span class="annot"><span class="annottext">Map (k1, k2) v
</span><a href="#local-6989586621680948146"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1408"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948145"><span class="annot"><span class="annottext">k1s :: Set k1
</span><a href="#local-6989586621680948145"><span class="hs-identifier hs-var hs-var">k1s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (k1, k2) v
</span><a href="#local-6989586621680948146"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1409"></span><span>          </span><span id="local-6989586621680948142"><span class="annot"><span class="annottext">k2s :: Map k1 (Set k2)
</span><a href="#local-6989586621680948142"><span class="hs-identifier hs-var hs-var">k2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1410"></span><span>            </span><span class="annot"><span class="annottext">Set k1
</span><a href="#local-6989586621680948145"><span class="hs-identifier hs-var">k1s</span></a></span><span>
</span><span id="line-1411"></span><span>              </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromSet</span></span><span>
</span><span id="line-1412"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680948140"><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948140"><span class="hs-identifier hs-var">k1'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1413"></span><span>                    </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (k1, k2) v
</span><a href="#local-6989586621680948146"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1414"></span><span>                      </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680948138"><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948138"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948138"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948140"><span class="hs-identifier hs-var">k1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1415"></span><span>                      </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-1416"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-1417"></span><span>          </span><span id="local-6989586621680948137"><span class="annot"><span class="annottext">maxk2s :: Map k1 k2
</span><a href="#local-6989586621680948137"><span class="hs-identifier hs-var hs-var">maxk2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">Map k1 (Set k2)
</span><a href="#local-6989586621680948142"><span class="hs-identifier hs-var">k2s</span></a></span><span>
</span><span id="line-1418"></span><span>          </span><span id="local-6989586621680948135"><span class="annot"><span class="annottext">err :: k1 -&gt; k2 -&gt; v
</span><a href="#local-6989586621680948135"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span id="local-6989586621680948134"><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948134"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621680948133"><span class="annot"><span class="annottext">k2
</span><a href="#local-6989586621680948133"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1419"></span><span>            </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1420"></span><span>              </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TermPrinter.longestPrefix not found &quot;</span></span><span>
</span><span id="line-1421"></span><span>                </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948134"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k2
</span><a href="#local-6989586621680948133"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1422"></span><span>                </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in &quot;</span></span><span>
</span><span id="line-1423"></span><span>                </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Map k1 k2
</span><a href="#local-6989586621680948137"><span class="hs-identifier hs-var">maxk2s</span></a></span><span>
</span><span id="line-1424"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680948131"><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948131"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621680948130"><span class="annot"><span class="annottext">k2
</span><a href="#local-6989586621680948130"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k1 -&gt; k2 -&gt; v
</span><a href="#local-6989586621680948135"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948131"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k2
</span><a href="#local-6989586621680948130"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621680948131"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k2
</span><a href="#local-6989586621680948130"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (k1, k2) v
</span><a href="#local-6989586621680948146"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k1 k2
</span><a href="#local-6989586621680948137"><span class="hs-identifier hs-var">maxk2s</span></a></span><span>
</span><span id="line-1425"></span><span>    </span><span class="hs-comment">-- Don't do another `use` for a name for which we've already done one, unless the</span><span>
</span><span id="line-1426"></span><span>    </span><span class="hs-comment">-- new suffix is shorter.</span><span>
</span><span id="line-1427"></span><span>    </span><span class="annot"><a href="#local-6989586621680948208"><span class="hs-identifier hs-type">avoidRepeatsAndClashes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1428"></span><span>    </span><span id="local-6989586621680948208"><span class="annot"><span class="annottext">avoidRepeatsAndClashes :: Map Name (Prefix, Text, Int) -&gt; Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948208"><span class="hs-identifier hs-var hs-var">avoidRepeatsAndClashes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filterWithKey</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1429"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621680948128"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948128"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prefix
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948127"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948127"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680948128"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948219"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1430"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680948126"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948126"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948127"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948126"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1431"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1432"></span><span>    </span><span class="hs-comment">-- Is there a strictly smaller block term underneath this one, containing all the usages</span><span>
</span><span id="line-1433"></span><span>    </span><span class="hs-comment">-- of some of the names?  Skip emitting `use` statements for those, so we can do it</span><span>
</span><span id="line-1434"></span><span>    </span><span class="hs-comment">-- further down, closer to the use sites.</span><span>
</span><span id="line-1435"></span><span>    </span><span class="annot"><a href="#local-6989586621680948207"><span class="hs-identifier hs-type">narrowestPossible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1436"></span><span>    </span><span id="local-6989586621680948207"><span class="annot"><span class="annottext">narrowestPossible :: Map Name (Prefix, Text, Int) -&gt; Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948207"><span class="hs-identifier hs-var hs-var">narrowestPossible</span></a></span></span><span> </span><span id="local-6989586621680948124"><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948124"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948124"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680948123"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948123"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948122"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948122"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948121"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948121"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v.
(Var v, Ord v) =&gt;
Term3 v PrintAnnotation -&gt; Prefix -&gt; Text -&gt; Int -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#allInSubBlock"><span class="hs-identifier hs-var">allInSubBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948218"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948123"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948122"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948121"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1437"></span><span>    </span><span class="hs-comment">-- `union` is left-biased, so this can replace existing imports.</span><span>
</span><span id="line-1438"></span><span>    </span><span id="local-6989586621680948217"><span class="annot"><span class="annottext">im' :: Imports
</span><a href="#local-6989586621680948217"><span class="hs-identifier hs-var hs-var">im'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int) -&gt; Imports
</span><a href="#local-6989586621680948119"><span class="hs-identifier hs-var">getImportMapAdditions</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948214"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.union`</span></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680948219"><span class="hs-identifier hs-var">im</span></a></span><span>
</span><span id="line-1439"></span><span>    </span><span class="annot"><a href="#local-6989586621680948119"><span class="hs-identifier hs-type">getImportMapAdditions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span>
</span><span id="line-1440"></span><span>    </span><span id="local-6989586621680948119"><span class="annot"><span class="annottext">getImportMapAdditions :: Map Name (Prefix, Text, Int) -&gt; Imports
</span><a href="#local-6989586621680948119"><span class="hs-identifier hs-var hs-var">getImportMapAdditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prefix
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948117"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948117"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948117"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1441"></span><span>    </span><span class="annot"><a href="#local-6989586621680948215"><span class="hs-identifier hs-type">getUses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1442"></span><span>    </span><span id="local-6989586621680948215"><span class="annot"><span class="annottext">getUses :: Map Name (Prefix, Text, Int) -&gt; Map Prefix (Set Text)
</span><a href="#local-6989586621680948215"><span class="hs-identifier hs-var hs-var">getUses</span></a></span></span><span> </span><span id="local-6989586621680948116"><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948116"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1443"></span><span>      </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map Name (Prefix, Text, Int)
</span><a href="#local-6989586621680948116"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1444"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680948114"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948114"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680948113"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948113"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948114"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948113"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1445"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span>
</span><span id="line-1446"></span><span>    </span><span id="local-6989586621680948216"><span class="annot"><span class="annottext">render :: Map (t Text) (Set Text) -&gt; [Pretty (SyntaxText' r)]
</span><a href="#local-6989586621680948216"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621680948095"><span class="annot"><span class="annottext">Map (t Text) (Set Text)
</span><a href="#local-6989586621680948095"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1447"></span><span>      </span><span class="annot"><span class="annottext">forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span>
</span><span id="line-1448"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680948094"><span class="annot"><span class="annottext">t Text
</span><a href="#local-6989586621680948094"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680948093"><span class="annot"><span class="annottext">Set Text
</span><a href="#local-6989586621680948093"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1449"></span><span>            </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.UseKeyword</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;use &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1450"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.UsePrefix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
(Foldable t, Monoid a) =&gt;
a -&gt; (b -&gt; a) -&gt; t b -&gt; a
</span><span class="hs-identifier hs-var">intercalateMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Text
</span><a href="#local-6989586621680948094"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1451"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-1452"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.UseSuffix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
(Foldable t, Monoid a) =&gt;
a -&gt; (b -&gt; a) -&gt; t b -&gt; a
</span><span class="hs-identifier hs-var">intercalateMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><a href="Unison.Syntax.TermPrinter.html#l"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Text
</span><a href="#local-6989586621680948093"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1453"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>        </span><span class="annot"><span class="annottext">Map (t Text) (Set Text)
</span><a href="#local-6989586621680948095"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1455"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span>
</span><span id="line-1456"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-1457"></span><span>
</span><span id="line-1458"></span><span class="hs-comment">-- Given a block term and a name (Prefix, Suffix) of interest, is there a</span><span>
</span><span id="line-1459"></span><span class="hs-comment">-- strictly smaller blockterm within it, containing all usages of that name?</span><span>
</span><span id="line-1460"></span><span class="hs-comment">-- A blockterm is a place where the syntax lets us put a use statement, like the</span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- branches of an if/then/else.</span><span>
</span><span id="line-1462"></span><span class="hs-comment">-- We traverse the block terms by traversing the whole subtree with ABT.find,</span><span>
</span><span id="line-1463"></span><span class="hs-comment">-- and paying attention to those subterms that look like a blockterm.</span><span>
</span><span id="line-1464"></span><span class="hs-comment">-- This is complicated by the fact that you can't always tell if a term is a</span><span>
</span><span id="line-1465"></span><span class="hs-comment">-- blockterm just by looking at it: in some cases you can only tell when you can</span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- see it in the context of the wider term that contains it. So actually we</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- traverse the tree, at each term looking for child terms that are block terms,</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- and see if any of those contain all the usages of the name.</span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- Cut out the occurrences of &quot;const id $&quot; to get tracing.</span><span>
</span><span id="line-1470"></span><span id="local-6989586621680950754"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#allInSubBlock"><span class="hs-identifier hs-type">allInSubBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1471"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950754"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680950754"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1472"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950754"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1473"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1474"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.FQN.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1475"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1476"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1477"></span><span id="allInSubBlock"><span class="annot"><span class="annottext">allInSubBlock :: forall v.
(Var v, Ord v) =&gt;
Term3 v PrintAnnotation -&gt; Prefix -&gt; Text -&gt; Int -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#allInSubBlock"><span class="hs-identifier hs-var hs-var">allInSubBlock</span></a></span></span><span> </span><span id="local-6989586621680948065"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948065"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621680948064"><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948064"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680948063"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948063"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680948062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948062"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1478"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948061"><span class="annot"><span class="annottext">found :: [Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948061"><span class="hs-identifier hs-var hs-var">found</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) a x.
(Ord v, Foldable f, Functor f) =&gt;
(Term f v a -&gt; FindAction x) -&gt; Term f v a -&gt; [x]
</span><span class="hs-identifier hs-var">ABT.find</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; FindAction [Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948058"><span class="hs-identifier hs-var">finder</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948065"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1479"></span><span>      </span><span id="local-6989586621680948057"><span class="annot"><span class="annottext">result :: Bool
</span><a href="#local-6989586621680948057"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948065"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948061"><span class="hs-identifier hs-var">found</span></a></span><span>
</span><span id="line-1480"></span><span>      </span><span id="local-6989586621680948055"><span class="annot"><span class="annottext">tr :: a -&gt; a
</span><a href="#local-6989586621680948055"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1481"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-1482"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="#local-6989586621680948055"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680948057"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1483"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1484"></span><span>    </span><span id="local-6989586621680948054"><span class="annot"><span class="annottext">getUsages :: Term3 v PrintAnnotation -&gt; Int
</span><a href="#local-6989586621680948054"><span class="hs-identifier hs-var hs-var">getUsages</span></a></span></span><span> </span><span id="local-6989586621680948053"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948053"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1485"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; a
</span><span class="hs-identifier hs-var">annotation</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948053"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1486"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PrintAnnotation -&gt; Map Text (Map Prefix Int)
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Ausages%3APrintAnnotation"><span class="hs-identifier hs-var">usages</span></a></span><span>
</span><span id="line-1487"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680948063"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1488"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Prefix
</span><a href="#local-6989586621680948064"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1489"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span>
</span><span id="line-1490"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="Unison.Syntax.TermPrinter.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1491"></span><span>    </span><span id="local-6989586621680948058"><span class="annot"><span class="annottext">finder :: Term3 v PrintAnnotation -&gt; FindAction [Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948058"><span class="hs-identifier hs-var hs-var">finder</span></a></span></span><span> </span><span id="local-6989586621680948052"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948052"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1492"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948051"><span class="annot"><span class="annottext">result :: FindAction [Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948051"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1493"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948050"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621680948050"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; Int
</span><a href="#local-6989586621680948054"><span class="hs-identifier hs-var">getUsages</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948052"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1494"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948050"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948062"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1495"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall x. FindAction x
</span><span class="hs-identifier hs-var">ABT.Prune</span></span><span>
</span><span id="line-1496"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-1497"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680948048"><span class="annot"><span class="annottext">found :: [Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948048"><span class="hs-identifier hs-var hs-var">found</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680948047"><span class="hs-identifier hs-var">hit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall vt v at ap a.
(Var vt, Var v) =&gt;
Term2 vt at ap v a -&gt; [Term2 vt at ap v a]
</span><a href="Unison.Syntax.TermPrinter.html#immediateChildBlockTerms"><span class="hs-identifier hs-var">immediateChildBlockTerms</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948052"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1498"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948050"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948062"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948048"><span class="hs-identifier hs-var">found</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1499"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall x. x -&gt; FindAction x
</span><span class="hs-identifier hs-var">ABT.Found</span></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948048"><span class="hs-identifier hs-var">found</span></a></span><span>
</span><span id="line-1500"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall x. FindAction x
</span><span class="hs-identifier hs-var">ABT.Continue</span></span><span>
</span><span id="line-1501"></span><span>          </span><span class="hs-comment">-- children =</span><span>
</span><span id="line-1502"></span><span>          </span><span class="hs-comment">--   concatMap</span><span>
</span><span id="line-1503"></span><span>          </span><span class="hs-comment">--     (\t -&gt; &quot;child: &quot; ++ show t ++ &quot;\n&quot;)</span><span>
</span><span id="line-1504"></span><span>          </span><span class="hs-comment">--     ( immediateChildBlockTerms t</span><span>
</span><span id="line-1505"></span><span>          </span><span class="hs-comment">--     )</span><span>
</span><span id="line-1506"></span><span>          </span><span id="local-6989586621680948043"><span class="annot"><span class="annottext">tr :: a -&gt; a
</span><a href="#local-6989586621680948043"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1507"></span><span>            </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-1508"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="#local-6989586621680948043"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">FindAction [Term3 v PrintAnnotation]
</span><a href="#local-6989586621680948051"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1509"></span><span>    </span><span id="local-6989586621680948047"><span class="annot"><span class="annottext">hit :: Term3 v PrintAnnotation -&gt; Bool
</span><a href="#local-6989586621680948047"><span class="hs-identifier hs-var hs-var">hit</span></a></span></span><span> </span><span id="local-6989586621680948042"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948042"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; Int
</span><a href="#local-6989586621680948054"><span class="hs-identifier hs-var">getUsages</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680948042"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680948062"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1510"></span><span>
</span><span id="line-1511"></span><span class="hs-comment">-- Return any blockterms at or immediately under this term. Has to match the</span><span>
</span><span id="line-1512"></span><span class="hs-comment">-- places in the syntax that get a call to `calcImports` in `pretty0`.</span><span>
</span><span id="line-1513"></span><span class="hs-comment">-- AST nodes that do a calcImports in pretty0, in order to try and emit a `use`</span><span>
</span><span id="line-1514"></span><span class="hs-comment">-- statement, need to be emitted also by this function, otherwise the `use`</span><span>
</span><span id="line-1515"></span><span class="hs-comment">-- statement may come out at an enclosing scope instead.</span><span>
</span><span id="line-1516"></span><span id="local-6989586621680950727"><span id="local-6989586621680950728"><span id="local-6989586621680950729"><span id="local-6989586621680950730"><span id="local-6989586621680950731"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#immediateChildBlockTerms"><span class="hs-identifier hs-type">immediateChildBlockTerms</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1517"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950731"><span class="hs-identifier hs-type">vt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950730"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950731"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950729"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950728"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950730"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950727"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950731"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950729"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950728"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950730"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950727"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-1518"></span><span id="immediateChildBlockTerms"><span class="annot"><span class="annottext">immediateChildBlockTerms :: forall vt v at ap a.
(Var vt, Var v) =&gt;
Term2 vt at ap v a -&gt; [Term2 vt at ap v a]
</span><a href="Unison.Syntax.TermPrinter.html#immediateChildBlockTerms"><span class="hs-identifier hs-var hs-var">immediateChildBlockTerms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1519"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LetBlock"><span class="hs-identifier hs-type">LetBlock</span></a></span><span> </span><span id="local-6989586621680948029"><span class="annot"><span class="annottext">[(v, Term2 vt at ap v a)]
</span><a href="#local-6989586621680948029"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621680948028"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680948028"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall {v} {v} {vt} {at} {ap} {a}.
(Var v, Show v, Show vt) =&gt;
(v, Term (F vt at ap) v a) -&gt; [Term (F vt at ap) v a]
</span><a href="#local-6989586621680948026"><span class="hs-identifier hs-var">doLet</span></a></span><span> </span><span class="annot"><span class="annottext">[(v, Term2 vt at ap v a)]
</span><a href="#local-6989586621680948029"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall {v} {vt} {at} {ap} {a}.
Var v =&gt;
Term2 vt at ap v a -&gt; [Term2 vt at ap v a]
</span><a href="#local-6989586621680948025"><span class="hs-identifier hs-var">handleDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680948028"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1520"></span><span>  </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1521"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1522"></span><span>    </span><span id="local-6989586621680948025"><span class="annot"><span class="annottext">handleDelay :: Term2 vt at ap v a -&gt; [Term2 vt at ap v a]
</span><a href="#local-6989586621680948025"><span class="hs-identifier hs-var hs-var">handleDelay</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Delay'</span></span><span> </span><span id="local-6989586621680948022"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680948022"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall vt at ap v a. Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-var">isLet</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680948022"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680948022"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1523"></span><span>    </span><span class="annot"><a href="#local-6989586621680948025"><span class="hs-identifier hs-var">handleDelay</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1524"></span><span>    </span><span id="local-6989586621680948026"><span class="annot"><span class="annottext">doLet :: (v, Term (F vt at ap) v a) -&gt; [Term (F vt at ap) v a]
</span><a href="#local-6989586621680948026"><span class="hs-identifier hs-var hs-var">doLet</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948009"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948009"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span id="local-6989586621680948008"><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><a href="#local-6989586621680948008"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type vt at
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v, Term (F vt at ap) v a) -&gt; [Term (F vt at ap) v a]
</span><a href="#local-6989586621680948026"><span class="hs-identifier hs-var">doLet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948009"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><a href="#local-6989586621680948008"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span>    </span><span class="hs-comment">-- we don't consider 'body' to be a place we can insert a `use`</span><span>
</span><span id="line-1526"></span><span>    </span><span class="hs-comment">-- clause unless it's already a let block. This avoids silliness like:</span><span>
</span><span id="line-1527"></span><span>    </span><span class="hs-comment">--   x = 1 + 1</span><span>
</span><span id="line-1528"></span><span>    </span><span class="hs-comment">-- turning into</span><span>
</span><span id="line-1529"></span><span>    </span><span class="hs-comment">--   x =</span><span>
</span><span id="line-1530"></span><span>    </span><span class="hs-comment">--    use Nat +</span><span>
</span><span id="line-1531"></span><span>    </span><span class="hs-comment">--    1 + 1</span><span>
</span><span id="line-1532"></span><span>    </span><span class="annot"><a href="#local-6989586621680948026"><span class="hs-identifier hs-var">doLet</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680948007"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948007"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LamsNamedOpt'</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680948005"><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><a href="#local-6989586621680948005"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><a href="#local-6989586621680948005"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Bool
</span><span class="hs-identifier hs-var">Var.isAction</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680948007"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall vt at ap v a. Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-var">isLet</span></a></span><span> </span><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><a href="#local-6989586621680948005"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1533"></span><span>    </span><span class="annot"><a href="#local-6989586621680948026"><span class="hs-identifier hs-var">doLet</span></a></span><span> </span><span id="local-6989586621680948004"><span class="annot"><span class="annottext">(v, Term (F vt at ap) v a)
</span><a href="#local-6989586621680948004"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(v, Term (F vt at ap) v a)
</span><a href="#local-6989586621680948004"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1534"></span><span>
</span><span id="line-1535"></span><span id="local-6989586621680951206"><span id="local-6989586621680951207"><span id="local-6989586621680951208"><span id="local-6989586621680951209"><span id="local-6989586621680951210"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-type">isSoftHangable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951210"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680951209"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951208"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951207"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951210"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951206"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-1536"></span><span class="hs-comment">-- isSoftHangable (Delay' d) = isLet d || isSoftHangable d || case d of</span><span>
</span><span id="line-1537"></span><span class="hs-comment">--    Match' scrute cases -&gt; isDestructuringBind scrute cases</span><span>
</span><span id="line-1538"></span><span class="hs-comment">--    _ -&gt; False</span><span>
</span><span id="line-1539"></span><span id="isSoftHangable"><span class="annot"><span class="annottext">isSoftHangable :: forall v vt at ap a. Var v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var hs-var">isSoftHangable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Delay'</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">--</span><span>
</span><span id="line-1540"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LamsNamedMatch%27"><span class="hs-identifier hs-type">LamsNamedMatch'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[([Pattern ap], Maybe (Term2 vt at ap v a), Term2 vt at ap v a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1541"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span id="local-6989586621680947997"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947997"><span class="hs-identifier hs-var">scrute</span></a></span></span><span> </span><span id="local-6989586621680947996"><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947996"><span class="hs-identifier hs-var">cases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) a loc.
Ord v =&gt;
Term f v a -&gt; [MatchCase loc (Term f v a)] -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isDestructuringBind"><span class="hs-identifier hs-var">isDestructuringBind</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947997"><span class="hs-identifier hs-var">scrute</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947996"><span class="hs-identifier hs-var">cases</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isSoftHangable"><span class="hs-identifier hs-var">isSoftHangable</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1543"></span><span>
</span><span id="line-1544"></span><span id="local-6989586621680951139"><span id="local-6989586621680951140"><span id="local-6989586621680951141"><span id="local-6989586621680951142"><span id="local-6989586621680951143"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-type">isLet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680951143"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951142"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951141"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951140"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951139"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-1545"></span><span id="isLet"><span class="annot"><span class="annottext">isLet :: forall vt at ap v a. Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-var hs-var">isLet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Let1Named'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1546"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-var">isLet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetRecNamed'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1547"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLet"><span class="hs-identifier hs-var">isLet</span></a></span><span> </span><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1548"></span><span>
</span><span id="line-1549"></span><span class="hs-comment">-- Matches with a single case, no variable shadowing, and where the pattern</span><span>
</span><span id="line-1550"></span><span class="hs-comment">-- has no literals are treated as destructuring bind, for instance:</span><span>
</span><span id="line-1551"></span><span class="hs-comment">--   match blah with (x,y) -&gt; body</span><span>
</span><span id="line-1552"></span><span class="hs-comment">-- BECOMES</span><span>
</span><span id="line-1553"></span><span class="hs-comment">--   (x,y) = blah</span><span>
</span><span id="line-1554"></span><span class="hs-comment">--   body</span><span>
</span><span id="line-1555"></span><span class="hs-comment">-- BUT</span><span>
</span><span id="line-1556"></span><span class="hs-comment">--   match (y,x) with (x,y) -&gt; body</span><span>
</span><span id="line-1557"></span><span class="hs-comment">-- Has shadowing, is rendered as a regular `match`.</span><span>
</span><span id="line-1558"></span><span class="hs-comment">--   match blah with 42 -&gt; body</span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- Pattern has (is) a literal, rendered as a regular match (rather than `42 = blah; body`)</span><span>
</span><span id="line-1560"></span><span id="local-6989586621680951123"><span id="local-6989586621680951124"><span id="local-6989586621680951125"><span id="local-6989586621680951126"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isDestructuringBind"><span class="hs-identifier hs-type">isDestructuringBind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680951126"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ABT.Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680951125"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951126"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951124"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span class="annot"><a href="#local-6989586621680951123"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ABT.Term</span></span><span> </span><span class="annot"><a href="#local-6989586621680951125"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951126"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951124"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-1561"></span><span id="isDestructuringBind"><span class="annot"><span class="annottext">isDestructuringBind :: forall v (f :: * -&gt; *) a loc.
Ord v =&gt;
Term f v a -&gt; [MatchCase loc (Term f v a)] -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isDestructuringBind"><span class="hs-identifier hs-var hs-var">isDestructuringBind</span></a></span></span><span> </span><span id="local-6989586621680947990"><span class="annot"><span class="annottext">Term f v a
</span><a href="#local-6989586621680947990"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span id="local-6989586621680947989"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947989"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Term f v a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ABT.AbsN'</span></span><span> </span><span id="local-6989586621680947988"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947988"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Term f v a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1562"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Term f v a
</span><a href="#local-6989586621680947990"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947988"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {loc}. Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947989"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1563"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1564"></span><span>    </span><span id="local-6989586621680947985"><span class="annot"><span class="annottext">hasLiteral :: Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var hs-var">hasLiteral</span></a></span></span><span> </span><span id="local-6989586621680947981"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947981"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947981"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1565"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Int</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1566"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Boolean</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1567"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Nat</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1568"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Float</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1569"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Text</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1570"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Char</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1571"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Constructor</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947980"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680947980"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680947980"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1572"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.As</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947979"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947979"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947979"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1573"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.EffectPure</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947978"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947978"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947978"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1574"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.EffectBind</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947977"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680947977"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680947976"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947976"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947976"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680947977"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1575"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.SequenceLiteral</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947975"><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680947975"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern loc]
</span><a href="#local-6989586621680947975"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1576"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.SequenceOp</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947974"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947974"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">SeqOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947973"><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947973"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947974"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc -&gt; Bool
</span><a href="#local-6989586621680947985"><span class="hs-identifier hs-var">hasLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><a href="#local-6989586621680947973"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-1577"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Var</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1578"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Pattern.Unbound</span></span><span> </span><span class="annot"><span class="annottext">loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1579"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isDestructuringBind"><span class="hs-identifier hs-var">isDestructuringBind</span></a></span><span> </span><span class="annot"><span class="annottext">Term f v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase loc (Term f v a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1580"></span><span>
</span><span id="line-1581"></span><span id="local-6989586621680951070"><span id="local-6989586621680951071"><span id="local-6989586621680951072"><span id="local-6989586621680951073"><span id="local-6989586621680951074"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isBlock"><span class="hs-identifier hs-type">isBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680951074"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680951073"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951072"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951071"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951074"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951070"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-1582"></span><span id="isBlock"><span class="annot"><span class="annottext">isBlock :: forall v vt at ap a. Ord v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isBlock"><span class="hs-identifier hs-var hs-var">isBlock</span></a></span></span><span> </span><span id="local-6989586621680947970"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947970"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1583"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947970"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1584"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">If'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1585"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Handle'</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1586"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1587"></span><span>    </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LetBlock"><span class="hs-identifier hs-type">LetBlock</span></a></span><span> </span><span class="annot"><span class="annottext">[(v, Term2 vt at ap v a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1588"></span><span>    </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1589"></span><span>
</span><span id="line-1590"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LetBlock"><span class="hs-identifier hs-type">LetBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1591"></span><span>  </span><span id="local-6989586621680950678"><span id="local-6989586621680950679"><span id="local-6989586621680950680"><span id="local-6989586621680950681"><span id="local-6989586621680951303"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680951303"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1592"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680951303"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950681"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950680"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950679"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951303"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950678"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1593"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950681"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950680"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950679"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951303"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950678"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1594"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950681"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950680"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950679"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951303"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950678"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-1595"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mLetBlock"><span id="LetBlock"><span class="annot"><span class="annottext">$mLetBlock :: forall {r} {v} {vt} {at} {ap} {a}.
Ord v =&gt;
Term2 vt at ap v a
-&gt; ([(v, Term2 vt at ap v a)] -&gt; Term2 vt at ap v a -&gt; r)
-&gt; ((# #) -&gt; r)
-&gt; r
</span><a href="Unison.Syntax.TermPrinter.html#%24mLetBlock"><span class="hs-identifier hs-var hs-var">LetBlock</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621680947968"><span class="hs-identifier hs-type">bindings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680947967"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#unLetBlock"><span class="hs-identifier hs-type">unLetBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947968"><span class="annot"><a href="#local-6989586621680947968"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947967"><span class="annot"><a href="#local-6989586621680947967"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>
</span><span id="line-1597"></span><span class="hs-comment">-- Collects nested let/let rec blocks into one minimally nested block.</span><span>
</span><span id="line-1598"></span><span class="hs-comment">-- Handy because `let` and `let rec` blocks get rendered the same way.</span><span>
</span><span id="line-1599"></span><span class="hs-comment">-- We preserve nesting when the inner block shadows definitions in the</span><span>
</span><span id="line-1600"></span><span class="hs-comment">-- outer block.</span><span>
</span><span id="line-1601"></span><span id="local-6989586621680950672"><span id="local-6989586621680950673"><span id="local-6989586621680950674"><span id="local-6989586621680950675"><span id="local-6989586621680950676"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#unLetBlock"><span class="hs-identifier hs-type">unLetBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680950676"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1603"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950675"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950674"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950673"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950676"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950672"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1604"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680950676"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950675"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950674"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950673"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950676"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950672"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950675"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950674"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950673"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950676"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950672"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1605"></span><span id="unLetBlock"><span class="annot"><span class="annottext">unLetBlock :: forall v vt at ap a.
Ord v =&gt;
Term2 vt at ap v a
-&gt; Maybe ([(v, Term2 vt at ap v a)], Term2 vt at ap v a)
</span><a href="Unison.Syntax.TermPrinter.html#unLetBlock"><span class="hs-identifier hs-var hs-var">unLetBlock</span></a></span></span><span> </span><span id="local-6989586621680947962"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947962"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a.
Ord v =&gt;
Term2 vt at ap v a
-&gt; Maybe ([(v, Term2 vt at ap v a)], Term2 vt at ap v a)
</span><a href="#local-6989586621680947961"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947962"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1606"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1607"></span><span>    </span><span id="local-6989586621680947952"><span class="annot"><span class="annottext">dontIntersect :: t (a, b) -&gt; [(a, b)] -&gt; Bool
</span><a href="#local-6989586621680947952"><span class="hs-identifier hs-var hs-var">dontIntersect</span></a></span></span><span> </span><span id="local-6989586621680947951"><span class="annot"><span class="annottext">t (a, b)
</span><a href="#local-6989586621680947951"><span class="hs-identifier hs-var">v1s</span></a></span></span><span> </span><span id="local-6989586621680947950"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621680947950"><span class="hs-identifier hs-var">v2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1608"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680947949"><span class="hs-identifier hs-var">v2set</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">t (a, b)
</span><a href="#local-6989586621680947951"><span class="hs-identifier hs-var">v1s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1609"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1610"></span><span>        </span><span id="local-6989586621680947949"><span class="annot"><span class="annottext">v2set :: Set a
</span><a href="#local-6989586621680947949"><span class="hs-identifier hs-var hs-var">v2set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621680947950"><span class="hs-identifier hs-var">v2s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1611"></span><span>    </span><span id="local-6989586621680947961"><span class="annot"><span class="annottext">rec :: Term2 vt at ap a a
-&gt; Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><a href="#local-6989586621680947961"><span class="hs-identifier hs-var hs-var">rec</span></a></span></span><span> </span><span id="local-6989586621680947941"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947941"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall vt at ap v a.
Term2 vt at ap v a
-&gt; Maybe (Bool, [(v, Term2 vt at ap v a)], Term2 vt at ap v a)
</span><span class="hs-identifier hs-var">unLetRecNamed</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947941"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1612"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Bool, [(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
-&gt; Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><a href="#local-6989586621680947939"><span class="hs-identifier hs-var">nonrec</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947941"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1613"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947938"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680947938"><span class="hs-identifier hs-var">_isTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947937"><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947937"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947936"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947936"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
-&gt; Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><a href="#local-6989586621680947961"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947936"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1614"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947935"><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947935"><span class="hs-identifier hs-var">innerBindings</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947934"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947934"><span class="hs-identifier hs-var">innerBody</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall {a} {t :: * -&gt; *} {b} {b}.
(Ord a, Foldable t, Functor t) =&gt;
t (a, b) -&gt; [(a, b)] -&gt; Bool
</span><a href="#local-6989586621680947952"><span class="hs-identifier hs-var">dontIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947937"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947935"><span class="hs-identifier hs-var">innerBindings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1616"></span><span>              </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947937"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947935"><span class="hs-identifier hs-var">innerBindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947934"><span class="hs-identifier hs-var">innerBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1617"></span><span>        </span><span class="annot"><span class="annottext">Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947937"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947936"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1618"></span><span>    </span><span id="local-6989586621680947939"><span class="annot"><span class="annottext">nonrec :: Term2 vt at ap a a
-&gt; Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><a href="#local-6989586621680947939"><span class="hs-identifier hs-var hs-var">nonrec</span></a></span></span><span> </span><span id="local-6989586621680947933"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947933"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall vt at ap v a.
Term2 vt at ap v a
-&gt; Maybe ([(Bool, v, Term2 vt at ap v a)], Term2 vt at ap v a)
</span><span class="hs-identifier hs-var">unLet</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947933"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1619"></span><span>      </span><span class="annot"><span class="annottext">Maybe ([(Bool, a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1620"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947931"><span class="annot"><span class="annottext">[(Bool, a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947931"><span class="hs-identifier hs-var">bindings0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947930"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947930"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1621"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947929"><span class="annot"><span class="annottext">bindings :: [(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947929"><span class="hs-identifier hs-var hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680947928"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947927"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947928"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680947928"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947927"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947927"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Bool, a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947931"><span class="hs-identifier hs-var">bindings0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1622"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
-&gt; Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><a href="#local-6989586621680947961"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947930"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1623"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947926"><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947926"><span class="hs-identifier hs-var">innerBindings</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947925"><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947925"><span class="hs-identifier hs-var">innerBody</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1624"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall {a} {t :: * -&gt; *} {b} {b}.
(Ord a, Foldable t, Functor t) =&gt;
t (a, b) -&gt; [(a, b)] -&gt; Bool
</span><a href="#local-6989586621680947952"><span class="hs-identifier hs-var">dontIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947929"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947926"><span class="hs-identifier hs-var">innerBindings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1625"></span><span>                    </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947929"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947926"><span class="hs-identifier hs-var">innerBindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947925"><span class="hs-identifier hs-var">innerBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1626"></span><span>              </span><span class="annot"><span class="annottext">Maybe ([(a, Term2 vt at ap a a)], Term2 vt at ap a a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Term2 vt at ap a a)]
</span><a href="#local-6989586621680947929"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap a a
</span><a href="#local-6989586621680947930"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1627"></span><span>
</span><span id="line-1628"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#LamsNamedMatch%27"><span class="hs-identifier hs-type">LamsNamedMatch'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1629"></span><span>  </span><span id="local-6989586621680950643"><span id="local-6989586621680950644"><span id="local-6989586621680950645"><span id="local-6989586621680950646"><span id="local-6989586621680951304"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951304"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1630"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680951304"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1631"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="annot"><a href="#local-6989586621680950644"><span class="hs-identifier hs-type">ap</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950646"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950645"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950644"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951304"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950643"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950646"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950645"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950644"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951304"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950643"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1632"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950646"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950645"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950644"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951304"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950643"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-1633"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mLamsNamedMatch%27"><span id="LamsNamedMatch%27"><span class="annot"><span class="annottext">$mLamsNamedMatch' :: forall {r} {v} {ap} {vt} {at} {a}.
Var v =&gt;
Term2 vt at ap v a
-&gt; ([v]
    -&gt; [([Pattern ap], Maybe (Term2 vt at ap v a), Term2 vt at ap v a)]
    -&gt; r)
-&gt; ((# #) -&gt; r)
-&gt; r
</span><a href="Unison.Syntax.TermPrinter.html#%24mLamsNamedMatch%27"><span class="hs-identifier hs-var hs-var">LamsNamedMatch'</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621680947923"><span class="hs-identifier hs-type">vs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680947922"><span class="hs-identifier hs-type">branches</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#unLamsMatch%27"><span class="hs-identifier hs-type">unLamsMatch'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947923"><span class="annot"><a href="#local-6989586621680947923"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947922"><span class="annot"><a href="#local-6989586621680947922"><span class="hs-identifier hs-var">branches</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span>
</span><span id="line-1635"></span><span class="hs-comment">-- This function is used to detect places where lambda case syntax can be used.</span><span>
</span><span id="line-1636"></span><span class="hs-comment">-- When given lambdas of a form that corresponds to a lambda case, it returns</span><span>
</span><span id="line-1637"></span><span class="hs-comment">-- `Just (varsBeforeCases, branches)`. Leading vars are the vars that should be</span><span>
</span><span id="line-1638"></span><span class="hs-comment">-- shown to the left of the `-&gt; cases`.</span><span>
</span><span id="line-1639"></span><span class="hs-comment">--</span><span>
</span><span id="line-1640"></span><span class="hs-comment">-- For instance, if given this term:</span><span>
</span><span id="line-1641"></span><span class="hs-comment">--</span><span>
</span><span id="line-1642"></span><span class="hs-comment">--   x y z -&gt; match z with</span><span>
</span><span id="line-1643"></span><span class="hs-comment">--     [] -&gt; &quot;empty&quot;</span><span>
</span><span id="line-1644"></span><span class="hs-comment">--     (h +: t) -&gt; &quot;nonempty&quot;</span><span>
</span><span id="line-1645"></span><span class="hs-comment">--</span><span>
</span><span id="line-1646"></span><span class="hs-comment">-- this function will return Just ([x,y], [[] -&gt; &quot;empty&quot;, (h +: t) -&gt; &quot;nonempty&quot;])</span><span>
</span><span id="line-1647"></span><span class="hs-comment">-- and it would be rendered as</span><span>
</span><span id="line-1648"></span><span class="hs-comment">--</span><span>
</span><span id="line-1649"></span><span class="hs-comment">--   x y -&gt; cases []     -&gt; &quot;empty&quot;</span><span>
</span><span id="line-1650"></span><span class="hs-comment">--                h +: t -&gt; &quot;nonempty&quot;</span><span>
</span><span id="line-1651"></span><span class="hs-comment">--</span><span>
</span><span id="line-1652"></span><span class="hs-comment">-- Given this term</span><span>
</span><span id="line-1653"></span><span class="hs-comment">--</span><span>
</span><span id="line-1654"></span><span class="hs-comment">--   x y z -&gt; match (y, z) with</span><span>
</span><span id="line-1655"></span><span class="hs-comment">--     (&quot;a&quot;, &quot;b&quot;) -&gt; &quot;abba&quot;</span><span>
</span><span id="line-1656"></span><span class="hs-comment">--     (x, y) -&gt; y ++ x</span><span>
</span><span id="line-1657"></span><span class="hs-comment">--</span><span>
</span><span id="line-1658"></span><span class="hs-comment">-- this function will return Just ([x], [ &quot;a&quot; &quot;b&quot; -&gt; &quot;abba&quot;, x y -&gt; y ++ x])</span><span>
</span><span id="line-1659"></span><span class="hs-comment">-- and it would be rendered as `x -&gt; cases &quot;a&quot;, &quot;b&quot; -&gt; &quot;abba&quot;</span><span>
</span><span id="line-1660"></span><span class="hs-comment">--                                         x,    y  -&gt; y ++ x</span><span>
</span><span id="line-1661"></span><span class="hs-comment">--</span><span>
</span><span id="line-1662"></span><span class="hs-comment">-- This function returns `Nothing` in cases where the term it is given isn't</span><span>
</span><span id="line-1663"></span><span class="hs-comment">-- a lambda, or when the lambda isn't in the correct form for lambda cases.</span><span>
</span><span id="line-1664"></span><span class="hs-comment">-- (For instance, `x -&gt; match (x, 42) with ...` can't be written using</span><span>
</span><span id="line-1665"></span><span class="hs-comment">-- lambda case)</span><span>
</span><span id="line-1666"></span><span id="local-6989586621680950637"><span id="local-6989586621680950638"><span id="local-6989586621680950639"><span id="local-6989586621680950640"><span id="local-6989586621680950641"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#unLamsMatch%27"><span class="hs-identifier hs-type">unLamsMatch'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1667"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950641"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1668"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950640"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950639"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950638"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950641"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950637"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1669"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680950641"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="annot"><a href="#local-6989586621680950638"><span class="hs-identifier hs-type">ap</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950640"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950639"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950638"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950641"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950640"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950639"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950638"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950641"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1670"></span><span id="unLamsMatch%27"><span class="annot"><span class="annottext">unLamsMatch' :: forall v vt at ap a.
Var v =&gt;
Term2 vt at ap v a
-&gt; Maybe
     ([v],
      [([Pattern ap], Maybe (Term2 vt at ap v a), Term2 vt at ap v a)])
</span><a href="Unison.Syntax.TermPrinter.html#unLamsMatch%27"><span class="hs-identifier hs-var hs-var">unLamsMatch'</span></a></span></span><span> </span><span id="local-6989586621680947895"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947895"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall v vt at ap a.
Var v =&gt;
Term2 vt at ap v a -&gt; Maybe ([v], Term2 vt at ap v a)
</span><span class="hs-identifier hs-var">unLamsUntilDelay'</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947895"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1671"></span><span>  </span><span class="hs-comment">-- x -&gt; match x with pat -&gt; ...</span><span>
</span><span id="line-1672"></span><span>  </span><span class="hs-comment">--   becomes</span><span>
</span><span id="line-1673"></span><span>  </span><span class="hs-comment">-- cases pat -&gt; ...</span><span>
</span><span id="line-1674"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947893"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947893"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680947892"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947892"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var'</span></span><span> </span><span id="local-6989586621680947891"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947891"><span class="hs-identifier hs-var">v1'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947890"><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947890"><span class="hs-identifier hs-var">branches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1675"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- if `v1'` is referenced in any of the branches, we can't use lambda case</span><span>
</span><span id="line-1676"></span><span>      </span><span class="hs-comment">-- syntax as we need to keep the `v1'` name that was introduced</span><span>
</span><span id="line-1677"></span><span>      </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947893"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947891"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.notMember</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947891"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {loc} {f :: * -&gt; *} {a}.
Ord a =&gt;
MatchCase loc (Term f a a) -&gt; Set a
</span><a href="#local-6989586621680947888"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947890"><span class="hs-identifier hs-var">branches</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1678"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947892"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern ap
</span><a href="#local-6989586621680947887"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Term2 vt at ap v a)
</span><a href="#local-6989586621680947886"><span class="hs-identifier hs-var">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947885"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span id="local-6989586621680947887"><span class="annot"><span class="annottext">Pattern ap
</span><a href="#local-6989586621680947887"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680947886"><span class="annot"><span class="annottext">Maybe (Term2 vt at ap v a)
</span><a href="#local-6989586621680947886"><span class="hs-identifier hs-var">guard</span></a></span></span><span> </span><span id="local-6989586621680947885"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947885"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947890"><span class="hs-identifier hs-var">branches</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1679"></span><span>  </span><span class="hs-comment">-- x y z -&gt; match (x,y,z) with (pat1, pat2, pat3) -&gt; ...</span><span>
</span><span id="line-1680"></span><span>  </span><span class="hs-comment">--   becomes</span><span>
</span><span id="line-1681"></span><span>  </span><span class="hs-comment">-- cases pat1 pat2 pat3 -&gt; ...`</span><span>
</span><span id="line-1682"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621680947884"><span class="annot"><span class="annottext">vs :: [v]
</span><a href="#local-6989586621680947884"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#TupleTerm%27"><span class="hs-identifier hs-type">TupleTerm'</span></a></span><span> </span><span id="local-6989586621680947883"><span class="annot"><span class="annottext">[Term2 vt at ap v a]
</span><a href="#local-6989586621680947883"><span class="hs-identifier hs-var">scrutes</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947882"><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947882"><span class="hs-identifier hs-var">branches</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1683"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall {a} {f :: * -&gt; *} {a}. Eq a =&gt; [a] -&gt; [Term f a a] -&gt; Bool
</span><a href="#local-6989586621680947881"><span class="hs-identifier hs-var">multiway</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947884"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Term2 vt at ap v a]
</span><a href="#local-6989586621680947883"><span class="hs-identifier hs-var">scrutes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1684"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-1685"></span><span>        </span><span class="hs-comment">-- (as above) if any of the vars are referenced in any of the branches,</span><span>
</span><span id="line-1686"></span><span>        </span><span class="hs-comment">-- we need to keep the names introduced by the lambda and can't use</span><span>
</span><span id="line-1687"></span><span>        </span><span class="hs-comment">-- lambda case syntax</span><span>
</span><span id="line-1688"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Bool
</span><a href="#local-6989586621680947880"><span class="hs-identifier hs-var">notFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947879"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947884"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1689"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">MatchCase ap (Term2 vt at ap v a) -&gt; Bool
</span><a href="#local-6989586621680947878"><span class="hs-identifier hs-var">isRightArity</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947882"><span class="hs-identifier hs-var">branches</span></a></span><span>
</span><span id="line-1690"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947879"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- all patterns need to match arity of scrutes</span><span>
</span><span id="line-1691"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947879"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947884"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[([Pattern ap], Maybe (Term2 vt at ap v a), Term2 vt at ap v a)]
</span><a href="#local-6989586621680947877"><span class="hs-identifier hs-var">branches'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1692"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1693"></span><span>      </span><span id="local-6989586621680947878"><span class="annot"><span class="annottext">isRightArity :: MatchCase ap (Term2 vt at ap v a) -&gt; Bool
</span><a href="#local-6989586621680947878"><span class="hs-identifier hs-var hs-var">isRightArity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#TuplePattern"><span class="hs-identifier hs-type">TuplePattern</span></a></span><span> </span><span id="local-6989586621680947876"><span class="annot"><span class="annottext">[Pattern ap]
</span><a href="#local-6989586621680947876"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Term2 vt at ap v a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pattern ap]
</span><a href="#local-6989586621680947876"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947879"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1694"></span><span>      </span><span class="annot"><a href="#local-6989586621680947878"><span class="hs-identifier hs-var">isRightArity</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1695"></span><span>      </span><span id="local-6989586621680947879"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621680947879"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Term2 vt at ap v a]
</span><a href="#local-6989586621680947883"><span class="hs-identifier hs-var">scrutes</span></a></span><span>
</span><span id="line-1696"></span><span>      </span><span id="local-6989586621680947875"><span class="annot"><span class="annottext">fvs :: Set v
</span><a href="#local-6989586621680947875"><span class="hs-identifier hs-var hs-var">fvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {loc} {f :: * -&gt; *} {a}.
Ord a =&gt;
MatchCase loc (Term f a a) -&gt; Set a
</span><a href="#local-6989586621680947888"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947882"><span class="hs-identifier hs-var">branches</span></a></span><span>
</span><span id="line-1697"></span><span>      </span><span id="local-6989586621680947880"><span class="annot"><span class="annottext">notFree :: v -&gt; Bool
</span><a href="#local-6989586621680947880"><span class="hs-identifier hs-var hs-var">notFree</span></a></span></span><span> </span><span id="local-6989586621680947874"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947874"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.notMember</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947874"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680947875"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1698"></span><span>      </span><span id="local-6989586621680947877"><span class="annot"><span class="annottext">branches' :: [([Pattern ap], Maybe (Term2 vt at ap v a), Term2 vt at ap v a)]
</span><a href="#local-6989586621680947877"><span class="hs-identifier hs-var hs-var">branches'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pattern ap]
</span><a href="#local-6989586621680947873"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Term2 vt at ap v a)
</span><a href="#local-6989586621680947872"><span class="hs-identifier hs-var">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947871"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Builtin.Decls.html#TuplePattern"><span class="hs-identifier hs-type">TuplePattern</span></a></span><span> </span><span id="local-6989586621680947873"><span class="annot"><span class="annottext">[Pattern ap]
</span><a href="#local-6989586621680947873"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947872"><span class="annot"><span class="annottext">Maybe (Term2 vt at ap v a)
</span><a href="#local-6989586621680947872"><span class="hs-identifier hs-var">guard</span></a></span></span><span> </span><span id="local-6989586621680947871"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947871"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MatchCase ap (Term2 vt at ap v a)]
</span><a href="#local-6989586621680947882"><span class="hs-identifier hs-var">branches</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1699"></span><span>  </span><span class="annot"><span class="annottext">Maybe ([v], Term2 vt at ap v a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1700"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1701"></span><span>    </span><span class="hs-comment">-- multiway vs tms checks that length tms &lt;= length vs, and their common prefix</span><span>
</span><span id="line-1702"></span><span>    </span><span class="hs-comment">-- is all matching variables</span><span>
</span><span id="line-1703"></span><span>    </span><span id="local-6989586621680947881"><span class="annot"><span class="annottext">multiway :: [a] -&gt; [Term f a a] -&gt; Bool
</span><a href="#local-6989586621680947881"><span class="hs-identifier hs-var hs-var">multiway</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1704"></span><span>    </span><span class="annot"><a href="#local-6989586621680947881"><span class="hs-identifier hs-var">multiway</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947868"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680947868"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680947867"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680947867"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var'</span></span><span> </span><span id="local-6989586621680947866"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680947866"><span class="hs-identifier hs-var">h2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680947865"><span class="annot"><span class="annottext">[Term f a a]
</span><a href="#local-6989586621680947865"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680947868"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680947866"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Term f a a] -&gt; Bool
</span><a href="#local-6989586621680947881"><span class="hs-identifier hs-var">multiway</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680947867"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Term f a a]
</span><a href="#local-6989586621680947865"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1705"></span><span>    </span><span class="annot"><a href="#local-6989586621680947881"><span class="hs-identifier hs-var">multiway</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Term f a a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1706"></span><span>    </span><span id="local-6989586621680947888"><span class="annot"><span class="annottext">freeVars :: MatchCase loc (Term f a a) -&gt; Set a
</span><a href="#local-6989586621680947888"><span class="hs-identifier hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span class="annot"><span class="annottext">Pattern loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947862"><span class="annot"><span class="annottext">Maybe (Term f a a)
</span><a href="#local-6989586621680947862"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680947861"><span class="annot"><span class="annottext">Term f a a
</span><a href="#local-6989586621680947861"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1707"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947860"><span class="annot"><span class="annottext">guardVars :: Set a
</span><a href="#local-6989586621680947860"><span class="hs-identifier hs-var hs-var">guardVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Term f a a)
</span><a href="#local-6989586621680947862"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1708"></span><span>          </span><span id="local-6989586621680947858"><span class="annot"><span class="annottext">rhsVars :: Set a
</span><a href="#local-6989586621680947858"><span class="hs-identifier hs-var hs-var">rhsVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Term f a a
</span><a href="#local-6989586621680947861"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1709"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680947860"><span class="hs-identifier hs-var">guardVars</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621680947858"><span class="hs-identifier hs-var">rhsVars</span></a></span><span>
</span><span id="line-1710"></span><span>
</span><span id="line-1711"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#Bytes%27"><span class="hs-identifier hs-type">Bytes'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621680950615"><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950615"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span></span><span>
</span><span id="line-1712"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mBytes%27"><span id="Bytes%27"><span class="annot"><span class="annottext">$mBytes' :: forall {r} {v}.
Term3 v PrintAnnotation
-&gt; ([ConstructorId] -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Unison.Syntax.TermPrinter.html#%24mBytes%27"><span class="hs-identifier hs-var hs-var">Bytes'</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621680947856"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toBytes"><span class="hs-identifier hs-type">toBytes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947856"><span class="annot"><a href="#local-6989586621680947856"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1713"></span><span>
</span><span id="line-1714"></span><span id="local-6989586621680950613"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toBytes"><span class="hs-identifier hs-type">toBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950613"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-1715"></span><span id="toBytes"><span class="annot"><span class="annottext">toBytes :: forall v. Term3 v PrintAnnotation -&gt; Maybe [ConstructorId]
</span><a href="Unison.Syntax.TermPrinter.html#toBytes"><span class="hs-identifier hs-var hs-var">toBytes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Builtin'</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Bytes.fromList&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947847"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947847"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1716"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">forall {typeVar} {typeAnn} {patternAnn} {v} {a}.
Term (F typeVar typeAnn patternAnn) v a -&gt; Maybe ConstructorId
</span><a href="#local-6989586621680947846"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947847"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1717"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1718"></span><span>    </span><span id="local-6989586621680947846"><span class="annot"><span class="annottext">go :: Term (F typeVar typeAnn patternAnn) v a -&gt; Maybe ConstructorId
</span><a href="#local-6989586621680947846"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nat'</span></span><span> </span><span id="local-6989586621680947845"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947845"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947845"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1719"></span><span>    </span><span class="annot"><a href="#local-6989586621680947846"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term (F typeVar typeAnn patternAnn) v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1720"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1721"></span><span>
</span><span id="line-1722"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#prettyDoc2"><span class="hs-identifier hs-type">prettyDoc2</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1723"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680951100"><span class="annot"><a href="#local-6989586621680951100"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680951099"><span class="annot"><a href="#local-6989586621680951099"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1724"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.MonadPretty.html#MonadPretty"><span class="hs-identifier hs-type">MonadPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951100"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951099"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1725"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#AmbientContext"><span class="hs-identifier hs-type">AmbientContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1726"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951100"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1727"></span><span>  </span><span class="annot"><a href="#local-6989586621680951099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1728"></span><span id="prettyDoc2"><span class="annot"><span class="annottext">prettyDoc2 :: forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext
-&gt; Term3 v PrintAnnotation -&gt; m (Maybe (Pretty SyntaxText))
</span><a href="Unison.Syntax.TermPrinter.html#prettyDoc2"><span class="hs-identifier hs-var hs-var">prettyDoc2</span></a></span></span><span> </span><span id="local-6989586621680947629"><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621680947628"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947628"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1729"></span><span>  </span><span id="local-6989586621680947627"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *). MonadPretty v m =&gt; m PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.MonadPretty.html#getPPE"><span class="hs-identifier hs-var">getPPE</span></a></span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947609"><span class="annot"><span class="annottext">brace :: Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var hs-var">brace</span></a></span></span><span> </span><span id="local-6989586621680947608"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947608"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1731"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Bool
</span><span class="hs-identifier hs-var">PP.isMultiLine</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947608"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1732"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;{{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.newline</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947608"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.newline</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;}}&quot;</span></span><span>
</span><span id="line-1733"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;{{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947608"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.softbreak</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Element r
</span><span class="hs-identifier hs-var">S.DocDelimiter</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><span class="hs-string">&quot;}}&quot;</span></span><span>
</span><span id="line-1734"></span><span>      </span><span id="local-6989586621680947606"><span class="annot"><span class="annottext">bail :: Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947606"><span class="hs-identifier hs-var hs-var">bail</span></a></span></span><span> </span><span id="local-6989586621680947605"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947605"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947605"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1735"></span><span>      </span><span class="annot"><a href="#local-6989586621680947604"><span class="hs-identifier hs-type">contains</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1736"></span><span>      </span><span id="local-6989586621680947604"><span class="annot"><span class="annottext">contains :: Char -&gt; Pretty SyntaxText -&gt; Bool
</span><a href="#local-6989586621680947604"><span class="hs-identifier hs-var hs-var">contains</span></a></span></span><span> </span><span id="local-6989586621680947603"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947603"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680947602"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947602"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1737"></span><span>        </span><span class="annot"><span class="annottext">Pretty ColorText -&gt; String
</span><span class="hs-identifier hs-var">PP.toPlainUnbroken</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947602"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1738"></span><span>          </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947603"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1739"></span><span>      </span><span class="hs-comment">-- Finds the longest run of a character and return one bigger than that</span><span>
</span><span id="line-1740"></span><span>      </span><span id="local-6989586621680947590"><span class="annot"><span class="annottext">longestRun :: Char -&gt; Pretty (SyntaxText' r) -&gt; Int
</span><a href="#local-6989586621680947590"><span class="hs-identifier hs-var hs-var">longestRun</span></a></span></span><span> </span><span id="local-6989586621680947589"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947589"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680947588"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947588"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1741"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680947587"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680947587"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680947587"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947589"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947589"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1742"></span><span>          </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">List.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty ColorText -&gt; String
</span><span class="hs-identifier hs-var">PP.toPlainUnbroken</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Pretty (SyntaxText' r) -&gt; Pretty ColorText
</span><span class="hs-identifier hs-var">PP.syntaxToColor</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947588"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1743"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1744"></span><span>          </span><span id="local-6989586621680947585"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680947585"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680947585"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1745"></span><span>      </span><span id="local-6989586621680947584"><span class="annot"><span class="annottext">oneMore :: Char -&gt; Pretty (SyntaxText' r) -&gt; String
</span><a href="#local-6989586621680947584"><span class="hs-identifier hs-var hs-var">oneMore</span></a></span></span><span> </span><span id="local-6989586621680947583"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947583"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680947582"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947582"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {r}. Char -&gt; Pretty (SyntaxText' r) -&gt; Int
</span><a href="#local-6989586621680947590"><span class="hs-identifier hs-var">longestRun</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947583"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947582"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947583"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1746"></span><span>      </span><span id="local-6989586621680947578"><span class="annot"><span class="annottext">makeFence :: Pretty (SyntaxText' r) -&gt; Pretty s
</span><a href="#local-6989586621680947578"><span class="hs-identifier hs-var hs-var">makeFence</span></a></span></span><span> </span><span id="local-6989586621680947577"><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947577"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.string</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Char -&gt; Pretty (SyntaxText' r) -&gt; Int
</span><a href="#local-6989586621680947590"><span class="hs-identifier hs-var">longestRun</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span> </span><span class="annot"><span class="annottext">Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947577"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span>
</span><span id="line-1747"></span><span>      </span><span class="annot"><a href="#local-6989586621680947574"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Width</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680951100"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680951099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#SyntaxText"><span class="hs-identifier hs-type">SyntaxText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1748"></span><span>      </span><span id="local-6989586621680947574"><span class="annot"><span class="annottext">go :: Width -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947574"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680947573"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680947573"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1749"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocTransclude"><span class="hs-identifier hs-var">toDocTransclude</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947571"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947571"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1750"></span><span>          </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947606"><span class="hs-identifier hs-var">bail</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947571"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1751"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocUntitledSection"><span class="hs-identifier hs-var">toDocUntitledSection</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947569"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947569"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1752"></span><span>          </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation] -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947568"><span class="hs-identifier hs-var">sepBlankline</span></a></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947569"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1753"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation, [Term3 v PrintAnnotation])
</span><a href="Unison.Syntax.TermPrinter.html#toDocSection"><span class="hs-identifier hs-var">toDocSection</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947566"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947566"><span class="hs-identifier hs-var">title</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947565"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947565"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1754"></span><span>          </span><span id="local-6989586621680947564"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947564"><span class="hs-identifier hs-var">prettyTitle</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947566"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-1755"></span><span>          </span><span id="local-6989586621680947562"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947562"><span class="hs-identifier hs-var">prettyDs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m, Monoid a) =&gt;
a -&gt; (b -&gt; m a) -&gt; t b -&gt; m a
</span><span class="hs-identifier hs-var">intercalateMapM</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947574"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680947573"><span class="hs-identifier hs-var">hdr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947565"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1756"></span><span>          </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-1757"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-1758"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width -&gt; Int
</span><span class="hs-identifier hs-var">PP.widthToInt</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680947573"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;#&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947564"><span class="hs-identifier hs-var">prettyTitle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1759"></span><span>                </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-1760"></span><span>                </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Width -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680947573"><span class="hs-identifier hs-var">hdr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947562"><span class="hs-identifier hs-var">prettyDs</span></a></span><span>
</span><span id="line-1761"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-1762"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocParagraph"><span class="hs-identifier hs-var">toDocParagraph</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947558"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947558"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1763"></span><span>          </span><span class="annot"><span class="annottext">forall s. (ListLike s Char, IsString s) =&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.wrap</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947558"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1764"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocBulletedList"><span class="hs-identifier hs-var">toDocBulletedList</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947555"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947555"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1765"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947554"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947555"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1766"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1767"></span><span>            </span><span id="local-6989586621680947554"><span class="annot"><span class="annottext">item :: Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947554"><span class="hs-identifier hs-var hs-var">item</span></a></span></span><span> </span><span id="local-6989586621680947553"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947553"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;* &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
Pretty s -&gt; Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.indentAfterNewline</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947553"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1768"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (ConstructorId, [Term3 v PrintAnnotation])
</span><a href="Unison.Syntax.TermPrinter.html#toDocNumberedList"><span class="hs-identifier hs-var">toDocNumberedList</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947551"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947551"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947550"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947550"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1769"></span><span>          </span><span class="annot"><span class="annottext">forall s.
(ListLike s Char, IsString s) =&gt;
[(Pretty s, Pretty s)] -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.column2</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(ConstructorId, Term3 v PrintAnnotation)
-&gt; m (Pretty SyntaxText, Pretty SyntaxText)
</span><a href="#local-6989586621680947549"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947551"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947550"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1770"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1771"></span><span>            </span><span id="local-6989586621680947549"><span class="annot"><span class="annottext">item :: (ConstructorId, Term3 v PrintAnnotation)
-&gt; m (Pretty SyntaxText, Pretty SyntaxText)
</span><a href="#local-6989586621680947549"><span class="hs-identifier hs-var hs-var">item</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947548"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947548"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947547"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947547"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a s. (Show a, IsString s) =&gt; a -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.shown</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947548"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947547"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1772"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Text
</span><a href="Unison.Syntax.TermPrinter.html#toDocWord"><span class="hs-identifier hs-var">toDocWord</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947545"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947545"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1773"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947545"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1774"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocCode"><span class="hs-identifier hs-var">toDocCode</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947543"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947543"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1775"></span><span>          </span><span id="local-6989586621680947542"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947542"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947543"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1776"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947541"><span class="annot"><span class="annottext">quotes :: Pretty SyntaxText
</span><a href="#local-6989586621680947541"><span class="hs-identifier hs-var hs-var">quotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1777"></span><span>                </span><span class="hs-comment">-- Prefer ` if there aren't any in the inner text,</span><span>
</span><span id="line-1778"></span><span>                </span><span class="hs-comment">-- otherwise use one more than the longest run of ' in the inner text</span><span>
</span><span id="line-1779"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Pretty SyntaxText -&gt; Bool
</span><a href="#local-6989586621680947604"><span class="hs-identifier hs-var">contains</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947542"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1780"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.string</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Char -&gt; Pretty (SyntaxText' r) -&gt; String
</span><a href="#local-6989586621680947584"><span class="hs-identifier hs-var">oneMore</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947542"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1781"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;`&quot;</span></span><span>
</span><span id="line-1782"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947541"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947542"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947541"><span class="hs-identifier hs-var">quotes</span></a></span><span>
</span><span id="line-1783"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocJoin"><span class="hs-identifier hs-var">toDocJoin</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947539"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947539"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (f :: * -&gt; *) b a.
(Monad m, Foldable f, Monoid b) =&gt;
(a -&gt; m b) -&gt; f a -&gt; m b
</span><span class="hs-identifier hs-var">foldMapM</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947539"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1784"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocItalic"><span class="hs-identifier hs-var">toDocItalic</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947537"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947537"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1785"></span><span>          </span><span id="local-6989586621680947536"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947536"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947537"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1786"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947535"><span class="annot"><span class="annottext">underscores :: Pretty SyntaxText
</span><a href="#local-6989586621680947535"><span class="hs-identifier hs-var hs-var">underscores</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.string</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Char -&gt; Pretty (SyntaxText' r) -&gt; String
</span><a href="#local-6989586621680947584"><span class="hs-identifier hs-var">oneMore</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947536"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1787"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947535"><span class="hs-identifier hs-var">underscores</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947536"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947535"><span class="hs-identifier hs-var">underscores</span></a></span><span>
</span><span id="line-1788"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocBold"><span class="hs-identifier hs-var">toDocBold</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947533"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947533"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1789"></span><span>          </span><span id="local-6989586621680947532"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947532"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947533"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1790"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947531"><span class="annot"><span class="annottext">stars :: Pretty SyntaxText
</span><a href="#local-6989586621680947531"><span class="hs-identifier hs-var hs-var">stars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.string</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Char -&gt; Pretty (SyntaxText' r) -&gt; String
</span><a href="#local-6989586621680947584"><span class="hs-identifier hs-var">oneMore</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947532"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1791"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947531"><span class="hs-identifier hs-var">stars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947532"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947531"><span class="hs-identifier hs-var">stars</span></a></span><span>
</span><span id="line-1792"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocStrikethrough"><span class="hs-identifier hs-var">toDocStrikethrough</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947529"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947529"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1793"></span><span>          </span><span id="local-6989586621680947528"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947528"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947529"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1794"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947527"><span class="annot"><span class="annottext">quotes :: Pretty SyntaxText
</span><a href="#local-6989586621680947527"><span class="hs-identifier hs-var hs-var">quotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; String -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.string</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Char -&gt; Pretty (SyntaxText' r) -&gt; String
</span><a href="#local-6989586621680947584"><span class="hs-identifier hs-var">oneMore</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947528"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1795"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947527"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947528"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947527"><span class="hs-identifier hs-var">quotes</span></a></span><span>
</span><span id="line-1796"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocGroup"><span class="hs-identifier hs-var">toDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947525"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947525"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1797"></span><span>          </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947525"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1798"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocColumn"><span class="hs-identifier hs-var">toDocColumn</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947523"><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947523"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1799"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><a href="#local-6989586621680947523"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1800"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation, Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocNamedLink"><span class="hs-identifier hs-var">toDocNamedLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947521"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947521"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947520"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947520"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1801"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-1802"></span><span>            </span><span id="local-6989586621680947519"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947519"><span class="hs-identifier hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947521"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1803"></span><span>            </span><span id="local-6989586621680947518"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947518"><span class="hs-identifier hs-var">target'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947520"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-1804"></span><span>            </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947519"><span class="hs-identifier hs-var">name'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;](&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947518"><span class="hs-identifier hs-var">target'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-1805"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Either Reference Referent)
</span><a href="Unison.Syntax.TermPrinter.html#toDocLink"><span class="hs-identifier hs-var">toDocLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947516"><span class="annot"><span class="annottext">Either Reference Referent
</span><a href="#local-6989586621680947516"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Reference Referent
</span><a href="#local-6989586621680947516"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1806"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680947515"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947515"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;{type &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947514"><span class="hs-identifier hs-var">tyName</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947515"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1807"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680947513"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947513"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947512"><span class="hs-identifier hs-var">tmName</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947513"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1808"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocEval"><span class="hs-identifier hs-var">toDocEval</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947510"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947510"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1809"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-1810"></span><span>            </span><span id="local-6989586621680947509"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947509"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947510"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1811"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947508"><span class="annot"><span class="annottext">fence :: Pretty SyntaxText
</span><a href="#local-6989586621680947508"><span class="hs-identifier hs-var hs-var">fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {r}. IsString s =&gt; Pretty (SyntaxText' r) -&gt; Pretty s
</span><a href="#local-6989586621680947578"><span class="hs-identifier hs-var">makeFence</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947509"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1812"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947508"><span class="hs-identifier hs-var">fence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947509"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947508"><span class="hs-identifier hs-var">fence</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1813"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocEvalInline"><span class="hs-identifier hs-var">toDocEvalInline</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947506"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947506"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1814"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-1815"></span><span>            </span><span id="local-6989586621680947505"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947505"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947506"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1816"></span><span>            </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;@eval{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947505"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1817"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExample"><span class="hs-identifier hs-var">toDocExample</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947503"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947503"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1818"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-1819"></span><span>            </span><span id="local-6989586621680947502"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947502"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947503"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1820"></span><span>            </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;``&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947502"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;``&quot;</span></span><span>
</span><span id="line-1821"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExampleBlock"><span class="hs-identifier hs-var">toDocExampleBlock</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947500"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947500"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1822"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-1823"></span><span>            </span><span id="local-6989586621680947499"><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947499"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (m :: * -&gt; *).
MonadPretty v m =&gt;
AmbientContext -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="Unison.Syntax.TermPrinter.html#pretty0"><span class="hs-identifier hs-var">pretty0</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947498"><span class="hs-identifier hs-var">ac'</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947500"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1824"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947497"><span class="annot"><span class="annottext">fence :: Pretty SyntaxText
</span><a href="#local-6989586621680947497"><span class="hs-identifier hs-var hs-var">fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {r}. IsString s =&gt; Pretty (SyntaxText' r) -&gt; Pretty s
</span><a href="#local-6989586621680947578"><span class="hs-identifier hs-var">makeFence</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947499"><span class="hs-identifier hs-var">inner</span></a></span><span>
</span><span id="line-1825"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;@typecheck &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947497"><span class="hs-identifier hs-var">fence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947499"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947497"><span class="hs-identifier hs-var">fence</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1826"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1827"></span><span>            </span><span id="local-6989586621680947498"><span class="annot"><span class="annottext">ac' :: AmbientContext
</span><a href="#local-6989586621680947498"><span class="hs-identifier hs-var hs-var">ac'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:elideUnit:AmbientContext :: Bool
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3AelideUnit%3AAmbientContext"><span class="hs-identifier hs-var">elideUnit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-1828"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSource"><span class="hs-identifier hs-var">toDocSource</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947495"><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947495"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1829"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;    @source{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
(Foldable t, Monoid a) =&gt;
a -&gt; (b -&gt; a) -&gt; t b -&gt; a
</span><span class="hs-identifier hs-var">intercalateMap</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">(Either Reference Referent, [Referent]) -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947494"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947495"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1830"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1831"></span><span>            </span><span id="local-6989586621680947494"><span class="annot"><span class="annottext">go :: (Either Reference Referent, [Referent]) -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947494"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680947493"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947493"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947492"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947492"><span class="hs-identifier hs-var">_anns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;type &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947514"><span class="hs-identifier hs-var">tyName</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947493"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1832"></span><span>            </span><span class="annot"><a href="#local-6989586621680947494"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680947491"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947491"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947490"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947490"><span class="hs-identifier hs-var">_anns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947512"><span class="hs-identifier hs-var">tmName</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947491"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1833"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocFoldedSource"><span class="hs-identifier hs-var">toDocFoldedSource</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947488"><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947488"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1834"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;    @foldedSource{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
(Foldable t, Monoid a) =&gt;
a -&gt; (b -&gt; a) -&gt; t b -&gt; a
</span><span class="hs-identifier hs-var">intercalateMap</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">(Either Reference Referent, [Referent]) -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947487"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947488"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1835"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1836"></span><span>            </span><span id="local-6989586621680947487"><span class="annot"><span class="annottext">go :: (Either Reference Referent, [Referent]) -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947487"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680947486"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947486"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947485"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947485"><span class="hs-identifier hs-var">_anns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;type &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947514"><span class="hs-identifier hs-var">tyName</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947486"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1837"></span><span>            </span><span class="annot"><a href="#local-6989586621680947487"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680947484"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947484"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947483"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947483"><span class="hs-identifier hs-var">_anns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947512"><span class="hs-identifier hs-var">tmName</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947484"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1838"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocSignatureInline"><span class="hs-identifier hs-var">toDocSignatureInline</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947481"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947481"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1839"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;@inlineSignature{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947512"><span class="hs-identifier hs-var">tmName</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947481"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1840"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe [Referent]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSignature"><span class="hs-identifier hs-var">toDocSignature</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947479"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947479"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1841"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947478"><span class="annot"><span class="annottext">name :: Pretty SyntaxText
</span><a href="#local-6989586621680947478"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947479"><span class="hs-identifier hs-var">tms</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;@signature&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;@signatures&quot;</span></span><span>
</span><span id="line-1842"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947478"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
(Foldable t, Monoid a) =&gt;
a -&gt; (b -&gt; a) -&gt; t b -&gt; a
</span><span class="hs-identifier hs-var">intercalateMap</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947512"><span class="hs-identifier hs-var">tmName</span></a></span><span> </span><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947479"><span class="hs-identifier hs-var">tms</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-1843"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe (Text, Text)
</span><a href="Unison.Syntax.TermPrinter.html#toDocCodeBlock"><span class="hs-identifier hs-var">toDocCodeBlock</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947476"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947476"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947475"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947475"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1844"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1845"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947474"><span class="annot"><span class="annottext">txt' :: Pretty SyntaxText
</span><a href="#local-6989586621680947474"><span class="hs-identifier hs-var hs-var">txt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947475"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-1846"></span><span>                </span><span id="local-6989586621680947473"><span class="annot"><span class="annottext">fence :: Pretty SyntaxText
</span><a href="#local-6989586621680947473"><span class="hs-identifier hs-var hs-var">fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {s} {r}. IsString s =&gt; Pretty (SyntaxText' r) -&gt; Pretty s
</span><a href="#local-6989586621680947578"><span class="hs-identifier hs-var">makeFence</span></a></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947474"><span class="hs-identifier hs-var">txt'</span></a></span><span>
</span><span id="line-1847"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1848"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-1849"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947473"><span class="hs-identifier hs-var">fence</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947476"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1850"></span><span>                      </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947474"><span class="hs-identifier hs-var">txt'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1851"></span><span>                      </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><a href="#local-6989586621680947473"><span class="hs-identifier hs-var">fence</span></a></span><span>
</span><span id="line-1852"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-1853"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Text
</span><a href="Unison.Syntax.TermPrinter.html#toDocVerbatim"><span class="hs-identifier hs-var">toDocVerbatim</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947471"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947471"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1854"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1855"></span><span>            </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1856"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s.
(Foldable f, IsString s) =&gt;
f (Pretty s) -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.lines</span></span><span>
</span><span id="line-1857"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;'''&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-1858"></span><span>                  </span><span class="annot"><span class="annottext">forall s. Pretty s -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.group</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s. IsString s =&gt; Text -&gt; Pretty s
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947471"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1859"></span><span>                  </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;'''&quot;</span></span><span>
</span><span id="line-1860"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-1861"></span><span>        </span><span class="hs-comment">-- todo : emit fewer gratuitous columns, maybe a wrapIfMany combinator</span><span>
</span><span id="line-1862"></span><span>        </span><span id="local-6989586621680947470"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947470"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947606"><span class="hs-identifier hs-var">bail</span></a></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947470"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1863"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1864"></span><span>          </span><span id="local-6989586621680947469"><span class="annot"><span class="annottext">im :: Imports
</span><a href="#local-6989586621680947469"><span class="hs-identifier hs-var hs-var">im</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AmbientContext -&gt; Imports
</span><a href="Unison.Syntax.TermPrinter.html#%24sel%3Aimports%3AAmbientContext"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="annot"><span class="annottext">AmbientContext
</span><a href="#local-6989586621680947629"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-1865"></span><span>          </span><span id="local-6989586621680947514"><span class="annot"><span class="annottext">tyName :: Reference -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947514"><span class="hs-identifier hs-var hs-var">tyName</span></a></span></span><span> </span><span id="local-6989586621680947468"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947468"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TypeReference</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947468"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680947469"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Reference -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#typeName"><span class="hs-identifier hs-var">PrettyPrintEnv.typeName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947468"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1866"></span><span>          </span><span id="local-6989586621680947512"><span class="annot"><span class="annottext">tmName :: Referent -&gt; Pretty SyntaxText
</span><a href="#local-6989586621680947512"><span class="hs-identifier hs-var hs-var">tmName</span></a></span></span><span> </span><span id="local-6989586621680947467"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947467"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pretty SyntaxText -&gt; Pretty SyntaxText)
-&gt; HashQualified Name -&gt; Pretty SyntaxText
</span><a href="Unison.Syntax.NamePrinter.html#styleHashQualified%27%27"><span class="hs-identifier hs-var">styleHashQualified''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r.
Element r -&gt; Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="Unison.Syntax.TermPrinter.html#fmt"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r. Referent' r -&gt; Element r
</span><span class="hs-identifier hs-var">S.TermReference</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947467"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Imports -&gt; HashQualified Name -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.FQN.html#elideFQN"><span class="hs-identifier hs-var">elideFQN</span></a></span><span> </span><span class="annot"><span class="annottext">Imports
</span><a href="#local-6989586621680947469"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947467"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1867"></span><span>          </span><span id="local-6989586621680947563"><span class="annot"><span class="annottext">rec :: Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var hs-var">rec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Width -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947574"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621680947573"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-1868"></span><span>          </span><span id="local-6989586621680947568"><span class="annot"><span class="annottext">sepBlankline :: [Term3 v PrintAnnotation] -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947568"><span class="hs-identifier hs-var hs-var">sepBlankline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m, Monoid a) =&gt;
a -&gt; (b -&gt; m a) -&gt; t b -&gt; m a
</span><span class="hs-identifier hs-var">intercalateMapM</span></span><span> </span><span class="annot"><span class="annottext">Pretty SyntaxText
</span><span class="hs-string">&quot;\n\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947563"><span class="hs-identifier hs-var">rec</span></a></span><span>
</span><span id="line-1869"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947628"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1870"></span><span>    </span><span class="hs-comment">-- these patterns can introduce a {{ .. }} block</span><span>
</span><span id="line-1871"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocUntitledSection"><span class="hs-identifier hs-var">toDocUntitledSection</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947574"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947628"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1872"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation, [Term3 v PrintAnnotation])
</span><a href="Unison.Syntax.TermPrinter.html#toDocSection"><span class="hs-identifier hs-var">toDocSection</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(Term3 v PrintAnnotation, [Term3 v PrintAnnotation])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947574"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947628"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1873"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocParagraph"><span class="hs-identifier hs-var">toDocParagraph</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947627"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">[Term3 v PrintAnnotation]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {r}. Pretty (SyntaxText' r) -&gt; Pretty (SyntaxText' r)
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Width -&gt; Term3 v PrintAnnotation -&gt; m (Pretty SyntaxText)
</span><a href="#local-6989586621680947574"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947628"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1874"></span><span>    </span><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1875"></span><span>
</span><span id="line-1876"></span><span id="local-6989586621680947466"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocJoin"><span class="hs-identifier hs-type">toDocJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947466"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947466"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1877"></span><span id="toDocJoin"><span class="annot"><span class="annottext">toDocJoin :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocJoin"><span class="hs-identifier hs-var hs-var">toDocJoin</span></a></span></span><span> </span><span id="local-6989586621680947463"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947463"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947462"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947462"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947461"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947461"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1878"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947463"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docJoin&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947462"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947461"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1879"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocJoin"><span class="hs-identifier hs-var">toDocJoin</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1880"></span><span>
</span><span id="line-1881"></span><span id="local-6989586621680950597"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocUntitledSection"><span class="hs-identifier hs-type">toDocUntitledSection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950597"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950597"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1882"></span><span id="toDocUntitledSection"><span class="annot"><span class="annottext">toDocUntitledSection :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocUntitledSection"><span class="hs-identifier hs-var hs-var">toDocUntitledSection</span></a></span></span><span> </span><span id="local-6989586621680947457"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947457"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947456"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947456"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947455"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947455"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1883"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947457"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docUntitledSection&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947456"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947455"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1884"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocUntitledSection"><span class="hs-identifier hs-var">toDocUntitledSection</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1885"></span><span>
</span><span id="line-1886"></span><span id="local-6989586621680947454"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocColumn"><span class="hs-identifier hs-type">toDocColumn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947454"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947454"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1887"></span><span id="toDocColumn"><span class="annot"><span class="annottext">toDocColumn :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocColumn"><span class="hs-identifier hs-var hs-var">toDocColumn</span></a></span></span><span> </span><span id="local-6989586621680947451"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947451"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947450"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947450"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947449"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947449"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1888"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947451"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docColumn&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947450"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947449"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1889"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocColumn"><span class="hs-identifier hs-var">toDocColumn</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1890"></span><span>
</span><span id="line-1891"></span><span id="local-6989586621680947448"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocGroup"><span class="hs-identifier hs-type">toDocGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947448"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947448"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1892"></span><span id="toDocGroup"><span class="annot"><span class="annottext">toDocGroup :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocGroup"><span class="hs-identifier hs-var hs-var">toDocGroup</span></a></span></span><span> </span><span id="local-6989586621680947446"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947446"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947445"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947445"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947444"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947444"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1893"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947446"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docGroup&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947445"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947444"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1894"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocGroup"><span class="hs-identifier hs-var">toDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1895"></span><span>
</span><span id="line-1896"></span><span id="local-6989586621680950589"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocWord"><span class="hs-identifier hs-type">toDocWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950589"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-1897"></span><span id="toDocWord"><span class="annot"><span class="annottext">toDocWord :: forall v. PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Text
</span><a href="Unison.Syntax.TermPrinter.html#toDocWord"><span class="hs-identifier hs-var hs-var">toDocWord</span></a></span></span><span> </span><span id="local-6989586621680947442"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947442"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947441"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947441"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text'</span></span><span> </span><span id="local-6989586621680947440"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947440"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947442"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docWord&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947441"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947440"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-1899"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocWord"><span class="hs-identifier hs-var">toDocWord</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1900"></span><span>
</span><span id="line-1901"></span><span id="local-6989586621680947439"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocBold"><span class="hs-identifier hs-type">toDocBold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947439"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947439"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1902"></span><span id="toDocBold"><span class="annot"><span class="annottext">toDocBold :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocBold"><span class="hs-identifier hs-var hs-var">toDocBold</span></a></span></span><span> </span><span id="local-6989586621680947437"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947437"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947436"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947436"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947435"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947435"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1903"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947437"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docBold&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947436"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947435"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1904"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocBold"><span class="hs-identifier hs-var">toDocBold</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1905"></span><span>
</span><span id="line-1906"></span><span id="local-6989586621680947434"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocCode"><span class="hs-identifier hs-type">toDocCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947434"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947434"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1907"></span><span id="toDocCode"><span class="annot"><span class="annottext">toDocCode :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocCode"><span class="hs-identifier hs-var hs-var">toDocCode</span></a></span></span><span> </span><span id="local-6989586621680947432"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947432"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947431"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947431"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947430"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947430"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1908"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947432"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docCode&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947431"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947430"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1909"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocCode"><span class="hs-identifier hs-var">toDocCode</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1910"></span><span>
</span><span id="line-1911"></span><span id="local-6989586621680950578"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocCodeBlock"><span class="hs-identifier hs-type">toDocCodeBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950578"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1912"></span><span id="toDocCodeBlock"><span class="annot"><span class="annottext">toDocCodeBlock :: forall v.
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe (Text, Text)
</span><a href="Unison.Syntax.TermPrinter.html#toDocCodeBlock"><span class="hs-identifier hs-var hs-var">toDocCodeBlock</span></a></span></span><span> </span><span id="local-6989586621680947428"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947428"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947427"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947427"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text'</span></span><span> </span><span id="local-6989586621680947426"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947426"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text'</span></span><span> </span><span id="local-6989586621680947425"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947425"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1913"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947428"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docCodeBlock&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947427"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947426"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947425"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1914"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocCodeBlock"><span class="hs-identifier hs-var">toDocCodeBlock</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1915"></span><span>
</span><span id="line-1916"></span><span id="local-6989586621680947424"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocVerbatim"><span class="hs-identifier hs-type">toDocVerbatim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947424"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-1917"></span><span id="toDocVerbatim"><span class="annot"><span class="annottext">toDocVerbatim :: forall v. PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Text
</span><a href="Unison.Syntax.TermPrinter.html#toDocVerbatim"><span class="hs-identifier hs-var hs-var">toDocVerbatim</span></a></span></span><span> </span><span id="local-6989586621680947422"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947422"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947421"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947421"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Text
</span><a href="Unison.Syntax.TermPrinter.html#toDocWord"><span class="hs-identifier hs-var">toDocWord</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947422"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947420"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947420"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1918"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947422"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docVerbatim&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947421"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947420"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-1919"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocVerbatim"><span class="hs-identifier hs-var">toDocVerbatim</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1920"></span><span>
</span><span id="line-1921"></span><span id="local-6989586621680950582"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEval"><span class="hs-identifier hs-type">toDocEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950582"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950582"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950582"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1922"></span><span id="toDocEval"><span class="annot"><span class="annottext">toDocEval :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocEval"><span class="hs-identifier hs-var hs-var">toDocEval</span></a></span></span><span> </span><span id="local-6989586621680947415"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947415"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947414"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947414"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DDelay%27"><span class="hs-identifier hs-type">DDelay'</span></a></span><span> </span><span id="local-6989586621680947412"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947412"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1923"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947415"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docEval&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947414"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947412"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1924"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947414"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Syntax.TermPrinter.html#_oldDocEval"><span class="hs-identifier hs-var">_oldDocEval</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947412"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1925"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEval"><span class="hs-identifier hs-var">toDocEval</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1926"></span><span>
</span><span id="line-1927"></span><span class="hs-comment">-- Old hashes for docEval, docEvalInline w/ incorrect type signatures.</span><span>
</span><span id="line-1928"></span><span class="hs-comment">-- They are still used by some existing docs so the pretty-printer</span><span>
</span><span id="line-1929"></span><span class="hs-comment">-- recognizes it.</span><span>
</span><span id="line-1930"></span><span class="hs-comment">--</span><span>
</span><span id="line-1931"></span><span class="hs-comment">-- See https://github.com/unisonweb/unison/issues/2238</span><span>
</span><span id="line-1932"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#_oldDocEval"><span class="hs-identifier hs-type">_oldDocEval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#_oldDocEvalInline"><span class="hs-identifier hs-type">_oldDocEvalInline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span>
</span><span id="line-1933"></span><span id="_oldDocEval"><span class="annot"><span class="annottext">_oldDocEval :: Reference
</span><a href="Unison.Syntax.TermPrinter.html#_oldDocEval"><span class="hs-identifier hs-var hs-var">_oldDocEval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Reference
</span><span class="hs-identifier hs-var">Reference.unsafeFromText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;#m2bmkdos2669tt46sh2gf6cmb4td5le8lcqnmsl9nfaqiv7s816q8bdtjdbt98tkk11ejlesepe7p7u8p0asu9758gdseffh0t78m2o&quot;</span></span><span>
</span><span id="line-1934"></span><span id="_oldDocEvalInline"><span class="annot"><span class="annottext">_oldDocEvalInline :: Reference
</span><a href="Unison.Syntax.TermPrinter.html#_oldDocEvalInline"><span class="hs-identifier hs-var hs-var">_oldDocEvalInline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Reference
</span><span class="hs-identifier hs-var">Reference.unsafeFromText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;#7pjlvdu42gmfvfntja265dmi08afk08l54kpsuu55l9hq4l32fco2jlrm8mf2jbn61esfsi972b6e66d9on4i5bkmfchjdare1v5npg&quot;</span></span><span>
</span><span id="line-1935"></span><span>
</span><span id="line-1936"></span><span class="hs-comment">-- for docs, we consider a delay to be any function that ignores its arg</span><span>
</span><span id="line-1937"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DDelay%27"><span class="hs-identifier hs-type">DDelay'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621680950563"><span id="local-6989586621680950564"><span id="local-6989586621680950565"><span id="local-6989586621680950566"><span id="local-6989586621680951306"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951306"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950566"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950565"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950564"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951306"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950563"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950566"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950565"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950564"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951306"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950563"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-1938"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24mDDelay%27"><span id="DDelay%27"><span class="annot"><span class="annottext">$mDDelay' :: forall {r} {v} {vt} {at} {ap} {a}.
Var v =&gt;
Term2 vt at ap v a
-&gt; (Term2 vt at ap v a -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Unison.Syntax.TermPrinter.html#%24mDDelay%27"><span class="hs-identifier hs-var hs-var">DDelay'</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621680947407"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#unDDelay"><span class="hs-identifier hs-type">unDDelay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947407"><span class="annot"><a href="#local-6989586621680947407"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1939"></span><span>
</span><span id="line-1940"></span><span id="local-6989586621680950557"><span id="local-6989586621680950558"><span id="local-6989586621680950559"><span id="local-6989586621680950560"><span id="local-6989586621680950561"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#unDDelay"><span class="hs-identifier hs-type">unDDelay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950561"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950560"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950559"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950558"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950561"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680950560"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950559"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950558"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950561"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950557"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1941"></span><span id="unDDelay"><span class="annot"><span class="annottext">unDDelay :: forall v vt at ap a.
Var v =&gt;
Term2 vt at ap v a -&gt; Maybe (Term2 vt at ap v a)
</span><a href="Unison.Syntax.TermPrinter.html#unDDelay"><span class="hs-identifier hs-var hs-var">unDDelay</span></a></span></span><span> </span><span id="local-6989586621680947400"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947400"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; ABT f v (Term f v a)
</span><span class="hs-identifier hs-var">ABT.out</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947400"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1942"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ABT.Tm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lam</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ABT.Term</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ABT.Abs</span></span><span> </span><span id="local-6989586621680947394"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947394"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680947393"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947393"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1943"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.notMember</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947394"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947393"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947393"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-1944"></span><span>  </span><span class="annot"><span class="annottext">ABT (F vt at ap) v (Term2 vt at ap v a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1945"></span><span>
</span><span id="line-1946"></span><span id="local-6989586621680947392"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEvalInline"><span class="hs-identifier hs-type">toDocEvalInline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680947392"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947392"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947392"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1947"></span><span id="toDocEvalInline"><span class="annot"><span class="annottext">toDocEvalInline :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocEvalInline"><span class="hs-identifier hs-var hs-var">toDocEvalInline</span></a></span></span><span> </span><span id="local-6989586621680947387"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947387"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947386"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947386"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DDelay%27"><span class="hs-identifier hs-type">DDelay'</span></a></span><span> </span><span id="local-6989586621680947385"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947385"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1948"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947387"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docEvalInline&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947386"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947385"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1949"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947386"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="Unison.Syntax.TermPrinter.html#_oldDocEvalInline"><span class="hs-identifier hs-var">_oldDocEvalInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947385"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1950"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEvalInline"><span class="hs-identifier hs-var">toDocEvalInline</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1951"></span><span>
</span><span id="line-1952"></span><span id="local-6989586621680947384"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocExample"><span class="hs-identifier hs-type">toDocExample</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocExampleBlock"><span class="hs-identifier hs-type">toDocExampleBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680947384"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947384"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947384"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1953"></span><span id="toDocExample"><span class="annot"><span class="annottext">toDocExample :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExample"><span class="hs-identifier hs-var hs-var">toDocExample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
Text
-&gt; PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExample%27"><span class="hs-identifier hs-var">toDocExample'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docExample&quot;</span></span><span>
</span><span id="line-1954"></span><span id="toDocExampleBlock"><span class="annot"><span class="annottext">toDocExampleBlock :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExampleBlock"><span class="hs-identifier hs-var hs-var">toDocExampleBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
Text
-&gt; PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExample%27"><span class="hs-identifier hs-var">toDocExample'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docExampleBlock&quot;</span></span><span>
</span><span id="line-1955"></span><span>
</span><span id="line-1956"></span><span id="local-6989586621680950545"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocExample%27"><span class="hs-identifier hs-type">toDocExample'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950545"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950545"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950545"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1957"></span><span id="toDocExample%27"><span class="annot"><span class="annottext">toDocExample' :: forall v.
Var v =&gt;
Text
-&gt; PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocExample%27"><span class="hs-identifier hs-var hs-var">toDocExample'</span></a></span></span><span> </span><span id="local-6989586621680947363"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947363"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span id="local-6989586621680947362"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947362"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947361"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947361"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Nat'</span></span><span> </span><span id="local-6989586621680947360"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947360"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947359"><span class="annot"><span class="annottext">l :: Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947359"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamsNamed'</span></span><span> </span><span id="local-6989586621680947357"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947357"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680947356"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947356"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1958"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947362"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947363"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947361"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1959"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947359"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span>
</span><span id="line-1960"></span><span>    </span><span class="annot"><span class="annottext">forall v vt at ap a. Ord v =&gt; Term2 vt at ap v a -&gt; Bool
</span><a href="#local-6989586621680947355"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947356"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1961"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v a vt at ap.
Ord v =&gt;
a -&gt; [v] -&gt; Term2 vt at ap v a -&gt; Term2 vt at ap v a
</span><span class="hs-identifier hs-var">lam'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; a
</span><span class="hs-identifier hs-var">ABT.annotation</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947359"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947360"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680947357"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947356"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1962"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1963"></span><span>    </span><span id="local-6989586621680947355"><span class="annot"><span class="annottext">ok :: Term2 vt at ap v a -&gt; Bool
</span><a href="#local-6989586621680947355"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span id="local-6989586621680947345"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947345"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Term2 vt at ap v a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947345"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1964"></span><span>    </span><span class="annot"><a href="#local-6989586621680947355"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span id="local-6989586621680947344"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947344"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Term f v a -&gt; Set v
</span><span class="hs-identifier hs-var">ABT.freeVars</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947344"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1965"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocExample%27"><span class="hs-identifier hs-var">toDocExample'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1966"></span><span>
</span><span id="line-1967"></span><span id="local-6989586621680950598"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocTransclude"><span class="hs-identifier hs-type">toDocTransclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1968"></span><span id="toDocTransclude"><span class="annot"><span class="annottext">toDocTransclude :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocTransclude"><span class="hs-identifier hs-var hs-var">toDocTransclude</span></a></span></span><span> </span><span id="local-6989586621680947342"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947342"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947341"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947341"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947340"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947340"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1969"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947342"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docTransclude&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947341"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947340"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-1970"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocTransclude"><span class="hs-identifier hs-var">toDocTransclude</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1971"></span><span>
</span><span id="line-1972"></span><span id="local-6989586621680950583"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocLink"><span class="hs-identifier hs-type">toDocLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950583"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950583"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1973"></span><span id="toDocLink"><span class="annot"><span class="annottext">toDocLink :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Either Reference Referent)
</span><a href="Unison.Syntax.TermPrinter.html#toDocLink"><span class="hs-identifier hs-var hs-var">toDocLink</span></a></span></span><span> </span><span id="local-6989586621680947336"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947336"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947335"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947335"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947334"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947334"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1974"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947336"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docLink&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947335"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947334"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1975"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTermLink"><span class="hs-identifier hs-var">toDocEmbedTermLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947336"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947332"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947332"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947332"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1976"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Reference
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTypeLink"><span class="hs-identifier hs-var">toDocEmbedTypeLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947336"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947330"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947330"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947330"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1977"></span><span>      </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1978"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocLink"><span class="hs-identifier hs-var">toDocLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1979"></span><span>
</span><span id="line-1980"></span><span id="local-6989586621680950584"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocNamedLink"><span class="hs-identifier hs-type">toDocNamedLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1981"></span><span id="toDocNamedLink"><span class="annot"><span class="annottext">toDocNamedLink :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation, Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocNamedLink"><span class="hs-identifier hs-var hs-var">toDocNamedLink</span></a></span></span><span> </span><span id="local-6989586621680947328"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947328"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947327"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947327"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680947326"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947326"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947325"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947325"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1982"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947328"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docNamedLink&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947327"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947326"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947325"><span class="hs-identifier hs-var">target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1983"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocNamedLink"><span class="hs-identifier hs-var">toDocNamedLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1984"></span><span>
</span><span id="line-1985"></span><span id="local-6989586621680947324"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocItalic"><span class="hs-identifier hs-type">toDocItalic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947324"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947324"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1986"></span><span id="toDocItalic"><span class="annot"><span class="annottext">toDocItalic :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocItalic"><span class="hs-identifier hs-var hs-var">toDocItalic</span></a></span></span><span> </span><span id="local-6989586621680947322"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947322"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947321"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947321"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947320"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947320"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1987"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947322"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docItalic&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947321"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947320"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1988"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocItalic"><span class="hs-identifier hs-var">toDocItalic</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1989"></span><span>
</span><span id="line-1990"></span><span id="local-6989586621680947319"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocStrikethrough"><span class="hs-identifier hs-type">toDocStrikethrough</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947319"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947319"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1991"></span><span id="toDocStrikethrough"><span class="annot"><span class="annottext">toDocStrikethrough :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)
</span><a href="Unison.Syntax.TermPrinter.html#toDocStrikethrough"><span class="hs-identifier hs-var hs-var">toDocStrikethrough</span></a></span></span><span> </span><span id="local-6989586621680947317"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947317"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947316"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947316"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947315"><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947315"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1992"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947317"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docStrikethrough&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947316"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><a href="#local-6989586621680947315"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-1993"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocStrikethrough"><span class="hs-identifier hs-var">toDocStrikethrough</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1994"></span><span>
</span><span id="line-1995"></span><span id="local-6989586621680947314"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocParagraph"><span class="hs-identifier hs-type">toDocParagraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947314"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947314"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1996"></span><span id="toDocParagraph"><span class="annot"><span class="annottext">toDocParagraph :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocParagraph"><span class="hs-identifier hs-var hs-var">toDocParagraph</span></a></span></span><span> </span><span id="local-6989586621680947311"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947311"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947310"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947310"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947309"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947309"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1997"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947311"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docParagraph&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947310"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947309"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1998"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocParagraph"><span class="hs-identifier hs-var">toDocParagraph</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1999"></span><span>
</span><span id="line-2000"></span><span id="local-6989586621680947308"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTermLink"><span class="hs-identifier hs-type">toDocEmbedTermLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680947308"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947308"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span></span><span>
</span><span id="line-2001"></span><span id="toDocEmbedTermLink"><span class="annot"><span class="annottext">toDocEmbedTermLink :: forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTermLink"><span class="hs-identifier hs-var hs-var">toDocEmbedTermLink</span></a></span></span><span> </span><span id="local-6989586621680947304"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947304"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947303"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947303"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DDelay%27"><span class="hs-identifier hs-type">DDelay'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referent'</span></span><span> </span><span id="local-6989586621680947301"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947301"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2002"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947304"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docEmbedTermLink&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947303"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947301"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-2003"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTermLink"><span class="hs-identifier hs-var">toDocEmbedTermLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2004"></span><span>
</span><span id="line-2005"></span><span id="local-6989586621680950527"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTypeLink"><span class="hs-identifier hs-type">toDocEmbedTypeLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950527"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span></span><span>
</span><span id="line-2006"></span><span id="toDocEmbedTypeLink"><span class="annot"><span class="annottext">toDocEmbedTypeLink :: forall v.
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Reference
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTypeLink"><span class="hs-identifier hs-var hs-var">toDocEmbedTypeLink</span></a></span></span><span> </span><span id="local-6989586621680947299"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947299"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947298"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947298"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeLink'</span></span><span> </span><span id="local-6989586621680947297"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947297"><span class="hs-identifier hs-var">typeref</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2007"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947299"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docEmbedTypeLink&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947298"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947297"><span class="hs-identifier hs-var">typeref</span></a></span><span>
</span><span id="line-2008"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTypeLink"><span class="hs-identifier hs-var">toDocEmbedTypeLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2009"></span><span>
</span><span id="line-2010"></span><span id="local-6989586621680947296"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSourceAnnotations"><span class="hs-identifier hs-type">toDocSourceAnnotations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680947296"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947296"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-2011"></span><span id="toDocSourceAnnotations"><span class="annot"><span class="annottext">toDocSourceAnnotations :: forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe [Referent]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSourceAnnotations"><span class="hs-identifier hs-var hs-var">toDocSourceAnnotations</span></a></span></span><span> </span><span id="local-6989586621680947293"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947293"><span class="hs-identifier hs-var">_ppe</span></a></span></span><span> </span><span id="local-6989586621680947292"><span class="annot"><span class="annottext">Term3 v PrintAnnotation
</span><a href="#local-6989586621680947292"><span class="hs-identifier hs-var">_tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- todo fetch annotations</span><span>
</span><span id="line-2012"></span><span>
</span><span id="line-2013"></span><span id="local-6989586621680950519"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSourceElement"><span class="hs-identifier hs-type">toDocSourceElement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950519"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950519"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-2014"></span><span id="toDocSourceElement"><span class="annot"><span class="annottext">toDocSourceElement :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Either Reference Referent, [Referent])
</span><a href="Unison.Syntax.TermPrinter.html#toDocSourceElement"><span class="hs-identifier hs-var hs-var">toDocSourceElement</span></a></span></span><span> </span><span id="local-6989586621680947281"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947281"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947280"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947280"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680947279"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947279"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe [Referent]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSourceAnnotations"><span class="hs-identifier hs-var">toDocSourceAnnotations</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947281"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947278"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947278"><span class="hs-identifier hs-var">annotations</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2015"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947281"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docSourceElement&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947280"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2016"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947278"><span class="hs-identifier hs-var">annotations</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
-&gt; Maybe (Either Reference Referent)
</span><a href="#local-6989586621680947277"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947279"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-2017"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2018"></span><span>    </span><span id="local-6989586621680947277"><span class="annot"><span class="annottext">ok :: Term2 v () () v PrintAnnotation
-&gt; Maybe (Either Reference Referent)
</span><a href="#local-6989586621680947277"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span id="local-6989586621680947276"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947276"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2019"></span><span>      </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTermLink"><span class="hs-identifier hs-var">toDocEmbedTermLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947281"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947276"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-2020"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall v.
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Reference
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedTypeLink"><span class="hs-identifier hs-var">toDocEmbedTypeLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947281"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947276"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-2021"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSourceElement"><span class="hs-identifier hs-var">toDocSourceElement</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2022"></span><span>
</span><span id="line-2023"></span><span id="local-6989586621680950514"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSource%27"><span class="hs-identifier hs-type">toDocSource'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2024"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950514"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2025"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2026"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2027"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950514"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2028"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-2029"></span><span id="toDocSource%27"><span class="annot"><span class="annottext">toDocSource' :: forall v.
Var v =&gt;
Text
-&gt; PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSource%27"><span class="hs-identifier hs-var hs-var">toDocSource'</span></a></span></span><span> </span><span id="local-6989586621680947266"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947266"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span id="local-6989586621680947265"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947265"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947264"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947264"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947263"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947263"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2030"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947265"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947266"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947264"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2031"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Either Reference Referent, [Referent])
</span><a href="#local-6989586621680947262"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947262"><span class="annot"><span class="annottext">(Either Reference Referent, [Referent])
</span><a href="#local-6989586621680947262"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Either Reference Referent, [Referent])
</span><a href="Unison.Syntax.TermPrinter.html#toDocSourceElement"><span class="hs-identifier hs-var">toDocSourceElement</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947265"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947263"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2032"></span><span>        </span><span id="local-6989586621680947261"><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947261"><span class="hs-identifier hs-var">tms'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947261"><span class="hs-identifier hs-var">tms'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947263"><span class="hs-identifier hs-var">tms</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><a href="#local-6989586621680947261"><span class="hs-identifier hs-var">tms'</span></a></span><span>
</span><span id="line-2033"></span><span>        </span><span class="annot"><span class="annottext">[(Either Reference Referent, [Referent])]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2034"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSource%27"><span class="hs-identifier hs-var">toDocSource'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2035"></span><span>
</span><span id="line-2036"></span><span id="local-6989586621680950581"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSource"><span class="hs-identifier hs-type">toDocSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2037"></span><span>  </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocFoldedSource"><span class="hs-identifier hs-type">toDocFoldedSource</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2038"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950581"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-2039"></span><span>    </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2040"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950581"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2041"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-2042"></span><span id="toDocSource"><span class="annot"><span class="annottext">toDocSource :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSource"><span class="hs-identifier hs-var hs-var">toDocSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
Text
-&gt; PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSource%27"><span class="hs-identifier hs-var">toDocSource'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docSource&quot;</span></span><span>
</span><span id="line-2043"></span><span id="toDocFoldedSource"><span class="annot"><span class="annottext">toDocFoldedSource :: forall v.
Var v =&gt;
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocFoldedSource"><span class="hs-identifier hs-var hs-var">toDocFoldedSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
Text
-&gt; PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe [(Either Reference Referent, [Referent])]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSource%27"><span class="hs-identifier hs-var">toDocSource'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docFoldedSource&quot;</span></span><span>
</span><span id="line-2044"></span><span>
</span><span id="line-2045"></span><span id="local-6989586621680950580"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSignatureInline"><span class="hs-identifier hs-type">toDocSignatureInline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950580"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950580"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span></span><span>
</span><span id="line-2046"></span><span id="toDocSignatureInline"><span class="annot"><span class="annottext">toDocSignatureInline :: forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocSignatureInline"><span class="hs-identifier hs-var hs-var">toDocSignatureInline</span></a></span></span><span> </span><span id="local-6989586621680947251"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947251"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947250"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947250"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedSignatureLink"><span class="hs-identifier hs-var">toDocEmbedSignatureLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947251"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947248"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947248"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2047"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947251"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docSignatureInline&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947250"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947248"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-2048"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSignatureInline"><span class="hs-identifier hs-var">toDocSignatureInline</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2049"></span><span>
</span><span id="line-2050"></span><span id="local-6989586621680947247"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEmbedSignatureLink"><span class="hs-identifier hs-type">toDocEmbedSignatureLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680947247"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947247"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span></span><span>
</span><span id="line-2051"></span><span id="toDocEmbedSignatureLink"><span class="annot"><span class="annottext">toDocEmbedSignatureLink :: forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedSignatureLink"><span class="hs-identifier hs-var hs-var">toDocEmbedSignatureLink</span></a></span></span><span> </span><span id="local-6989586621680947243"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947243"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947242"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947242"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#DDelay%27"><span class="hs-identifier hs-type">DDelay'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referent'</span></span><span> </span><span id="local-6989586621680947241"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947241"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2052"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947243"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docEmbedSignatureLink&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947242"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947241"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-2053"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocEmbedSignatureLink"><span class="hs-identifier hs-var">toDocEmbedSignatureLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2054"></span><span>
</span><span id="line-2055"></span><span class="hs-comment">-- toDocEmbedAnnotation :: PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe (Term3 v PrintAnnotation)</span><span>
</span><span id="line-2056"></span><span class="hs-comment">-- toDocEmbedAnnotation ppe (App' (Ref' r) tm)</span><span>
</span><span id="line-2057"></span><span class="hs-comment">--   | nameEndsWith ppe &quot;.docEmbedAnnotation&quot; r = Just tm</span><span>
</span><span id="line-2058"></span><span class="hs-comment">-- toDocEmbedAnnotation _ _ = Nothing</span><span>
</span><span id="line-2059"></span><span>
</span><span id="line-2060"></span><span class="hs-comment">-- toDocEmbedAnnotations :: PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]</span><span>
</span><span id="line-2061"></span><span class="hs-comment">-- toDocEmbedAnnotations ppe (App' (Ref' r) (List' tms))</span><span>
</span><span id="line-2062"></span><span class="hs-comment">--   | nameEndsWith ppe &quot;.docEmbedAnnotations&quot; r =</span><span>
</span><span id="line-2063"></span><span class="hs-comment">--     case [ann | Just ann &lt;- toDocEmbedAnnotation ppe &lt;$&gt; toList tms] of</span><span>
</span><span id="line-2064"></span><span class="hs-comment">--       tms' | length tms' == length tms -&gt; Just tms'</span><span>
</span><span id="line-2065"></span><span class="hs-comment">--       _ -&gt; Nothing</span><span>
</span><span id="line-2066"></span><span class="hs-comment">-- toDocEmbedAnnotations _ _ = Nothing</span><span>
</span><span id="line-2067"></span><span>
</span><span id="line-2068"></span><span id="local-6989586621680950579"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSignature"><span class="hs-identifier hs-type">toDocSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680950579"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950579"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referent</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-2069"></span><span id="toDocSignature"><span class="annot"><span class="annottext">toDocSignature :: forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe [Referent]
</span><a href="Unison.Syntax.TermPrinter.html#toDocSignature"><span class="hs-identifier hs-var hs-var">toDocSignature</span></a></span></span><span> </span><span id="local-6989586621680947232"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947232"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947231"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947231"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947230"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947230"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2070"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947232"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docSignature&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947231"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2071"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947229"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680947229"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947229"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v.
Var v =&gt;
PrettyPrintEnv -&gt; Term3 v PrintAnnotation -&gt; Maybe Referent
</span><a href="Unison.Syntax.TermPrinter.html#toDocEmbedSignatureLink"><span class="hs-identifier hs-var">toDocEmbedSignatureLink</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947232"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947230"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2072"></span><span>        </span><span id="local-6989586621680947228"><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947228"><span class="hs-identifier hs-var">tms'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947228"><span class="hs-identifier hs-var">tms'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947230"><span class="hs-identifier hs-var">tms</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Referent]
</span><a href="#local-6989586621680947228"><span class="hs-identifier hs-var">tms'</span></a></span><span>
</span><span id="line-2073"></span><span>        </span><span class="annot"><span class="annottext">[Referent]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2074"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSignature"><span class="hs-identifier hs-var">toDocSignature</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2075"></span><span>
</span><span id="line-2076"></span><span id="local-6989586621680947227"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocBulletedList"><span class="hs-identifier hs-type">toDocBulletedList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947227"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680947227"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-2077"></span><span id="toDocBulletedList"><span class="annot"><span class="annottext">toDocBulletedList :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation -&gt; Maybe [Term3 v PrintAnnotation]
</span><a href="Unison.Syntax.TermPrinter.html#toDocBulletedList"><span class="hs-identifier hs-var hs-var">toDocBulletedList</span></a></span></span><span> </span><span id="local-6989586621680947224"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947224"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">App'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947223"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947223"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947222"><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947222"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2078"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947224"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docBulletedList&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947223"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term (F v () ()) v PrintAnnotation)
</span><a href="#local-6989586621680947222"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2079"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocBulletedList"><span class="hs-identifier hs-var">toDocBulletedList</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term (F v () ()) v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span id="local-6989586621680950590"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocNumberedList"><span class="hs-identifier hs-type">toDocNumberedList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2082"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2083"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950590"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2084"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950590"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-2085"></span><span id="toDocNumberedList"><span class="annot"><span class="annottext">toDocNumberedList :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (ConstructorId, [Term3 v PrintAnnotation])
</span><a href="Unison.Syntax.TermPrinter.html#toDocNumberedList"><span class="hs-identifier hs-var hs-var">toDocNumberedList</span></a></span></span><span> </span><span id="local-6989586621680947219"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947219"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947218"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947218"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Nat'</span></span><span> </span><span id="local-6989586621680947217"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947217"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947216"><span class="annot"><span class="annottext">Seq (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680947216"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2086"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947219"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docNumberedList&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947218"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621680947217"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680947216"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2087"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocNumberedList"><span class="hs-identifier hs-var">toDocNumberedList</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2088"></span><span>
</span><span id="line-2089"></span><span id="local-6989586621680950596"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSection"><span class="hs-identifier hs-type">toDocSection</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-2090"></span><span>  </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2091"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950596"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2092"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950596"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term3</span></span><span> </span><span class="annot"><a href="#local-6989586621680950596"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#PrintAnnotation"><span class="hs-identifier hs-type">PrintAnnotation</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-2093"></span><span id="toDocSection"><span class="annot"><span class="annottext">toDocSection :: forall v.
PrettyPrintEnv
-&gt; Term3 v PrintAnnotation
-&gt; Maybe (Term3 v PrintAnnotation, [Term3 v PrintAnnotation])
</span><a href="Unison.Syntax.TermPrinter.html#toDocSection"><span class="hs-identifier hs-var hs-var">toDocSection</span></a></span></span><span> </span><span id="local-6989586621680947213"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947213"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Apps'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span id="local-6989586621680947212"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947212"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680947211"><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947211"><span class="hs-identifier hs-var">title</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List'</span></span><span> </span><span id="local-6989586621680947210"><span class="annot"><span class="annottext">Seq (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680947210"><span class="hs-identifier hs-var">tms</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2094"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var">nameEndsWith</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947213"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.docSection&quot;</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947212"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><a href="#local-6989586621680947211"><span class="hs-identifier hs-var">title</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq (Term2 v () () v PrintAnnotation)
</span><a href="#local-6989586621680947210"><span class="hs-identifier hs-var">tms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2095"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#toDocSection"><span class="hs-identifier hs-var">toDocSection</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Term2 v () () v PrintAnnotation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2096"></span><span>
</span><span id="line-2097"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-type">nameEndsWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reference</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2098"></span><span id="nameEndsWith"><span class="annot"><span class="annottext">nameEndsWith :: PrettyPrintEnv -&gt; Text -&gt; Reference -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#nameEndsWith"><span class="hs-identifier hs-var hs-var">nameEndsWith</span></a></span></span><span> </span><span id="local-6989586621680947209"><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947209"><span class="hs-identifier hs-var">ppe</span></a></span></span><span> </span><span id="local-6989586621680947208"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947208"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span id="local-6989586621680947207"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947207"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv -&gt; Referent -&gt; HashQualified Name
</span><a href="Unison.PrettyPrintEnv.html#termName"><span class="hs-identifier hs-var">PrettyPrintEnv.termName</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyPrintEnv
</span><a href="#local-6989586621680947209"><span class="hs-identifier hs-var">ppe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Referent
</span><span class="hs-identifier hs-var">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947207"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2099"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HQ.NameOnly</span></span><span> </span><span id="local-6989586621680947206"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947206"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2100"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947205"><span class="annot"><span class="annottext">tn :: Text
</span><a href="#local-6989586621680947205"><span class="hs-identifier hs-var hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var">Name.toText</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947206"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2101"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947205"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947208"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">Text.isSuffixOf</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947208"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680947205"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-2102"></span><span>  </span><span class="annot"><span class="annottext">HashQualified Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2103"></span><span>
</span><span id="line-2104"></span><span class="hs-comment">-- Modifies a PrettyPrintEnv to avoid picking a name for a term or type ref</span><span>
</span><span id="line-2105"></span><span class="hs-comment">-- which is the same as a locally introduced variable. For example:</span><span>
</span><span id="line-2106"></span><span class="hs-comment">--</span><span>
</span><span id="line-2107"></span><span class="hs-comment">--   qux.quaffle = 23</span><span>
</span><span id="line-2108"></span><span class="hs-comment">--</span><span>
</span><span id="line-2109"></span><span class="hs-comment">--   example : Text -&gt; Nat</span><span>
</span><span id="line-2110"></span><span class="hs-comment">--   example quaffle = qux.quaffle + 1</span><span>
</span><span id="line-2111"></span><span class="hs-comment">--</span><span>
</span><span id="line-2112"></span><span class="hs-comment">-- Here, we want the pretty-printer to use the name 'qux.quaffle' even though</span><span>
</span><span id="line-2113"></span><span class="hs-comment">-- 'quaffle' would otherwise be a unique suffix.</span><span>
</span><span id="line-2114"></span><span class="hs-comment">--</span><span>
</span><span id="line-2115"></span><span class="hs-comment">-- Algorithm is the following:</span><span>
</span><span id="line-2116"></span><span class="hs-comment">--   1. Form the set of all local variables used anywhere in the term</span><span>
</span><span id="line-2117"></span><span class="hs-comment">--   2. When picking a name for a term, see if it is contained in this set.</span><span>
</span><span id="line-2118"></span><span class="hs-comment">--      If yes: use a minimally qualified name which is longer than the suffixed name,</span><span>
</span><span id="line-2119"></span><span class="hs-comment">--              but doesn't conflict with any local vars.</span><span>
</span><span id="line-2120"></span><span class="hs-comment">--      If no: use the suffixed name for the term</span><span>
</span><span id="line-2121"></span><span class="hs-comment">--</span><span>
</span><span id="line-2122"></span><span class="hs-comment">-- The algorithm does the same for type references in signatures.</span><span>
</span><span id="line-2123"></span><span class="hs-comment">--</span><span>
</span><span id="line-2124"></span><span class="hs-comment">-- This algorithm is conservative in the sense that it doesn't take into account</span><span>
</span><span id="line-2125"></span><span class="hs-comment">-- the binding structure of the term. If the variable 'quaffle' is used as a local</span><span>
</span><span id="line-2126"></span><span class="hs-comment">-- variable anywhere in the term, then 'quaffle' will not be considered a unique suffix</span><span>
</span><span id="line-2127"></span><span class="hs-comment">-- even in places where the local 'quaffle' isn't in scope.</span><span>
</span><span id="line-2128"></span><span class="hs-comment">--</span><span>
</span><span id="line-2129"></span><span class="hs-comment">-- To do better this, you'd have to track bound variables in the pretty-printer and</span><span>
</span><span id="line-2130"></span><span class="hs-comment">-- fold this logic into the core pretty-printing implementation. This conservative</span><span>
</span><span id="line-2131"></span><span class="hs-comment">-- algorithm has the advantage of being purely a preprocessing step.</span><span>
</span><span id="line-2132"></span><span id="local-6989586621680951254"><span id="local-6989586621680951255"><span id="local-6989586621680951256"><span id="local-6989586621680951257"><span id="local-6989586621680951258"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-type">avoidShadowing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951258"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680951257"><span class="hs-identifier hs-type">vt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680951257"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951256"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951255"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951258"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680951254"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span></span></span></span></span></span><span>
</span><span id="line-2133"></span><span id="avoidShadowing"><span class="annot"><span class="annottext">avoidShadowing :: forall v vt at ap a.
(Var v, Var vt) =&gt;
Term2 vt at ap v a -&gt; PrettyPrintEnv -&gt; PrettyPrintEnv
</span><a href="Unison.Syntax.TermPrinter.html#avoidShadowing"><span class="hs-identifier hs-var hs-var">avoidShadowing</span></a></span></span><span> </span><span id="local-6989586621680947181"><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947181"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-type">PrettyPrintEnv</span></a></span><span> </span><span id="local-6989586621680947179"><span class="annot"><span class="annottext">Referent -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947179"><span class="hs-identifier hs-var">terms</span></a></span></span><span> </span><span id="local-6989586621680947178"><span class="annot"><span class="annottext">Reference -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947178"><span class="hs-identifier hs-var">types</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2134"></span><span>  </span><span class="annot"><span class="annottext">(Referent -&gt; [(HashQualified Name, HashQualified Name)])
-&gt; (Reference -&gt; [(HashQualified Name, HashQualified Name)])
-&gt; PrettyPrintEnv
</span><a href="Unison.PrettyPrintEnv.html#PrettyPrintEnv"><span class="hs-identifier hs-var">PrettyPrintEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947177"><span class="hs-identifier hs-var">terms'</span></a></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947176"><span class="hs-identifier hs-var">types'</span></a></span><span>
</span><span id="line-2135"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2136"></span><span>    </span><span id="local-6989586621680947177"><span class="annot"><span class="annottext">terms' :: Referent -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947177"><span class="hs-identifier hs-var hs-var">terms'</span></a></span></span><span> </span><span id="local-6989586621680947175"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947175"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name
-&gt; (HashQualified Name, HashQualified Name)
-&gt; (HashQualified Name, HashQualified Name)
</span><a href="#local-6989586621680947174"><span class="hs-identifier hs-var">tweak</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680947173"><span class="hs-identifier hs-var">usedTermNames</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Referent -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947179"><span class="hs-identifier hs-var">terms</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680947175"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2137"></span><span>    </span><span id="local-6989586621680947176"><span class="annot"><span class="annottext">types' :: Reference -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947176"><span class="hs-identifier hs-var hs-var">types'</span></a></span></span><span> </span><span id="local-6989586621680947172"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947172"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name
-&gt; (HashQualified Name, HashQualified Name)
-&gt; (HashQualified Name, HashQualified Name)
</span><a href="#local-6989586621680947174"><span class="hs-identifier hs-var">tweak</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680947171"><span class="hs-identifier hs-var">usedTypeNames</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; [(HashQualified Name, HashQualified Name)]
</span><a href="#local-6989586621680947178"><span class="hs-identifier hs-var">types</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680947172"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-2138"></span><span>    </span><span id="local-6989586621680947173"><span class="annot"><span class="annottext">usedTermNames :: Set Name
</span><a href="#local-6989586621680947173"><span class="hs-identifier hs-var hs-var">usedTermNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2139"></span><span>      </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947170"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680947169"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947169"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Foldable f =&gt; Term f v a -&gt; [v]
</span><span class="hs-identifier hs-var">ABT.allVars</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947181"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947170"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947170"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {v}. Var v =&gt; v -&gt; [Name]
</span><a href="#local-6989586621680947168"><span class="hs-identifier hs-var">varToName</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680947169"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2140"></span><span>    </span><span id="local-6989586621680947171"><span class="annot"><span class="annottext">usedTypeNames :: Set Name
</span><a href="#local-6989586621680947171"><span class="hs-identifier hs-var hs-var">usedTypeNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2141"></span><span>      </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947167"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann'</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947166"><span class="annot"><span class="annottext">Type vt at
</span><a href="#local-6989586621680947166"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall v (f :: * -&gt; *) a.
(Ord v, Traversable f) =&gt;
Term f v a -&gt; [Term f v a]
</span><span class="hs-identifier hs-var">ABT.subterms</span></span><span> </span><span class="annot"><span class="annottext">Term2 vt at ap v a
</span><a href="#local-6989586621680947181"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947165"><span class="annot"><span class="annottext">vt
</span><a href="#local-6989586621680947165"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) v a. Foldable f =&gt; Term f v a -&gt; [v]
</span><span class="hs-identifier hs-var">ABT.allVars</span></span><span> </span><span class="annot"><span class="annottext">Type vt at
</span><a href="#local-6989586621680947166"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947167"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947167"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {v}. Var v =&gt; v -&gt; [Name]
</span><a href="#local-6989586621680947168"><span class="hs-identifier hs-var">varToName</span></a></span><span> </span><span class="annot"><span class="annottext">vt
</span><a href="#local-6989586621680947165"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2142"></span><span>    </span><span class="annot"><a href="#local-6989586621680947174"><span class="hs-identifier hs-type">tweak</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HQ'.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HQ'.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HQ'.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HQ'.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-2143"></span><span>    </span><span id="local-6989586621680947174"><span class="annot"><span class="annottext">tweak :: Set Name
-&gt; (HashQualified Name, HashQualified Name)
-&gt; (HashQualified Name, HashQualified Name)
</span><a href="#local-6989586621680947174"><span class="hs-identifier hs-var hs-var">tweak</span></a></span></span><span> </span><span id="local-6989586621680947164"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680947164"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947163"><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680947163"><span class="hs-identifier hs-var">fullName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HQ'.NameOnly</span></span><span> </span><span id="local-6989586621680947161"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947161"><span class="hs-identifier hs-var">suffixedName</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2144"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947161"><span class="hs-identifier hs-var">suffixedName</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680947164"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2145"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680947159"><span class="hs-identifier hs-type">revFQNSegments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NEL.NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameSegment</span></span><span>
</span><span id="line-2146"></span><span>              </span><span id="local-6989586621680947159"><span class="annot"><span class="annottext">revFQNSegments :: NonEmpty NameSegment
</span><a href="#local-6989586621680947159"><span class="hs-identifier hs-var hs-var">revFQNSegments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NonEmpty NameSegment
</span><span class="hs-identifier hs-var">Name.reverseSegments</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall n. HashQualified n -&gt; n
</span><span class="hs-identifier hs-var">HQ'.toName</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680947163"><span class="hs-identifier hs-var">fullName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2147"></span><span>              </span><span class="annot"><a href="#local-6989586621680947156"><span class="hs-identifier hs-type">minimallySuffixed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HQ'.HashQualified</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-2148"></span><span>              </span><span id="local-6989586621680947156"><span class="annot"><span class="annottext">minimallySuffixed :: HashQualified Name
</span><a href="#local-6989586621680947156"><span class="hs-identifier hs-var hs-var">minimallySuffixed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2149"></span><span>                </span><span class="annot"><span class="annottext">NonEmpty NameSegment
</span><a href="#local-6989586621680947159"><span class="hs-identifier hs-var">revFQNSegments</span></a></span><span>
</span><span id="line-2150"></span><span>                  </span><span class="hs-comment">-- Get all suffixes (it's inits instead of tails because name segments are in reverse order)</span><span>
</span><span id="line-2151"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; NonEmpty [a]
</span><span class="hs-identifier hs-var">NEL.inits</span></span><span>
</span><span id="line-2152"></span><span>                  </span><span class="hs-comment">-- Drop the empty 'init'</span><span>
</span><span id="line-2153"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NEL.tail</span></span><span>
</span><span id="line-2154"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty NameSegment -&gt; Name
</span><span class="hs-identifier hs-var">Name.fromReverseSegments</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NEL.nonEmpty</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Convert back into names</span><span>
</span><span id="line-2155"></span><span>                  </span><span class="hs-comment">-- Drop the suffixes that we know are shorter than the suffixified name</span><span>
</span><span id="line-2156"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Int
</span><span class="hs-identifier hs-var">Name.countSegments</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947161"><span class="hs-identifier hs-var">suffixedName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2157"></span><span>                  </span><span class="hs-comment">-- Drop the suffixes that are equal to local variables</span><span>
</span><span id="line-2158"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680947149"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947149"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680947149"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621680947164"><span class="hs-identifier hs-var">used</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2159"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span>
</span><span id="line-2160"></span><span>                  </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680947163"><span class="hs-identifier hs-var">fullName</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. n -&gt; HashQualified n
</span><span class="hs-identifier hs-var">HQ'.NameOnly</span></span><span>
</span><span id="line-2161"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680947163"><span class="hs-identifier hs-var">fullName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680947156"><span class="hs-identifier hs-var">minimallySuffixed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2162"></span><span>    </span><span class="annot"><a href="#local-6989586621680947174"><span class="hs-identifier hs-var">tweak</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947147"><span class="annot"><span class="annottext">(HashQualified Name, HashQualified Name)
</span><a href="#local-6989586621680947147"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HashQualified Name, HashQualified Name)
</span><a href="#local-6989586621680947147"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-2163"></span><span>    </span><span id="local-6989586621680947146"><span class="annot"><a href="#local-6989586621680947168"><span class="hs-identifier hs-type">varToName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span class="annot"><a href="#local-6989586621680947146"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680947146"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-2164"></span><span>    </span><span id="local-6989586621680947168"><span class="annot"><span class="annottext">varToName :: forall {v}. Var v =&gt; v -&gt; [Name]
</span><a href="#local-6989586621680947168"><span class="hs-identifier hs-var hs-var">varToName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Name
</span><span class="hs-identifier hs-var">Name.parseText</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v. Var v =&gt; v -&gt; Text
</span><span class="hs-identifier hs-var">Var.name</span></span><span>
</span><span id="line-2165"></span><span>
</span><span id="line-2166"></span><span id="local-6989586621680947138"><span id="local-6989586621680947139"><span id="local-6989586621680947140"><span id="local-6989586621680947141"><span id="local-6989586621680947142"><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-type">isLeaf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term2</span></span><span> </span><span class="annot"><a href="#local-6989586621680947142"><span class="hs-identifier hs-type">vt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680947141"><span class="hs-identifier hs-type">at</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680947140"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680947139"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680947138"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-2167"></span><span id="isLeaf"><span class="annot"><span class="annottext">isLeaf :: forall vt at ap v a. Term2 vt at ap v a -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-var hs-var">isLeaf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2168"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Constructor'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2169"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Request'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2170"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref'</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2171"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">Term (F vt at ap) v a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2172"></span><span>
</span><span id="line-2173"></span><span class="hs-comment">-- | Indicates this is the RHS of a top-level definition.</span><span>
</span><span id="line-2174"></span><span class="annot"><a href="Unison.Syntax.TermPrinter.html#isTopLevelPrecedence"><span class="hs-identifier hs-type">isTopLevelPrecedence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2175"></span><span id="isTopLevelPrecedence"><span class="annot"><span class="annottext">isTopLevelPrecedence :: Int -&gt; Bool
</span><a href="Unison.Syntax.TermPrinter.html#isTopLevelPrecedence"><span class="hs-identifier hs-var hs-var">isTopLevelPrecedence</span></a></span></span><span> </span><span id="local-6989586621680947137"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947137"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947137"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-2176"></span></pre></body></html>