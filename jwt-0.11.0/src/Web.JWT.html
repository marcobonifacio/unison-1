<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs              #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes         #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards    #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">{-|
Module:      Web.JWT
License:     MIT
Maintainer:  Stefan Saasen &lt;stefan@saasen.me&gt;
Stability:   experimental

This implementation of JWT is based on &lt;https://tools.ietf.org/html/rfc7519&gt;
but currently only implements the minimum required to work with the Atlassian Connect framework and GitHub App

Known limitations:

   * Only HMAC SHA-256 and RSA SHA-256 algorithms are currently a supported signature algorithm

   * There is currently no verification of time related information
   ('exp', 'nbf', 'iat').

   * Registered claims are not validated
-}</span><span>
</span><span id="line-28"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Web.JWT</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Encoding &amp; Decoding JWTs</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Decoding</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- $docDecoding</span></span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="Web.JWT.html#decode"><span class="hs-identifier">decode</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#decodeAndVerifySignature"><span class="hs-identifier">decodeAndVerifySignature</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Encoding</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#encodeSigned"><span class="hs-identifier">encodeSigned</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#encodeUnsigned"><span class="hs-identifier">encodeUnsigned</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utility functions</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Common</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#tokenIssuer"><span class="hs-identifier">tokenIssuer</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#hmacSecret"><span class="hs-identifier">hmacSecret</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#readRsaSecret"><span class="hs-identifier">readRsaSecret</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#readRsaPublicKey"><span class="hs-identifier">readRsaPublicKey</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#toVerify"><span class="hs-identifier">toVerify</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** JWT structure</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#claims"><span class="hs-identifier">claims</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#header"><span class="hs-identifier">header</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#signature"><span class="hs-keyword">signature</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** JWT claims set</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#auds"><span class="hs-identifier">auds</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#intDate"><span class="hs-identifier">intDate</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#numericDate"><span class="hs-identifier">numericDate</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#stringOrURI"><span class="hs-identifier">stringOrURI</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#stringOrURIToText"><span class="hs-identifier">stringOrURIToText</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#secondsSinceEpoch"><span class="hs-identifier">secondsSinceEpoch</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#UnverifiedJWT"><span class="hs-identifier">UnverifiedJWT</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#VerifiedJWT"><span class="hs-identifier">VerifiedJWT</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier">Signature</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#VerifySigner"><span class="hs-identifier">VerifySigner</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier">EncodeSigner</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier">JWT</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#Algorithm"><span class="hs-identifier">Algorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier">JWTClaimsSet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier">ClaimsMap</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#IntDate"><span class="hs-identifier">IntDate</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier">NumericDate</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier">StringOrURI</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTHeader"><span class="hs-identifier">JWTHeader</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier">JOSEHeader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Deprecated</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.JWT.html#rsaKeySecret"><span class="hs-identifier">rsaKeySecret</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C8</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromStrict</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toStrict</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.ByteString.Extended.html"><span class="hs-identifier">Data.ByteString.Extended</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Hash.Algorithms</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.MAC.HMAC</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrivateKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PublicKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA.PKCS15</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RSA</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Store.X509</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readPubKeyFileFromMemory</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteArray.Encoding</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                 </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Scientific</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NominalDiffTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrivKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrivKeyRSA</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PubKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PubKeyRSA</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.X509.Memory</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readKeyFileFromMemory</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.URI</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">URI</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>                    </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_aeson(2,0,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Key</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Key</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.KeyMap</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KeyMap</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.HashMap.Strict</span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">KeyMap</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-113"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">JWTHeader</span><span> </span><span class="hs-pragma">&quot;Use JOSEHeader instead. JWTHeader will be removed in 1.0&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-114"></span><span class="hs-keyword">type</span><span> </span><span id="JWTHeader"><span class="annot"><a href="Web.JWT.html#JWTHeader"><span class="hs-identifier hs-var">JWTHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">data</span><span> </span><span id="VerifySigner"><span class="annot"><a href="Web.JWT.html#VerifySigner"><span class="hs-identifier hs-var">VerifySigner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="VerifyHMACSecret"><span class="annot"><a href="Web.JWT.html#VerifyHMACSecret"><span class="hs-identifier hs-var">VerifyHMACSecret</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-117"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="VerifyRSAPrivateKey"><span class="annot"><a href="Web.JWT.html#VerifyRSAPrivateKey"><span class="hs-identifier hs-var">VerifyRSAPrivateKey</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateKey</span></span><span>
</span><span id="line-118"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="VerifyRSAPublicKey"><span class="annot"><a href="Web.JWT.html#VerifyRSAPublicKey"><span class="hs-identifier hs-var">VerifyRSAPublicKey</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicKey</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">data</span><span> </span><span id="EncodeSigner"><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier hs-var">EncodeSigner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EncodeHMACSecret"><span class="annot"><a href="Web.JWT.html#EncodeHMACSecret"><span class="hs-identifier hs-var">EncodeHMACSecret</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-121"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="EncodeRSAPrivateKey"><span class="annot"><a href="Web.JWT.html#EncodeRSAPrivateKey"><span class="hs-identifier hs-var">EncodeRSAPrivateKey</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateKey</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">newtype</span><span> </span><span id="Signature"><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097411"><span id="local-6989586621679097413"><span id="local-6989586621679097417"><span class="annot"><span class="annottext">Int -&gt; Signature -&gt; ShowS
[Signature] -&gt; ShowS
Signature -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Signature] -&gt; ShowS
$cshowList :: [Signature] -&gt; ShowS
show :: Signature -&gt; String
$cshow :: Signature -&gt; String
showsPrec :: Int -&gt; Signature -&gt; ShowS
$cshowsPrec :: Int -&gt; Signature -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097407"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679097405"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097405"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097404"><span class="annot"><span class="annottext">== :: Signature -&gt; Signature -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679097403"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097403"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097405"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="Data.Text.Extended.html#constTimeCompare"><span class="hs-operator hs-var">`T.constTimeCompare`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097403"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | JSON Web Token without signature verification</span><span>
</span><span id="line-129"></span><span class="hs-keyword">data</span><span> </span><span id="UnverifiedJWT"><span class="annot"><a href="Web.JWT.html#UnverifiedJWT"><span class="hs-identifier hs-var">UnverifiedJWT</span></a></span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | JSON Web Token that has been successfully verified</span><span>
</span><span id="line-132"></span><span class="hs-keyword">data</span><span> </span><span id="VerifiedJWT"><span class="annot"><a href="Web.JWT.html#VerifiedJWT"><span class="hs-identifier hs-var">VerifiedJWT</span></a></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | The JSON Web Token</span><span>
</span><span id="line-136"></span><span class="hs-keyword">data</span><span> </span><span id="JWT"><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-var">JWT</span></a></span></span><span> </span><span id="local-6989586621679097401"><span class="annot"><a href="#local-6989586621679097401"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>   </span><span id="Unverified"><span class="annot"><a href="Web.JWT.html#Unverified"><span class="hs-identifier hs-var">Unverified</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTHeader"><span class="hs-identifier hs-type">JWTHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="Web.JWT.html#UnverifiedJWT"><span class="hs-identifier hs-type">UnverifiedJWT</span></a></span><span>
</span><span id="line-138"></span><span>   </span><span id="Verified"><span class="annot"><a href="Web.JWT.html#Verified"><span class="hs-identifier hs-var">Verified</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTHeader"><span class="hs-identifier hs-type">JWTHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="Web.JWT.html#VerifiedJWT"><span class="hs-identifier hs-type">VerifiedJWT</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679097393"><span id="local-6989586621679097395"><span id="local-6989586621679097397"><span id="local-6989586621679097761"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097761"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Extract the claims set from a JSON Web Token</span><span>
</span><span id="line-143"></span><span id="local-6989586621679097760"><span class="annot"><a href="Web.JWT.html#claims"><span class="hs-identifier hs-type">claims</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097760"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span></span><span>
</span><span id="line-144"></span><span id="claims"><span class="annot"><span class="annottext">claims :: forall r. JWT r -&gt; JWTClaimsSet
</span><a href="Web.JWT.html#claims"><span class="hs-identifier hs-var hs-var">claims</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Unverified"><span class="hs-identifier hs-type">Unverified</span></a></span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679097391"><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097391"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097391"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Web.JWT.html#claims"><span class="hs-identifier hs-var">claims</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Verified"><span class="hs-identifier hs-type">Verified</span></a></span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679097389"><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097389"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097389"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Extract the header from a JSON Web Token</span><span>
</span><span id="line-148"></span><span id="local-6989586621679097758"><span class="annot"><a href="Web.JWT.html#header"><span class="hs-identifier hs-type">header</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097758"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span></span><span>
</span><span id="line-149"></span><span id="header"><span class="annot"><span class="annottext">header :: forall r. JWT r -&gt; JWTHeader
</span><a href="Web.JWT.html#header"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Unverified"><span class="hs-identifier hs-type">Unverified</span></a></span><span> </span><span id="local-6989586621679097387"><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097387"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097387"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Web.JWT.html#header"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Verified"><span class="hs-identifier hs-type">Verified</span></a></span><span> </span><span id="local-6989586621679097385"><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097385"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097385"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Extract the signature from a verified JSON Web Token</span><span>
</span><span id="line-153"></span><span id="local-6989586621679097756"><span class="annot"><a href="Web.JWT.html#signature"><span class="hs-keyword hs-type">signature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097756"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span></span><span>
</span><span id="line-154"></span><span id="signature"><span class="annot"><span class="annottext">signature :: forall r. JWT r -&gt; Maybe Signature
</span><a href="Web.JWT.html#signature"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span class="annot"><a href="Web.JWT.html#Unverified"><span class="hs-identifier hs-type">Unverified</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Web.JWT.html#signature"><span class="hs-keyword hs-var">signature</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Verified"><span class="hs-identifier hs-type">Verified</span></a></span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679097382"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097382"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097382"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | A JSON numeric value representing the number of seconds from</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- 1970-01-01T0:0:0Z UTC until the specified UTC date/time.</span><span>
</span><span id="line-159"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">IntDate</span><span> </span><span class="hs-pragma">&quot;Use NumericDate instead. IntDate will be removed in 1.0&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-160"></span><span class="hs-keyword">type</span><span> </span><span id="IntDate"><span class="annot"><a href="Web.JWT.html#IntDate"><span class="hs-identifier hs-var">IntDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | A JSON numeric value representing the number of seconds from</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- 1970-01-01T0:0:0Z UTC until the specified UTC date/time.</span><span>
</span><span id="line-164"></span><span class="hs-keyword">newtype</span><span> </span><span id="NumericDate"><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NumericDate"><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097372"><span id="local-6989586621679097374"><span id="local-6989586621679097379"><span class="annot"><span class="annottext">Int -&gt; NumericDate -&gt; ShowS
[NumericDate] -&gt; ShowS
NumericDate -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NumericDate] -&gt; ShowS
$cshowList :: [NumericDate] -&gt; ShowS
show :: NumericDate -&gt; String
$cshow :: NumericDate -&gt; String
showsPrec :: Int -&gt; NumericDate -&gt; ShowS
$cshowsPrec :: Int -&gt; NumericDate -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097365"><span id="local-6989586621679097370"><span class="annot"><span class="annottext">NumericDate -&gt; NumericDate -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NumericDate -&gt; NumericDate -&gt; Bool
$c/= :: NumericDate -&gt; NumericDate -&gt; Bool
== :: NumericDate -&gt; NumericDate -&gt; Bool
$c== :: NumericDate -&gt; NumericDate -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097333"><span id="local-6989586621679097337"><span id="local-6989586621679097341"><span id="local-6989586621679097345"><span id="local-6989586621679097349"><span id="local-6989586621679097353"><span id="local-6989586621679097358"><span class="annot"><span class="annottext">Eq NumericDate
NumericDate -&gt; NumericDate -&gt; Bool
NumericDate -&gt; NumericDate -&gt; Ordering
NumericDate -&gt; NumericDate -&gt; NumericDate
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: NumericDate -&gt; NumericDate -&gt; NumericDate
$cmin :: NumericDate -&gt; NumericDate -&gt; NumericDate
max :: NumericDate -&gt; NumericDate -&gt; NumericDate
$cmax :: NumericDate -&gt; NumericDate -&gt; NumericDate
&gt;= :: NumericDate -&gt; NumericDate -&gt; Bool
$c&gt;= :: NumericDate -&gt; NumericDate -&gt; Bool
&gt; :: NumericDate -&gt; NumericDate -&gt; Bool
$c&gt; :: NumericDate -&gt; NumericDate -&gt; Bool
&lt;= :: NumericDate -&gt; NumericDate -&gt; Bool
$c&lt;= :: NumericDate -&gt; NumericDate -&gt; Bool
&lt; :: NumericDate -&gt; NumericDate -&gt; Bool
$c&lt; :: NumericDate -&gt; NumericDate -&gt; Bool
compare :: NumericDate -&gt; NumericDate -&gt; Ordering
$ccompare :: NumericDate -&gt; NumericDate -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Return the seconds since 1970-01-01T0:0:0Z UTC for the given 'IntDate'</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Web.JWT.html#secondsSinceEpoch"><span class="hs-identifier hs-type">secondsSinceEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-169"></span><span id="secondsSinceEpoch"><span class="annot"><span class="annottext">secondsSinceEpoch :: NumericDate -&gt; NominalDiffTime
</span><a href="Web.JWT.html#secondsSinceEpoch"><span class="hs-identifier hs-var hs-var">secondsSinceEpoch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span> </span><span id="local-6989586621679097328"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679097328"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679097328"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | A JSON string value, with the additional requirement that while</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- arbitrary string values MAY be used, any value containing a &quot;:&quot;</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- character MUST be a URI [RFC3986].  StringOrURI values are</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- compared as case-sensitive strings with no transformations or</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- canonicalizations applied.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="StringOrURI"><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-var">StringOrURI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="S"><span class="annot"><a href="Web.JWT.html#S"><span class="hs-identifier hs-var">S</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="U"><span class="annot"><a href="Web.JWT.html#U"><span class="hs-identifier hs-var">U</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097318"><span id="local-6989586621679097324"><span class="annot"><span class="annottext">StringOrURI -&gt; StringOrURI -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: StringOrURI -&gt; StringOrURI -&gt; Bool
$c/= :: StringOrURI -&gt; StringOrURI -&gt; Bool
== :: StringOrURI -&gt; StringOrURI -&gt; Bool
$c== :: StringOrURI -&gt; StringOrURI -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097313"><span id="local-6989586621679097316"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679097310"><span class="annot"><span class="annottext">show :: StringOrURI -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679097308"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097308"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097308"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#U"><span class="hs-identifier hs-type">U</span></a></span><span> </span><span id="local-6989586621679097306"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679097306"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679097306"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="Algorithm"><span class="annot"><a href="Web.JWT.html#Algorithm"><span class="hs-identifier hs-var">Algorithm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HS256"><span class="annot"><a href="Web.JWT.html#HS256"><span class="hs-identifier hs-var">HS256</span></a></span></span><span> </span><span class="hs-comment">-- ^ HMAC using SHA-256 hash algorithm</span><span>
</span><span id="line-183"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="RS256"><span class="annot"><a href="Web.JWT.html#RS256"><span class="hs-identifier hs-var">RS256</span></a></span></span><span> </span><span class="hs-comment">-- ^ RSA using SHA-256 hash algorithm</span><span>
</span><span id="line-184"></span><span>                 </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097300"><span id="local-6989586621679097302"><span class="annot"><span class="annottext">Algorithm -&gt; Algorithm -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Algorithm -&gt; Algorithm -&gt; Bool
$c/= :: Algorithm -&gt; Algorithm -&gt; Bool
== :: Algorithm -&gt; Algorithm -&gt; Bool
$c== :: Algorithm -&gt; Algorithm -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097294"><span id="local-6989586621679097296"><span id="local-6989586621679097298"><span class="annot"><span class="annottext">Int -&gt; Algorithm -&gt; ShowS
[Algorithm] -&gt; ShowS
Algorithm -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Algorithm] -&gt; ShowS
$cshowList :: [Algorithm] -&gt; ShowS
show :: Algorithm -&gt; String
$cshow :: Algorithm -&gt; String
showsPrec :: Int -&gt; Algorithm -&gt; ShowS
$cshowsPrec :: Int -&gt; Algorithm -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | JOSE Header, describes the cryptographic operations applied to the JWT</span><span>
</span><span id="line-187"></span><span class="hs-keyword">data</span><span> </span><span id="JOSEHeader"><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-var">JOSEHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JOSEHeader"><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-var">JOSEHeader</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- | The typ (type) Header Parameter defined by [JWS] and [JWE] is used to</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- declare the MIME Media Type [IANA.MediaTypes] of this complete JWT in</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- contexts where this is useful to the application.</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- This parameter has no effect upon the JWT processing.</span><span>
</span><span id="line-192"></span><span>    </span><span id="typ"><span class="annot"><span class="annottext">JWTHeader -&gt; Maybe Text
</span><a href="Web.JWT.html#typ"><span class="hs-identifier hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- | The cty (content type) Header Parameter defined by [JWS] and [JWE] is</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-comment">-- used by this specification to convey structural information about the JWT.</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cty"><span class="annot"><span class="annottext">JWTHeader -&gt; Maybe Text
</span><a href="Web.JWT.html#cty"><span class="hs-identifier hs-var hs-var">cty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">-- | The alg (algorithm) used for signing the JWT. The HS256 (HMAC using</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">-- SHA-256) is the only required algorithm in addition to &quot;none&quot; which means</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- that no signature will be used.</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- See &lt;http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#page-6&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="alg"><span class="annot"><span class="annottext">JWTHeader -&gt; Maybe Algorithm
</span><a href="Web.JWT.html#alg"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#Algorithm"><span class="hs-identifier hs-type">Algorithm</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- | The &quot;kid&quot; (key ID) Header Parameter is a hint indicating which key</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- was used to secure the JWS.  This parameter allows originators to</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">-- explicitly signal a change of key to recipients.  The structure of</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- the &quot;kid&quot; value is unspecified.  Its value MUST be a case-sensitive</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- string.  Use of this Header Parameter is OPTIONAL.</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- See &lt;https://tools.ietf.org/html/rfc7515#section-4.1.4&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="kid"><span class="annot"><span class="annottext">JWTHeader -&gt; Maybe Text
</span><a href="Web.JWT.html#kid"><span class="hs-identifier hs-var hs-var">kid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-210"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097278"><span id="local-6989586621679097287"><span class="annot"><span class="annottext">JWTHeader -&gt; JWTHeader -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: JWTHeader -&gt; JWTHeader -&gt; Bool
$c/= :: JWTHeader -&gt; JWTHeader -&gt; Bool
== :: JWTHeader -&gt; JWTHeader -&gt; Bool
$c== :: JWTHeader -&gt; JWTHeader -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097264"><span id="local-6989586621679097266"><span id="local-6989586621679097276"><span class="annot"><span class="annottext">Int -&gt; JWTHeader -&gt; ShowS
[JWTHeader] -&gt; ShowS
JWTHeader -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [JWTHeader] -&gt; ShowS
$cshowList :: [JWTHeader] -&gt; ShowS
show :: JWTHeader -&gt; String
$cshow :: JWTHeader -&gt; String
showsPrec :: Int -&gt; JWTHeader -&gt; ShowS
$cshowsPrec :: Int -&gt; JWTHeader -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097258"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679097256"><span class="annot"><span class="annottext">mempty :: JWTHeader
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><span class="annottext">Maybe Text
-&gt; Maybe Text -&gt; Maybe Algorithm -&gt; Maybe Text -&gt; JWTHeader
</span><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-var">JOSEHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679097254"><span class="annot"><span class="annottext">mappend :: JWTHeader -&gt; JWTHeader -&gt; JWTHeader
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(Semigroup.&lt;&gt;)</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097249"><span id="local-6989586621679097251"><span class="annot"><span class="hs-identifier hs-type">Semigroup.Semigroup</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span><span> </span><span id="local-6989586621679097242"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097242"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679097241"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097241"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679097240"><span class="annot"><span class="annottext">Maybe Algorithm
</span><a href="#local-6989586621679097240"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679097239"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097239"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679097238"><span class="annot"><span class="annottext">&lt;&gt; :: JWTHeader -&gt; JWTHeader -&gt; JWTHeader
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span><span> </span><span id="local-6989586621679097237"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097237"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679097236"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097236"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679097235"><span class="annot"><span class="annottext">Maybe Algorithm
</span><a href="#local-6989586621679097235"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span id="local-6989586621679097234"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097234"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text
-&gt; Maybe Text -&gt; Maybe Algorithm -&gt; Maybe Text -&gt; JWTHeader
</span><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-var">JOSEHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097242"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097237"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097241"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097236"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Algorithm
</span><a href="#local-6989586621679097240"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Algorithm
</span><a href="#local-6989586621679097235"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097239"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679097234"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | The JWT Claims Set represents a JSON object whose members are the claims conveyed by the JWT.</span><span>
</span><span id="line-222"></span><span class="hs-keyword">data</span><span> </span><span id="JWTClaimsSet"><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-var">JWTClaimsSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWTClaimsSet"><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-var">JWTClaimsSet</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-comment">-- Registered Claim Names</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-comment">-- http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html#ClaimsContents</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-comment">-- | The iss (issuer) claim identifies the principal that issued the JWT.</span><span>
</span><span id="line-227"></span><span>    </span><span id="iss"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#iss"><span class="hs-identifier hs-var hs-var">iss</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- | The sub (subject) claim identifies the principal that is the subject of the JWT.</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sub"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#sub"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- | The aud (audience) claim identifies the audiences that the JWT is intended for according to draft 18 of the JWT spec, the aud claim is option and may be present in singular or as a list.</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="aud"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe (Either StringOrURI [StringOrURI])
</span><a href="Web.JWT.html#aud"><span class="hs-identifier hs-var hs-var">aud</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- | The exp (expiration time) claim identifies the expiration time on or after which the JWT MUST NOT be accepted for processing. Its value MUST be a number containing an IntDate value.</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="exp"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe NumericDate
</span><a href="Web.JWT.html#exp"><span class="hs-identifier hs-var hs-var">exp</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#IntDate"><span class="hs-identifier hs-type">IntDate</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-comment">-- | The nbf (not before) claim identifies the time before which the JWT MUST NOT be accepted for processing.</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nbf"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe NumericDate
</span><a href="Web.JWT.html#nbf"><span class="hs-identifier hs-var hs-var">nbf</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#IntDate"><span class="hs-identifier hs-type">IntDate</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- | The iat (issued at) claim identifies the time at which the JWT was issued.</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="iat"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe NumericDate
</span><a href="Web.JWT.html#iat"><span class="hs-identifier hs-var hs-var">iat</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#IntDate"><span class="hs-identifier hs-type">IntDate</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-comment">-- | The jti (JWT ID) claim provides a unique identifier for the JWT.</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="jti"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#jti"><span class="hs-identifier hs-var hs-var">jti</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unregisteredClaims"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; ClaimsMap
</span><a href="Web.JWT.html#unregisteredClaims"><span class="hs-identifier hs-var hs-var">unregisteredClaims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097206"><span id="local-6989586621679097208"><span id="local-6989586621679097222"><span class="annot"><span class="annottext">Int -&gt; JWTClaimsSet -&gt; ShowS
[JWTClaimsSet] -&gt; ShowS
JWTClaimsSet -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [JWTClaimsSet] -&gt; ShowS
$cshowList :: [JWTClaimsSet] -&gt; ShowS
show :: JWTClaimsSet -&gt; String
$cshow :: JWTClaimsSet -&gt; String
showsPrec :: Int -&gt; JWTClaimsSet -&gt; ShowS
$cshowsPrec :: Int -&gt; JWTClaimsSet -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097187"><span id="local-6989586621679097201"><span class="annot"><span class="annottext">JWTClaimsSet -&gt; JWTClaimsSet -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: JWTClaimsSet -&gt; JWTClaimsSet -&gt; Bool
$c/= :: JWTClaimsSet -&gt; JWTClaimsSet -&gt; Bool
== :: JWTClaimsSet -&gt; JWTClaimsSet -&gt; Bool
$c== :: JWTClaimsSet -&gt; JWTClaimsSet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097178"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679097177"><span class="annot"><span class="annottext">mempty :: JWTClaimsSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">Maybe StringOrURI
-&gt; Maybe StringOrURI
-&gt; Maybe (Either StringOrURI [StringOrURI])
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe StringOrURI
-&gt; ClaimsMap
-&gt; JWTClaimsSet
</span><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-var">JWTClaimsSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Text Value -&gt; ClaimsMap
</span><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679097173"><span class="annot"><span class="annottext">mappend :: JWTClaimsSet -&gt; JWTClaimsSet -&gt; JWTClaimsSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(Semigroup.&lt;&gt;)</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097168"><span id="local-6989586621679097170"><span class="annot"><span class="hs-identifier hs-type">Semigroup.Semigroup</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span id="local-6989586621679097159"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097159"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679097158"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097158"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679097157"><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
</span><a href="#local-6989586621679097157"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679097156"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097156"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679097155"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097155"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679097154"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097154"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679097153"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097153"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679097152"><span class="annot"><span class="annottext">ClaimsMap
</span><a href="#local-6989586621679097152"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679097151"><span class="annot"><span class="annottext">&lt;&gt; :: JWTClaimsSet -&gt; JWTClaimsSet -&gt; JWTClaimsSet
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span id="local-6989586621679097150"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097150"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679097149"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097149"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679097148"><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
</span><a href="#local-6989586621679097148"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span id="local-6989586621679097147"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097147"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span id="local-6989586621679097146"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097146"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span id="local-6989586621679097145"><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097145"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679097144"><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097144"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span id="local-6989586621679097143"><span class="annot"><span class="annottext">ClaimsMap
</span><a href="#local-6989586621679097143"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">Maybe StringOrURI
-&gt; Maybe StringOrURI
-&gt; Maybe (Either StringOrURI [StringOrURI])
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe StringOrURI
-&gt; ClaimsMap
-&gt; JWTClaimsSet
</span><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-var">JWTClaimsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097159"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097150"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097158"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097149"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
</span><a href="#local-6989586621679097157"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
</span><a href="#local-6989586621679097148"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097156"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097147"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097155"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097146"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097154"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679097145"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097153"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679097144"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClaimsMap
</span><a href="#local-6989586621679097152"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">Semigroup.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ClaimsMap
</span><a href="#local-6989586621679097143"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Encode a claims set using the given secret</span><span>
</span><span id="line-261"></span><span class="hs-comment">--</span><span>
</span><span id="line-262"></span><span class="hs-comment">--  &gt;&gt;&gt; :{</span><span>
</span><span id="line-263"></span><span class="hs-comment">--  let</span><span>
</span><span id="line-264"></span><span class="hs-comment">--      cs = mempty { -- mempty returns a default JWTClaimsSet</span><span>
</span><span id="line-265"></span><span class="hs-comment">--         iss = stringOrURI . T.pack $ &quot;Foo&quot;</span><span>
</span><span id="line-266"></span><span class="hs-comment">--       , unregisteredClaims = ClaimsMap $ Map.fromList [(T.pack &quot;http://example.com/is_root&quot;, (Bool True))]</span><span>
</span><span id="line-267"></span><span class="hs-comment">--      }</span><span>
</span><span id="line-268"></span><span class="hs-comment">--      key = hmacSecret . T.pack $ &quot;secret-key&quot;</span><span>
</span><span id="line-269"></span><span class="hs-comment">--  in encodeSigned key mempty cs</span><span>
</span><span id="line-270"></span><span class="hs-comment">--  :}</span><span>
</span><span id="line-271"></span><span class="hs-comment">--  &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJodHRwOi8vZXhhbXBsZS5jb20vaXNfcm9vdCI6dHJ1ZSwiaXNzIjoiRm9vIn0.vHQHuG3ujbnBUmEp-fSUtYxk27rLiP2hrNhxpyWhb2E&quot;</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Web.JWT.html#encodeSigned"><span class="hs-identifier hs-type">encodeSigned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier hs-type">EncodeSigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-273"></span><span id="encodeSigned"><span class="annot"><span class="annottext">encodeSigned :: EncodeSigner -&gt; JWTHeader -&gt; JWTClaimsSet -&gt; Text
</span><a href="Web.JWT.html#encodeSigned"><span class="hs-identifier hs-var hs-var">encodeSigned</span></a></span></span><span> </span><span id="local-6989586621679097142"><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679097142"><span class="hs-identifier hs-var">signer</span></a></span></span><span> </span><span id="local-6989586621679097141"><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097141"><span class="hs-identifier hs-var">header'</span></a></span></span><span> </span><span id="local-6989586621679097140"><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097140"><span class="hs-identifier hs-var">claims'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><a href="Web.JWT.html#dotted"><span class="hs-identifier hs-var">dotted</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097138"><span class="hs-identifier hs-var">header''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097137"><span class="hs-identifier hs-var">claim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097136"><span class="hs-identifier hs-var">signature'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679097137"><span class="annot"><span class="annottext">claim :: Text
</span><a href="#local-6989586621679097137"><span class="hs-identifier hs-var hs-var">claim</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Text
</span><a href="Web.JWT.html#encodeJWT"><span class="hs-identifier hs-var">encodeJWT</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097140"><span class="hs-identifier hs-var">claims'</span></a></span><span>
</span><span id="line-275"></span><span>          </span><span id="local-6989586621679097134"><span class="annot"><span class="annottext">algo :: Algorithm
</span><a href="#local-6989586621679097134"><span class="hs-identifier hs-var hs-var">algo</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679097142"><span class="hs-identifier hs-var">signer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>                        </span><span class="annot"><a href="Web.JWT.html#EncodeHMACSecret"><span class="hs-identifier hs-type">EncodeHMACSecret</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#HS256"><span class="hs-identifier hs-var">HS256</span></a></span><span>
</span><span id="line-277"></span><span>                        </span><span class="annot"><a href="Web.JWT.html#EncodeRSAPrivateKey"><span class="hs-identifier hs-type">EncodeRSAPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#RS256"><span class="hs-identifier hs-var">RS256</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>          </span><span id="local-6989586621679097138"><span class="annot"><span class="annottext">header'' :: Text
</span><a href="#local-6989586621679097138"><span class="hs-identifier hs-var hs-var">header''</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Text
</span><a href="Web.JWT.html#encodeJWT"><span class="hs-identifier hs-var">encodeJWT</span></a></span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097141"><span class="hs-identifier hs-var">header'</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-280"></span><span>                        </span><span class="annot"><span class="annottext">typ :: Maybe Text
</span><a href="Web.JWT.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;JWT&quot;</span></span><span>
</span><span id="line-281"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alg :: Maybe Algorithm
</span><a href="Web.JWT.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="#local-6989586621679097134"><span class="hs-identifier hs-var">algo</span></a></span><span>
</span><span id="line-282"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>          </span><span id="local-6989586621679097136"><span class="annot"><span class="annottext">signature' :: Text
</span><a href="#local-6989586621679097136"><span class="hs-identifier hs-var hs-var">signature'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncodeSigner -&gt; Text -&gt; Text
</span><a href="Web.JWT.html#calculateDigest"><span class="hs-identifier hs-var">calculateDigest</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679097142"><span class="hs-identifier hs-var">signer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><a href="Web.JWT.html#dotted"><span class="hs-identifier hs-var">dotted</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097138"><span class="hs-identifier hs-var">header''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097137"><span class="hs-identifier hs-var">claim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Encode a claims set without signing it</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">--  &gt;&gt;&gt; :{</span><span>
</span><span id="line-288"></span><span class="hs-comment">--  let cs = mempty</span><span>
</span><span id="line-289"></span><span class="hs-comment">--            { iss = stringOrURI . Data.Text.pack $ &quot;Foo&quot;</span><span>
</span><span id="line-290"></span><span class="hs-comment">--            , iat = numericDate 1394700934</span><span>
</span><span id="line-291"></span><span class="hs-comment">--            , unregisteredClaims = ClaimsMap $ Data.Map.fromList [(Data.Text.pack &quot;http://example.com/is_root&quot;, (Bool True))]</span><span>
</span><span id="line-292"></span><span class="hs-comment">--            }</span><span>
</span><span id="line-293"></span><span class="hs-comment">--  in encodeUnsigned cs mempty</span><span>
</span><span id="line-294"></span><span class="hs-comment">--  :}</span><span>
</span><span id="line-295"></span><span class="hs-comment">--  &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjEzOTQ3MDA5MzQsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJGb28ifQ.&quot;</span><span>
</span><span id="line-296"></span><span class="annot"><a href="Web.JWT.html#encodeUnsigned"><span class="hs-identifier hs-type">encodeUnsigned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-297"></span><span id="encodeUnsigned"><span class="annot"><span class="annottext">encodeUnsigned :: JWTClaimsSet -&gt; JWTHeader -&gt; Text
</span><a href="Web.JWT.html#encodeUnsigned"><span class="hs-identifier hs-var hs-var">encodeUnsigned</span></a></span></span><span> </span><span id="local-6989586621679097132"><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097132"><span class="hs-identifier hs-var">claims'</span></a></span></span><span> </span><span id="local-6989586621679097131"><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097131"><span class="hs-identifier hs-var">header'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><a href="Web.JWT.html#dotted"><span class="hs-identifier hs-var">dotted</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097130"><span class="hs-identifier hs-var">header''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097129"><span class="hs-identifier hs-var">claim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679097129"><span class="annot"><span class="annottext">claim :: Text
</span><a href="#local-6989586621679097129"><span class="hs-identifier hs-var hs-var">claim</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Text
</span><a href="Web.JWT.html#encodeJWT"><span class="hs-identifier hs-var">encodeJWT</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097132"><span class="hs-identifier hs-var">claims'</span></a></span><span>
</span><span id="line-299"></span><span>          </span><span id="local-6989586621679097130"><span class="annot"><span class="annottext">header'' :: Text
</span><a href="#local-6989586621679097130"><span class="hs-identifier hs-var hs-var">header''</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Text
</span><a href="Web.JWT.html#encodeJWT"><span class="hs-identifier hs-var">encodeJWT</span></a></span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097131"><span class="hs-identifier hs-var">header'</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-300"></span><span>                        </span><span class="annot"><span class="annottext">typ :: Maybe Text
</span><a href="Web.JWT.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;JWT&quot;</span></span><span>
</span><span id="line-301"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alg :: Maybe Algorithm
</span><a href="Web.JWT.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#HS256"><span class="hs-identifier hs-var">HS256</span></a></span><span>
</span><span id="line-302"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Decode a claims set without verifying the signature. This is useful if</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- information from the claim set is required in order to verify the claim</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- (e.g. the secret needs to be retrieved based on unverified information</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- from the claims set).</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-310"></span><span class="hs-comment">--  let</span><span>
</span><span id="line-311"></span><span class="hs-comment">--      input = Data.Text.pack &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzb21lIjoicGF5bG9hZCJ9.Joh1R2dYzkRvDkqv3sygm5YyK8Gi4ShZqbhK2gxcs2U&quot;</span><span>
</span><span id="line-312"></span><span class="hs-comment">--      mJwt = decode input</span><span>
</span><span id="line-313"></span><span class="hs-comment">--  in fmap header mJwt</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- Just (JOSEHeader {typ = Just &quot;JWT&quot;, cty = Nothing, alg = Just HS256, kid = Nothing})</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-320"></span><span class="hs-comment">--  let</span><span>
</span><span id="line-321"></span><span class="hs-comment">--      input = T.pack &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzb21lIjoicGF5bG9hZCJ9.Joh1R2dYzkRvDkqv3sygm5YyK8Gi4ShZqbhK2gxcs2U&quot;</span><span>
</span><span id="line-322"></span><span class="hs-comment">--      mJwt = decode input</span><span>
</span><span id="line-323"></span><span class="hs-comment">--  in fmap claims mJwt</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- Just (JWTClaimsSet {iss = Nothing, sub = Nothing, aud = Nothing, exp = Nothing, nbf = Nothing, iat = Nothing, jti = Nothing, unregisteredClaims = ClaimsMap {unClaimsMap = fromList [(&quot;some&quot;,String &quot;payload&quot;)]}})</span><span>
</span><span id="line-326"></span><span class="annot"><a href="Web.JWT.html#decode"><span class="hs-identifier hs-type">decode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="Web.JWT.html#UnverifiedJWT"><span class="hs-identifier hs-type">UnverifiedJWT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span id="decode"><span class="annot"><span class="annottext">decode :: Text -&gt; Maybe (JWT UnverifiedJWT)
</span><a href="Web.JWT.html#decode"><span class="hs-identifier hs-var hs-var">decode</span></a></span></span><span> </span><span id="local-6989586621679097128"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097128"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679097127"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097127"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679097126"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097126"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679097125"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097125"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {c}. [c] -&gt; Maybe (c, c, c)
</span><a href="#local-6989586621679097124"><span class="hs-identifier hs-var">extractElems</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.splitOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097128"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097122"><span class="annot"><span class="annottext">header' :: Maybe JWTHeader
</span><a href="#local-6989586621679097122"><span class="hs-identifier hs-var hs-var">header'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Text -&gt; Maybe a
</span><a href="Web.JWT.html#parseJWT"><span class="hs-identifier hs-var">parseJWT</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097127"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621679097120"><span class="annot"><span class="annottext">claims' :: Maybe JWTClaimsSet
</span><a href="#local-6989586621679097120"><span class="hs-identifier hs-var hs-var">claims'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Text -&gt; Maybe a
</span><a href="Web.JWT.html#parseJWT"><span class="hs-identifier hs-var">parseJWT</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097126"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">JWTHeader -&gt; JWTClaimsSet -&gt; Signature -&gt; Text -&gt; JWT UnverifiedJWT
</span><a href="Web.JWT.html#Unverified"><span class="hs-identifier hs-var">Unverified</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe JWTHeader
</span><a href="#local-6989586621679097122"><span class="hs-identifier hs-var">header'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe JWTClaimsSet
</span><a href="#local-6989586621679097120"><span class="hs-identifier hs-var">claims'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Signature
</span><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097125"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><a href="Web.JWT.html#dotted"><span class="hs-identifier hs-var">dotted</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097127"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097126"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>        </span><span id="local-6989586621679097124"><span class="annot"><span class="annottext">extractElems :: [c] -&gt; Maybe (c, c, c)
</span><a href="#local-6989586621679097124"><span class="hs-identifier hs-var hs-var">extractElems</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097117"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679097117"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679097116"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679097116"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679097115"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679097115"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679097117"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679097116"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679097115"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><a href="#local-6989586621679097124"><span class="hs-identifier hs-var">extractElems</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | Using a known secret and a decoded claims set verify that the signature is correct</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- and return a verified JWT token as a result.</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- This will return a VerifiedJWT if and only if the signature can be verified using the</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- given secret.</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- The separation between decode and verify is very useful if you are communicating with</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- multiple different services with different secrets and it allows you to lookup the</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- correct secret for the unverified JWT before trying to verify it. If this is not an</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- isuse for you (there will only ever be one secret) then you should just use</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- 'decodeAndVerifySignature'.</span><span>
</span><span id="line-347"></span><span class="hs-comment">--</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-349"></span><span class="hs-comment">--  let</span><span>
</span><span id="line-350"></span><span class="hs-comment">--      input = T.pack &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzb21lIjoicGF5bG9hZCJ9.Joh1R2dYzkRvDkqv3sygm5YyK8Gi4ShZqbhK2gxcs2U&quot;</span><span>
</span><span id="line-351"></span><span class="hs-comment">--      mUnverifiedJwt = decode input</span><span>
</span><span id="line-352"></span><span class="hs-comment">--      mVerifiedJwt = verify (toVerify . hmacSecret . T.pack $ &quot;secret&quot;) =&lt;&lt; mUnverifiedJwt</span><span>
</span><span id="line-353"></span><span class="hs-comment">--  in signature =&lt;&lt; mVerifiedJwt</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- Just (Signature &quot;Joh1R2dYzkRvDkqv3sygm5YyK8Gi4ShZqbhK2gxcs2U&quot;)</span><span>
</span><span id="line-356"></span><span class="annot"><a href="Web.JWT.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#VerifySigner"><span class="hs-identifier hs-type">VerifySigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="Web.JWT.html#UnverifiedJWT"><span class="hs-identifier hs-type">UnverifiedJWT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="Web.JWT.html#VerifiedJWT"><span class="hs-identifier hs-type">VerifiedJWT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span id="verify"><span class="annot"><span class="annottext">verify :: VerifySigner -&gt; JWT UnverifiedJWT -&gt; Maybe (JWT VerifiedJWT)
</span><a href="Web.JWT.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span id="local-6989586621679097114"><span class="annot"><span class="annottext">VerifySigner
</span><a href="#local-6989586621679097114"><span class="hs-identifier hs-var">signer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Unverified"><span class="hs-identifier hs-type">Unverified</span></a></span><span> </span><span id="local-6989586621679097109"><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097109"><span class="hs-identifier hs-var">header'</span></a></span></span><span> </span><span id="local-6989586621679097108"><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097108"><span class="hs-identifier hs-var">claims'</span></a></span></span><span> </span><span id="local-6989586621679097107"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097107"><span class="hs-identifier hs-var">unverifiedSignature</span></a></span></span><span> </span><span id="local-6989586621679097106"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097106"><span class="hs-identifier hs-var">originalClaim</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>   </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerifySigner -&gt; Signature -&gt; Text -&gt; Bool
</span><a href="Web.JWT.html#verifyDigest"><span class="hs-identifier hs-var">verifyDigest</span></a></span><span> </span><span class="annot"><span class="annottext">VerifySigner
</span><a href="#local-6989586621679097114"><span class="hs-identifier hs-var">signer</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097107"><span class="hs-identifier hs-var">unverifiedSignature</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097106"><span class="hs-identifier hs-var">originalClaim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>   </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">JWTHeader -&gt; JWTClaimsSet -&gt; Signature -&gt; JWT VerifiedJWT
</span><a href="Web.JWT.html#Verified"><span class="hs-identifier hs-var">Verified</span></a></span><span> </span><span class="annot"><span class="annottext">JWTHeader
</span><a href="#local-6989586621679097109"><span class="hs-identifier hs-var">header'</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097108"><span class="hs-identifier hs-var">claims'</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097107"><span class="hs-identifier hs-var">unverifiedSignature</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- | Decode a claims set and verify that the signature matches by using the supplied secret.</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- The algorithm is based on the supplied header value.</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- This will return a VerifiedJWT if and only if the signature can be verified</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- using the given secret.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-368"></span><span class="hs-comment">--  let</span><span>
</span><span id="line-369"></span><span class="hs-comment">--      input = T.pack &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzb21lIjoicGF5bG9hZCJ9.Joh1R2dYzkRvDkqv3sygm5YyK8Gi4ShZqbhK2gxcs2U&quot;</span><span>
</span><span id="line-370"></span><span class="hs-comment">--      mJwt = decodeAndVerifySignature (toVerify . hmacSecret . T.pack $ &quot;secret&quot;) input</span><span>
</span><span id="line-371"></span><span class="hs-comment">--  in signature =&lt;&lt; mJwt</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- Just (Signature &quot;Joh1R2dYzkRvDkqv3sygm5YyK8Gi4ShZqbhK2gxcs2U&quot;)</span><span>
</span><span id="line-374"></span><span class="annot"><a href="Web.JWT.html#decodeAndVerifySignature"><span class="hs-identifier hs-type">decodeAndVerifySignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#VerifySigner"><span class="hs-identifier hs-type">VerifySigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#JWT"><span class="hs-identifier hs-type">JWT</span></a></span><span> </span><span class="annot"><a href="Web.JWT.html#VerifiedJWT"><span class="hs-identifier hs-type">VerifiedJWT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span id="decodeAndVerifySignature"><span class="annot"><span class="annottext">decodeAndVerifySignature :: VerifySigner -&gt; Text -&gt; Maybe (JWT VerifiedJWT)
</span><a href="Web.JWT.html#decodeAndVerifySignature"><span class="hs-identifier hs-var hs-var">decodeAndVerifySignature</span></a></span></span><span> </span><span id="local-6989586621679097104"><span class="annot"><span class="annottext">VerifySigner
</span><a href="#local-6989586621679097104"><span class="hs-identifier hs-var">signer</span></a></span></span><span> </span><span id="local-6989586621679097103"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097103"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerifySigner -&gt; JWT UnverifiedJWT -&gt; Maybe (JWT VerifiedJWT)
</span><a href="Web.JWT.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">VerifySigner
</span><a href="#local-6989586621679097104"><span class="hs-identifier hs-var">signer</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (JWT UnverifiedJWT)
</span><a href="Web.JWT.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097103"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | Try to extract the value for the issue claim field 'iss' from the web token in JSON form</span><span>
</span><span id="line-378"></span><span class="annot"><a href="Web.JWT.html#tokenIssuer"><span class="hs-identifier hs-type">tokenIssuer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-379"></span><span id="tokenIssuer"><span class="annot"><span class="annottext">tokenIssuer :: Text -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#tokenIssuer"><span class="hs-identifier hs-var hs-var">tokenIssuer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (JWT UnverifiedJWT)
</span><a href="Web.JWT.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall r. JWT r -&gt; JWTClaimsSet
</span><a href="Web.JWT.html#claims"><span class="hs-identifier hs-var">claims</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#iss"><span class="hs-identifier hs-var">iss</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Create a Secret using the given key.</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- Consider using `HMACSecret` instead if your key is not already a &quot;Data.Text&quot;.</span><span>
</span><span id="line-383"></span><span class="annot"><a href="Web.JWT.html#hmacSecret"><span class="hs-identifier hs-type">hmacSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier hs-type">EncodeSigner</span></a></span><span>
</span><span id="line-384"></span><span id="hmacSecret"><span class="annot"><span class="annottext">hmacSecret :: Text -&gt; EncodeSigner
</span><a href="Web.JWT.html#hmacSecret"><span class="hs-identifier hs-var hs-var">hmacSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; EncodeSigner
</span><a href="Web.JWT.html#EncodeHMACSecret"><span class="hs-identifier hs-var">EncodeHMACSecret</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Converts an EncodeSigner into a VerifySigner</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- If you can encode then you can always verify; but the reverse is not always true.</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Web.JWT.html#toVerify"><span class="hs-identifier hs-type">toVerify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier hs-type">EncodeSigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#VerifySigner"><span class="hs-identifier hs-type">VerifySigner</span></a></span><span>
</span><span id="line-389"></span><span id="toVerify"><span class="annot"><span class="annottext">toVerify :: EncodeSigner -&gt; VerifySigner
</span><a href="Web.JWT.html#toVerify"><span class="hs-identifier hs-var hs-var">toVerify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#EncodeHMACSecret"><span class="hs-identifier hs-type">EncodeHMACSecret</span></a></span><span> </span><span id="local-6989586621679097099"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097099"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; VerifySigner
</span><a href="Web.JWT.html#VerifyHMACSecret"><span class="hs-identifier hs-var">VerifyHMACSecret</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097099"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Web.JWT.html#toVerify"><span class="hs-identifier hs-var">toVerify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#EncodeRSAPrivateKey"><span class="hs-identifier hs-type">EncodeRSAPrivateKey</span></a></span><span> </span><span id="local-6989586621679097098"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097098"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; VerifySigner
</span><a href="Web.JWT.html#VerifyRSAPrivateKey"><span class="hs-identifier hs-var">VerifyRSAPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097098"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- | Create an RSAPrivateKey from PEM contents</span><span>
</span><span id="line-393"></span><span class="hs-comment">--</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- Please, consider using 'readRsaSecret' instead.</span><span>
</span><span id="line-395"></span><span class="annot"><a href="Web.JWT.html#rsaKeySecret"><span class="hs-identifier hs-type">rsaKeySecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier hs-type">EncodeSigner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span id="rsaKeySecret"><span class="annot"><span class="annottext">rsaKeySecret :: String -&gt; IO (Maybe EncodeSigner)
</span><a href="Web.JWT.html#rsaKeySecret"><span class="hs-identifier hs-var hs-var">rsaKeySecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; EncodeSigner
</span><a href="Web.JWT.html#EncodeRSAPrivateKey"><span class="hs-identifier hs-var">EncodeRSAPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe PrivateKey
</span><a href="Web.JWT.html#readRsaSecret"><span class="hs-identifier hs-var">readRsaSecret</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">C8.pack</span></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | Create an RSA 'PrivateKey' from PEM contents</span><span>
</span><span id="line-399"></span><span class="hs-comment">--</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- &gt; readRsaSecret &lt;$&gt; BS.readFile &quot;foo.pem&quot;</span><span>
</span><span id="line-401"></span><span class="hs-comment">--</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-403"></span><span class="hs-comment">--   -- A random example key created with `ssh-keygen -t rsa`</span><span>
</span><span id="line-404"></span><span class="hs-comment">--   fromJust . readRsaSecret . C8.pack $ unlines</span><span>
</span><span id="line-405"></span><span class="hs-comment">--       [ &quot;-----BEGIN RSA PRIVATE KEY-----&quot;</span><span>
</span><span id="line-406"></span><span class="hs-comment">--       , &quot;MIIEowIBAAKCAQEAkkmgbLluo5HommstpHr1h53uWfuN3CwYYYR6I6a2MzAHIMIv&quot;</span><span>
</span><span id="line-407"></span><span class="hs-comment">--       , &quot;8Ak2ha+N2UDeYsfVhZ/DOnE+PMm2RpYSaiYT0l2a7ZkmRSbcyvVFt3XLePJbmUgo&quot;</span><span>
</span><span id="line-408"></span><span class="hs-comment">--       , &quot;ieyccS4uYHeqRggdWH9His3JaR2N71N9iU0+mY5nu2+15iYw3naT/PSx01IzBqHN&quot;</span><span>
</span><span id="line-409"></span><span class="hs-comment">--       , &quot;Zie1z3FYX09FgOs31mcR8VWj8DefxbKE08AW+vDMT2AmUC2b+Gqk6SqRz29HuPBs&quot;</span><span>
</span><span id="line-410"></span><span class="hs-comment">--       , &quot;yyV4Xl9CgzcCWjuXTv6mevDygo5RVZg34U6L1iFRgwwHbrLcd2N97wlKz+OiDSgM&quot;</span><span>
</span><span id="line-411"></span><span class="hs-comment">--       , &quot;sbZWA0i2D9ZsDR9rdEdXzUIw6toIRYZfeI9QYQIDAQABAoIBAEXkh5Fqx0G/ZLLi&quot;</span><span>
</span><span id="line-412"></span><span class="hs-comment">--       , &quot;olwDo2u4OTkkxxJ6vutYsEJ4VHUAbWdpYB3/SN12kv9JzvbDI3FEc7JoiKPifAQd&quot;</span><span>
</span><span id="line-413"></span><span class="hs-comment">--       , &quot;j47HwpCvyGXc1jwT5UnTBgwxa5XNtZX2s+ex9Mzek6njgqcTGXI+3Z+j0qc2R6og&quot;</span><span>
</span><span id="line-414"></span><span class="hs-comment">--       , &quot;6cm/7jjPoSAcr3vWo2KmpO4muw+LbYoSGo0Jydoa5cGtkmDfsjjrMw7mDoRttdhw&quot;</span><span>
</span><span id="line-415"></span><span class="hs-comment">--       , &quot;WdhS+q2aJPFI7q7itoYUd7KLe3nOeM0zd35Pc8Qc6jGk+JZxQdXrb/NrSNgAATcN&quot;</span><span>
</span><span id="line-416"></span><span class="hs-comment">--       , &quot;GGS226Q444N0pAfc188IDcAtQPSJpzbs/1+TPzE4ov/lpHTr91hXr3RLyVgYBI01&quot;</span><span>
</span><span id="line-417"></span><span class="hs-comment">--       , &quot;jrggfAECgYEAwaC4iDSZQ+8eUx/zR973Lu9mvQxC2BZn6QcOtBcIRBdGRlXfhwuD&quot;</span><span>
</span><span id="line-418"></span><span class="hs-comment">--       , &quot;UgwVZ2M3atH5ZXFuQ7pRtJtj7KCFy7HUFAJC15RCfLjx+n39bISNp5NOJEdI+UM+&quot;</span><span>
</span><span id="line-419"></span><span class="hs-comment">--       , &quot;G2xMHv5ywkULV7Jxb+tSgsYIvJ0tBjACkif8ahNjgVJmgMSOgdHR2pkCgYEAwWkN&quot;</span><span>
</span><span id="line-420"></span><span class="hs-comment">--       , &quot;uquRqKekx4gx1gJYV7Y6tPWcsZpEcgSS7AGNJ4UuGZGGHdStpUoJICn2cFUngYNz&quot;</span><span>
</span><span id="line-421"></span><span class="hs-comment">--       , &quot;eJXOg+VhQJMqQx9c+u85mg/tJluGaw95tBAafspwvhKewlO9OhQeVInPbXMUwrJ0&quot;</span><span>
</span><span id="line-422"></span><span class="hs-comment">--       , &quot;PS3XV7c74nxm6Nn4QHlM07orn3lOiWxZF8BBSQkCgYATjwSU3ZtNvW22v9d3PxKA&quot;</span><span>
</span><span id="line-423"></span><span class="hs-comment">--       , &quot;7zXVitOFuF2usEPP9TOkjSVQHYSCw6r0MrxGwULry2IB2T9mH//42mlxkZVySfg+&quot;</span><span>
</span><span id="line-424"></span><span class="hs-comment">--       , &quot;PSw7UoKUzqnCv89Fku4sKzkNeRXp99ziMEJQLyuwbAEFTsUepQqkoxRm2QmfQmJA&quot;</span><span>
</span><span id="line-425"></span><span class="hs-comment">--       , &quot;GUHqBSNcANLR1wj+HA+yoQKBgQCBlqj7RQ+AaGsQwiFaGhIlGtU1AEgv+4QWvRfQ&quot;</span><span>
</span><span id="line-426"></span><span class="hs-comment">--       , &quot;B64TJ7neqdGp1SFP2U5J/bPASl4A+hl5Vy6a0ysZQEGV3cLH41e98SPdin+C5kiO&quot;</span><span>
</span><span id="line-427"></span><span class="hs-comment">--       , &quot;LCgEghGOWR2EaOUlr+sui3OvCueDGFynzTo27G+0bdPp+nnKgTvHtTqbTIUhsLX1&quot;</span><span>
</span><span id="line-428"></span><span class="hs-comment">--       , &quot;IvzbOQKBgH4q36jgBb9T3hjXtWyrytlmFtBdw0i+UiMvMlnOqujGhcnOk5UMyxOQ&quot;</span><span>
</span><span id="line-429"></span><span class="hs-comment">--       , &quot;sQI+/31jIGbmlE7YaYykR1FH3LzAjO4J1+m7vv5fIRdG8+sI01xTc8UAdbmWtK+5&quot;</span><span>
</span><span id="line-430"></span><span class="hs-comment">--       , &quot;TK1oLP43BHH5gRAfIlXj2qmap5lEG6If/xYB4MOs8Bui5iKaJlM5&quot;</span><span>
</span><span id="line-431"></span><span class="hs-comment">--       , &quot;-----END RSA PRIVATE KEY-----&quot;</span><span>
</span><span id="line-432"></span><span class="hs-comment">--       ]</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- PrivateKey {private_pub = PublicKey {public_size = 256, public_n = 1846..., public_e = 65537}, private_d = 8823..., private_p = 135..., private_q = 1358..., private_dP = 1373..., private_dQ = 9100..., private_qinv = 8859...}</span><span>
</span><span id="line-435"></span><span class="hs-comment">--</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Web.JWT.html#readRsaSecret"><span class="hs-identifier hs-type">readRsaSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateKey</span></span><span>
</span><span id="line-437"></span><span id="readRsaSecret"><span class="annot"><span class="annottext">readRsaSecret :: ByteString -&gt; Maybe PrivateKey
</span><a href="Web.JWT.html#readRsaSecret"><span class="hs-identifier hs-var hs-var">readRsaSecret</span></a></span></span><span> </span><span id="local-6989586621679097096"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097096"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [PrivKey]
</span><span class="hs-identifier hs-var">readKeyFileFromMemory</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097096"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-439"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyRSA</span></span><span> </span><span id="local-6989586621679097095"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097095"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097095"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="annottext">[PrivKey]
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Create an RSA 'PublicKey' from PEM contents</span><span>
</span><span id="line-444"></span><span class="hs-comment">--</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- &gt; readRsaPublicKey &lt;$&gt; BS.readFile &quot;foo.pub&quot;</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-447"></span><span class="hs-comment">--   fromJust . readRsaPublicKey . Data.ByteString.Char8.pack $ Data.List.unlines</span><span>
</span><span id="line-448"></span><span class="hs-comment">--       [ &quot;-----BEGIN PUBLIC KEY-----&quot;</span><span>
</span><span id="line-449"></span><span class="hs-comment">--       , &quot;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA12d4M6f3QQ9E52fVjoJ7&quot;</span><span>
</span><span id="line-450"></span><span class="hs-comment">--       , &quot;HorKvi1A83f4YL4e7TU0Lj/73+afrRBtnAdl8dIrnYHLWRdL9T4+yw7+AimQgj1R&quot;</span><span>
</span><span id="line-451"></span><span class="hs-comment">--       , &quot;zZO5FQN/qVxygkPeMKAZ53nObi2NyBbQYmRrBjx7rOz7UddI5qo/ApTWNrSBjDKK&quot;</span><span>
</span><span id="line-452"></span><span class="hs-comment">--       , &quot;1splbuO2BoTrsHlsSoJDWps/5SwpEF4GGkn5c4nZRnpnayUZqolp+HwDK2Dys9MO&quot;</span><span>
</span><span id="line-453"></span><span class="hs-comment">--       , &quot;GEIsUil1+k/76T96pBnPf6mf3X0IacTCNjJcztSaHCPWre1q45miQUGVlTmhfg/6&quot;</span><span>
</span><span id="line-454"></span><span class="hs-comment">--       , &quot;L8xmNRxz4BZdv8Nv6STfRTsn6PqiaabD0vITVsF1AapdHohmPMwe+lG5ebUJEh8p&quot;</span><span>
</span><span id="line-455"></span><span class="hs-comment">--       , &quot;HQIDAQAB&quot;</span><span>
</span><span id="line-456"></span><span class="hs-comment">--       , &quot;-----END PUBLIC KEY-----&quot;</span><span>
</span><span id="line-457"></span><span class="hs-comment">--       ]</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- PublicKey {public_size = 256, public_n = 27192258298637073499814714121384917708820189127612408586659742012541332375187297990620494295383503839337630959589643433993051132285579261506578281787130221431792495554016841577295914249477128682873612830754668313951998800261326356221445367133271958375798088350587817966390021082924122322621635687775325677158394714044356852489350530339926527334843762933075425870780010358838296108179073735084189560997222261973170469403371017667139302904425235800700389626242339763391588052694912470921008842459564204534000688115202764921141372629345213727775126077560633656612484128950350759146471467728292335666402631045889956718877, public_e = 65537}</span><span>
</span><span id="line-460"></span><span class="annot"><a href="Web.JWT.html#readRsaPublicKey"><span class="hs-identifier hs-type">readRsaPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicKey</span></span><span>
</span><span id="line-461"></span><span id="readRsaPublicKey"><span class="annot"><span class="annottext">readRsaPublicKey :: ByteString -&gt; Maybe PublicKey
</span><a href="Web.JWT.html#readRsaPublicKey"><span class="hs-identifier hs-var hs-var">readRsaPublicKey</span></a></span></span><span> </span><span id="local-6989586621679097094"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097094"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [PubKey]
</span><span class="hs-identifier hs-var">readPubKeyFileFromMemory</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097094"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-463"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span> </span><span id="local-6989586621679097093"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679097093"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679097093"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-464"></span><span>          </span><span class="annot"><span class="annottext">[PubKey]
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Convert the `NominalDiffTime` into an IntDate. Returns a Nothing if the</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- argument is invalid (e.g. the NominalDiffTime must be convertible into a</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- positive Integer representing the seconds since epoch).</span><span>
</span><span id="line-469"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">intDate</span><span> </span><span class="hs-pragma">&quot;Use numericDate instead. intDate will be removed in 1.0&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-470"></span><span class="annot"><a href="Web.JWT.html#intDate"><span class="hs-identifier hs-type">intDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#IntDate"><span class="hs-identifier hs-type">IntDate</span></a></span><span>
</span><span id="line-471"></span><span id="intDate"><span class="annot"><span class="annottext">intDate :: NominalDiffTime -&gt; Maybe NumericDate
</span><a href="Web.JWT.html#intDate"><span class="hs-identifier hs-var hs-var">intDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Maybe NumericDate
</span><a href="Web.JWT.html#numericDate"><span class="hs-identifier hs-var">numericDate</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Convert the `NominalDiffTime` into an NumericDate. Returns a Nothing if the</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- argument is invalid (e.g. the NominalDiffTime must be convertible into a</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- positive Integer representing the seconds since epoch).</span><span>
</span><span id="line-476"></span><span class="annot"><a href="Web.JWT.html#numericDate"><span class="hs-identifier hs-type">numericDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span>
</span><span id="line-477"></span><span id="numericDate"><span class="annot"><span class="annottext">numericDate :: NominalDiffTime -&gt; Maybe NumericDate
</span><a href="Web.JWT.html#numericDate"><span class="hs-identifier hs-var hs-var">numericDate</span></a></span></span><span> </span><span id="local-6989586621679097092"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679097092"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679097092"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-478"></span><span class="annot"><a href="Web.JWT.html#numericDate"><span class="hs-identifier hs-var">numericDate</span></a></span><span> </span><span id="local-6989586621679097090"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679097090"><span class="hs-identifier hs-var">i</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; NumericDate
</span><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679097090"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | Convert a `T.Text` into a 'StringOrURI`. Returns a Nothing if the</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- String cannot be converted (e.g. if the String contains a ':' but is</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- *not* a valid URI).</span><span>
</span><span id="line-483"></span><span class="annot"><a href="Web.JWT.html#stringOrURI"><span class="hs-identifier hs-type">stringOrURI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span>
</span><span id="line-484"></span><span id="stringOrURI"><span class="annot"><span class="annottext">stringOrURI :: Text -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#stringOrURI"><span class="hs-identifier hs-var hs-var">stringOrURI</span></a></span></span><span> </span><span id="local-6989586621679097088"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097088"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><span class="hs-identifier hs-var">URI.isURI</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097088"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">URI -&gt; StringOrURI
</span><a href="Web.JWT.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe URI
</span><span class="hs-identifier hs-var">URI.parseURI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097088"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span class="annot"><a href="Web.JWT.html#stringOrURI"><span class="hs-identifier hs-var">stringOrURI</span></a></span><span> </span><span id="local-6989586621679097085"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097085"><span class="hs-identifier hs-var">t</span></a></span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; StringOrURI
</span><a href="Web.JWT.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097085"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- | Convert a `StringOrURI` into a `T.Text`. Returns the T.Text</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- representing the String as-is or a Text representation of the URI</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- otherwise.</span><span>
</span><span id="line-491"></span><span class="annot"><a href="Web.JWT.html#stringOrURIToText"><span class="hs-identifier hs-type">stringOrURIToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-492"></span><span id="stringOrURIToText"><span class="annot"><span class="annottext">stringOrURIToText :: StringOrURI -&gt; Text
</span><a href="Web.JWT.html#stringOrURIToText"><span class="hs-identifier hs-var hs-var">stringOrURIToText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679097084"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097084"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097084"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Web.JWT.html#stringOrURIToText"><span class="hs-identifier hs-var">stringOrURIToText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#U"><span class="hs-identifier hs-type">U</span></a></span><span> </span><span id="local-6989586621679097083"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679097083"><span class="hs-identifier hs-var">uri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; URI -&gt; ShowS
</span><span class="hs-identifier hs-var">URI.uriToString</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679097083"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | Convert the `aud` claim in a `JWTClaimsSet` into a `[StringOrURI]`</span><span>
</span><span id="line-496"></span><span class="annot"><a href="Web.JWT.html#auds"><span class="hs-identifier hs-type">auds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-497"></span><span id="auds"><span class="annot"><span class="annottext">auds :: JWTClaimsSet -&gt; [StringOrURI]
</span><a href="Web.JWT.html#auds"><span class="hs-identifier hs-var hs-var">auds</span></a></span></span><span> </span><span id="local-6989586621679097079"><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097079"><span class="hs-identifier hs-var">jwt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe (Either StringOrURI [StringOrURI])
</span><a href="Web.JWT.html#aud"><span class="hs-identifier hs-var">aud</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679097079"><span class="hs-identifier hs-var">jwt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679097078"><span class="annot"><span class="annottext">StringOrURI
</span><a href="#local-6989586621679097078"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StringOrURI
</span><a href="#local-6989586621679097078"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679097077"><span class="annot"><span class="annottext">[StringOrURI]
</span><a href="#local-6989586621679097077"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[StringOrURI]
</span><a href="#local-6989586621679097077"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="local-6989586621679097728"><span class="annot"><a href="Web.JWT.html#encodeJWT"><span class="hs-identifier hs-type">encodeJWT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679097728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span><span>
</span><span id="line-505"></span><span id="encodeJWT"><span class="annot"><span class="annottext">encodeJWT :: forall a. ToJSON a =&gt; a -&gt; Text
</span><a href="Web.JWT.html#encodeJWT"><span class="hs-identifier hs-var hs-var">encodeJWT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; bout
</span><span class="hs-identifier hs-var">convertToBase</span></span><span> </span><span class="annot"><span class="annottext">Base
</span><span class="hs-identifier hs-var">Base64URLUnpadded</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">JSON.encode</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span id="local-6989586621679097725"><span class="annot"><a href="Web.JWT.html#parseJWT"><span class="hs-identifier hs-type">parseJWT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679097725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679097725"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-508"></span><span id="parseJWT"><span class="annot"><span class="annottext">parseJWT :: forall a. FromJSON a =&gt; Text -&gt; Maybe a
</span><a href="Web.JWT.html#parseJWT"><span class="hs-identifier hs-var hs-var">parseJWT</span></a></span></span><span> </span><span id="local-6989586621679097065"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097065"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; Either String bout
</span><span class="hs-identifier hs-var">convertFromBase</span></span><span> </span><span class="annot"><span class="annottext">Base
</span><span class="hs-identifier hs-var">Base64URLUnpadded</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097065"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-509"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-510"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679097063"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097063"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">JSON.decode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097063"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="annot"><a href="Web.JWT.html#dotted"><span class="hs-identifier hs-type">dotted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-513"></span><span id="dotted"><span class="annot"><span class="annottext">dotted :: [Text] -&gt; Text
</span><a href="Web.JWT.html#dotted"><span class="hs-identifier hs-var hs-var">dotted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="annot"><a href="Web.JWT.html#calculateDigest"><span class="hs-identifier hs-type">calculateDigest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#EncodeSigner"><span class="hs-identifier hs-type">EncodeSigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-519"></span><span id="calculateDigest"><span class="annot"><span class="annottext">calculateDigest :: EncodeSigner -&gt; Text -&gt; Text
</span><a href="Web.JWT.html#calculateDigest"><span class="hs-identifier hs-var hs-var">calculateDigest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#EncodeHMACSecret"><span class="hs-identifier hs-type">EncodeHMACSecret</span></a></span><span> </span><span id="local-6989586621679097061"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097061"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097060"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097060"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; bout
</span><span class="hs-identifier hs-var">convertToBase</span></span><span> </span><span class="annot"><span class="annottext">Base
</span><span class="hs-identifier hs-var">Base64URLUnpadded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">hmac</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097061"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097060"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="annot"><a href="Web.JWT.html#calculateDigest"><span class="hs-identifier hs-var">calculateDigest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#EncodeRSAPrivateKey"><span class="hs-identifier hs-type">EncodeRSAPrivateKey</span></a></span><span> </span><span id="local-6989586621679097058"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097058"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097057"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097057"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; bout
</span><span class="hs-identifier hs-var">convertToBase</span></span><span> </span><span class="annot"><span class="annottext">Base
</span><span class="hs-identifier hs-var">Base64URLUnpadded</span></span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679097056"><span class="hs-identifier hs-var">sign'</span></a></span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097057"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><a href="#local-6989586621679097056"><span class="hs-identifier hs-type">sign'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621679097056"><span class="annot"><span class="annottext">sign' :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679097056"><span class="hs-identifier hs-var hs-var">sign'</span></a></span></span><span> </span><span id="local-6989586621679097055"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097055"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe Blinder
-&gt; Maybe hashAlg
-&gt; PrivateKey
-&gt; ByteString
-&gt; Either Error ByteString
</span><span class="hs-identifier hs-var">RSA.sign</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">SHA256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097058"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097055"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-529"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679097052"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097052"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097052"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-530"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="annot"><span class="annottext">Error
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>  </span><span class="hs-comment">-- This function can only fail with @SignatureTooLong@,</span><span>
</span><span id="line-531"></span><span>                                         </span><span class="hs-comment">-- which is impossible because we use a hash.</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="annot"><a href="Web.JWT.html#verifyDigest"><span class="hs-identifier hs-type">verifyDigest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#VerifySigner"><span class="hs-identifier hs-type">VerifySigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-534"></span><span id="verifyDigest"><span class="annot"><span class="annottext">verifyDigest :: VerifySigner -&gt; Signature -&gt; Text -&gt; Bool
</span><a href="Web.JWT.html#verifyDigest"><span class="hs-identifier hs-var hs-var">verifyDigest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#VerifyHMACSecret"><span class="hs-identifier hs-type">VerifyHMACSecret</span></a></span><span> </span><span id="local-6989586621679097050"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097050"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097049"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097049"><span class="hs-identifier hs-var">unverifiedSig</span></a></span></span><span> </span><span id="local-6989586621679097048"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097048"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097049"><span class="hs-identifier hs-var">unverifiedSig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Signature
</span><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncodeSigner -&gt; Text -&gt; Text
</span><a href="Web.JWT.html#calculateDigest"><span class="hs-identifier hs-var">calculateDigest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; EncodeSigner
</span><a href="Web.JWT.html#EncodeHMACSecret"><span class="hs-identifier hs-var">EncodeHMACSecret</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679097050"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097048"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span class="annot"><a href="Web.JWT.html#verifyDigest"><span class="hs-identifier hs-var">verifyDigest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#VerifyRSAPrivateKey"><span class="hs-identifier hs-type">VerifyRSAPrivateKey</span></a></span><span> </span><span id="local-6989586621679097047"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097047"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097046"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097046"><span class="hs-identifier hs-var">unverifiedSig</span></a></span></span><span> </span><span id="local-6989586621679097045"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097045"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679097046"><span class="hs-identifier hs-var">unverifiedSig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Signature
</span><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncodeSigner -&gt; Text -&gt; Text
</span><a href="Web.JWT.html#calculateDigest"><span class="hs-identifier hs-var">calculateDigest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; EncodeSigner
</span><a href="Web.JWT.html#EncodeRSAPrivateKey"><span class="hs-identifier hs-var">EncodeRSAPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679097047"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097045"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span class="annot"><a href="Web.JWT.html#verifyDigest"><span class="hs-identifier hs-var">verifyDigest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#VerifyRSAPublicKey"><span class="hs-identifier hs-type">VerifyRSAPublicKey</span></a></span><span> </span><span id="local-6989586621679097044"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679097044"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679097043"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097043"><span class="hs-identifier hs-var">base64Sig</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679097042"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097042"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679097041"><span class="annot"><span class="annottext">decodedSig :: Either String ByteString
</span><a href="#local-6989586621679097041"><span class="hs-identifier hs-var hs-var">decodedSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; Either String bout
</span><span class="hs-identifier hs-var">convertFromBase</span></span><span> </span><span class="annot"><span class="annottext">Base
</span><span class="hs-identifier hs-var">Base64URLUnpadded</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097043"><span class="hs-identifier hs-var">base64Sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">SHA256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679097044"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679097042"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String ByteString
</span><a href="#local-6989586621679097041"><span class="hs-identifier hs-var">decodedSig</span></a></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-comment">-- =================================================================================</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="hs-keyword">newtype</span><span> </span><span id="ClaimsMap"><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClaimsMap"><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unClaimsMap"><span class="annot"><span class="annottext">ClaimsMap -&gt; Map Text Value
</span><a href="Web.JWT.html#unClaimsMap"><span class="hs-identifier hs-var hs-var">unClaimsMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097029"><span id="local-6989586621679097036"><span class="annot"><span class="annottext">ClaimsMap -&gt; ClaimsMap -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ClaimsMap -&gt; ClaimsMap -&gt; Bool
$c/= :: ClaimsMap -&gt; ClaimsMap -&gt; Bool
== :: ClaimsMap -&gt; ClaimsMap -&gt; Bool
$c== :: ClaimsMap -&gt; ClaimsMap -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097013"><span id="local-6989586621679097015"><span id="local-6989586621679097022"><span class="annot"><span class="annottext">Int -&gt; ClaimsMap -&gt; ShowS
[ClaimsMap] -&gt; ShowS
ClaimsMap -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ClaimsMap] -&gt; ShowS
$cshowList :: [ClaimsMap] -&gt; ShowS
show :: ClaimsMap -&gt; String
$cshow :: ClaimsMap -&gt; String
showsPrec :: Int -&gt; ClaimsMap -&gt; ShowS
$cshowsPrec :: Int -&gt; ClaimsMap -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097006"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>  </span><span id="local-6989586621679097003"><span class="annot"><span class="annottext">mempty :: ClaimsMap
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><span class="annottext">Map Text Value -&gt; ClaimsMap
</span><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621679097001"><span class="annot"><span class="annottext">mappend :: ClaimsMap -&gt; ClaimsMap -&gt; ClaimsMap
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(Semigroup.&lt;&gt;)</span></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096996"><span id="local-6989586621679096998"><span class="annot"><span class="hs-identifier hs-type">Semigroup.Semigroup</span></span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span> </span><span id="local-6989586621679096993"><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096993"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679096992"><span class="annot"><span class="annottext">&lt;&gt; :: ClaimsMap -&gt; ClaimsMap -&gt; ClaimsMap
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span> </span><span id="local-6989586621679096991"><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096991"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="annottext">Map Text Value -&gt; ClaimsMap
</span><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096993"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">Semigroup.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096991"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="annot"><a href="Web.JWT.html#fromHashMap"><span class="hs-identifier hs-type">fromHashMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span>
</span><span id="line-558"></span><span id="fromHashMap"><span class="annot"><span class="annottext">fromHashMap :: Object -&gt; ClaimsMap
</span><a href="Web.JWT.html#fromHashMap"><span class="hs-identifier hs-var hs-var">fromHashMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text Value -&gt; ClaimsMap
</span><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="#local-6989586621679096988"><span class="hs-identifier hs-var">toText</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall v. KeyMap v -&gt; [(Key, v)]
</span><span class="hs-identifier hs-var">KeyMap.toList</span></span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if MIN_VERSION_aeson(2,0,0)
</span><span>    </span><span id="local-6989586621679096988"><span class="annot"><span class="annottext">toText :: Key -&gt; Text
</span><a href="#local-6989586621679096988"><span class="hs-identifier hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text
</span><span class="hs-identifier hs-var">Key.toText</span></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">toText</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-566"></span><span class="annot"><a href="Web.JWT.html#removeRegisteredClaims"><span class="hs-identifier hs-type">removeRegisteredClaims</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span>
</span><span id="line-567"></span><span id="removeRegisteredClaims"><span class="annot"><span class="annottext">removeRegisteredClaims :: ClaimsMap -&gt; ClaimsMap
</span><a href="Web.JWT.html#removeRegisteredClaims"><span class="hs-identifier hs-var hs-var">removeRegisteredClaims</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-type">ClaimsMap</span></a></span><span> </span><span id="local-6989586621679096984"><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096984"><span class="hs-identifier hs-var">input</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Text Value -&gt; ClaimsMap
</span><a href="Web.JWT.html#ClaimsMap"><span class="hs-identifier hs-var">ClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a b.
Ord k =&gt;
(k -&gt; a -&gt; b -&gt; Maybe a) -&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.differenceWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096984"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text Value
</span><a href="#local-6989586621679096982"><span class="hs-identifier hs-var">registeredClaims</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-569"></span><span>        </span><span id="local-6989586621679096982"><span class="annot"><span class="annottext">registeredClaims :: Map Text Value
</span><a href="#local-6989586621679096982"><span class="hs-identifier hs-var hs-var">registeredClaims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096973"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096973"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096973"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">Null</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iss&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sub&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;aud&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;exp&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;nbf&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;iat&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jti&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096965"><span id="local-6989586621679096967"><span id="local-6989586621679096969"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679096928"><span class="annot"><span class="annottext">toJSON :: JWTClaimsSet -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span><span class="hs-special">{</span><span id="local-6989586621679096919"><span id="local-6989586621679096920"><span id="local-6989586621679096921"><span id="local-6989586621679096922"><span id="local-6989586621679096923"><span id="local-6989586621679096924"><span id="local-6989586621679096925"><span id="local-6989586621679096926"><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
Maybe StringOrURI
Maybe NumericDate
ClaimsMap
unregisteredClaims :: ClaimsMap
jti :: Maybe StringOrURI
iat :: Maybe NumericDate
nbf :: Maybe NumericDate
exp :: Maybe NumericDate
aud :: Maybe (Either StringOrURI [StringOrURI])
sub :: Maybe StringOrURI
iss :: Maybe StringOrURI
unregisteredClaims :: JWTClaimsSet -&gt; ClaimsMap
jti :: JWTClaimsSet -&gt; Maybe StringOrURI
iat :: JWTClaimsSet -&gt; Maybe NumericDate
nbf :: JWTClaimsSet -&gt; Maybe NumericDate
exp :: JWTClaimsSet -&gt; Maybe NumericDate
aud :: JWTClaimsSet -&gt; Maybe (Either StringOrURI [StringOrURI])
sub :: JWTClaimsSet -&gt; Maybe StringOrURI
iss :: JWTClaimsSet -&gt; Maybe StringOrURI
</span><a href="#local-6989586621679096919"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-573"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;iss&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679096926"><span class="hs-identifier hs-var">iss</span></a></span><span>
</span><span id="line-574"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;sub&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679096925"><span class="hs-identifier hs-var">sub</span></a></span><span>
</span><span id="line-575"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;aud&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;aud&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either StringOrURI [StringOrURI])
</span><a href="#local-6989586621679096924"><span class="hs-identifier hs-var">aud</span></a></span><span>
</span><span id="line-576"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;exp&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679096923"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-577"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;nbf&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679096922"><span class="hs-identifier hs-var">nbf</span></a></span><span>
</span><span id="line-578"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;iat&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe NumericDate
</span><a href="#local-6989586621679096921"><span class="hs-identifier hs-var">iat</span></a></span><span>
</span><span id="line-579"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jti&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
</span><a href="#local-6989586621679096920"><span class="hs-identifier hs-var">jti</span></a></span><span>
</span><span id="line-580"></span><span>            </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="#local-6989586621679096915"><span class="hs-identifier hs-var">fromText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ClaimsMap -&gt; Map Text Value
</span><a href="Web.JWT.html#unClaimsMap"><span class="hs-identifier hs-var">unClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ClaimsMap -&gt; ClaimsMap
</span><a href="Web.JWT.html#removeRegisteredClaims"><span class="hs-identifier hs-var">removeRegisteredClaims</span></a></span><span> </span><span class="annot"><span class="annottext">ClaimsMap
</span><a href="#local-6989586621679096919"><span class="hs-identifier hs-var">unregisteredClaims</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if MIN_VERSION_aeson(2,0,0)
</span><span>        </span><span id="local-6989586621679096915"><span class="annot"><span class="annottext">fromText :: Text -&gt; Key
</span><a href="#local-6989586621679096915"><span class="hs-identifier hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><span class="hs-identifier hs-var">Key.fromText</span></span><span class="hs-cpp">
#else
</span><span>        </span><span class="hs-identifier">fromText</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-588"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096910"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-type">JWTClaimsSet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-589"></span><span>        </span><span id="local-6989586621679096877"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser JWTClaimsSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWTClaimsSet&quot;</span></span><span>
</span><span id="line-590"></span><span>                     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096874"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe StringOrURI
-&gt; Maybe StringOrURI
-&gt; Maybe (Either StringOrURI [StringOrURI])
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe NumericDate
-&gt; Maybe StringOrURI
-&gt; ClaimsMap
-&gt; JWTClaimsSet
</span><a href="Web.JWT.html#JWTClaimsSet"><span class="hs-identifier hs-var">JWTClaimsSet</span></a></span><span>
</span><span id="line-591"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;iss&quot;</span></span><span>
</span><span id="line-592"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;sub&quot;</span></span><span>
</span><span id="line-593"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall v. Key -&gt; KeyMap v -&gt; Maybe v
</span><span class="hs-identifier hs-var">KeyMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;aud&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-594"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679096871"><span class="annot"><span class="annottext">as :: Value
</span><a href="#local-6989586621679096871"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">JSON.Array</span></span><span> </span><span class="annot"><span class="annottext">Array
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679096871"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-595"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">JSON.String</span></span><span> </span><span id="local-6989586621679096868"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096868"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe StringOrURI
</span><a href="Web.JWT.html#stringOrURI"><span class="hs-identifier hs-var">stringOrURI</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096868"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-596"></span><span>                         </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier">_</span></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-597"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;exp&quot;</span></span><span>
</span><span id="line-598"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;nbf&quot;</span></span><span>
</span><span id="line-599"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;iat&quot;</span></span><span>
</span><span id="line-600"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jti&quot;</span></span><span>
</span><span id="line-601"></span><span>                     </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClaimsMap -&gt; ClaimsMap
</span><a href="Web.JWT.html#removeRegisteredClaims"><span class="hs-identifier hs-var">removeRegisteredClaims</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; ClaimsMap
</span><a href="Web.JWT.html#fromHashMap"><span class="hs-identifier hs-var">fromHashMap</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096874"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096865"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621679096851"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser JWTHeader
</span><a href="#local-6989586621679096851"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JOSEHeader&quot;</span></span><span>
</span><span id="line-605"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679096850"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; Maybe Text -&gt; Maybe Algorithm -&gt; Maybe Text -&gt; JWTHeader
</span><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-var">JOSEHeader</span></a></span><span>
</span><span id="line-606"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;typ&quot;</span></span><span>
</span><span id="line-607"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;cty&quot;</span></span><span>
</span><span id="line-608"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;alg&quot;</span></span><span>
</span><span id="line-609"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679096850"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;kid&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096843"><span id="local-6989586621679096845"><span id="local-6989586621679096847"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679096825"><span class="annot"><span class="annottext">toJSON :: JWTHeader -&gt; Value
</span><a href="#local-6989586621679096825"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><a href="Web.JWT.html#JOSEHeader"><span class="hs-identifier hs-type">JOSEHeader</span></a></span><span class="hs-special">{</span><span id="local-6989586621679096821"><span id="local-6989586621679096822"><span id="local-6989586621679096823"><span id="local-6989586621679096824"><span class="annot"><span class="annottext">Maybe Text
Maybe Algorithm
kid :: Maybe Text
alg :: Maybe Algorithm
cty :: Maybe Text
typ :: Maybe Text
kid :: JWTHeader -&gt; Maybe Text
alg :: JWTHeader -&gt; Maybe Algorithm
cty :: JWTHeader -&gt; Maybe Text
typ :: JWTHeader -&gt; Maybe Text
</span><a href="#local-6989586621679096821"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-613"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;typ&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679096824"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-614"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;cty&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679096823"><span class="hs-identifier hs-var">cty</span></a></span><span>
</span><span id="line-615"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;alg&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Algorithm
</span><a href="#local-6989586621679096822"><span class="hs-identifier hs-var">alg</span></a></span><span>
</span><span id="line-616"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;kid&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679096821"><span class="hs-identifier hs-var">kid</span></a></span><span>
</span><span id="line-617"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096814"><span id="local-6989586621679096816"><span id="local-6989586621679096818"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-620"></span><span>    </span><span id="local-6989586621679096810"><span class="annot"><span class="annottext">toJSON :: NumericDate -&gt; Value
</span><a href="#local-6989586621679096810"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span><span> </span><span id="local-6989586621679096809"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679096809"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><span class="hs-identifier hs-var">Number</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Scientific
</span><span class="hs-identifier hs-var">scientific</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679096809"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096804"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-type">NumericDate</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621679096799"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser NumericDate
</span><a href="#local-6989586621679096799"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Number</span></span><span> </span><span id="local-6989586621679096798"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679096798"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; NumericDate
</span><a href="Web.JWT.html#NumericDate"><span class="hs-identifier hs-var">NumericDate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Integer
</span><span class="hs-identifier hs-var">coefficient</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679096798"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-624"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096789"><span id="local-6989586621679096791"><span id="local-6989586621679096793"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#Algorithm"><span class="hs-identifier hs-type">Algorithm</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-627"></span><span>    </span><span id="local-6989586621679096786"><span class="annot"><span class="annottext">toJSON :: Algorithm -&gt; Value
</span><a href="#local-6989586621679096786"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#HS256"><span class="hs-identifier hs-var">HS256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;HS256&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#RS256"><span class="hs-identifier hs-var">RS256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;RS256&quot;</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096783"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#Algorithm"><span class="hs-identifier hs-type">Algorithm</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621679096775"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Algorithm
</span><a href="#local-6989586621679096775"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;HS256&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#HS256"><span class="hs-identifier hs-var">HS256</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;RS256&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Algorithm
</span><a href="Web.JWT.html#RS256"><span class="hs-identifier hs-var">RS256</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096768"><span id="local-6989586621679096770"><span id="local-6989586621679096772"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679096767"><span class="annot"><span class="annottext">toJSON :: StringOrURI -&gt; Value
</span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096766"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096766"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096766"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.JWT.html#U"><span class="hs-identifier hs-type">U</span></a></span><span> </span><span id="local-6989586621679096765"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679096765"><span class="hs-identifier hs-var">uri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; URI -&gt; ShowS
</span><span class="hs-identifier hs-var">URI.uriToString</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679096765"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679096762"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Web.JWT.html#StringOrURI"><span class="hs-identifier hs-type">StringOrURI</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679096758"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser StringOrURI
</span><a href="#local-6989586621679096758"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span id="local-6989586621679096757"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><span class="hs-identifier hs-var">URI.isURI</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">URI -&gt; StringOrURI
</span><a href="Web.JWT.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><span class="hs-identifier hs-var">URI.nullURI</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe URI
</span><span class="hs-identifier hs-var">URI.parseURI</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span id="local-6989586621679096754"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096754"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; StringOrURI
</span><a href="Web.JWT.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096754"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="hs-comment">-- $docDecoding</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- There are three use cases supported by the set of decoding/verification</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- functions:</span><span>
</span><span id="line-647"></span><span class="hs-comment">--</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- (1) Unsecured JWTs (&lt;http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-30#section-6&gt;).</span><span>
</span><span id="line-649"></span><span class="hs-comment">--      This is supported by the decode function 'decode'.</span><span>
</span><span id="line-650"></span><span class="hs-comment">--      As a client you don't care about signing or encrypting so you only get back a 'JWT' 'UnverifiedJWT'.</span><span>
</span><span id="line-651"></span><span class="hs-comment">--      I.e. the type makes it clear that no signature verification was attempted.</span><span>
</span><span id="line-652"></span><span class="hs-comment">--</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- (2) Signed JWTs you want to verify using a known secret.</span><span>
</span><span id="line-654"></span><span class="hs-comment">--      This is what 'decodeAndVerifySignature' supports, given a secret</span><span>
</span><span id="line-655"></span><span class="hs-comment">--      and JSON it will return a 'JWT' 'VerifiedJWT' if the signature can be</span><span>
</span><span id="line-656"></span><span class="hs-comment">--      verified.</span><span>
</span><span id="line-657"></span><span class="hs-comment">--</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- (3) Signed JWTs that need to be verified using a secret that depends on</span><span>
</span><span id="line-659"></span><span class="hs-comment">--      information contained in the JWT. E.g. the secret depends on</span><span>
</span><span id="line-660"></span><span class="hs-comment">--      some claim, therefore the JWT needs to be decoded first and after</span><span>
</span><span id="line-661"></span><span class="hs-comment">--      retrieving the appropriate secret value, verified in a subsequent step.</span><span>
</span><span id="line-662"></span><span class="hs-comment">--      This is supported by using the `verify` function which given</span><span>
</span><span id="line-663"></span><span class="hs-comment">--      a 'JWT' 'UnverifiedJWT' and a secret will return a 'JWT' 'VerifiedJWT' iff the</span><span>
</span><span id="line-664"></span><span class="hs-comment">--      signature can be verified.</span><span>
</span><span id="line-665"></span></pre></body></html>