<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (C) 2013, 2014, 2015, 2016, 2020  Fraser Tweedale</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- you may not use this file except in compliance with the License.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- You may obtain a copy of the License at</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">--      http://www.apache.org/licenses/LICENSE-2.0</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Unless required by applicable law or agreed to in writing, software</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- See the License for the specific language governing permissions and</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- limitations under the License.</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">{-|

JSON Web Signature (JWS) represents content secured with digital
signatures or Message Authentication Codes (MACs) using JavaScript
Object Notation (JSON) based data structures.  It is defined in
&lt;https://tools.ietf.org/html/rfc7515 RFC 7515&gt;.

@
doJwsSign :: 'JWK' -&gt; L.ByteString -&gt; IO (Either 'Error' ('GeneralJWS' 'JWSHeader'))
doJwsSign jwk payload = runExceptT $ do
  alg \&lt;- 'bestJWSAlg' jwk
  'signJWS' payload [('newJWSHeader' ('Protected', alg), jwk)]

doJwsVerify :: 'JWK' -&gt; 'GeneralJWS' 'JWSHeader' -&gt; IO (Either 'Error' ())
doJwsVerify jwk jws = runExceptT $ 'verifyJWS'' jwk jws
@

-}</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-35"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-36"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-37"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-38"></span><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds #-}</span><span>
</span><span id="line-39"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-40"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.JOSE.JWS</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Overview</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier">JWS</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#GeneralJWS"><span class="hs-identifier">GeneralJWS</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#FlattenedJWS"><span class="hs-identifier">FlattenedJWS</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#CompactJWS"><span class="hs-identifier">CompactJWS</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Defining additional header parameters</span></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-comment">-- $extending</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="hs-comment">-- * JWS creation</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#newJWSHeader"><span class="hs-identifier">newJWSHeader</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#makeJWSHeader"><span class="hs-identifier">makeJWSHeader</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#signJWS"><span class="hs-identifier">signJWS</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="hs-comment">-- * JWS verification</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWS"><span class="hs-identifier">verifyJWS</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWS%27"><span class="hs-identifier">verifyJWS'</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWSWithPayload"><span class="hs-identifier">verifyJWSWithPayload</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** JWS validation settings</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#defaultValidationSettings"><span class="hs-identifier">defaultValidationSettings</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier">ValidationSettings</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationPolicy"><span class="hs-identifier">ValidationPolicy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier">HasValidationSettings</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasAlgorithms"><span class="hs-identifier">HasAlgorithms</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationPolicy"><span class="hs-identifier">HasValidationPolicy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Signature data</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#signatures"><span class="hs-identifier">signatures</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier">Signature</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#header"><span class="hs-identifier">header</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#signature"><span class="hs-keyword">signature</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#rawProtectedHeader"><span class="hs-identifier">rawProtectedHeader</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="hs-comment">-- * JWS headers</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier">Alg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier">HasJWSHeader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier">JWSHeader</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html"><span class="hs-identifier">Crypto.JOSE.Error</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html"><span class="hs-identifier">Crypto.JOSE.Header</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html"><span class="hs-identifier">Crypto.JOSE.JWK</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens.Cons.Extras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">recons</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Error.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwing_</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.KeyMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Compact.html"><span class="hs-identifier">Crypto.JOSE.Compact</span></a></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html"><span class="hs-identifier">Crypto.JOSE.Error</span></a></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html"><span class="hs-identifier">Crypto.JOSE.JWA.JWS</span></a></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html"><span class="hs-identifier">Crypto.JOSE.JWK</span></a></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.Store.html"><span class="hs-identifier">Crypto.JOSE.JWK.Store</span></a></span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html"><span class="hs-identifier">Crypto.JOSE.Header</span></a></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html"><span class="hs-identifier">Crypto.JOSE.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Types</span></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.Internal.html"><span class="hs-identifier">Crypto.JOSE.Types.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Types</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">{- $extending

Several specifications extend JWS with additional header parameters.
The 'JWS' type is parameterised over the header type; this library
provides the 'JWSHeader' type which encompasses all the JWS header
parameters defined in RFC 7515.  To define an extended header type
declare the data type, and instances for 'HasJWSHeader' and
'HasParams'.  For example:

@
data ACMEHeader p = ACMEHeader
  { _acmeJwsHeader :: 'JWSHeader' p
  , _acmeNonce :: 'Types.Base64Octets'
  }

acmeJwsHeader :: Lens' (ACMEHeader p) (JWSHeader p)
acmeJwsHeader f s\@(ACMEHeader { _acmeJwsHeader = a}) =
  fmap (\\a' -&gt; s { _acmeJwsHeader = a'}) (f a)

acmeNonce :: Lens' (ACMEHeader p) Types.Base64Octets
acmeNonce f s\@(ACMEHeader { _acmeNonce = a}) =
  fmap (\\a' -&gt; s { _acmeNonce = a'}) (f a)

instance HasJWSHeader ACMEHeader where
  jwsHeader = acmeJwsHeader

instance HasParams ACMEHeader where
  'parseParamsFor' proxy hp hu = ACMEHeader
    \&lt;$&gt; 'parseParamsFor' proxy hp hu
    \&lt;*&gt; 'headerRequiredProtected' &quot;nonce&quot; hp hu
  params h =
    (True, &quot;nonce&quot; .= view acmeNonce h)
    : 'params' (view acmeJwsHeader h)
  'extensions' = const [&quot;nonce&quot;]
@

See also:

- 'HasParams'
- 'headerRequired'
- 'headerRequiredProtected'
- 'headerOptional'
- 'headerOptionalProtected'

-}</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Crypto.JOSE.JWS.html#jwsCritInvalidNames"><span class="hs-identifier hs-type">jwsCritInvalidNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span id="jwsCritInvalidNames"><span class="annot"><span class="annottext">jwsCritInvalidNames :: [Text]
</span><a href="Crypto.JOSE.JWS.html#jwsCritInvalidNames"><span class="hs-identifier hs-var hs-var">jwsCritInvalidNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;alg&quot;</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jku&quot;</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jwk&quot;</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5u&quot;</span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t&quot;</span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t#S256&quot;</span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5c&quot;</span></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;kid&quot;</span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;typ&quot;</span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cty&quot;</span></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;crit&quot;</span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | JWS Header data type.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-keyword">data</span><span> </span><span id="JWSHeader"><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-var">JWSHeader</span></a></span></span><span> </span><span id="local-6989586621679403438"><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWSHeader"><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-var">JWSHeader</span></a></span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_jwsHeaderAlg"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; HeaderParam p Alg
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderAlg"><span class="hs-identifier hs-var hs-var">_jwsHeaderAlg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier hs-type">Alg</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderJku"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderJku"><span class="hs-identifier hs-var hs-var">_jwsHeaderJku</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Types.URI</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ JWK Set URL</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderJwk"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p JWK)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderJwk"><span class="hs-identifier hs-var hs-var">_jwsHeaderJwk</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderKid"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderKid"><span class="hs-identifier hs-var hs-var">_jwsHeaderKid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ interpretation unspecified</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderX5u"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5u"><span class="hs-identifier hs-var hs-var">_jwsHeaderX5u</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Types.URI</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderX5c"><span class="annot"><span class="annottext">forall p.
JWSHeader p -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5c"><span class="hs-identifier hs-var hs-var">_jwsHeaderX5c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Types.SignedCertificate</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderX5t"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p Base64SHA1)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5t"><span class="hs-identifier hs-var hs-var">_jwsHeaderX5t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64SHA1"><span class="hs-identifier hs-type">Types.Base64SHA1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderX5tS256"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p Base64SHA256)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5tS256"><span class="hs-identifier hs-var hs-var">_jwsHeaderX5tS256</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64SHA256"><span class="hs-identifier hs-type">Types.Base64SHA256</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderTyp"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderTyp"><span class="hs-identifier hs-var hs-var">_jwsHeaderTyp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Content Type (of object)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderCty"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderCty"><span class="hs-identifier hs-var hs-var">_jwsHeaderCty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Content Type (of payload)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jwsHeaderCrit"><span class="annot"><span class="annottext">forall p. JWSHeader p -&gt; Maybe (NonEmpty Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderCrit"><span class="hs-identifier hs-var hs-var">_jwsHeaderCrit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402806"><span id="local-6989586621679402829"><span class="annot"><span class="annottext">JWSHeader p -&gt; JWSHeader p -&gt; Bool
forall p. Eq p =&gt; JWSHeader p -&gt; JWSHeader p -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: JWSHeader p -&gt; JWSHeader p -&gt; Bool
$c/= :: forall p. Eq p =&gt; JWSHeader p -&gt; JWSHeader p -&gt; Bool
== :: JWSHeader p -&gt; JWSHeader p -&gt; Bool
$c== :: forall p. Eq p =&gt; JWSHeader p -&gt; JWSHeader p -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679402755"><span id="local-6989586621679402757"><span id="local-6989586621679402782"><span class="annot"><span class="annottext">Int -&gt; JWSHeader p -&gt; ShowS
forall p. Show p =&gt; Int -&gt; JWSHeader p -&gt; ShowS
forall p. Show p =&gt; [JWSHeader p] -&gt; ShowS
forall p. Show p =&gt; JWSHeader p -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [JWSHeader p] -&gt; ShowS
$cshowList :: forall p. Show p =&gt; [JWSHeader p] -&gt; ShowS
show :: JWSHeader p -&gt; String
$cshow :: forall p. Show p =&gt; JWSHeader p -&gt; String
showsPrec :: Int -&gt; JWSHeader p -&gt; ShowS
$cshowsPrec :: forall p. Show p =&gt; Int -&gt; JWSHeader p -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">class</span><span> </span><span id="HasJWSHeader"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-var">HasJWSHeader</span></a></span></span><span> </span><span id="local-6989586621679403402"><span class="annot"><a href="#local-6989586621679403402"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="jwsHeader"><span class="annot"><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-type">jwsHeader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679403404"><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403402"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403404"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403404"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679402730"><span class="annot"><span class="annottext">jwsHeader :: forall p. Lens' (JWSHeader p) (JWSHeader p)
</span><a href="#local-6989586621679402730"><span class="hs-identifier hs-var hs-var hs-var hs-var">jwsHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403394"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasAlg"><span class="hs-identifier hs-type">HasAlg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403394"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679402720"><span class="annot"><span class="annottext">alg :: forall p. Lens' (a p) (HeaderParam p Alg)
</span><a href="Crypto.JOSE.Header.html#alg"><span class="hs-identifier hs-var hs-var hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402717"><span class="annot"><span class="annottext">HeaderParam p Alg -&gt; f (HeaderParam p Alg)
</span><a href="#local-6989586621679402717"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402716"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402716"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderAlg :: forall p. JWSHeader p -&gt; HeaderParam p Alg
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderAlg"><span class="hs-identifier hs-var">_jwsHeaderAlg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402715"><span class="annot"><span class="annottext">HeaderParam p Alg
</span><a href="#local-6989586621679402715"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402714"><span class="annot"><span class="annottext">HeaderParam p Alg
</span><a href="#local-6989586621679402714"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402716"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderAlg :: HeaderParam p Alg
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderAlg"><span class="hs-identifier hs-var">_jwsHeaderAlg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HeaderParam p Alg
</span><a href="#local-6989586621679402714"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderParam p Alg -&gt; f (HeaderParam p Alg)
</span><a href="#local-6989586621679402717"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Alg
</span><a href="#local-6989586621679402715"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403381"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasJku"><span class="hs-identifier hs-type">HasJku</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403381"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679402705"><span class="annot"><span class="annottext">jku :: forall p. Lens' (a p) (Maybe (HeaderParam p URI))
</span><a href="Crypto.JOSE.Header.html#jku"><span class="hs-identifier hs-var hs-var hs-var hs-var">jku</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402703"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI) -&gt; f (Maybe (HeaderParam p URI))
</span><a href="#local-6989586621679402703"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402702"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderJku :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderJku"><span class="hs-identifier hs-var">_jwsHeaderJku</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402701"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402701"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402700"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402700"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402702"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderJku :: Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderJku"><span class="hs-identifier hs-var">_jwsHeaderJku</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402700"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI) -&gt; f (Maybe (HeaderParam p URI))
</span><a href="#local-6989586621679402703"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402701"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403374"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasJwk"><span class="hs-identifier hs-type">HasJwk</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403374"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679402691"><span class="annot"><span class="annottext">jwk :: forall p. Lens' (a p) (Maybe (HeaderParam p JWK))
</span><a href="Crypto.JOSE.Header.html#jwk"><span class="hs-identifier hs-var hs-var hs-var hs-var">jwk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402689"><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK) -&gt; f (Maybe (HeaderParam p JWK))
</span><a href="#local-6989586621679402689"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402688"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402688"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderJwk :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p JWK)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderJwk"><span class="hs-identifier hs-var">_jwsHeaderJwk</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402687"><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
</span><a href="#local-6989586621679402687"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402686"><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
</span><a href="#local-6989586621679402686"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402688"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderJwk :: Maybe (HeaderParam p JWK)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderJwk"><span class="hs-identifier hs-var">_jwsHeaderJwk</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
</span><a href="#local-6989586621679402686"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK) -&gt; f (Maybe (HeaderParam p JWK))
</span><a href="#local-6989586621679402689"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
</span><a href="#local-6989586621679402687"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403367"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403367"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasKid"><span class="hs-identifier hs-type">HasKid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403367"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679402677"><span class="annot"><span class="annottext">kid :: forall p. Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#kid"><span class="hs-identifier hs-var hs-var hs-var hs-var">kid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402675"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text) -&gt; f (Maybe (HeaderParam p Text))
</span><a href="#local-6989586621679402675"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402674"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402674"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderKid :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderKid"><span class="hs-identifier hs-var">_jwsHeaderKid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402673"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402673"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402672"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402672"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402674"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderKid :: Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderKid"><span class="hs-identifier hs-var">_jwsHeaderKid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402672"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text) -&gt; f (Maybe (HeaderParam p Text))
</span><a href="#local-6989586621679402675"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402673"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403360"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasX5u"><span class="hs-identifier hs-type">HasX5u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403360"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679402663"><span class="annot"><span class="annottext">x5u :: forall p. Lens' (a p) (Maybe (HeaderParam p URI))
</span><a href="Crypto.JOSE.Header.html#x5u"><span class="hs-identifier hs-var hs-var hs-var hs-var">x5u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402661"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI) -&gt; f (Maybe (HeaderParam p URI))
</span><a href="#local-6989586621679402661"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402660"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402660"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5u :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5u"><span class="hs-identifier hs-var">_jwsHeaderX5u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402659"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402659"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402658"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402658"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402660"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5u :: Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5u"><span class="hs-identifier hs-var">_jwsHeaderX5u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402658"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI) -&gt; f (Maybe (HeaderParam p URI))
</span><a href="#local-6989586621679402661"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679402659"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403353"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403353"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasX5c"><span class="hs-identifier hs-type">HasX5c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403353"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679402649"><span class="annot"><span class="annottext">x5c :: forall p.
Lens' (a p) (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
</span><a href="Crypto.JOSE.Header.html#x5c"><span class="hs-identifier hs-var hs-var hs-var hs-var">x5c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402647"><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; f (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402646"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402646"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5c :: forall p.
JWSHeader p -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5c"><span class="hs-identifier hs-var">_jwsHeaderX5c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402645"><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402644"><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="#local-6989586621679402644"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402646"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5c :: Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5c"><span class="hs-identifier hs-var">_jwsHeaderX5c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="#local-6989586621679402644"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; f (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
</span><a href="#local-6989586621679402647"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="#local-6989586621679402645"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403346"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403346"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasX5t"><span class="hs-identifier hs-type">HasX5t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403346"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679402635"><span class="annot"><span class="annottext">x5t :: forall p. Lens' (a p) (Maybe (HeaderParam p Base64SHA1))
</span><a href="Crypto.JOSE.Header.html#x5t"><span class="hs-identifier hs-var hs-var hs-var hs-var">x5t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402633"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
-&gt; f (Maybe (HeaderParam p Base64SHA1))
</span><a href="#local-6989586621679402633"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402632"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402632"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5t :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p Base64SHA1)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5t"><span class="hs-identifier hs-var">_jwsHeaderX5t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402631"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
</span><a href="#local-6989586621679402631"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402630"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
</span><a href="#local-6989586621679402630"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402632"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5t :: Maybe (HeaderParam p Base64SHA1)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5t"><span class="hs-identifier hs-var">_jwsHeaderX5t</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
</span><a href="#local-6989586621679402630"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
-&gt; f (Maybe (HeaderParam p Base64SHA1))
</span><a href="#local-6989586621679402633"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
</span><a href="#local-6989586621679402631"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403339"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403339"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasX5tS256"><span class="hs-identifier hs-type">HasX5tS256</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403339"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679402621"><span class="annot"><span class="annottext">x5tS256 :: forall p. Lens' (a p) (Maybe (HeaderParam p Base64SHA256))
</span><a href="Crypto.JOSE.Header.html#x5tS256"><span class="hs-identifier hs-var hs-var hs-var hs-var">x5tS256</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402619"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
-&gt; f (Maybe (HeaderParam p Base64SHA256))
</span><a href="#local-6989586621679402619"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402618"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402618"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5tS256 :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p Base64SHA256)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5tS256"><span class="hs-identifier hs-var">_jwsHeaderX5tS256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402617"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
</span><a href="#local-6989586621679402617"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402616"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
</span><a href="#local-6989586621679402616"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402618"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderX5tS256 :: Maybe (HeaderParam p Base64SHA256)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderX5tS256"><span class="hs-identifier hs-var">_jwsHeaderX5tS256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
</span><a href="#local-6989586621679402616"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
-&gt; f (Maybe (HeaderParam p Base64SHA256))
</span><a href="#local-6989586621679402619"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
</span><a href="#local-6989586621679402617"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403332"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403332"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasTyp"><span class="hs-identifier hs-type">HasTyp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403332"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679402607"><span class="annot"><span class="annottext">typ :: forall p. Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#typ"><span class="hs-identifier hs-var hs-var hs-var hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402605"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text) -&gt; f (Maybe (HeaderParam p Text))
</span><a href="#local-6989586621679402605"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402604"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402604"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderTyp :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderTyp"><span class="hs-identifier hs-var">_jwsHeaderTyp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402603"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402603"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402602"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402602"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402604"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderTyp :: Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderTyp"><span class="hs-identifier hs-var">_jwsHeaderTyp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402602"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text) -&gt; f (Maybe (HeaderParam p Text))
</span><a href="#local-6989586621679402605"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402603"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403325"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403325"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasCty"><span class="hs-identifier hs-type">HasCty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403325"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679402593"><span class="annot"><span class="annottext">cty :: forall p. Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#cty"><span class="hs-identifier hs-var hs-var hs-var hs-var">cty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402591"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text) -&gt; f (Maybe (HeaderParam p Text))
</span><a href="#local-6989586621679402591"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402590"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402590"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderCty :: forall p. JWSHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderCty"><span class="hs-identifier hs-var">_jwsHeaderCty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402589"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402589"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402588"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402588"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402590"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderCty :: Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderCty"><span class="hs-identifier hs-var">_jwsHeaderCty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402588"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text) -&gt; f (Maybe (HeaderParam p Text))
</span><a href="#local-6989586621679402591"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679402589"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403318"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403318"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasCrit"><span class="hs-identifier hs-type">HasCrit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403318"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679402579"><span class="annot"><span class="annottext">crit :: forall p. Lens' (a p) (Maybe (NonEmpty Text))
</span><a href="Crypto.JOSE.Header.html#crit"><span class="hs-identifier hs-var hs-var hs-var hs-var">crit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasJWSHeader a =&gt; Lens' (a p) (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#jwsHeader"><span class="hs-identifier hs-var">jwsHeader</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402577"><span class="annot"><span class="annottext">Maybe (NonEmpty Text) -&gt; f (Maybe (NonEmpty Text))
</span><a href="#local-6989586621679402577"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402576"><span class="annot"><span class="annottext">h :: JWSHeader p
</span><a href="#local-6989586621679402576"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderCrit :: forall p. JWSHeader p -&gt; Maybe (NonEmpty Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderCrit"><span class="hs-identifier hs-var">_jwsHeaderCrit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679402575"><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
</span><a href="#local-6989586621679402575"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402574"><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
</span><a href="#local-6989586621679402574"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402576"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_jwsHeaderCrit :: Maybe (NonEmpty Text)
</span><a href="Crypto.JOSE.JWS.html#_jwsHeaderCrit"><span class="hs-identifier hs-var">_jwsHeaderCrit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
</span><a href="#local-6989586621679402574"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (NonEmpty Text) -&gt; f (Maybe (NonEmpty Text))
</span><a href="#local-6989586621679402577"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
</span><a href="#local-6989586621679402575"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Construct a minimal header with the given algorithm and</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- protection indicator for the /alg/ header.</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span id="local-6989586621679403315"><span class="annot"><a href="Crypto.JOSE.JWS.html#newJWSHeader"><span class="hs-identifier hs-type">newJWSHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403315"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier hs-type">Alg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403315"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-239"></span><span id="newJWSHeader"><span class="annot"><span class="annottext">newJWSHeader :: forall p. (p, Alg) -&gt; JWSHeader p
</span><a href="Crypto.JOSE.JWS.html#newJWSHeader"><span class="hs-identifier hs-var hs-var">newJWSHeader</span></a></span></span><span> </span><span id="local-6989586621679402573"><span class="annot"><span class="annottext">(p, Alg)
</span><a href="#local-6989586621679402573"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p.
HeaderParam p Alg
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p JWK)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p Base64SHA1)
-&gt; Maybe (HeaderParam p Base64SHA256)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (NonEmpty Text)
-&gt; JWSHeader p
</span><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-var">JWSHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">forall p a. p -&gt; a -&gt; HeaderParam p a
</span><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-var">HeaderParam</span></a></span><span> </span><span class="annot"><span class="annottext">(p, Alg)
</span><a href="#local-6989586621679402573"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679402570"><span class="annot"><span class="annottext">z :: Maybe a
</span><a href="#local-6989586621679402570"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Make a JWS header for the given signing key.</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- Uses 'bestJWSAlg' to choose the algorithm.</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- If set, the JWK's @&quot;kid&quot;@, @&quot;x5u&quot;@, @&quot;x5c&quot;@, @&quot;x5t&quot;@ and</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- @&quot;x5t#S256&quot;@ parameters are copied to the JWS header (as</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- protected parameters).</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- May return 'KeySizeTooSmall' or 'KeyMismatch'.</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span class="annot"><a href="Crypto.JOSE.JWS.html#makeJWSHeader"><span class="hs-identifier hs-type">makeJWSHeader</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679403307"><span class="annot"><a href="#local-6989586621679403307"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679403306"><span class="annot"><a href="#local-6989586621679403306"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679403303"><span class="annot"><a href="#local-6989586621679403303"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679403307"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403306"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403307"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403303"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403303"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span id="makeJWSHeader"><span class="annot"><span class="annottext">makeJWSHeader :: forall e (m :: * -&gt; *) p.
(MonadError e m, AsError e, ProtectionIndicator p) =&gt;
JWK -&gt; m (JWSHeader p)
</span><a href="Crypto.JOSE.JWS.html#makeJWSHeader"><span class="hs-identifier hs-var hs-var">makeJWSHeader</span></a></span></span><span> </span><span id="local-6989586621679402524"><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679402524"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679402522"><span class="annot"><span class="annottext">p :: p
</span><a href="#local-6989586621679402522"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ProtectionIndicator a =&gt; a
</span><a href="Crypto.JOSE.Header.html#getProtected"><span class="hs-identifier hs-var">getProtected</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679403283"><span id="local-6989586621679403284"><span id="local-6989586621679403285"><span id="local-6989586621679403286"><span class="annot"><a href="#local-6989586621679402520"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASetter</span></span><span> </span><span class="annot"><a href="#local-6989586621679403286"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403285"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403284"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403303"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403283"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679403283"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679403283"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403286"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403285"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679402520"><span class="annot"><span class="annottext">f :: forall s t a a1.
ASetter s t a (Maybe (HeaderParam p a1))
-&gt; Getting (Maybe a1) JWK (Maybe a1) -&gt; s -&gt; t
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679402517"><span class="annot"><span class="annottext">ASetter s t a (Maybe (HeaderParam p a1))
</span><a href="#local-6989586621679402517"><span class="hs-identifier hs-var">lh</span></a></span></span><span> </span><span id="local-6989586621679402516"><span class="annot"><span class="annottext">Getting (Maybe a1) JWK (Maybe a1)
</span><a href="#local-6989586621679402516"><span class="hs-identifier hs-var">lk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter s t a (Maybe (HeaderParam p a1))
</span><a href="#local-6989586621679402517"><span class="hs-identifier hs-var">lh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p a. p -&gt; a -&gt; HeaderParam p a
</span><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-var">HeaderParam</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679402522"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe a1) JWK (Maybe a1)
</span><a href="#local-6989586621679402516"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679402524"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679402512"><span class="annot"><span class="annottext">Alg
</span><a href="#local-6989586621679402512"><span class="hs-identifier hs-var">algo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *). (MonadError e m, AsError e) =&gt; JWK -&gt; m Alg
</span><a href="Crypto.JOSE.JWK.html#bestJWSAlg"><span class="hs-identifier hs-var">bestJWSAlg</span></a></span><span> </span><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679402524"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall p. (p, Alg) -&gt; JWSHeader p
</span><a href="Crypto.JOSE.JWS.html#newJWSHeader"><span class="hs-identifier hs-var">newJWSHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679402522"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="#local-6989586621679402512"><span class="hs-identifier hs-var">algo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall s t a a1.
ASetter s t a (Maybe (HeaderParam p a1))
-&gt; Getting (Maybe a1) JWK (Maybe a1) -&gt; s -&gt; t
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasKid a =&gt;
Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#kid"><span class="hs-identifier hs-var">kid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' JWK (Maybe Text)
</span><a href="Crypto.JOSE.JWK.html#jwkKid"><span class="hs-identifier hs-var">jwkKid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall s t a a1.
ASetter s t a (Maybe (HeaderParam p a1))
-&gt; Getting (Maybe a1) JWK (Maybe a1) -&gt; s -&gt; t
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5u a =&gt;
Lens' (a p) (Maybe (HeaderParam p URI))
</span><a href="Crypto.JOSE.Header.html#x5u"><span class="hs-identifier hs-var">x5u</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' JWK (Maybe URI)
</span><a href="Crypto.JOSE.JWK.html#jwkX5u"><span class="hs-identifier hs-var">jwkX5u</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall s t a a1.
ASetter s t a (Maybe (HeaderParam p a1))
-&gt; Getting (Maybe a1) JWK (Maybe a1) -&gt; s -&gt; t
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5c a =&gt;
Lens' (a p) (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
</span><a href="Crypto.JOSE.Header.html#x5c"><span class="hs-identifier hs-var">x5c</span></a></span><span> </span><span class="annot"><span class="annottext">Getter JWK (Maybe (NonEmpty SignedCertificate))
</span><a href="Crypto.JOSE.JWK.html#jwkX5c"><span class="hs-identifier hs-var">jwkX5c</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall s t a a1.
ASetter s t a (Maybe (HeaderParam p a1))
-&gt; Getting (Maybe a1) JWK (Maybe a1) -&gt; s -&gt; t
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5t a =&gt;
Lens' (a p) (Maybe (HeaderParam p Base64SHA1))
</span><a href="Crypto.JOSE.Header.html#x5t"><span class="hs-identifier hs-var">x5t</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' JWK (Maybe Base64SHA1)
</span><a href="Crypto.JOSE.JWK.html#jwkX5t"><span class="hs-identifier hs-var">jwkX5t</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall s t a a1.
ASetter s t a (Maybe (HeaderParam p a1))
-&gt; Getting (Maybe a1) JWK (Maybe a1) -&gt; s -&gt; t
</span><a href="#local-6989586621679402520"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5tS256 a =&gt;
Lens' (a p) (Maybe (HeaderParam p Base64SHA256))
</span><a href="Crypto.JOSE.Header.html#x5tS256"><span class="hs-identifier hs-var">x5tS256</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' JWK (Maybe Base64SHA256)
</span><a href="Crypto.JOSE.JWK.html#jwkX5tS256"><span class="hs-identifier hs-var">jwkX5tS256</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Signature object containing header, and signature bytes.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- If it was decoded from a serialised JWS, it &quot;remembers&quot; how the</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- protected header was encoded; the remembered value is used when</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- computing the signing input and when serialising the object.</span><span>
</span><span id="line-276"></span><span class="hs-comment">--</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- The remembered value is not used in equality checks, i.e. two</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- decoded signatures with differently serialised by otherwise equal</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- protected headers, and equal signature bytes, are equal.</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-keyword">data</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span id="local-6989586621679403246"><span class="annot"><a href="#local-6989586621679403246"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679403247"><span class="annot"><a href="#local-6989586621679403247"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Encoded protected header, if available</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403246"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- Header</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>  </span><span class="hs-comment">-- Signature</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679402491"><span id="local-6989586621679402493"><span id="local-6989586621679402501"><span class="annot"><span class="annottext">Int -&gt; Signature p a -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall p (a :: * -&gt; *). Show (a p) =&gt; Int -&gt; Signature p a -&gt; ShowS
forall p (a :: * -&gt; *). Show (a p) =&gt; [Signature p a] -&gt; ShowS
forall p (a :: * -&gt; *). Show (a p) =&gt; Signature p a -&gt; String
showList :: [Signature p a] -&gt; ShowS
$cshowList :: forall p (a :: * -&gt; *). Show (a p) =&gt; [Signature p a] -&gt; ShowS
show :: Signature p a -&gt; String
$cshow :: forall p (a :: * -&gt; *). Show (a p) =&gt; Signature p a -&gt; String
showsPrec :: Int -&gt; Signature p a -&gt; ShowS
$cshowsPrec :: forall p (a :: * -&gt; *). Show (a p) =&gt; Int -&gt; Signature p a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Getter for header of a signature</span><span>
</span><span id="line-288"></span><span id="local-6989586621679403244"><span id="local-6989586621679403245"><span class="annot"><a href="Crypto.JOSE.JWS.html#header"><span class="hs-identifier hs-type">header</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403245"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403244"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403244"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403245"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-289"></span><span id="header"><span class="annot"><span class="annottext">header :: forall p (a :: * -&gt; *). Getter (Signature p a) (a p)
</span><a href="Crypto.JOSE.JWS.html#header"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402486"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402486"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402486"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Getter for signature bytes</span><span>
</span><span id="line-292"></span><span id="local-6989586621679403238"><span id="local-6989586621679403239"><span id="local-6989586621679403240"><span class="annot"><a href="Crypto.JOSE.JWS.html#signature"><span class="hs-keyword hs-type">signature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679403240"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403240"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679403240"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403239"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403240"><span class="hs-identifier hs-type">s</span></a></span></span></span></span><span>
</span><span id="line-293"></span><span id="signature"><span class="annot"><span class="annottext">signature :: forall s p (a :: * -&gt; *).
(Cons s s Word8 Word8, AsEmpty s) =&gt;
Getter (Signature p a) s
</span><a href="Crypto.JOSE.JWS.html#signature"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679402472"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679402472"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679402472"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span>
</span><span id="line-294"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#signature"><span class="hs-pragma hs-type">signature</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402469"><span id="local-6989586621679403231"><span id="local-6989586621679403232"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403231"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403231"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402465"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402465"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679402464"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402464"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679402463"><span class="annot"><span class="annottext">== :: Signature p a -&gt; Signature p a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402462"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402462"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span id="local-6989586621679402461"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402461"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402465"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402462"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402464"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402461"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402457"><span id="local-6989586621679403226"><span id="local-6989586621679403227"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403226"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403226"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679402411"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Signature p a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;signature&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402408"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall p (a :: * -&gt; *).
Maybe Text -&gt; a p -&gt; Base64Octets -&gt; Signature p a
</span><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;protected&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- raw protected header</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679402406"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679402406"><span class="hs-identifier hs-var">hpB64</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;protected&quot;</span></span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621679402404"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402404"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;base64url-encoded header params&quot;</span></span><span>
</span><span id="line-307"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (ByteString -&gt; Parser a) -&gt; Text -&gt; Parser a
</span><a href="Crypto.JOSE.Types.Internal.html#parseB64Url"><span class="hs-identifier hs-var">Types.parseB64Url</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-308"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;protected header contains invalid JSON&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">decode</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679402406"><span class="hs-identifier hs-var">hpB64</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621679402399"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402399"><span class="hs-identifier hs-var">hu</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;header&quot;</span></span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Maybe Object -&gt; Maybe Object -&gt; Parser (a p)
</span><a href="Crypto.JOSE.Header.html#parseParams"><span class="hs-identifier hs-var">parseParams</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402404"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402399"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402408"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signature&quot;</span></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402391"><span id="local-6989586621679402393"><span id="local-6989586621679402395"><span id="local-6989586621679403198"><span id="local-6989586621679403199"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403199"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403198"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403198"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403199"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621679402362"><span class="annot"><span class="annottext">toJSON :: Signature p a -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span id="local-6989586621679402360"><span class="annot"><span class="annottext">s :: Signature p a
</span><a href="#local-6989586621679402360"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402359"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402359"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679402358"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402358"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679402357"><span class="annot"><span class="annottext">pro :: [Pair] -&gt; [Pair]
</span><a href="#local-6989586621679402357"><span class="hs-identifier hs-var hs-var">pro</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#rawProtectedHeader"><span class="hs-identifier hs-var">rawProtectedHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679402360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621679402356"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679402356"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;protected&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679402356"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>      </span><span id="local-6989586621679402352"><span class="annot"><span class="annottext">unp :: [Pair] -&gt; [Pair]
</span><a href="#local-6989586621679402352"><span class="hs-identifier hs-var hs-var">unp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
a p -&gt; Maybe Value
</span><a href="Crypto.JOSE.Header.html#unprotectedParams"><span class="hs-identifier hs-var">unprotectedParams</span></a></span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679402359"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679402350"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402350"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;header&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pair] -&gt; [Pair]
</span><a href="#local-6989586621679402357"><span class="hs-identifier hs-var">pro</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; [Pair]
</span><a href="#local-6989586621679402352"><span class="hs-identifier hs-var">unp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signature&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402358"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402346"><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-type">JWSHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621679402269"><span class="annot"><span class="annottext">parseParamsFor :: forall (b :: * -&gt; *) p.
(HasParams b, ProtectionIndicator p) =&gt;
Proxy b -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (JWSHeader p)
</span><a href="Crypto.JOSE.Header.html#parseParamsFor"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParamsFor</span></a></span></span><span> </span><span id="local-6989586621679402267"><span class="annot"><span class="annottext">Proxy b
</span><a href="#local-6989586621679402267"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span id="local-6989586621679402266"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span id="local-6989586621679402265"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p.
HeaderParam p Alg
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p JWK)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p Base64SHA1)
-&gt; Maybe (HeaderParam p Base64SHA256)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (NonEmpty Text)
-&gt; JWSHeader p
</span><a href="Crypto.JOSE.JWS.html#JWSHeader"><span class="hs-identifier hs-var">JWSHeader</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#headerRequired"><span class="hs-identifier hs-var">headerRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;alg&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jku&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jwk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;kid&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5u&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64X509"><span class="hs-identifier hs-type">Types.Base64X509</span></a></span><span> </span><span id="local-6989586621679402261"><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679402261"><span class="hs-identifier hs-var">cert</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679402261"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5c&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t#S256&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;typ&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cty&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
FromJSON a =&gt;
Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe a)
</span><a href="Crypto.JOSE.Header.html#headerOptionalProtected"><span class="hs-identifier hs-var">headerOptionalProtected</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;crit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t0 :: * -&gt; *) (t1 :: * -&gt; *) (t2 :: * -&gt; *) (t3 :: * -&gt; *)
       (m :: * -&gt; *).
(Foldable t0, Foldable t1, Traversable t2, Traversable t3,
 MonadFail m) =&gt;
t0 Text -&gt; t1 Text -&gt; Object -&gt; t2 (t3 Text) -&gt; m (t2 (t3 Text))
</span><a href="Crypto.JOSE.Header.html#parseCrit"><span class="hs-identifier hs-var">parseCrit</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="Crypto.JOSE.JWS.html#jwsCritInvalidNames"><span class="hs-identifier hs-var">jwsCritInvalidNames</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *). HasParams a =&gt; Proxy a -&gt; [Text]
</span><a href="Crypto.JOSE.Header.html#extensions"><span class="hs-identifier hs-var">extensions</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy b
</span><a href="#local-6989586621679402267"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402266"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679402265"><span class="hs-identifier hs-var">hu</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679402096"><span class="annot"><span class="annottext">params :: forall p. ProtectionIndicator p =&gt; JWSHeader p -&gt; [(Bool, Pair)]
</span><a href="Crypto.JOSE.Header.html#params"><span class="hs-identifier hs-var hs-var hs-var hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679402094"><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasAlg a =&gt; Lens' (a p) (HeaderParam p Alg)
</span><a href="Crypto.JOSE.Header.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;alg&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasAlg a =&gt; Lens' (a p) (HeaderParam p Alg)
</span><a href="Crypto.JOSE.Header.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402091"><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679402091"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679402091"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jku&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679402091"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasJku a =&gt;
Lens' (a p) (Maybe (HeaderParam p URI))
</span><a href="Crypto.JOSE.Header.html#jku"><span class="hs-identifier hs-var">jku</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402090"><span class="annot"><span class="annottext">HeaderParam p JWK
</span><a href="#local-6989586621679402090"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p JWK
</span><a href="#local-6989586621679402090"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jwk&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p JWK
</span><a href="#local-6989586621679402090"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasJwk a =&gt;
Lens' (a p) (Maybe (HeaderParam p JWK))
</span><a href="Crypto.JOSE.Header.html#jwk"><span class="hs-identifier hs-var">jwk</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402089"><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402089"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402089"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;kid&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402089"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasKid a =&gt;
Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#kid"><span class="hs-identifier hs-var">kid</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402088"><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679402088"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679402088"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5u&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679402088"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5u a =&gt;
Lens' (a p) (Maybe (HeaderParam p URI))
</span><a href="Crypto.JOSE.Header.html#x5u"><span class="hs-identifier hs-var">x5u</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402087"><span class="annot"><span class="annottext">HeaderParam p (NonEmpty SignedCertificate)
</span><a href="#local-6989586621679402087"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p (NonEmpty SignedCertificate)
</span><a href="#local-6989586621679402087"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5c&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate -&gt; Base64X509
</span><a href="Crypto.JOSE.Types.html#Base64X509"><span class="hs-identifier hs-var">Types.Base64X509</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p (NonEmpty SignedCertificate)
</span><a href="#local-6989586621679402087"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5c a =&gt;
Lens' (a p) (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
</span><a href="Crypto.JOSE.Header.html#x5c"><span class="hs-identifier hs-var">x5c</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402086"><span class="annot"><span class="annottext">HeaderParam p Base64SHA1
</span><a href="#local-6989586621679402086"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA1
</span><a href="#local-6989586621679402086"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5t&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA1
</span><a href="#local-6989586621679402086"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5t a =&gt;
Lens' (a p) (Maybe (HeaderParam p Base64SHA1))
</span><a href="Crypto.JOSE.Header.html#x5t"><span class="hs-identifier hs-var">x5t</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402085"><span class="annot"><span class="annottext">HeaderParam p Base64SHA256
</span><a href="#local-6989586621679402085"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA256
</span><a href="#local-6989586621679402085"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5t#S256&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA256
</span><a href="#local-6989586621679402085"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasX5tS256 a =&gt;
Lens' (a p) (Maybe (HeaderParam p Base64SHA256))
</span><a href="Crypto.JOSE.Header.html#x5tS256"><span class="hs-identifier hs-var">x5tS256</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402084"><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402084"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402084"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;typ&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402084"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasTyp a =&gt;
Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#typ"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402083"><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402083"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402083"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;cty&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679402083"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasCty a =&gt;
Lens' (a p) (Maybe (HeaderParam p Text))
</span><a href="Crypto.JOSE.Header.html#cty"><span class="hs-identifier hs-var">cty</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402082"><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621679402082"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;crit&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621679402082"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
HasCrit a =&gt;
Lens' (a p) (Maybe (NonEmpty Text))
</span><a href="Crypto.JOSE.Header.html#crit"><span class="hs-identifier hs-var">crit</span></a></span><span> </span><span class="annot"><span class="annottext">JWSHeader p
</span><a href="#local-6989586621679402094"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- | JSON Web Signature data type.  The payload can only be</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- accessed by verifying the JWS.</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- Parameterised by the signature container type, the header</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- 'ProtectionIndicator' type, and the header record type.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- Use 'encode' and 'decode' to convert a JWS to or from JSON.</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- When encoding a @'JWS' []@ with exactly one signature, the</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- /flattened JWS JSON serialisation/ syntax is used, otherwise</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- the /general JWS JSON serialisation/ is used.</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- When decoding a @'JWS' []@ either serialisation is accepted.</span><span>
</span><span id="line-372"></span><span class="hs-comment">--</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- @'JWS' 'Identity'@ uses the flattened JSON serialisation</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- or the /JWS compact serialisation/ (see 'decodeCompact' and</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- 'encodeCompact').</span><span>
</span><span id="line-376"></span><span class="hs-comment">--</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- Use 'signJWS' to create a signed/MACed JWS.</span><span>
</span><span id="line-378"></span><span class="hs-comment">--</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- Use 'verifyJWS' to verify a JWS and extract the payload.</span><span>
</span><span id="line-380"></span><span class="hs-comment">--</span><span>
</span><span id="line-381"></span><span class="hs-keyword">data</span><span> </span><span id="JWS"><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-var">JWS</span></a></span></span><span> </span><span id="local-6989586621679403131"><span class="annot"><a href="#local-6989586621679403131"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679403130"><span class="annot"><a href="#local-6989586621679403130"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679403129"><span class="annot"><a href="#local-6989586621679403129"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWS"><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-var">JWS</span></a></span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403131"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403130"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403129"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | A JWS that allows multiple signatures, and cannot use</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- the /compact serialisation/.  Headers may be 'Protected'</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- or 'Unprotected'.</span><span>
</span><span id="line-386"></span><span class="hs-comment">--</span><span>
</span><span id="line-387"></span><span class="hs-keyword">type</span><span> </span><span id="GeneralJWS"><span class="annot"><a href="Crypto.JOSE.JWS.html#GeneralJWS"><span class="hs-identifier hs-var">GeneralJWS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#Protection"><span class="hs-identifier hs-type">Protection</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | A JWS with one signature, which uses the</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- /flattened serialisation/.  Headers may be 'Protected'</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- or 'Unprotected'.</span><span>
</span><span id="line-392"></span><span class="hs-comment">--</span><span>
</span><span id="line-393"></span><span class="hs-keyword">type</span><span> </span><span id="FlattenedJWS"><span class="annot"><a href="Crypto.JOSE.JWS.html#FlattenedJWS"><span class="hs-identifier hs-var">FlattenedJWS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#Protection"><span class="hs-identifier hs-type">Protection</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | A JWS with one signature which only allows protected</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- parameters.  Can use the /flattened serialisation/ or</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- the /compact serialisation/.</span><span>
</span><span id="line-398"></span><span class="hs-comment">--</span><span>
</span><span id="line-399"></span><span class="hs-keyword">type</span><span> </span><span id="CompactJWS"><span class="annot"><a href="Crypto.JOSE.JWS.html#CompactJWS"><span class="hs-identifier hs-var">CompactJWS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402077"><span id="local-6989586621679403153"><span id="local-6989586621679403154"><span id="local-6989586621679403155"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403155"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403154"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403153"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403155"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403154"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403153"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679402074"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402074"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679402073"><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402073"><span class="hs-identifier hs-var">sigs</span></a></span></span><span> </span><span id="local-6989586621679402072"><span class="annot"><span class="annottext">== :: JWS t p a -&gt; JWS t p a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679402071"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402071"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span id="local-6989586621679402070"><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402070"><span class="hs-identifier hs-var">sigs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402074"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402071"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402073"><span class="hs-identifier hs-var">sigs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402070"><span class="hs-identifier hs-var">sigs'</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402065"><span id="local-6989586621679402068"><span id="local-6989586621679403150"><span id="local-6989586621679403151"><span id="local-6989586621679403152"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403152"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403151"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403150"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403152"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403151"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403150"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679402054"><span class="annot"><span class="annottext">show :: JWS t p a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679402052"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402052"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679402051"><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402051"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWS &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402052"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402051"><span class="hs-identifier hs-var">sigs</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span id="local-6989586621679403145"><span id="local-6989586621679403146"><span id="local-6989586621679403147"><span class="annot"><a href="Crypto.JOSE.JWS.html#signatures"><span class="hs-identifier hs-type">signatures</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679403147"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fold</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403147"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403146"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403146"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-408"></span><span id="signatures"><span class="annot"><span class="annottext">signatures :: forall (t :: * -&gt; *) p (a :: * -&gt; *).
Foldable t =&gt;
Fold (JWS t p a) (Signature p a)
</span><a href="Crypto.JOSE.JWS.html#signatures"><span class="hs-identifier hs-var hs-var">signatures</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) s a. Foldable f =&gt; (s -&gt; f a) -&gt; Fold s a
</span><span class="hs-identifier hs-var">folding</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679402043"><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402043"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t (Signature p a)
</span><a href="#local-6989586621679402043"><span class="hs-identifier hs-var">sigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402040"><span id="local-6989586621679403135"><span id="local-6989586621679403136"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403136"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403135"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679403135"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403136"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679402028"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (JWS [] p a)
</span><a href="#local-6989586621679402028"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span id="local-6989586621679402027"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402027"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWS JSON serialization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402026"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402026"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) p (a :: * -&gt; *).
Base64Octets -&gt; t (Signature p a) -&gt; JWS t p a
</span><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-var">JWS</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402026"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;payload&quot;</span></span><span>
</span><span id="line-414"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402026"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signatures&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402027"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679402025"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402025"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679402023"><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679402023"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) p (a :: * -&gt; *).
Base64Octets -&gt; t (Signature p a) -&gt; JWS t p a
</span><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-var">JWS</span></a></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402025"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679402023"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679402027"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679402020"><span id="local-6989586621679403132"><span id="local-6989586621679403133"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403133"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403132"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679403132"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403133"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-418"></span><span>  </span><span id="local-6989586621679402010"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (JWS Identity p a)
</span><a href="#local-6989586621679402010"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><span class="annottext">forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Flattened JWS JSON serialization&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679402009"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402009"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Key -&gt; KeyMap a -&gt; Bool
</span><span class="hs-identifier hs-var">M.member</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signatures&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402009"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;signatures\&quot; member MUST NOT be present&quot;</span></span><span>
</span><span id="line-422"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679402007"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402007"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679402006"><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679402006"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) p (a :: * -&gt; *).
Base64Octets -&gt; t (Signature p a) -&gt; JWS t p a
</span><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-var">JWS</span></a></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679402007"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679402006"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402009"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;payload&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Value
</span><span class="hs-identifier hs-var">Object</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679402009"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679401998"><span id="local-6989586621679402000"><span id="local-6989586621679402002"><span id="local-6989586621679403126"><span id="local-6989586621679403127"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403127"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403126"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679403126"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403127"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679401987"><span class="annot"><span class="annottext">toJSON :: JWS [] p a -&gt; Value
</span><a href="#local-6989586621679401987"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679401986"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401986"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679401985"><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401985"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. ToJSON v =&gt; Key -&gt; v -&gt; Value -&gt; Value
</span><a href="Crypto.JOSE.Types.Internal.html#insertToObject"><span class="hs-identifier hs-var">Types.insertToObject</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;payload&quot;</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401986"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401985"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679401983"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401983"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679401982"><span class="annot"><span class="annottext">[Signature p a]
</span><a href="#local-6989586621679401982"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;payload&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401983"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signatures&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Signature p a]
</span><a href="#local-6989586621679401982"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679401975"><span id="local-6989586621679401977"><span id="local-6989586621679401979"><span id="local-6989586621679403122"><span id="local-6989586621679403123"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403123"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403122"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679403122"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403123"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621679401971"><span class="annot"><span class="annottext">toJSON :: JWS Identity p a -&gt; Value
</span><a href="#local-6989586621679401971"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679401970"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401970"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679401969"><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401969"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v. ToJSON v =&gt; Key -&gt; v -&gt; Value -&gt; Value
</span><a href="Crypto.JOSE.Types.Internal.html#insertToObject"><span class="hs-identifier hs-var">Types.insertToObject</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;payload&quot;</span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401970"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401969"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span id="local-6989586621679403120"><span id="local-6989586621679403121"><span class="annot"><a href="Crypto.JOSE.JWS.html#signingInput"><span class="hs-identifier hs-type">signingInput</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403121"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403120"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403120"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403121"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span></span><span>
</span><span id="line-437"></span><span id="signingInput"><span class="annot"><span class="annottext">signingInput :: forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; Base64Octets -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#signingInput"><span class="hs-identifier hs-var hs-var">signingInput</span></a></span></span><span> </span><span id="local-6989586621679401951"><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401951"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679401950"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401950"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#rawProtectedHeader"><span class="hs-identifier hs-var">rawProtectedHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401951"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">forall s1 s2.
(AsEmpty s1, AsEmpty s2, Cons s1 s1 Word8 Word8,
 Cons s2 s2 Word8 Word8) =&gt;
Prism' s1 s2
</span><a href="Crypto.JOSE.Types.Internal.html#base64url"><span class="hs-identifier hs-var">Types.base64url</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401950"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Return the raw base64url-encoded protected header value.</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- If the Signature was decoded from JSON, this returns the</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- original string value as-is.</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- Application code should never need to use this.  It is exposed</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- for testing purposes.</span><span>
</span><span id="line-446"></span><span id="local-6989586621679403194"><span id="local-6989586621679403195"><span class="annot"><a href="Crypto.JOSE.JWS.html#rawProtectedHeader"><span class="hs-identifier hs-type">rawProtectedHeader</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403194"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403194"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span></span><span>
</span><span id="line-449"></span><span id="rawProtectedHeader"><span class="annot"><span class="annottext">rawProtectedHeader :: forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#rawProtectedHeader"><span class="hs-identifier hs-var hs-var">rawProtectedHeader</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679401937"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679401937"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span id="local-6989586621679401936"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401936"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
a p -&gt; ByteString
</span><a href="Crypto.JOSE.Header.html#protectedParamsEncoded"><span class="hs-identifier hs-var">protectedParamsEncoded</span></a></span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401936"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679401937"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- Convert JWS to compact serialization.</span><span>
</span><span id="line-453"></span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- The operation is defined only when there is exactly one</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- signature and returns Nothing otherwise</span><span>
</span><span id="line-456"></span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403101"><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403101"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Compact.html#ToCompact"><span class="hs-identifier hs-type">ToCompact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403101"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-458"></span><span>  </span><span id="local-6989586621679401913"><span class="annot"><span class="annottext">toCompact :: JWS Identity () a -&gt; [ByteString]
</span><a href="Crypto.JOSE.Compact.html#toCompact"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCompact</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679401911"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401911"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679401910"><span class="annot"><span class="annottext">s :: Signature () a
</span><a href="#local-6989586621679401910"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679401909"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401909"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; Base64Octets -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#signingInput"><span class="hs-identifier hs-var">signingInput</span></a></span><span> </span><span class="annot"><span class="annottext">Signature () a
</span><a href="#local-6989586621679401910"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401911"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">forall s1 s2.
(AsEmpty s1, AsEmpty s2, Cons s1 s1 Word8 Word8,
 Cons s2 s2 Word8 Word8) =&gt;
Prism' s1 s2
</span><a href="Crypto.JOSE.Types.Internal.html#base64url"><span class="hs-identifier hs-var">Types.base64url</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401909"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403095"><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403095"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Compact.html#FromCompact"><span class="hs-identifier hs-type">FromCompact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403095"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621679401861"><span class="annot"><span class="annottext">fromCompact :: forall e (m :: * -&gt; *).
(AsError e, MonadError e m) =&gt;
[ByteString] -&gt; m (JWS Identity () a)
</span><a href="Crypto.JOSE.Compact.html#fromCompact"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCompact</span></a></span></span><span> </span><span id="local-6989586621679401859"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679401859"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679401859"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679401858"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401858"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401857"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401857"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401856"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401856"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679401855"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401855"><span class="hs-identifier hs-var">h'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401854"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401854"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401853"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401853"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; ByteString -&gt; m Value
</span><a href="#local-6989586621679401852"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401858"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; ByteString -&gt; m Value
</span><a href="#local-6989586621679401852"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401857"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; ByteString -&gt; m Value
</span><a href="#local-6989586621679401852"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401856"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679401851"><span class="annot"><span class="annottext">o :: Value
</span><a href="#local-6989586621679401851"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;payload&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401854"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;protected&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401855"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signature&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401853"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Result a
</span><span class="hs-identifier hs-var">fromJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679401851"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-469"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span id="local-6989586621679401848"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679401848"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) t x.
MonadError e m =&gt;
AReview e t -&gt; t -&gt; m x
</span><span class="hs-identifier hs-var">throwing</span></span><span> </span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r String
</span><a href="Crypto.JOSE.Error.html#_JSONDecodeError"><span class="hs-identifier hs-var">_JSONDecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679401848"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-470"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Success</span></span><span> </span><span id="local-6989586621679401845"><span class="annot"><span class="annottext">JWS Identity () a
</span><a href="#local-6989586621679401845"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">JWS Identity () a
</span><a href="#local-6989586621679401845"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679401844"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679401844"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) t x.
MonadError e m =&gt;
AReview e t -&gt; t -&gt; m x
</span><span class="hs-identifier hs-var">throwing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r CompactDecodeError
</span><a href="Crypto.JOSE.Error.html#_CompactDecodeError"><span class="hs-identifier hs-var">_CompactDecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prism' CompactDecodeError InvalidNumberOfParts
</span><a href="Crypto.JOSE.Error.html#_CompactInvalidNumberOfParts"><span class="hs-identifier hs-var">_CompactInvalidNumberOfParts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; InvalidNumberOfParts
</span><a href="Crypto.JOSE.Error.html#InvalidNumberOfParts"><span class="hs-identifier hs-var">InvalidNumberOfParts</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679401844"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-474"></span><span>      </span><span id="local-6989586621679401834"><span class="annot"><span class="annottext">l :: Tagged CompactTextError (Identity CompactTextError)
-&gt; Tagged e (Identity e)
</span><a href="#local-6989586621679401834"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r CompactDecodeError
</span><a href="Crypto.JOSE.Error.html#_CompactDecodeError"><span class="hs-identifier hs-var">_CompactDecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prism' CompactDecodeError CompactTextError
</span><a href="Crypto.JOSE.Error.html#_CompactInvalidText"><span class="hs-identifier hs-var">_CompactInvalidText</span></a></span><span>
</span><span id="line-475"></span><span>      </span><span id="local-6989586621679401852"><span class="annot"><span class="annottext">t :: Natural -&gt; ByteString -&gt; m Value
</span><a href="#local-6989586621679401852"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679401832"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679401832"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) t x.
MonadError e m =&gt;
AReview e t -&gt; t -&gt; m x
</span><span class="hs-identifier hs-var">throwing</span></span><span> </span><span class="annot"><span class="annottext">Tagged CompactTextError (Identity CompactTextError)
-&gt; Tagged e (Identity e)
</span><a href="#local-6989586621679401834"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; UnicodeException -&gt; CompactTextError
</span><a href="Crypto.JOSE.Error.html#CompactTextError"><span class="hs-identifier hs-var">CompactTextError</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679401832"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><span class="hs-identifier hs-var">T.decodeUtf8'</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | Create a signed or MACed JWS with the given payload by</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- traversing a collection of @(header, key)@ pairs.</span><span>
</span><span id="line-481"></span><span class="hs-comment">--</span><span>
</span><span id="line-482"></span><span id="local-6989586621679403066"><span id="local-6989586621679403067"><span id="local-6989586621679403068"><span id="local-6989586621679403070"><span id="local-6989586621679403071"><span id="local-6989586621679403072"><span class="annot"><a href="Crypto.JOSE.JWS.html#signJWS"><span class="hs-identifier hs-type">signJWS</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679403072"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403072"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-484"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679403070"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403068"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679403068"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403070"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-485"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679403067"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-486"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403066"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-487"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403072"><span class="hs-identifier hs-type">s</span></a></span><span>          </span><span class="hs-comment">-- ^ Payload</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403067"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403066"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Traversable of header, key pairs</span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403070"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403067"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403066"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-491"></span><span id="signJWS"><span class="annot"><span class="annottext">signJWS :: forall s (a :: * -&gt; *) (m :: * -&gt; *) e (t :: * -&gt; *) p.
(Cons s s Word8 Word8, HasJWSHeader a, HasParams a, MonadRandom m,
 AsError e, MonadError e m, Traversable t, ProtectionIndicator p) =&gt;
s -&gt; t (a p, JWK) -&gt; m (JWS t p a)
</span><a href="Crypto.JOSE.JWS.html#signJWS"><span class="hs-identifier hs-var hs-var">signJWS</span></a></span></span><span> </span><span id="local-6989586621679401801"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679401801"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679401800"><span class="annot"><span class="annottext">s' :: ByteString
</span><a href="#local-6989586621679401800"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679401801"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) p (a :: * -&gt; *).
Base64Octets -&gt; t (Signature p a) -&gt; JWS t p a
</span><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-var">JWS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Base64Octets
</span><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-var">Types.Base64Octets</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401800"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) (m :: * -&gt; *) e p.
(HasJWSHeader a, HasParams a, MonadRandom m, AsError e,
 MonadError e m, ProtectionIndicator p) =&gt;
ByteString -&gt; a p -&gt; JWK -&gt; m (Signature p a)
</span><a href="Crypto.JOSE.JWS.html#mkSignature"><span class="hs-identifier hs-var">mkSignature</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401800"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#signJWS"><span class="hs-pragma hs-type">signJWS</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="local-6989586621679403051"><span id="local-6989586621679403052"><span id="local-6989586621679403053"><span id="local-6989586621679403054"><span class="annot"><a href="Crypto.JOSE.JWS.html#mkSignature"><span class="hs-identifier hs-type">mkSignature</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679403053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403052"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679403052"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403053"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-498"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403051"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-499"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403051"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403051"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-501"></span><span id="mkSignature"><span class="annot"><span class="annottext">mkSignature :: forall (a :: * -&gt; *) (m :: * -&gt; *) e p.
(HasJWSHeader a, HasParams a, MonadRandom m, AsError e,
 MonadError e m, ProtectionIndicator p) =&gt;
ByteString -&gt; a p -&gt; JWK -&gt; m (Signature p a)
</span><a href="Crypto.JOSE.JWS.html#mkSignature"><span class="hs-identifier hs-var hs-var">mkSignature</span></a></span></span><span> </span><span id="local-6989586621679401775"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401775"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679401774"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401774"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679401773"><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679401773"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621679401772"><span class="annot"><span class="annottext">almostSig :: ByteString -&gt; Signature p a
</span><a href="#local-6989586621679401772"><span class="hs-identifier hs-var hs-var">almostSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p (a :: * -&gt; *).
Maybe Text -&gt; a p -&gt; Base64Octets -&gt; Signature p a
</span><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401774"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Base64Octets
</span><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-var">Types.Base64Octets</span></a></span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Signature p a
</span><a href="#local-6989586621679401772"><span class="hs-identifier hs-var">almostSig</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e.
(MonadRandom m, MonadError e m, AsError e) =&gt;
Alg -&gt; KeyMaterial -&gt; ByteString -&gt; m ByteString
</span><a href="Crypto.JOSE.JWA.JWK.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasAlg a =&gt; Lens' (a p) (HeaderParam p Alg)
</span><a href="Crypto.JOSE.Header.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401774"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679401773"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Lens' JWK KeyMaterial
</span><a href="Crypto.JOSE.JWK.html#jwkMaterial"><span class="hs-identifier hs-var">jwkMaterial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; Base64Octets -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#signingInput"><span class="hs-identifier hs-var">signingInput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Signature p a
</span><a href="#local-6989586621679401772"><span class="hs-identifier hs-var">almostSig</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Base64Octets
</span><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-var">Types.Base64Octets</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401775"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | Validation policy.</span><span>
</span><span id="line-513"></span><span class="hs-comment">--</span><span>
</span><span id="line-514"></span><span class="hs-keyword">data</span><span> </span><span id="ValidationPolicy"><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationPolicy"><span class="hs-identifier hs-var">ValidationPolicy</span></a></span></span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AnyValidated"><span class="annot"><a href="Crypto.JOSE.JWS.html#AnyValidated"><span class="hs-identifier hs-var">AnyValidated</span></a></span></span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-comment">-- ^ One successfully validated signature is sufficient</span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AllValidated"><span class="annot"><a href="Crypto.JOSE.JWS.html#AllValidated"><span class="hs-identifier hs-var">AllValidated</span></a></span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-comment">-- ^ All signatures in all configured algorithms must be validated.</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-comment">-- No signatures in configured algorithms is also an error.</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401763"><span id="local-6989586621679401765"><span class="annot"><span class="annottext">ValidationPolicy -&gt; ValidationPolicy -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ValidationPolicy -&gt; ValidationPolicy -&gt; Bool
$c/= :: ValidationPolicy -&gt; ValidationPolicy -&gt; Bool
== :: ValidationPolicy -&gt; ValidationPolicy -&gt; Bool
$c== :: ValidationPolicy -&gt; ValidationPolicy -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- | Validation settings:</span><span>
</span><span id="line-523"></span><span class="hs-comment">--</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- * The set of acceptable signature algorithms</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- * The validation policy</span><span>
</span><span id="line-526"></span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span class="hs-keyword">data</span><span> </span><span id="ValidationSettings"><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-var">ValidationSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ValidationSettings"><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-var">ValidationSettings</span></a></span></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier hs-type">Alg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationPolicy"><span class="hs-identifier hs-type">ValidationPolicy</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-keyword">class</span><span> </span><span id="HasValidationSettings"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-var">HasValidationSettings</span></a></span></span><span> </span><span id="local-6989586621679403041"><span class="annot"><a href="#local-6989586621679403041"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>  </span><span id="validationSettings"><span class="annot"><a href="Crypto.JOSE.JWS.html#validationSettings"><span class="hs-identifier hs-type">validationSettings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679403041"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-type">ValidationSettings</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>  </span><span id="validationSettingsAlgorithms"><span class="annot"><a href="Crypto.JOSE.JWS.html#validationSettingsAlgorithms"><span class="hs-identifier hs-type">validationSettingsAlgorithms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679403041"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier hs-type">Alg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621679401758"><span class="annot"><a href="Crypto.JOSE.JWS.html#validationSettingsAlgorithms"><span class="hs-identifier hs-var hs-var">validationSettingsAlgorithms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasValidationSettings a =&gt; Lens' a ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#validationSettings"><span class="hs-identifier hs-var">validationSettings</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *}.
Functor f =&gt;
(Set Alg -&gt; f (Set Alg))
-&gt; ValidationSettings -&gt; f ValidationSettings
</span><a href="#local-6989586621679401753"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621679401753"><span class="annot"><span class="annottext">go :: (Set Alg -&gt; f (Set Alg))
-&gt; ValidationSettings -&gt; f ValidationSettings
</span><a href="#local-6989586621679401753"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679401750"><span class="annot"><span class="annottext">Set Alg -&gt; f (Set Alg)
</span><a href="#local-6989586621679401750"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-type">ValidationSettings</span></a></span><span> </span><span id="local-6989586621679401749"><span class="annot"><span class="annottext">Set Alg
</span><a href="#local-6989586621679401749"><span class="hs-identifier hs-var">algs</span></a></span></span><span> </span><span id="local-6989586621679401748"><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="#local-6989586621679401748"><span class="hs-identifier hs-var">pol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-537"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Alg -&gt; ValidationPolicy -&gt; ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-operator hs-var">`ValidationSettings`</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="#local-6989586621679401748"><span class="hs-identifier hs-var">pol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set Alg -&gt; f (Set Alg)
</span><a href="#local-6989586621679401750"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Set Alg
</span><a href="#local-6989586621679401749"><span class="hs-identifier hs-var">algs</span></a></span></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span>  </span><span id="validationSettingsValidationPolicy"><span class="annot"><a href="Crypto.JOSE.JWS.html#validationSettingsValidationPolicy"><span class="hs-identifier hs-type">validationSettingsValidationPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679403041"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationPolicy"><span class="hs-identifier hs-type">ValidationPolicy</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span id="local-6989586621679401746"><span class="annot"><a href="Crypto.JOSE.JWS.html#validationSettingsValidationPolicy"><span class="hs-identifier hs-var hs-var">validationSettingsValidationPolicy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasValidationSettings a =&gt; Lens' a ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#validationSettings"><span class="hs-identifier hs-var">validationSettings</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *}.
Functor f =&gt;
(ValidationPolicy -&gt; f ValidationPolicy)
-&gt; ValidationSettings -&gt; f ValidationSettings
</span><a href="#local-6989586621679401741"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>    </span><span id="local-6989586621679401741"><span class="annot"><span class="annottext">go :: (ValidationPolicy -&gt; f ValidationPolicy)
-&gt; ValidationSettings -&gt; f ValidationSettings
</span><a href="#local-6989586621679401741"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679401738"><span class="annot"><span class="annottext">ValidationPolicy -&gt; f ValidationPolicy
</span><a href="#local-6989586621679401738"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-type">ValidationSettings</span></a></span><span> </span><span id="local-6989586621679401737"><span class="annot"><span class="annottext">Set Alg
</span><a href="#local-6989586621679401737"><span class="hs-identifier hs-var">algs</span></a></span></span><span> </span><span id="local-6989586621679401736"><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="#local-6989586621679401736"><span class="hs-identifier hs-var">pol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><span class="annottext">Set Alg -&gt; ValidationPolicy -&gt; ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-var">ValidationSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Set Alg
</span><a href="#local-6989586621679401737"><span class="hs-identifier hs-var">algs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy -&gt; f ValidationPolicy
</span><a href="#local-6989586621679401738"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="#local-6989586621679401736"><span class="hs-identifier hs-var">pol</span></a></span></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679401731"><span id="local-6989586621679401733"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-type">HasValidationSettings</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-type">ValidationSettings</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621679401728"><span class="annot"><span class="annottext">validationSettings :: Lens' ValidationSettings ValidationSettings
</span><a href="#local-6989586621679401728"><span class="hs-identifier hs-var hs-var hs-var hs-var">validationSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-keyword">class</span><span> </span><span id="HasAlgorithms"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasAlgorithms"><span class="hs-identifier hs-var">HasAlgorithms</span></a></span></span><span> </span><span id="local-6989586621679403033"><span class="annot"><a href="#local-6989586621679403033"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>  </span><span id="algorithms"><span class="annot"><a href="Crypto.JOSE.JWS.html#algorithms"><span class="hs-identifier hs-type">algorithms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679403033"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier hs-type">Alg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span class="hs-keyword">class</span><span> </span><span id="HasValidationPolicy"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationPolicy"><span class="hs-identifier hs-var">HasValidationPolicy</span></a></span></span><span> </span><span id="local-6989586621679403028"><span class="annot"><a href="#local-6989586621679403028"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-550"></span><span>  </span><span id="validationPolicy"><span class="annot"><a href="Crypto.JOSE.JWS.html#validationPolicy"><span class="hs-identifier hs-type">validationPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679403028"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationPolicy"><span class="hs-identifier hs-type">ValidationPolicy</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403031"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-type">HasValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403031"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasAlgorithms"><span class="hs-identifier hs-type">HasAlgorithms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403031"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621679401718"><span class="annot"><span class="annottext">algorithms :: Lens' a (Set Alg)
</span><a href="#local-6989586621679401718"><span class="hs-identifier hs-var hs-var hs-var hs-var">algorithms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasValidationSettings a =&gt; Lens' a (Set Alg)
</span><a href="Crypto.JOSE.JWS.html#validationSettingsAlgorithms"><span class="hs-identifier hs-var">validationSettingsAlgorithms</span></a></span><span>
</span><span id="line-554"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679403026"><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationSettings"><span class="hs-identifier hs-type">HasValidationSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403026"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationPolicy"><span class="hs-identifier hs-type">HasValidationPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403026"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679401710"><span class="annot"><span class="annottext">validationPolicy :: Lens' a ValidationPolicy
</span><a href="#local-6989586621679401710"><span class="hs-identifier hs-var hs-var hs-var hs-var">validationPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasValidationSettings a =&gt; Lens' a ValidationPolicy
</span><a href="Crypto.JOSE.JWS.html#validationSettingsValidationPolicy"><span class="hs-identifier hs-var">validationSettingsValidationPolicy</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">-- | The default validation settings.</span><span>
</span><span id="line-558"></span><span class="hs-comment">--</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- - All algorithms except &quot;none&quot; are acceptable.</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- - All signatures must be valid (and there must be at least one signature.)</span><span>
</span><span id="line-561"></span><span class="hs-comment">--</span><span>
</span><span id="line-562"></span><span class="annot"><a href="Crypto.JOSE.JWS.html#defaultValidationSettings"><span class="hs-identifier hs-type">defaultValidationSettings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-type">ValidationSettings</span></a></span><span>
</span><span id="line-563"></span><span id="defaultValidationSettings"><span class="annot"><span class="annottext">defaultValidationSettings :: ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#defaultValidationSettings"><span class="hs-identifier hs-var hs-var">defaultValidationSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Alg -&gt; ValidationPolicy -&gt; ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#ValidationSettings"><span class="hs-identifier hs-var">ValidationSettings</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#HS256"><span class="hs-identifier hs-var">HS256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#HS384"><span class="hs-identifier hs-var">HS384</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#HS512"><span class="hs-identifier hs-var">HS512</span></a></span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#RS256"><span class="hs-identifier hs-var">RS256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#RS384"><span class="hs-identifier hs-var">RS384</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#RS512"><span class="hs-identifier hs-var">RS512</span></a></span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#ES256"><span class="hs-identifier hs-var">ES256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#ES384"><span class="hs-identifier hs-var">ES384</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#ES512"><span class="hs-identifier hs-var">ES512</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#PS256"><span class="hs-identifier hs-var">PS256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#PS384"><span class="hs-identifier hs-var">PS384</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#PS512"><span class="hs-identifier hs-var">PS512</span></a></span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Alg
</span><a href="Crypto.JOSE.JWA.JWS.html#EdDSA"><span class="hs-identifier hs-var">EdDSA</span></a></span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>  </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="Crypto.JOSE.JWS.html#AllValidated"><span class="hs-identifier hs-var">AllValidated</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- | Verify a JWS with the default validation settings.</span><span>
</span><span id="line-574"></span><span class="hs-comment">--</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- See also 'defaultValidationSettings'.</span><span>
</span><span id="line-576"></span><span class="hs-comment">--</span><span>
</span><span id="line-577"></span><span id="local-6989586621679403016"><span id="local-6989586621679403018"><span id="local-6989586621679403019"><span id="local-6989586621679403020"><span id="local-6989586621679403021"><span id="local-6989586621679403022"><span id="local-6989586621679403023"><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWS%27"><span class="hs-identifier hs-type">verifyJWS'</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403023"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679403023"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403021"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403021"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.Store.html#VerificationKeyStore"><span class="hs-identifier hs-type">VerificationKeyStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403021"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403020"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403019"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403018"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679403019"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403019"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679403019"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679403016"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-582"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403020"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403018"><span class="hs-identifier hs-type">k</span></a></span><span>      </span><span class="hs-comment">-- ^ key or key store</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403016"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403020"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403021"><span class="hs-identifier hs-type">h</span></a></span><span>  </span><span class="hs-comment">-- ^ JWS</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403022"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403019"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-587"></span><span id="verifyJWS%27"><span class="annot"><span class="annottext">verifyJWS' :: forall e (m :: * -&gt; *) (h :: * -&gt; *) p s k (t :: * -&gt; *).
(AsError e, MonadError e m, HasJWSHeader h, HasParams h,
 VerificationKeyStore m (h p) s k, Cons s s Word8 Word8, AsEmpty s,
 Foldable t, ProtectionIndicator p) =&gt;
k -&gt; JWS t p h -&gt; m s
</span><a href="Crypto.JOSE.JWS.html#verifyJWS%27"><span class="hs-identifier hs-var hs-var">verifyJWS'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a e (m :: * -&gt; *) (h :: * -&gt; *) p s k (t :: * -&gt; *).
(HasAlgorithms a, HasValidationPolicy a, AsError e, MonadError e m,
 HasJWSHeader h, HasParams h, VerificationKeyStore m (h p) s k,
 Cons s s Word8 Word8, AsEmpty s, Foldable t,
 ProtectionIndicator p) =&gt;
a -&gt; k -&gt; JWS t p h -&gt; m s
</span><a href="Crypto.JOSE.JWS.html#verifyJWS"><span class="hs-identifier hs-var">verifyJWS</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationSettings
</span><a href="Crypto.JOSE.JWS.html#defaultValidationSettings"><span class="hs-identifier hs-var">defaultValidationSettings</span></a></span><span>
</span><span id="line-588"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWS%27"><span class="hs-pragma hs-type">verifyJWS'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">-- | Verify a JWS.</span><span>
</span><span id="line-591"></span><span class="hs-comment">--</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- Signatures made with an unsupported algorithms are ignored.</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- If the validation policy is 'AnyValidated', a single successfully</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- validated signature is sufficient.  If the validation policy is</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- 'AllValidated' then all remaining signatures (there must be at least one)</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- must be valid.</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- Returns the payload if successfully verified.</span><span>
</span><span id="line-599"></span><span class="hs-comment">--</span><span>
</span><span id="line-600"></span><span id="local-6989586621679403001"><span id="local-6989586621679403002"><span id="local-6989586621679403003"><span id="local-6989586621679403004"><span id="local-6989586621679403005"><span id="local-6989586621679403006"><span id="local-6989586621679403007"><span id="local-6989586621679403008"><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWS"><span class="hs-identifier hs-type">verifyJWS</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasAlgorithms"><span class="hs-identifier hs-type">HasAlgorithms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationPolicy"><span class="hs-identifier hs-type">HasValidationPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403008"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403007"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679403007"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403006"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403005"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403005"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.Store.html#VerificationKeyStore"><span class="hs-identifier hs-type">VerificationKeyStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679403005"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403004"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679403003"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403002"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679403003"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403003"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679403003"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679403001"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-606"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403004"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-607"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403008"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ validation settings</span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403002"><span class="hs-identifier hs-type">k</span></a></span><span>        </span><span class="hs-comment">-- ^ key or key store</span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403001"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403004"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403005"><span class="hs-identifier hs-type">h</span></a></span><span>  </span><span class="hs-comment">-- ^ JWS</span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403003"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-612"></span><span id="verifyJWS"><span class="annot"><span class="annottext">verifyJWS :: forall a e (m :: * -&gt; *) (h :: * -&gt; *) p s k (t :: * -&gt; *).
(HasAlgorithms a, HasValidationPolicy a, AsError e, MonadError e m,
 HasJWSHeader h, HasParams h, VerificationKeyStore m (h p) s k,
 Cons s s Word8 Word8, AsEmpty s, Foldable t,
 ProtectionIndicator p) =&gt;
a -&gt; k -&gt; JWS t p h -&gt; m s
</span><a href="Crypto.JOSE.JWS.html#verifyJWS"><span class="hs-identifier hs-var hs-var">verifyJWS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a e (m :: * -&gt; *) (h :: * -&gt; *) p payload k s (t :: * -&gt; *).
(HasAlgorithms a, HasValidationPolicy a, AsError e, MonadError e m,
 HasJWSHeader h, HasParams h,
 VerificationKeyStore m (h p) payload k, Cons s s Word8 Word8,
 AsEmpty s, Foldable t, ProtectionIndicator p) =&gt;
(s -&gt; m payload) -&gt; a -&gt; k -&gt; JWS t p h -&gt; m payload
</span><a href="Crypto.JOSE.JWS.html#verifyJWSWithPayload"><span class="hs-identifier hs-var">verifyJWSWithPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-613"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWS"><span class="hs-pragma hs-type">verifyJWS</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span id="local-6989586621679402984"><span id="local-6989586621679402985"><span id="local-6989586621679402986"><span id="local-6989586621679402987"><span id="local-6989586621679402988"><span id="local-6989586621679402989"><span id="local-6989586621679402990"><span id="local-6989586621679402991"><span id="local-6989586621679402992"><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWSWithPayload"><span class="hs-identifier hs-type">verifyJWSWithPayload</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasAlgorithms"><span class="hs-identifier hs-type">HasAlgorithms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasValidationPolicy"><span class="hs-identifier hs-type">HasValidationPolicy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#AsError"><span class="hs-identifier hs-type">AsError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402991"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679402991"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402990"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-617"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402989"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402989"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-618"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.Store.html#VerificationKeyStore"><span class="hs-identifier hs-type">VerificationKeyStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679402989"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402988"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679402987"><span class="hs-identifier hs-type">payload</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402986"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-619"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679402985"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402985"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679402985"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-620"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679402984"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-621"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402988"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-622"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679402985"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402987"><span class="hs-identifier hs-type">payload</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ payload decoder</span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402992"><span class="hs-identifier hs-type">a</span></a></span><span>                 </span><span class="hs-comment">-- ^ validation settings</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402986"><span class="hs-identifier hs-type">k</span></a></span><span>                 </span><span class="hs-comment">-- ^ key or key store</span><span>
</span><span id="line-626"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402984"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402988"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402989"><span class="hs-identifier hs-type">h</span></a></span><span>         </span><span class="hs-comment">-- ^ JWS</span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402987"><span class="hs-identifier hs-type">payload</span></a></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-628"></span><span id="verifyJWSWithPayload"><span class="annot"><span class="annottext">verifyJWSWithPayload :: forall a e (m :: * -&gt; *) (h :: * -&gt; *) p payload k s (t :: * -&gt; *).
(HasAlgorithms a, HasValidationPolicy a, AsError e, MonadError e m,
 HasJWSHeader h, HasParams h,
 VerificationKeyStore m (h p) payload k, Cons s s Word8 Word8,
 AsEmpty s, Foldable t, ProtectionIndicator p) =&gt;
(s -&gt; m payload) -&gt; a -&gt; k -&gt; JWS t p h -&gt; m payload
</span><a href="Crypto.JOSE.JWS.html#verifyJWSWithPayload"><span class="hs-identifier hs-var hs-var">verifyJWSWithPayload</span></a></span></span><span> </span><span id="local-6989586621679401595"><span class="annot"><span class="annottext">s -&gt; m payload
</span><a href="#local-6989586621679401595"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679401594"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401594"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679401593"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679401593"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#JWS"><span class="hs-identifier hs-type">JWS</span></a></span><span> </span><span id="local-6989586621679401592"><span class="annot"><span class="annottext">p :: Base64Octets
</span><a href="#local-6989586621679401592"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679401591"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401591"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679401590"><span class="annot"><span class="annottext">t (Signature p h)
</span><a href="#local-6989586621679401590"><span class="hs-identifier hs-var">sigs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="#local-6989586621679401589"><span class="hs-identifier hs-type">algs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWS.html#Alg"><span class="hs-identifier hs-type">Alg</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621679401589"><span class="annot"><span class="annottext">algs :: Set Alg
</span><a href="#local-6989586621679401589"><span class="hs-identifier hs-var hs-var">algs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401594"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s. HasAlgorithms s =&gt; Lens' s (Set Alg)
</span><a href="Crypto.JOSE.JWS.html#algorithms"><span class="hs-identifier hs-var">algorithms</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><a href="#local-6989586621679401588"><span class="hs-identifier hs-type">policy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#ValidationPolicy"><span class="hs-identifier hs-type">ValidationPolicy</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span id="local-6989586621679401588"><span class="annot"><span class="annottext">policy :: ValidationPolicy
</span><a href="#local-6989586621679401588"><span class="hs-identifier hs-var hs-var">policy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401594"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall s. HasValidationPolicy s =&gt; Lens' s ValidationPolicy
</span><a href="Crypto.JOSE.JWS.html#validationPolicy"><span class="hs-identifier hs-var">validationPolicy</span></a></span><span>
</span><span id="line-634"></span><span>    </span><span id="local-6989586621679401577"><span class="annot"><span class="annottext">shouldValidateSig :: Signature p h -&gt; Bool
</span><a href="#local-6989586621679401577"><span class="hs-identifier hs-var hs-var">shouldValidateSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Set Alg
</span><a href="#local-6989586621679401589"><span class="hs-identifier hs-var">algs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p (a :: * -&gt; *). Getter (Signature p a) (a p)
</span><a href="Crypto.JOSE.JWS.html#header"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasAlg a =&gt; Lens' (a p) (HeaderParam p Alg)
</span><a href="Crypto.JOSE.Header.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679401555"><span class="annot"><span class="annottext">applyPolicy :: ValidationPolicy -&gt; [Bool] -&gt; f ()
</span><a href="#local-6989586621679401555"><span class="hs-identifier hs-var hs-var">applyPolicy</span></a></span></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="Crypto.JOSE.JWS.html#AnyValidated"><span class="hs-identifier hs-var">AnyValidated</span></a></span><span> </span><span id="local-6989586621679401554"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679401554"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679401554"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r ()
</span><a href="Crypto.JOSE.Error.html#_JWSNoValidSignatures"><span class="hs-identifier hs-var">_JWSNoValidSignatures</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">applyPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="Crypto.JOSE.JWS.html#AllValidated"><span class="hs-identifier hs-var">AllValidated</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r ()
</span><a href="Crypto.JOSE.Error.html#_JWSNoSignatures"><span class="hs-identifier hs-var">_JWSNoSignatures</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="annot"><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">applyPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="Crypto.JOSE.JWS.html#AllValidated"><span class="hs-identifier hs-var">AllValidated</span></a></span><span> </span><span id="local-6989586621679401550"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679401550"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679401550"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r ()
</span><a href="Crypto.JOSE.Error.html#_JWSInvalidSignature"><span class="hs-identifier hs-var">_JWSInvalidSignature</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679401547"><span class="annot"><span class="annottext">validate :: payload -&gt; Signature p h -&gt; m Bool
</span><a href="#local-6989586621679401547"><span class="hs-identifier hs-var hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679401546"><span class="annot"><span class="annottext">payload
</span><a href="#local-6989586621679401546"><span class="hs-identifier hs-var">payload</span></a></span></span><span> </span><span id="local-6989586621679401545"><span class="annot"><span class="annottext">Signature p h
</span><a href="#local-6989586621679401545"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>      </span><span id="local-6989586621679401544"><span class="annot"><span class="annottext">[JWK]
</span><a href="#local-6989586621679401544"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) h s a.
VerificationKeyStore m h s a =&gt;
h -&gt; s -&gt; a -&gt; m [JWK]
</span><a href="Crypto.JOSE.JWK.Store.html#getVerificationKeys"><span class="hs-identifier hs-var">getVerificationKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall p (a :: * -&gt; *). Getter (Signature p a) (a p)
</span><a href="Crypto.JOSE.JWS.html#header"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Signature p h
</span><a href="#local-6989586621679401545"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">payload
</span><a href="#local-6989586621679401546"><span class="hs-identifier hs-var">payload</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679401593"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-642"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[JWK]
</span><a href="#local-6989586621679401544"><span class="hs-identifier hs-var">keys</span></a></span><span>
</span><span id="line-643"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) x. MonadError e m =&gt; AReview e () -&gt; m x
</span><span class="hs-identifier hs-var">throwing_</span></span><span> </span><span class="annot"><span class="annottext">forall r. AsError r =&gt; Prism' r ()
</span><a href="Crypto.JOSE.Error.html#_NoUsableKeys"><span class="hs-identifier hs-var">_NoUsableKeys</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasJWSHeader a, HasParams a, ProtectionIndicator p) =&gt;
Base64Octets -&gt; Signature p a -&gt; JWK -&gt; Either Error Bool
</span><a href="Crypto.JOSE.JWS.html#verifySig"><span class="hs-identifier hs-var">verifySig</span></a></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401592"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Signature p h
</span><a href="#local-6989586621679401545"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[JWK]
</span><a href="#local-6989586621679401544"><span class="hs-identifier hs-var">keys</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621679401538"><span class="annot"><span class="annottext">payload
</span><a href="#local-6989586621679401538"><span class="hs-identifier hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s -&gt; m payload
</span><a href="#local-6989586621679401595"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall s1 a s2.
(Cons s1 s1 a a, Cons s2 s2 a a, AsEmpty s2) =&gt;
Getter s1 s2
</span><span class="hs-identifier hs-var">recons</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401591"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621679401537"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679401537"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">payload -&gt; Signature p h -&gt; m Bool
</span><a href="#local-6989586621679401547"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">payload
</span><a href="#local-6989586621679401538"><span class="hs-identifier hs-var">payload</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">forall {p}. Signature p h -&gt; Bool
</span><a href="#local-6989586621679401577"><span class="hs-identifier hs-var">shouldValidateSig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">t (Signature p h)
</span><a href="#local-6989586621679401590"><span class="hs-identifier hs-var">sigs</span></a></span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><span class="annottext">payload
</span><a href="#local-6989586621679401538"><span class="hs-identifier hs-var">payload</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">forall {e} {f :: * -&gt; *}.
(MonadError e f, AsError e) =&gt;
ValidationPolicy -&gt; [Bool] -&gt; f ()
</span><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">applyPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPolicy
</span><a href="#local-6989586621679401588"><span class="hs-identifier hs-var">policy</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679401537"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-649"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#verifyJWSWithPayload"><span class="hs-pragma hs-type">verifyJWSWithPayload</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span id="local-6989586621679402952"><span id="local-6989586621679402953"><span class="annot"><a href="Crypto.JOSE.JWS.html#verifySig"><span class="hs-identifier hs-type">verifySig</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#HasJWSHeader"><span class="hs-identifier hs-type">HasJWSHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402953"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402953"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402952"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402952"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402953"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-657"></span><span id="verifySig"><span class="annot"><span class="annottext">verifySig :: forall (a :: * -&gt; *) p.
(HasJWSHeader a, HasParams a, ProtectionIndicator p) =&gt;
Base64Octets -&gt; Signature p a -&gt; JWK -&gt; Either Error Bool
</span><a href="Crypto.JOSE.JWS.html#verifySig"><span class="hs-identifier hs-var hs-var">verifySig</span></a></span></span><span> </span><span id="local-6989586621679401519"><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401519"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679401518"><span class="annot"><span class="annottext">sig :: Signature p a
</span><a href="#local-6989586621679401518"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWS.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401517"><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401517"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679401516"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401516"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679401515"><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679401515"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-658"></span><span>  </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *).
(MonadError e m, AsError e) =&gt;
Alg -&gt; KeyMaterial -&gt; ByteString -&gt; ByteString -&gt; m Bool
</span><a href="Crypto.JOSE.JWA.JWK.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. HasAlg a =&gt; Lens' (a p) (HeaderParam p Alg)
</span><a href="Crypto.JOSE.Header.html#alg"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall p a. Lens' (HeaderParam p a) a
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a p
</span><a href="#local-6989586621679401517"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Lens' JWK KeyMaterial
</span><a href="Crypto.JOSE.JWK.html#jwkMaterial"><span class="hs-identifier hs-var">jwkMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">JWK
</span><a href="#local-6989586621679401515"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401513"><span class="hs-identifier hs-var">tbs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679401516"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-660"></span><span>  </span><span id="local-6989586621679401513"><span class="annot"><span class="annottext">tbs :: ByteString
</span><a href="#local-6989586621679401513"><span class="hs-identifier hs-var hs-var">tbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Signature p a -&gt; Base64Octets -&gt; ByteString
</span><a href="Crypto.JOSE.JWS.html#signingInput"><span class="hs-identifier hs-var">signingInput</span></a></span><span> </span><span class="annot"><span class="annottext">Signature p a
</span><a href="#local-6989586621679401518"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Base64Octets
</span><a href="#local-6989586621679401519"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-661"></span></pre></body></html>