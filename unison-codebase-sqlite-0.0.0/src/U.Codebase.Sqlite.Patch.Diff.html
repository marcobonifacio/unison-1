<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">U.Codebase.Sqlite.Patch.Diff</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bimap</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Reference</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reference'</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Referent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Referent'</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.DbId.html"><span class="hs-identifier">U.Codebase.Sqlite.DbId</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Db</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html"><span class="hs-identifier">U.Codebase.Sqlite.LocalIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html#LocalDefnId"><span class="hs-identifier">LocalDefnId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html#LocalHashId"><span class="hs-identifier">LocalHashId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html#LocalTextId"><span class="hs-identifier">LocalTextId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TermEdit.html"><span class="hs-identifier">U.Codebase.Sqlite.Patch.TermEdit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TermEdit.html#TermEdit%27"><span class="hs-identifier">TermEdit'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TypeEdit.html"><span class="hs-identifier">U.Codebase.Sqlite.Patch.TypeEdit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TypeEdit.html#TypeEdit%27"><span class="hs-identifier">TypeEdit'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Util.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">type</span><span> </span><span id="PatchDiff"><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff"><span class="hs-identifier hs-var">PatchDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff%27"><span class="hs-identifier hs-type">PatchDiff'</span></a></span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.DbId.html#TextId"><span class="hs-identifier hs-type">Db.TextId</span></a></span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.DbId.html#HashId"><span class="hs-identifier hs-type">Db.HashId</span></a></span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.DbId.html#ObjectId"><span class="hs-identifier hs-type">Db.ObjectId</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">type</span><span> </span><span id="LocalPatchDiff"><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#LocalPatchDiff"><span class="hs-identifier hs-var">LocalPatchDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff%27"><span class="hs-identifier hs-type">PatchDiff'</span></a></span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html#LocalTextId"><span class="hs-identifier hs-type">LocalTextId</span></a></span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html#LocalHashId"><span class="hs-identifier hs-type">LocalHashId</span></a></span><span> </span><span class="annot"><a href="U.Codebase.Sqlite.LocalIds.html#LocalDefnId"><span class="hs-identifier hs-type">LocalDefnId</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">type</span><span> </span><span id="Referent%27%27"><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#Referent%27%27"><span class="hs-identifier hs-var">Referent''</span></a></span></span><span> </span><span id="local-6989586621679579797"><span class="annot"><a href="#local-6989586621679579797"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679579796"><span class="annot"><a href="#local-6989586621679579796"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referent'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reference'</span></span><span> </span><span class="annot"><a href="#local-6989586621679579797"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579796"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reference'</span></span><span> </span><span class="annot"><a href="#local-6989586621679579797"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579796"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- | diff. = min. - sub.</span><span>
</span><span id="line-22"></span><span class="hs-keyword">data</span><span> </span><span id="PatchDiff%27"><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff%27"><span class="hs-identifier hs-var">PatchDiff'</span></a></span></span><span> </span><span id="local-6989586621679579910"><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679579909"><span class="annot"><a href="#local-6989586621679579909"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679579908"><span class="annot"><a href="#local-6989586621679579908"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PatchDiff"><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff"><span class="hs-identifier hs-var">PatchDiff</span></a></span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | elements present in min. but absent in sub.</span><span>
</span><span id="line-24"></span><span>    </span><span id="%24sel%3AaddedTermEdits%3APatchDiff"><span class="annot"><span class="annottext">forall t h d.
PatchDiff' t h d -&gt; Map (Referent'' t h) (Set (TermEdit' t d))
</span><a href="U.Codebase.Sqlite.Patch.Diff.html#%24sel%3AaddedTermEdits%3APatchDiff"><span class="hs-identifier hs-var hs-var">addedTermEdits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#Referent%27%27"><span class="hs-identifier hs-type">Referent''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579909"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TermEdit.html#TermEdit%27"><span class="hs-identifier hs-type">TermEdit'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579908"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span id="%24sel%3AaddedTypeEdits%3APatchDiff"><span class="annot"><span class="annottext">forall t h d.
PatchDiff' t h d -&gt; Map (Reference' t h) (Set (TypeEdit' t d))
</span><a href="U.Codebase.Sqlite.Patch.Diff.html#%24sel%3AaddedTypeEdits%3APatchDiff"><span class="hs-identifier hs-var hs-var">addedTypeEdits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reference'</span></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579909"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TypeEdit.html#TypeEdit%27"><span class="hs-identifier hs-type">TypeEdit'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579908"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-comment">-- | elements missing in min. but present in sub.</span><span>
</span><span id="line-27"></span><span>    </span><span id="%24sel%3AremovedTermEdits%3APatchDiff"><span class="annot"><span class="annottext">forall t h d.
PatchDiff' t h d -&gt; Map (Referent'' t h) (Set (TermEdit' t d))
</span><a href="U.Codebase.Sqlite.Patch.Diff.html#%24sel%3AremovedTermEdits%3APatchDiff"><span class="hs-identifier hs-var hs-var">removedTermEdits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#Referent%27%27"><span class="hs-identifier hs-type">Referent''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579909"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TermEdit.html#TermEdit%27"><span class="hs-identifier hs-type">TermEdit'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579908"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span id="%24sel%3AremovedTypeEdits%3APatchDiff"><span class="annot"><span class="annottext">forall t h d.
PatchDiff' t h d -&gt; Map (Reference' t h) (Set (TypeEdit' t d))
</span><a href="U.Codebase.Sqlite.Patch.Diff.html#%24sel%3AremovedTypeEdits%3APatchDiff"><span class="hs-identifier hs-var hs-var">removedTypeEdits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reference'</span></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579909"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.TypeEdit.html#TypeEdit%27"><span class="hs-identifier hs-type">TypeEdit'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579910"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579908"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679579778"><span id="local-6989586621679579789"><span class="annot"><span class="annottext">PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall t h d.
(Eq t, Eq h, Eq d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
/= :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
$c/= :: forall t h d.
(Eq t, Eq h, Eq d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
== :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
$c== :: forall t h d.
(Eq t, Eq h, Eq d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679579733"><span id="local-6989586621679579735"><span id="local-6989586621679579738"><span id="local-6989586621679579741"><span id="local-6989586621679579744"><span id="local-6989586621679579754"><span id="local-6989586621679579765"><span class="annot"><span class="annottext">PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {t} {h} {d}. (Ord t, Ord h, Ord d) =&gt; Eq (PatchDiff' t h d)
forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Ordering
forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; PatchDiff' t h d
min :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; PatchDiff' t h d
$cmin :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; PatchDiff' t h d
max :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; PatchDiff' t h d
$cmax :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; PatchDiff' t h d
&gt;= :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
$c&gt;= :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
&gt; :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
$c&gt; :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
&lt;= :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
$c&lt;= :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
&lt; :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
$c&lt; :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Bool
compare :: PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Ordering
$ccompare :: forall t h d.
(Ord t, Ord h, Ord d) =&gt;
PatchDiff' t h d -&gt; PatchDiff' t h d -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679579704"><span id="local-6989586621679579706"><span id="local-6989586621679579719"><span class="annot"><span class="annottext">Int -&gt; PatchDiff' t h d -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall t h d.
(Show t, Show h, Show d) =&gt;
Int -&gt; PatchDiff' t h d -&gt; ShowS
forall t h d.
(Show t, Show h, Show d) =&gt;
[PatchDiff' t h d] -&gt; ShowS
forall t h d.
(Show t, Show h, Show d) =&gt;
PatchDiff' t h d -&gt; String
showList :: [PatchDiff' t h d] -&gt; ShowS
$cshowList :: forall t h d.
(Show t, Show h, Show d) =&gt;
[PatchDiff' t h d] -&gt; ShowS
show :: PatchDiff' t h d -&gt; String
$cshow :: forall t h d.
(Show t, Show h, Show d) =&gt;
PatchDiff' t h d -&gt; String
showsPrec :: Int -&gt; PatchDiff' t h d -&gt; ShowS
$cshowsPrec :: forall t h d.
(Show t, Show h, Show d) =&gt;
Int -&gt; PatchDiff' t h d -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621679579846"><span id="local-6989586621679579847"><span id="local-6989586621679579848"><span id="local-6989586621679579849"><span id="local-6989586621679579850"><span id="local-6989586621679579851"><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#trimap"><span class="hs-identifier hs-type">trimap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679579851"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679579850"><span class="hs-identifier hs-type">h'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679579849"><span class="hs-identifier hs-type">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679579848"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679579851"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679579847"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679579850"><span class="hs-identifier hs-type">h'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679579846"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679579849"><span class="hs-identifier hs-type">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff%27"><span class="hs-identifier hs-type">PatchDiff'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579848"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579847"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579846"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff%27"><span class="hs-identifier hs-type">PatchDiff'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579851"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579850"><span class="hs-identifier hs-type">h'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679579849"><span class="hs-identifier hs-type">d'</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-39"></span><span id="trimap"><span class="annot"><span class="annottext">trimap :: forall t' h' d' t h d.
(Ord t', Ord h', Ord d') =&gt;
(t -&gt; t')
-&gt; (h -&gt; h')
-&gt; (d -&gt; d')
-&gt; PatchDiff' t h d
-&gt; PatchDiff' t' h' d'
</span><a href="U.Codebase.Sqlite.Patch.Diff.html#trimap"><span class="hs-identifier hs-var hs-var">trimap</span></a></span></span><span> </span><span id="local-6989586621679579667"><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span id="local-6989586621679579666"><span class="annot"><span class="annottext">h -&gt; h'
</span><a href="#local-6989586621679579666"><span class="hs-identifier hs-var">fh</span></a></span></span><span> </span><span id="local-6989586621679579665"><span class="annot"><span class="annottext">d -&gt; d'
</span><a href="#local-6989586621679579665"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff"><span class="hs-identifier hs-type">PatchDiff</span></a></span><span> </span><span id="local-6989586621679579664"><span class="annot"><span class="annottext">Map (Referent'' t h) (Set (TermEdit' t d))
</span><a href="#local-6989586621679579664"><span class="hs-identifier hs-var">atm</span></a></span></span><span> </span><span id="local-6989586621679579663"><span class="annot"><span class="annottext">Map (Reference' t h) (Set (TypeEdit' t d))
</span><a href="#local-6989586621679579663"><span class="hs-identifier hs-var">atp</span></a></span></span><span> </span><span id="local-6989586621679579662"><span class="annot"><span class="annottext">Map (Referent'' t h) (Set (TermEdit' t d))
</span><a href="#local-6989586621679579662"><span class="hs-identifier hs-var">rtm</span></a></span></span><span> </span><span id="local-6989586621679579661"><span class="annot"><span class="annottext">Map (Reference' t h) (Set (TypeEdit' t d))
</span><a href="#local-6989586621679579661"><span class="hs-identifier hs-var">rtp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="annottext">forall t h d.
Map (Referent'' t h) (Set (TermEdit' t d))
-&gt; Map (Reference' t h) (Set (TypeEdit' t d))
-&gt; Map (Referent'' t h) (Set (TermEdit' t d))
-&gt; Map (Reference' t h) (Set (TypeEdit' t d))
-&gt; PatchDiff' t h d
</span><a href="U.Codebase.Sqlite.Patch.Diff.html#PatchDiff"><span class="hs-identifier hs-var">PatchDiff</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a' a b b'.
Ord a' =&gt;
(a -&gt; a') -&gt; (b -&gt; b') -&gt; Map a b -&gt; Map a' b'
</span><span class="hs-identifier hs-var">Map.bimap</span></span><span> </span><span class="annot"><span class="annottext">Referent'' t h -&gt; Referent'' t' h'
</span><a href="#local-6989586621679579659"><span class="hs-identifier hs-var">bimapReferent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; d'
</span><a href="#local-6989586621679579665"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Referent'' t h) (Set (TermEdit' t d))
</span><a href="#local-6989586621679579664"><span class="hs-identifier hs-var">atm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a' a b b'.
Ord a' =&gt;
(a -&gt; a') -&gt; (b -&gt; b') -&gt; Map a b -&gt; Map a' b'
</span><span class="hs-identifier hs-var">Map.bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">h -&gt; h'
</span><a href="#local-6989586621679579666"><span class="hs-identifier hs-var">fh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; d'
</span><a href="#local-6989586621679579665"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Reference' t h) (Set (TypeEdit' t d))
</span><a href="#local-6989586621679579663"><span class="hs-identifier hs-var">atp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a' a b b'.
Ord a' =&gt;
(a -&gt; a') -&gt; (b -&gt; b') -&gt; Map a b -&gt; Map a' b'
</span><span class="hs-identifier hs-var">Map.bimap</span></span><span> </span><span class="annot"><span class="annottext">Referent'' t h -&gt; Referent'' t' h'
</span><a href="#local-6989586621679579659"><span class="hs-identifier hs-var">bimapReferent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; d'
</span><a href="#local-6989586621679579665"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Referent'' t h) (Set (TermEdit' t d))
</span><a href="#local-6989586621679579662"><span class="hs-identifier hs-var">rtm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a' a b b'.
Ord a' =&gt;
(a -&gt; a') -&gt; (b -&gt; b') -&gt; Map a b -&gt; Map a' b'
</span><span class="hs-identifier hs-var">Map.bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">h -&gt; h'
</span><a href="#local-6989586621679579666"><span class="hs-identifier hs-var">fh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; d'
</span><a href="#local-6989586621679579665"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Reference' t h) (Set (TypeEdit' t d))
</span><a href="#local-6989586621679579661"><span class="hs-identifier hs-var">rtp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679579659"><span class="annot"><span class="annottext">bimapReferent :: Referent'' t h -&gt; Referent'' t' h'
</span><a href="#local-6989586621679579659"><span class="hs-identifier hs-var hs-var">bimapReferent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">h -&gt; h'
</span><a href="#local-6989586621679579666"><span class="hs-identifier hs-var">fh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t'
</span><a href="#local-6989586621679579667"><span class="hs-identifier hs-var">ft</span></a></span><span> </span><span class="annot"><span class="annottext">h -&gt; h'
</span><a href="#local-6989586621679579666"><span class="hs-identifier hs-var">fh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span></pre></body></html>