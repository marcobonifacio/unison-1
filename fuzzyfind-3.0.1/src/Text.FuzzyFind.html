<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLists #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">{-|
Module      : FuzzyFind
Description : Provides fuzzy matching on text
Copyright   : Unison Computing, 2021
License     : MIT
Maintainer  : runar.bjarnason@unison.cloud
Stability   : experimental

A package that provides an API for fuzzy text search in Haskell, using a
modified version of the Smith-Waterman algorithm. The search is intended to
behave similarly to the excellent fzf tool by Junegunn Choi.
-}</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.FuzzyFind</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Massiv.Array</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-identifier">Ix2</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-operator">(...)</span></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-identifier">forM_</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Massiv.Array</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Massiv.Array.Unsafe</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Massiv.Array.Mutable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isAlphaNum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isLower</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isUpper</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maximumBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runST</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-identifier">ViewL</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-identifier">ViewR</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-identifier">viewl</span></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-identifier">viewr</span></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | @bestMatch query string@ will return 'Nothing' if @query@ is not a</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- subsequence of @string@. Otherwise, it will return the &quot;best&quot; way to line up</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- the characters in @query@ with the characters in @string@. Lower-case</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- characters in the @query@ are assumed to be case-insensitive, and upper-case</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- characters are assumed to be case-sensitive.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt; bestMatch &quot;ff&quot; \&quot;FuzzyFind\&quot;</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- Just (Alignment {score = 25, result = Result {[Match \&quot;F\&quot;, Gap &quot;uzzy&quot;, Match \&quot;F\&quot;, Gap &quot;ind&quot;]}})</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- The score indicates how &quot;good&quot; the match is. Better matches have higher</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- scores. There's no maximum score (except for the upper limit of the 'Int'</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- datatype), but the lowest score is @0@.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- A substring from the query will generate a 'Match', and any characters from</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- the input that don't result in a 'Match' will generate a 'Gap'.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Concatenating all the 'Match' and 'Gap' results should yield the original</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- input string.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Note that the matched characters in the input always occur in the same order</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- as they do in the query pattern.</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- The algorithm prefers (and will generate higher scores for) the following</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- kinds of matches:</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">--   1. Contiguous characters from the query string. For example, @bestMatch &quot;pp&quot;@</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- will find the last two ps in &quot;pickled pepper&quot;.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--   2. Characters at the beginnings of words. For example, @bestMatch &quot;pp&quot;@</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- will find the first two Ps in \&quot;Peter Piper\&quot;.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--   3. Characters at CamelCase humps. For example, @bestMatch &quot;bm&quot; \&quot;BatMan\&quot;@</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- will score higher than @bestMatch &quot;bm&quot; \&quot;Batman\&quot;.@</span><span>
</span><span id="line-88"></span><span class="hs-comment">--   4. The algorithm strongly prefers the first character of the query pattern</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- to be at the beginning of a word or CamelHump. For example,</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- @bestMatch &quot;mn&quot; \&quot;Bat Man\&quot;@ will score higher than @bestMatch &quot;atn&quot; \&quot;Batman\&quot;@.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- All else being equal, matches that occur later in the input string are preferred.</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Text.FuzzyFind.html#bestMatch"><span class="hs-identifier hs-type">bestMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ The query pattern.</span><span>
</span><span id="line-94"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ The input string.</span><span>
</span><span id="line-95"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span>
</span><span id="line-96"></span><span id="bestMatch"><span class="annot"><span class="annottext">bestMatch :: [Char] -&gt; [Char] -&gt; Maybe Alignment
</span><a href="Text.FuzzyFind.html#bestMatch"><span class="hs-identifier hs-var hs-var">bestMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; [Char]
-&gt; [Char]
-&gt; Maybe Alignment
</span><a href="Text.FuzzyFind.html#bestMatch%27"><span class="hs-identifier hs-var">bestMatch'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultMatchScore"><span class="hs-identifier hs-var">defaultMatchScore</span></a></span><span>
</span><span id="line-97"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultMismatchScore"><span class="hs-identifier hs-var">defaultMismatchScore</span></a></span><span>
</span><span id="line-98"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultGapPenalty"><span class="hs-identifier hs-var">defaultGapPenalty</span></a></span><span>
</span><span id="line-99"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultBoundaryBonus"><span class="hs-identifier hs-var">defaultBoundaryBonus</span></a></span><span>
</span><span id="line-100"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultCamelCaseBonus"><span class="hs-identifier hs-var">defaultCamelCaseBonus</span></a></span><span>
</span><span id="line-101"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultFirstCharBonusMultiplier"><span class="hs-identifier hs-var">defaultFirstCharBonusMultiplier</span></a></span><span>
</span><span id="line-102"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultConsecutiveBonus"><span class="hs-identifier hs-var">defaultConsecutiveBonus</span></a></span><span>
</span><span id="line-103"></span><span>                       </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultLaterBonusMultiplier"><span class="hs-identifier hs-var">defaultLaterBonusMultiplier</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Finds input strings that match all the given input patterns. For each input</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- that matches, it returns one 'Alignment'. The output is not sorted.</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- ascending.</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt; import Data.Foldable</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt; traverse_ (putStrLn . (&quot;\\n&quot; ++) . highlight) $ fuzzyFind [&quot;dad&quot;, &quot;mac&quot;, &quot;dam&quot;] [&quot;red macadamia&quot;, &quot;Madam Card&quot;]</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- Madam Card</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- * *** ** *</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- red macadamia</span><span>
</span><span id="line-119"></span><span class="hs-comment">--   * *******</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-121"></span><span class="annot"><a href="Text.FuzzyFind.html#fuzzyFind"><span class="hs-identifier hs-type">fuzzyFind</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The query patterns.</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The input strings.</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span id="fuzzyFind"><span class="annot"><span class="annottext">fuzzyFind :: [[Char]] -&gt; [[Char]] -&gt; [Alignment]
</span><a href="Text.FuzzyFind.html#fuzzyFind"><span class="hs-identifier hs-var hs-var">fuzzyFind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; [Char]) -&gt; [[Char]] -&gt; [a] -&gt; [(Alignment, a)]
</span><a href="Text.FuzzyFind.html#fuzzyFindOn"><span class="hs-identifier hs-var">fuzzyFindOn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | A version of 'fuzzyFind' that searches on the given text field of the data.</span><span>
</span><span id="line-128"></span><span id="local-6989586621679068063"><span class="annot"><a href="Text.FuzzyFind.html#fuzzyFindOn"><span class="hs-identifier hs-type">fuzzyFindOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679068063"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068063"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679068063"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-129"></span><span id="fuzzyFindOn"><span class="annot"><span class="annottext">fuzzyFindOn :: forall a. (a -&gt; [Char]) -&gt; [[Char]] -&gt; [a] -&gt; [(Alignment, a)]
</span><a href="Text.FuzzyFind.html#fuzzyFindOn"><span class="hs-identifier hs-var hs-var">fuzzyFindOn</span></a></span></span><span> </span><span id="local-6989586621679067754"><span class="annot"><span class="annottext">a -&gt; [Char]
</span><a href="#local-6989586621679067754"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679067753"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679067753"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679067752"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067752"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067752"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679067751"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067751"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>   </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067751"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679067749"><span class="annot"><span class="annottext">Maybe Alignment
</span><a href="#local-6989586621679067749"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679067748"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067748"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Alignment
</span><a href="#local-6989586621679067749"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Maybe Alignment
</span><a href="Text.FuzzyFind.html#bestMatch"><span class="hs-identifier hs-var">bestMatch</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067748"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [Char]
</span><a href="#local-6989586621679067754"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067751"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>                       </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679067753"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679067743"><span id="local-6989586621679067745"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span id="local-6989586621679067739"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067739"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067738"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067738"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679067737"><span class="annot"><span class="annottext">&lt;&gt; :: Alignment -&gt; Alignment -&gt; Alignment
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span id="local-6989586621679067736"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067736"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679067735"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067735"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Alignment
</span><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-var">Alignment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067739"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067736"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="Text.FuzzyFind.html#mergeResults"><span class="hs-identifier hs-var">mergeResults</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067738"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067735"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679067726"><span id="local-6989586621679067728"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679067723"><span class="annot"><span class="annottext">mempty :: Alignment
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Alignment
</span><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-var">Alignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">type</span><span> </span><span id="Score"><span class="annot"><a href="Text.FuzzyFind.html#Score"><span class="hs-identifier hs-var">Score</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | An 'Alignment' is a 'Score' together with a 'Result'. Better results have</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- higher scores.</span><span>
</span><span id="line-149"></span><span id="local-6989586621679067720"><span id="local-6989586621679067721"></span></span><span class="hs-keyword">data</span><span> </span><span id="Alignment"><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-var">Alignment</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Alignment"><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-var">Alignment</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="score"><span class="annot"><span class="annottext">Alignment -&gt; Int
</span><a href="Text.FuzzyFind.html#score"><span class="hs-identifier hs-var hs-var">score</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Text.FuzzyFind.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span class="hs-special">,</span><span> </span><span id="result"><span class="annot"><span class="annottext">Alignment -&gt; Result
</span><a href="Text.FuzzyFind.html#result"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067711"><span id="local-6989586621679067716"><span class="annot"><span class="annottext">Alignment -&gt; Alignment -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Alignment -&gt; Alignment -&gt; Bool
$c/= :: Alignment -&gt; Alignment -&gt; Bool
== :: Alignment -&gt; Alignment -&gt; Bool
$c== :: Alignment -&gt; Alignment -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067686"><span id="local-6989586621679067688"><span id="local-6989586621679067691"><span id="local-6989586621679067694"><span id="local-6989586621679067697"><span id="local-6989586621679067701"><span id="local-6989586621679067706"><span class="annot"><span class="annottext">Eq Alignment
Alignment -&gt; Alignment -&gt; Bool
Alignment -&gt; Alignment -&gt; Ordering
Alignment -&gt; Alignment -&gt; Alignment
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Alignment -&gt; Alignment -&gt; Alignment
$cmin :: Alignment -&gt; Alignment -&gt; Alignment
max :: Alignment -&gt; Alignment -&gt; Alignment
$cmax :: Alignment -&gt; Alignment -&gt; Alignment
&gt;= :: Alignment -&gt; Alignment -&gt; Bool
$c&gt;= :: Alignment -&gt; Alignment -&gt; Bool
&gt; :: Alignment -&gt; Alignment -&gt; Bool
$c&gt; :: Alignment -&gt; Alignment -&gt; Bool
&lt;= :: Alignment -&gt; Alignment -&gt; Bool
$c&lt;= :: Alignment -&gt; Alignment -&gt; Bool
&lt; :: Alignment -&gt; Alignment -&gt; Bool
$c&lt; :: Alignment -&gt; Alignment -&gt; Bool
compare :: Alignment -&gt; Alignment -&gt; Ordering
$ccompare :: Alignment -&gt; Alignment -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067675"><span id="local-6989586621679067677"><span id="local-6989586621679067683"><span class="annot"><span class="annottext">Int -&gt; Alignment -&gt; ShowS
[Alignment] -&gt; ShowS
Alignment -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Alignment] -&gt; ShowS
$cshowList :: [Alignment] -&gt; ShowS
show :: Alignment -&gt; [Char]
$cshow :: Alignment -&gt; [Char]
showsPrec :: Int -&gt; Alignment -&gt; ShowS
$cshowsPrec :: Int -&gt; Alignment -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep Alignment x -&gt; Alignment
forall x. Alignment -&gt; Rep Alignment x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Alignment x -&gt; Alignment
$cfrom :: forall x. Alignment -&gt; Rep Alignment x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | The base score given to a matching character</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultMatchScore"><span class="hs-identifier hs-type">defaultMatchScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-155"></span><span id="defaultMatchScore"><span class="annot"><span class="annottext">defaultMatchScore :: Int
</span><a href="Text.FuzzyFind.html#defaultMatchScore"><span class="hs-identifier hs-var hs-var">defaultMatchScore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | The base score given to a mismatched character</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultMismatchScore"><span class="hs-identifier hs-type">defaultMismatchScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-159"></span><span id="defaultMismatchScore"><span class="annot"><span class="annottext">defaultMismatchScore :: Int
</span><a href="Text.FuzzyFind.html#defaultMismatchScore"><span class="hs-identifier hs-var hs-var">defaultMismatchScore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Bonus points given to characters matching at the beginning of words</span><span>
</span><span id="line-162"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultBoundaryBonus"><span class="hs-identifier hs-type">defaultBoundaryBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-163"></span><span id="defaultBoundaryBonus"><span class="annot"><span class="annottext">defaultBoundaryBonus :: Int
</span><a href="Text.FuzzyFind.html#defaultBoundaryBonus"><span class="hs-identifier hs-var hs-var">defaultBoundaryBonus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultMatchScore"><span class="hs-identifier hs-var">defaultMatchScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Bonus points given to characters matching a hump of a CamelCase word.</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- We subtract a point from the word boundary score, since a word boundary will</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- incur a gap penalty.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultCamelCaseBonus"><span class="hs-identifier hs-type">defaultCamelCaseBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-169"></span><span id="defaultCamelCaseBonus"><span class="annot"><span class="annottext">defaultCamelCaseBonus :: Int
</span><a href="Text.FuzzyFind.html#defaultCamelCaseBonus"><span class="hs-identifier hs-var hs-var">defaultCamelCaseBonus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Text.FuzzyFind.html#defaultBoundaryBonus"><span class="hs-identifier hs-var">defaultBoundaryBonus</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Double any bonus points for matching the first pattern of the character.</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- This way we strongly prefer starting the match at the beginning of a word.</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultFirstCharBonusMultiplier"><span class="hs-identifier hs-type">defaultFirstCharBonusMultiplier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-174"></span><span id="defaultFirstCharBonusMultiplier"><span class="annot"><span class="annottext">defaultFirstCharBonusMultiplier :: Int
</span><a href="Text.FuzzyFind.html#defaultFirstCharBonusMultiplier"><span class="hs-identifier hs-var hs-var">defaultFirstCharBonusMultiplier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | We prefer consecutive runs of matched characters in the pattern, so we</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- impose a penalty for any gaps, which is added to the size of the gap.</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultGapPenalty"><span class="hs-identifier hs-type">defaultGapPenalty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-179"></span><span id="defaultGapPenalty"><span class="annot"><span class="annottext">defaultGapPenalty :: Int
</span><a href="Text.FuzzyFind.html#defaultGapPenalty"><span class="hs-identifier hs-var hs-var">defaultGapPenalty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | We give a bonus to consecutive matching characters.</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- A number about the same as the boundary bonus will prefer</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- runs of consecutive characters vs finding acronyms.</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultConsecutiveBonus"><span class="hs-identifier hs-type">defaultConsecutiveBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-185"></span><span id="defaultConsecutiveBonus"><span class="annot"><span class="annottext">defaultConsecutiveBonus :: Int
</span><a href="Text.FuzzyFind.html#defaultConsecutiveBonus"><span class="hs-identifier hs-var hs-var">defaultConsecutiveBonus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | We give a bonus for matches that occur later in the input string.</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- If this is e.g. 100, we give one bonus point for each percentage of the</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- length of the input that the match occurs at (100 points for the last</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- character, 50 for characters in the middle, and so on).</span><span>
</span><span id="line-191"></span><span class="annot"><a href="Text.FuzzyFind.html#defaultLaterBonusMultiplier"><span class="hs-identifier hs-type">defaultLaterBonusMultiplier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-192"></span><span id="defaultLaterBonusMultiplier"><span class="annot"><span class="annottext">defaultLaterBonusMultiplier :: Int
</span><a href="Text.FuzzyFind.html#defaultLaterBonusMultiplier"><span class="hs-identifier hs-var hs-var">defaultLaterBonusMultiplier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Text.FuzzyFind.html#segmentToString"><span class="hs-identifier hs-type">segmentToString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#ResultSegment"><span class="hs-identifier hs-type">ResultSegment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-195"></span><span id="segmentToString"><span class="annot"><span class="annottext">segmentToString :: ResultSegment -&gt; [Char]
</span><a href="Text.FuzzyFind.html#segmentToString"><span class="hs-identifier hs-var hs-var">segmentToString</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span>   </span><span id="local-6989586621679067666"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067666"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067666"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Text.FuzzyFind.html#segmentToString"><span class="hs-identifier hs-var">segmentToString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067664"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067664"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067664"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Renders an 'Alignment' as a pair of lines with &quot;*&quot; on the lower line</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- indicating the location of pattern matches.</span><span>
</span><span id="line-200"></span><span class="annot"><a href="Text.FuzzyFind.html#highlight"><span class="hs-identifier hs-type">highlight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-201"></span><span id="highlight"><span class="annot"><span class="annottext">highlight :: Alignment -&gt; [Char]
</span><a href="Text.FuzzyFind.html#highlight"><span class="hs-identifier hs-var hs-var">highlight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span id="local-6989586621679067662"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067662"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span id="local-6989586621679067660"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067660"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">ResultSegment -&gt; [Char]
</span><a href="Text.FuzzyFind.html#segmentToString"><span class="hs-identifier hs-var">segmentToString</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067660"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">ResultSegment -&gt; [Char]
</span><a href="#local-6989586621679067658"><span class="hs-identifier hs-var">showGaps</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067660"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-203"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679067658"><span class="annot"><span class="annottext">showGaps :: ResultSegment -&gt; [Char]
</span><a href="#local-6989586621679067658"><span class="hs-identifier hs-var hs-var">showGaps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span>   </span><span id="local-6989586621679067655"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067655"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067655"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="#local-6989586621679067658"><span class="hs-identifier hs-var">showGaps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067652"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067652"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067652"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><a href="Text.FuzzyFind.html#highlight%27"><span class="hs-identifier hs-type">highlight'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-208"></span><span id="highlight%27"><span class="annot"><span class="annottext">highlight' :: Alignment -&gt; Text
</span><a href="Text.FuzzyFind.html#highlight%27"><span class="hs-identifier hs-var hs-var">highlight'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Alignment -&gt; [Char]
</span><a href="Text.FuzzyFind.html#highlight"><span class="hs-identifier hs-var">highlight</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | A highly configurable version of 'bestMatch'.</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Text.FuzzyFind.html#bestMatch%27"><span class="hs-identifier hs-type">bestMatch'</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Base score for a matching character. See 'defaultMatchScore'.</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Base score for a mismatched character. See 'defaultMismatchScore'.</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Additional penalty for a gap. See 'defaultGapPenalty'.</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Bonus score for a match at the beginning of a word. See 'defaultBoundaryBonus'.</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Bonus score for a match on a CamelCase hump. See 'defaultCamelCaseBonus'.</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Bonus multiplier for matching the first character of the pattern.</span><span>
</span><span id="line-218"></span><span>         </span><span class="hs-comment">--   See 'defaultFirstCharBonusMultiplier'.</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Bonus score for each consecutive character matched.</span><span>
</span><span id="line-220"></span><span>         </span><span class="hs-comment">--   See 'defaultFirstCharBonusMultiplier'.</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Bonus multiplier for matching later characters of the input.</span><span>
</span><span id="line-222"></span><span>         </span><span class="hs-comment">--   E.g. if this is 10, the bonus for matching the last character of</span><span>
</span><span id="line-223"></span><span>         </span><span class="hs-comment">--   the input is 10, and 5 for characters close to the middle, and so on.</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ The query pattern.</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ The input string.</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-type">Alignment</span></a></span><span>
</span><span id="line-227"></span><span id="bestMatch%27"><span class="annot"><span class="annottext">bestMatch' :: Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; [Char]
-&gt; [Char]
-&gt; Maybe Alignment
</span><a href="Text.FuzzyFind.html#bestMatch%27"><span class="hs-identifier hs-var hs-var">bestMatch'</span></a></span></span><span> </span><span id="local-6989586621679067649"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067649"><span class="hs-identifier hs-var">matchScore</span></a></span></span><span> </span><span id="local-6989586621679067648"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067648"><span class="hs-identifier hs-var">mismatchScore</span></a></span></span><span> </span><span id="local-6989586621679067647"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067647"><span class="hs-identifier hs-var">gapPenalty</span></a></span></span><span> </span><span id="local-6989586621679067646"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067646"><span class="hs-identifier hs-var">boundaryBonus</span></a></span></span><span> </span><span id="local-6989586621679067645"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067645"><span class="hs-identifier hs-var">camelCaseBonus</span></a></span></span><span> </span><span id="local-6989586621679067644"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067644"><span class="hs-identifier hs-var">firstCharBonusMultiplier</span></a></span></span><span> </span><span id="local-6989586621679067643"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067643"><span class="hs-identifier hs-var">consecutiveBonus</span></a></span></span><span> </span><span id="local-6989586621679067642"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067642"><span class="hs-identifier hs-var">laterBonusMultiplier</span></a></span></span><span> </span><span id="local-6989586621679067641"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067641"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679067640"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067640"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Alignment
</span><a href="Text.FuzzyFind.html#Alignment"><span class="hs-identifier hs-var">Alignment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067639"><span class="hs-identifier hs-var">totalScore</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067637"><span class="hs-identifier hs-var">nx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [ResultSegment]
</span><a href="#local-6989586621679067635"><span class="hs-identifier hs-var">traceback</span></a></span><span>
</span><span id="line-229"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679067639"><span class="annot"><span class="annottext">totalScore :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067639"><span class="hs-identifier hs-var hs-var">totalScore</span></a></span></span><span> </span><span id="local-6989586621679067622"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067622"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679067621"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067621"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067622"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Ix2 Int
</span><a href="#local-6989586621679067618"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067622"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067621"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Ix2 Int
</span><a href="#local-6989586621679067616"><span class="hs-identifier hs-var">bonuses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067622"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067621"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- table = unlines</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-comment">--   [ unwords</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-comment">--     $ (if y &gt; 0 then show $ str' ! y else &quot;   &quot;)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">--     : [ show (totalScore x y) | x &lt;- [0 .. m] ]</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">--   | y &lt;- [0 .. n]</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">--   ]</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679067612"><span class="annot"><span class="annottext">similarity :: Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var hs-var">similarity</span></a></span></span><span> </span><span id="local-6989586621679067611"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679067611"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679067610"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679067610"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679067611"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679067610"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679067611"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679067610"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067649"><span class="hs-identifier hs-var">matchScore</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067648"><span class="hs-identifier hs-var">mismatchScore</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="#local-6989586621679067635"><span class="hs-identifier hs-type">traceback</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.FuzzyFind.html#ResultSegment"><span class="hs-identifier hs-type">ResultSegment</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679067635"><span class="annot"><span class="annottext">traceback :: Maybe [ResultSegment]
</span><a href="#local-6989586621679067635"><span class="hs-identifier hs-var hs-var">traceback</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t}.
(Eq t, Num t) =&gt;
[ResultSegment]
-&gt; [Char] -&gt; t -&gt; Int -&gt; Int -&gt; Maybe [ResultSegment]
</span><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067637"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067637"><span class="hs-identifier hs-var">nx</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067640"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067637"><span class="hs-identifier hs-var">nx</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679067608"><span class="annot"><span class="annottext">go :: [ResultSegment]
-&gt; [Char] -&gt; t -&gt; Int -&gt; Int -&gt; Maybe [ResultSegment]
</span><a href="#local-6989586621679067608"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679067526"><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067526"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679067525"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679067524"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067524"><span class="hs-identifier hs-var">currOp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679067523"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067523"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067523"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067523"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067640"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067526"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067524"><span class="hs-identifier hs-var">currOp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067526"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067526"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>        </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679067521"><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679067520"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679067519"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067519"><span class="hs-identifier hs-var">currOp</span></a></span></span><span> </span><span id="local-6989586621679067518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679067517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">similarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067519"><span class="hs-identifier hs-var">currOp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
-&gt; [Char] -&gt; t -&gt; Int -&gt; Int -&gt; Maybe [ResultSegment]
</span><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
-&gt; [Char] -&gt; t -&gt; Int -&gt; Int -&gt; Maybe [ResultSegment]
</span><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067519"><span class="hs-identifier hs-var">currOp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
-&gt; [Char] -&gt; t -&gt; Int -&gt; Int -&gt; Maybe [ResultSegment]
</span><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
-&gt; [Char] -&gt; t -&gt; Int -&gt; Int -&gt; Maybe [ResultSegment]
</span><a href="#local-6989586621679067608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[ResultSegment]
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679067637"><span class="annot"><span class="annottext">nx :: Int
</span><a href="#local-6989586621679067637"><span class="hs-identifier hs-var hs-var">nx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067514"><span class="hs-identifier hs-var">localMax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679067514"><span class="annot"><span class="annottext">localMax :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067514"><span class="hs-identifier hs-var hs-var">localMax</span></a></span></span><span> </span><span id="local-6989586621679067509"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067509"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679067508"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067508"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067507"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679067506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067506"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679067505"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067508"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067506"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067504"><span class="annot"><span class="annottext">s' :: Int
</span><a href="#local-6989586621679067504"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067639"><span class="hs-identifier hs-var">totalScore</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067509"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067514"><span class="hs-identifier hs-var">localMax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067509"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067508"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067504"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067506"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067504"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679067516"><span class="annot"><span class="annottext">query' :: Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var hs-var">query'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r e. Manifest r e =&gt; Comp -&gt; [e] -&gt; Vector r e
</span><span class="hs-identifier hs-var">A.fromList</span></span><span> </span><span class="annot"><span class="annottext">Comp
</span><span class="hs-identifier hs-var">A.Seq</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067641"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.U</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Ix1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679067515"><span class="annot"><span class="annottext">str' :: Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var hs-var">str'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r e. Manifest r e =&gt; Comp -&gt; [e] -&gt; Vector r e
</span><span class="hs-identifier hs-var">A.fromList</span></span><span> </span><span class="annot"><span class="annottext">Comp
</span><span class="hs-identifier hs-var">A.Seq</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067640"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.U</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Ix1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679067638"><span class="annot"><span class="annottext">m :: Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ix. Sz ix -&gt; ix
</span><span class="hs-identifier hs-var">A.unSz</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r ix e. Size r =&gt; Array r ix e -&gt; Sz ix
</span><span class="hs-identifier hs-var">A.size</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679067606"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ix. Sz ix -&gt; ix
</span><span class="hs-identifier hs-var">A.unSz</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall r ix e. Size r =&gt; Array r ix e -&gt; Sz ix
</span><span class="hs-identifier hs-var">A.size</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><a href="#local-6989586621679067618"><span class="hs-identifier hs-type">hs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.U</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679067618"><span class="annot"><span class="annottext">hs :: Array U Ix2 Int
</span><a href="#local-6989586621679067618"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r ix e a.
(Manifest r e, Index ix) =&gt;
Sz ix -&gt; (forall s. MArray s r ix e -&gt; ST s a) -&gt; Array r ix e
</span><span class="hs-identifier hs-var">M.createArrayST_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix. Index ix =&gt; ix -&gt; Sz ix
</span><span class="hs-identifier hs-var">A.Sz</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067409"><span class="annot"><span class="annottext">MArray s U Ix2 Int
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="annottext">forall r a ix (m :: * -&gt; *) b.
(Source r a, Index ix, Monad m) =&gt;
Array r ix a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">A.forM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall ix. Index ix =&gt; ix -&gt; ix -&gt; Array D ix ix
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679067408"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span id="local-6989586621679067407"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall r e ix (m :: * -&gt; *).
(Manifest r e, Index ix, PrimMonad m, MonadThrow m) =&gt;
MArray (PrimState m) r ix e -&gt; ix -&gt; e -&gt; m ()
</span><span class="hs-identifier hs-var">M.writeM</span></span><span> </span><span class="annot"><span class="annottext">MArray s U Ix2 Int
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679067405"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067405"><span class="hs-identifier hs-var">scoreMatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>          </span><span id="local-6989586621679067404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067404"><span class="hs-identifier hs-var">hprev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r e ix (m :: * -&gt; *).
(Manifest r e, Index ix, PrimMonad m, MonadThrow m) =&gt;
MArray (PrimState m) r ix e -&gt; ix -&gt; m e
</span><span class="hs-identifier hs-var">M.readM</span></span><span> </span><span class="annot"><span class="annottext">MArray s U Ix2 Int
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067404"><span class="hs-identifier hs-var">hprev</span></a></span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">similarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>            </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Ix2 Int
</span><a href="#local-6989586621679067616"><span class="hs-identifier hs-var">bonuses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621679067402"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067402"><span class="hs-identifier hs-var">scoreGap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679067401"><span class="annot"><span class="annottext">Array U Int Int
</span><a href="#local-6989586621679067401"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.U</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Ix1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r ix b r' a (m :: * -&gt; *).
(Source r' a, Manifest r b, Index ix, Monad m) =&gt;
Array r' ix a -&gt; (a -&gt; m b) -&gt; m (Array r ix b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall ix. Index ix =&gt; ix -&gt; ix -&gt; Array D ix ix
</span><span class="hs-operator hs-var">...</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067400"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067400"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679067399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067399"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067399"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067400"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067647"><span class="hs-identifier hs-var">gapPenalty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r e ix (m :: * -&gt; *).
(Manifest r e, Index ix, PrimMonad m, MonadThrow m) =&gt;
MArray (PrimState m) r ix e -&gt; ix -&gt; m e
</span><span class="hs-identifier hs-var">M.readM</span></span><span> </span><span class="annot"><span class="annottext">MArray s U Ix2 Int
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067400"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r ix e.
(MonadThrow m, Shape r ix, Source r e, Ord e) =&gt;
Array r ix e -&gt; m e
</span><span class="hs-identifier hs-var">A.maximumM</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Int
</span><a href="#local-6989586621679067401"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">forall r e ix (m :: * -&gt; *).
(Manifest r e, Index ix, PrimMonad m, MonadThrow m) =&gt;
MArray (PrimState m) r ix e -&gt; ix -&gt; e -&gt; m ()
</span><span class="hs-identifier hs-var">M.writeM</span></span><span> </span><span class="annot"><span class="annottext">MArray s U Ix2 Int
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067408"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067407"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067405"><span class="hs-identifier hs-var">scoreMatch</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067402"><span class="hs-identifier hs-var">scoreGap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679067616"><span class="annot"><span class="annottext">bonuses :: Array U Ix2 Int
</span><a href="#local-6989586621679067616"><span class="hs-identifier hs-var hs-var">bonuses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r ix e.
Load r ix e =&gt;
Comp -&gt; Sz ix -&gt; (ix -&gt; e) -&gt; Array r ix e
</span><span class="hs-identifier hs-var">A.makeArray</span></span><span> </span><span class="annot"><span class="annottext">Comp
</span><span class="hs-identifier hs-var">A.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix. Index ix =&gt; ix -&gt; Sz ix
</span><span class="hs-identifier hs-var">A.Sz</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ix2
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ix2 -&gt; Int
</span><a href="#local-6989586621679067386"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.U</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ix2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679067386"><span class="annot"><span class="annottext">f :: Ix2 -&gt; Int
</span><a href="#local-6989586621679067386"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067385"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067385"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span id="local-6989586621679067384"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067384"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067383"><span class="hs-identifier hs-var">bonus</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067385"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067384"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="#local-6989586621679067383"><span class="hs-identifier hs-type">bonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679067383"><span class="annot"><span class="annottext">bonus :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679067383"><span class="hs-identifier hs-var hs-var">bonus</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679067382"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067382"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="#local-6989586621679067383"><span class="hs-identifier hs-var">bonus</span></a></span><span> </span><span id="local-6989586621679067381"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067381"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><a href="#local-6989586621679067383"><span class="hs-identifier hs-var">bonus</span></a></span><span> </span><span id="local-6989586621679067380"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679067379"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">similarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067378"><span class="hs-identifier hs-var">multiplier</span></a></span><span>
</span><span id="line-293"></span><span>          </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067376"><span class="hs-identifier hs-var">boundary</span></a></span><span>
</span><span id="line-294"></span><span>            </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067375"><span class="hs-identifier hs-var">camel</span></a></span><span>
</span><span id="line-295"></span><span>            </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067374"><span class="hs-identifier hs-var">consecutive</span></a></span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067642"><span class="hs-identifier hs-var">laterBonusMultiplier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-299"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679067376"><span class="annot"><span class="annottext">boundary :: Int
</span><a href="#local-6989586621679067376"><span class="hs-identifier hs-var hs-var">boundary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span>
</span><span id="line-302"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067646"><span class="hs-identifier hs-var">boundaryBonus</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679067375"><span class="annot"><span class="annottext">camel :: Int
</span><a href="#local-6989586621679067375"><span class="hs-identifier hs-var hs-var">camel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isLower</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isUpper</span></span><span>
</span><span id="line-307"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067645"><span class="hs-identifier hs-var">camelCaseBonus</span></a></span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679067378"><span class="annot"><span class="annottext">multiplier :: Int
</span><a href="#local-6989586621679067378"><span class="hs-identifier hs-var hs-var">multiplier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067644"><span class="hs-identifier hs-var">firstCharBonusMultiplier</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621679067374"><span class="annot"><span class="annottext">consecutive :: Int
</span><a href="#local-6989586621679067374"><span class="hs-identifier hs-var hs-var">consecutive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621679067316"><span class="annot"><span class="annottext">similar :: Bool
</span><a href="#local-6989586621679067316"><span class="hs-identifier hs-var hs-var">similar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-318"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-319"></span><span>            </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-320"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">similarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>            </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679067296"><span class="annot"><span class="annottext">afterMatch :: Bool
</span><a href="#local-6989586621679067296"><span class="hs-identifier hs-var hs-var">afterMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-327"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">similarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>            </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621679067282"><span class="annot"><span class="annottext">beforeMatch :: Bool
</span><a href="#local-6989586621679067282"><span class="hs-identifier hs-var hs-var">beforeMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>          </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067638"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067606"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Int
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">similarity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ix r e.
(HasCallStack, Index ix, Manifest r e) =&gt;
Array r ix e -&gt; ix -&gt; e
</span><span class="hs-identifier hs-var">A.index'</span></span><span> </span><span class="annot"><span class="annottext">Array U Int Char
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">str'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067316"><span class="hs-identifier hs-var">similar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067296"><span class="hs-identifier hs-var">afterMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067282"><span class="hs-identifier hs-var">beforeMatch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067643"><span class="hs-identifier hs-var">consecutiveBonus</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- gaps :: String -&gt; Seq ResultSegment</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- gaps s = [Gap s]</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span id="local-6989586621679067280"><span id="local-6989586621679067281"></span></span><span class="hs-keyword">data</span><span> </span><span id="ResultSegment"><span class="annot"><a href="Text.FuzzyFind.html#ResultSegment"><span class="hs-identifier hs-var">ResultSegment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gap"><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Match"><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067272"><span id="local-6989586621679067278"><span class="annot"><span class="annottext">ResultSegment -&gt; ResultSegment -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ResultSegment -&gt; ResultSegment -&gt; Bool
$c/= :: ResultSegment -&gt; ResultSegment -&gt; Bool
== :: ResultSegment -&gt; ResultSegment -&gt; Bool
$c== :: ResultSegment -&gt; ResultSegment -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067246"><span id="local-6989586621679067248"><span id="local-6989586621679067251"><span id="local-6989586621679067254"><span id="local-6989586621679067257"><span id="local-6989586621679067262"><span id="local-6989586621679067268"><span class="annot"><span class="annottext">Eq ResultSegment
ResultSegment -&gt; ResultSegment -&gt; Bool
ResultSegment -&gt; ResultSegment -&gt; Ordering
ResultSegment -&gt; ResultSegment -&gt; ResultSegment
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ResultSegment -&gt; ResultSegment -&gt; ResultSegment
$cmin :: ResultSegment -&gt; ResultSegment -&gt; ResultSegment
max :: ResultSegment -&gt; ResultSegment -&gt; ResultSegment
$cmax :: ResultSegment -&gt; ResultSegment -&gt; ResultSegment
&gt;= :: ResultSegment -&gt; ResultSegment -&gt; Bool
$c&gt;= :: ResultSegment -&gt; ResultSegment -&gt; Bool
&gt; :: ResultSegment -&gt; ResultSegment -&gt; Bool
$c&gt; :: ResultSegment -&gt; ResultSegment -&gt; Bool
&lt;= :: ResultSegment -&gt; ResultSegment -&gt; Bool
$c&lt;= :: ResultSegment -&gt; ResultSegment -&gt; Bool
&lt; :: ResultSegment -&gt; ResultSegment -&gt; Bool
$c&lt; :: ResultSegment -&gt; ResultSegment -&gt; Bool
compare :: ResultSegment -&gt; ResultSegment -&gt; Ordering
$ccompare :: ResultSegment -&gt; ResultSegment -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067233"><span id="local-6989586621679067235"><span id="local-6989586621679067243"><span class="annot"><span class="annottext">Int -&gt; ResultSegment -&gt; ShowS
[ResultSegment] -&gt; ShowS
ResultSegment -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ResultSegment] -&gt; ShowS
$cshowList :: [ResultSegment] -&gt; ShowS
show :: ResultSegment -&gt; [Char]
$cshow :: ResultSegment -&gt; [Char]
showsPrec :: Int -&gt; ResultSegment -&gt; ShowS
$cshowsPrec :: Int -&gt; ResultSegment -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep ResultSegment x -&gt; ResultSegment
forall x. ResultSegment -&gt; Rep ResultSegment x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep ResultSegment x -&gt; ResultSegment
$cfrom :: forall x. ResultSegment -&gt; Rep ResultSegment x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Concatenating all the 'ResultSegment's should yield the original input string.</span><span>
</span><span id="line-341"></span><span id="local-6989586621679067227"><span id="local-6989586621679067228"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Result"><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Result"><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="segments"><span class="annot"><span class="annottext">Result -&gt; Seq ResultSegment
</span><a href="Text.FuzzyFind.html#segments"><span class="hs-identifier hs-var hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#ResultSegment"><span class="hs-identifier hs-type">ResultSegment</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067218"><span id="local-6989586621679067224"><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Result -&gt; Result -&gt; Bool
$c/= :: Result -&gt; Result -&gt; Bool
== :: Result -&gt; Result -&gt; Bool
$c== :: Result -&gt; Result -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067180"><span id="local-6989586621679067185"><span id="local-6989586621679067190"><span id="local-6989586621679067195"><span id="local-6989586621679067200"><span id="local-6989586621679067205"><span id="local-6989586621679067211"><span class="annot"><span class="annottext">Eq Result
Result -&gt; Result -&gt; Bool
Result -&gt; Result -&gt; Ordering
Result -&gt; Result -&gt; Result
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Result -&gt; Result -&gt; Result
$cmin :: Result -&gt; Result -&gt; Result
max :: Result -&gt; Result -&gt; Result
$cmax :: Result -&gt; Result -&gt; Result
&gt;= :: Result -&gt; Result -&gt; Bool
$c&gt;= :: Result -&gt; Result -&gt; Bool
&gt; :: Result -&gt; Result -&gt; Bool
$c&gt; :: Result -&gt; Result -&gt; Bool
&lt;= :: Result -&gt; Result -&gt; Bool
$c&lt;= :: Result -&gt; Result -&gt; Bool
&lt; :: Result -&gt; Result -&gt; Bool
$c&lt; :: Result -&gt; Result -&gt; Bool
compare :: Result -&gt; Result -&gt; Ordering
$ccompare :: Result -&gt; Result -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067167"><span id="local-6989586621679067169"><span id="local-6989586621679067175"><span class="annot"><span class="annottext">Int -&gt; Result -&gt; ShowS
[Result] -&gt; ShowS
Result -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Result] -&gt; ShowS
$cshowList :: [Result] -&gt; ShowS
show :: Result -&gt; [Char]
$cshow :: Result -&gt; [Char]
showsPrec :: Int -&gt; Result -&gt; ShowS
$cshowsPrec :: Int -&gt; Result -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep Result x -&gt; Result
forall x. Result -&gt; Rep Result x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Result x -&gt; Result
$cfrom :: forall x. Result -&gt; Rep Result x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679067157"><span id="local-6989586621679067159"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679067155"><span class="annot"><span class="annottext">mempty :: Result
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679067150"><span id="local-6989586621679067152"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><span class="hs-identifier hs-var">Empty</span></span><span> </span><span id="local-6989586621679067130"><span class="annot"><span class="annottext">&lt;&gt; :: Result -&gt; Result -&gt; Result
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621679067129"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067129"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067129"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679067128"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067128"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><span class="hs-identifier hs-var">Empty</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067128"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewR a
</span><span class="hs-identifier hs-var">viewr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679067127"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067127"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679067125"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067125"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067127"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067125"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679067124"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067124"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067122"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067122"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067124"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067122"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewR a
</span><span class="hs-identifier hs-var">viewr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679067121"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067121"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679067120"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067120"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067121"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067120"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679067119"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067119"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067118"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067118"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067119"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067118"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewR a
</span><span class="hs-identifier hs-var">viewr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679067117"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067117"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067116"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067116"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067115"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067115"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067114"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067114"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067117"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067116"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067115"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067114"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewR a
</span><span class="hs-identifier hs-var">viewr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679067113"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067113"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067112"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067112"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067111"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067111"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067110"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067110"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067113"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067112"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067111"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067110"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span id="local-6989586621679067109"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067109"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span id="local-6989586621679067108"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067108"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067109"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067108"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Text.FuzzyFind.html#mergeResults"><span class="hs-identifier hs-type">mergeResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-361"></span><span id="mergeResults"><span class="annot"><span class="annottext">mergeResults :: Result -&gt; Result -&gt; Result
</span><a href="Text.FuzzyFind.html#mergeResults"><span class="hs-identifier hs-var hs-var">mergeResults</span></a></span></span><span> </span><span id="local-6989586621679067107"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067107"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679067106"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067106"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067107"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067106"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-362"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><a href="#local-6989586621679067104"><span class="hs-identifier hs-type">drop'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679067104"><span class="annot"><span class="annottext">drop' :: Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var hs-var">drop'</span></a></span></span><span> </span><span id="local-6989586621679067103"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067103"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067102"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067102"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067103"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067102"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span id="local-6989586621679067101"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067101"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067100"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067100"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067099"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067099"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067101"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067100"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067101"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067100"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067099"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span id="local-6989586621679067098"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067098"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067097"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067097"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067096"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067096"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067098"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067097"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067098"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067097"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067096"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="#local-6989586621679067105"><span class="hs-identifier hs-type">merge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679067105"><span class="annot"><span class="annottext">merge :: Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><span class="hs-identifier hs-var">Seq.Empty</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679067095"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067095"><span class="hs-identifier hs-var">ys</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067095"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621679067094"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067094"><span class="hs-identifier hs-var">xs</span></a></span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><span class="hs-identifier hs-var">Seq.Empty</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679067094"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span id="local-6989586621679067093"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067093"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span id="local-6989586621679067092"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067092"><span class="hs-identifier hs-var">ys</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067093"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067092"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067091"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067091"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067090"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067090"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067089"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067089"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067088"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067088"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067091"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067089"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067091"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067090"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067091"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067092"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-var">Gap</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067089"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067089"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067093"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067088"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067086"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067086"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067085"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067085"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067084"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067084"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067083"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067083"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067086"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067084"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067086"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067085"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067086"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067092"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067084"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067084"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067093"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067083"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067082"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067082"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067081"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067081"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067080"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067080"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067079"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067079"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067080"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067080"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067093"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067079"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679067078"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067078"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067077"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067077"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.FuzzyFind.html#Gap"><span class="hs-identifier hs-type">Gap</span></a></span><span> </span><span id="local-6989586621679067076"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067076"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679067075"><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067075"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; ResultSegment
</span><a href="Text.FuzzyFind.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067078"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067077"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Result -&gt; Result
</span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">drop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679067078"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq ResultSegment -&gt; Result
</span><a href="Text.FuzzyFind.html#Result"><span class="hs-identifier hs-var">Result</span></a></span><span> </span><span class="annot"><span class="annottext">Seq ResultSegment
</span><a href="#local-6989586621679067092"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span></pre></body></html>