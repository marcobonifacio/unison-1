<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.Store.CMS</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Cryptographic Message Syntax</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc5652 RFC 5652&gt;: Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc3370 RFC 3370&gt;: Cryptographic Message Syntax (CMS) Algorithms</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc3560 RFC 3560&gt;: Use of the RSAES-OAEP Key Transport Algorithm in the Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc4056 RFC 4056&gt;: Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc3565 RFC 3565&gt;: Use of the Advanced Encryption Standard (AES) Encryption Algorithm in Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc5753 RFC 5753&gt;: Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc5754 RFC 5754&gt;: Using SHA2 Algorithms with Cryptographic Message Syntax</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc3211 RFC 3211&gt;: Password-based Encryption for CMS</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc5083 RFC 5083&gt;: Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc5084 RFC 5084&gt;: Using AES-CCM and AES-GCM Authenticated Encryption in the Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc6476 RFC 6476&gt;: Using Message Authentication Code (MAC) Encryption in the Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc8103 RFC 8103&gt;: Using ChaCha20-Poly1305 Authenticated Encryption in the Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc8418 RFC 8418&gt;: Use of the Elliptic Curve Diffie-Hellman Key Agreement Algorithm with X25519 and X448 in the Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- * &lt;https://tools.ietf.org/html/rfc8419 RFC 8419&gt;: Use of Edwards-Curve Digital Signature Algorithm (EdDSA) Signatures in the Cryptographic Message Syntax (CMS)</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.Store.CMS</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html#ContentType"><span class="hs-identifier">ContentType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier">ContentInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier">getContentType</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Reading and writing PEM files</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.PEM.html"><span class="hs-identifier">Crypto.Store.CMS.PEM</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Content encapsulation</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html#Encap"><span class="hs-identifier">Encap</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html#fromEncap"><span class="hs-identifier">fromEncap</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#Encapsulates"><span class="hs-identifier">Encapsulates</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#isAttached"><span class="hs-identifier">isAttached</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#fromAttached"><span class="hs-identifier">fromAttached</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#toAttachedCI"><span class="hs-identifier">toAttachedCI</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#isDetached"><span class="hs-identifier">isDetached</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#fromDetached"><span class="hs-identifier">fromDetached</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#toDetachedCI"><span class="hs-identifier">toDetachedCI</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Signed data</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#SignatureValue"><span class="hs-identifier">SignatureValue</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#SignatureAlg"><span class="hs-identifier">SignatureAlg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier">EncapsulatedContent</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignedData"><span class="hs-identifier">SignedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#ProducerOfSI"><span class="hs-identifier">ProducerOfSI</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#ConsumerOfSI"><span class="hs-identifier">ConsumerOfSI</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#signData"><span class="hs-identifier">signData</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#verifySignedData"><span class="hs-identifier">verifySignedData</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Signer information</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignerInfo"><span class="hs-identifier">SignerInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignerIdentifier"><span class="hs-identifier">SignerIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier">IssuerAndSerialNumber</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#certSigner"><span class="hs-identifier">certSigner</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#withPublicKey"><span class="hs-identifier">withPublicKey</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#withSignerKey"><span class="hs-identifier">withSignerKey</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#withSignerCertificate"><span class="hs-identifier">withSignerCertificate</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Enveloped data</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier">EncryptedKey</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyEncryptionParams"><span class="hs-identifier">KeyEncryptionParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyTransportParams"><span class="hs-identifier">KeyTransportParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyAgreementParams"><span class="hs-identifier">KeyAgreementParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier">RecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier">EnvelopedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier">ProducerOfRI</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier">ConsumerOfRI</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#envelopData"><span class="hs-identifier">envelopData</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#openEnvelopedData"><span class="hs-identifier">openEnvelopedData</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Key Transport recipients</span></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier">KTRecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier">RecipientIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyTransRecipient"><span class="hs-identifier">forKeyTransRecipient</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyTrans"><span class="hs-identifier">withRecipientKeyTrans</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Key Agreement recipients</span></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier">KARecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIdentifierOrKey"><span class="hs-identifier">OriginatorIdentifierOrKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKey"><span class="hs-identifier">OriginatorPublicKey</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier">RecipientEncryptedKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIdentifier"><span class="hs-identifier">KeyAgreeRecipientIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#UserKeyingMaterial"><span class="hs-identifier">UserKeyingMaterial</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyAgreeRecipient"><span class="hs-identifier">forKeyAgreeRecipient</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyAgree"><span class="hs-identifier">withRecipientKeyAgree</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Key Encryption Key recipients</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier">KEKRecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier">KeyIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier">OtherKeyAttribute</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyEncryptionKey"><span class="hs-identifier">KeyEncryptionKey</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyRecipient"><span class="hs-identifier">forKeyRecipient</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKey"><span class="hs-identifier">withRecipientKey</span></a></span><span>
</span><span id="line-90"></span><span>     </span><span class="annot"><span class="hs-comment">-- ** Password recipients</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier">PasswordRecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forPasswordRecipient"><span class="hs-identifier">forPasswordRecipient</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientPassword"><span class="hs-identifier">withRecipientPassword</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Digested data</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#DigestProxy"><span class="hs-identifier">DigestProxy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#DigestAlgorithm"><span class="hs-identifier">DigestAlgorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Digested.html#DigestedData"><span class="hs-identifier">DigestedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#digestData"><span class="hs-identifier">digestData</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#digestVerify"><span class="hs-identifier">digestVerify</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Encrypted data</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier">ContentEncryptionKey</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#ContentEncryptionCipher"><span class="hs-identifier">ContentEncryptionCipher</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#ContentEncryptionAlg"><span class="hs-identifier">ContentEncryptionAlg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#ContentEncryptionParams"><span class="hs-identifier">ContentEncryptionParams</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier">EncryptedContent</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedData"><span class="hs-identifier">EncryptedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateEncryptionParams"><span class="hs-identifier">generateEncryptionParams</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateRC2EncryptionParams"><span class="hs-identifier">generateRC2EncryptionParams</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#getContentEncryptionAlg"><span class="hs-identifier">getContentEncryptionAlg</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#encryptData"><span class="hs-identifier">encryptData</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#decryptData"><span class="hs-identifier">decryptData</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Authenticated data</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#AuthenticationKey"><span class="hs-identifier">AuthenticationKey</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#MACAlgorithm"><span class="hs-identifier">MACAlgorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#MessageAuthenticationCode"><span class="hs-identifier">MessageAuthenticationCode</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Authenticated.html#AuthenticatedData"><span class="hs-identifier">AuthenticatedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#generateAuthenticatedData"><span class="hs-identifier">generateAuthenticatedData</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#verifyAuthenticatedData"><span class="hs-identifier">verifyAuthenticatedData</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Authenticated-enveloped data</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#AuthContentEncryptionAlg"><span class="hs-identifier">AuthContentEncryptionAlg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#AuthContentEncryptionParams"><span class="hs-identifier">AuthContentEncryptionParams</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.AuthEnveloped.html#AuthEnvelopedData"><span class="hs-identifier">AuthEnvelopedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateAuthEnc128Params"><span class="hs-identifier">generateAuthEnc128Params</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateAuthEnc256Params"><span class="hs-identifier">generateAuthEnc256Params</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateChaChaPoly1305Params"><span class="hs-identifier">generateChaChaPoly1305Params</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateCCMParams"><span class="hs-identifier">generateCCMParams</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateGCMParams"><span class="hs-identifier">generateGCMParams</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#authEnvelopData"><span class="hs-identifier">authEnvelopData</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#openAuthEnvelopedData"><span class="hs-identifier">openAuthEnvelopedData</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Key derivation</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#Salt"><span class="hs-identifier">Salt</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateSalt"><span class="hs-identifier">generateSalt</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyDerivationFunc"><span class="hs-identifier">KeyDerivationFunc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#PBKDF2_PRF"><span class="hs-identifier">PBKDF2_PRF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Secret-key algorithms</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#HasKeySize"><span class="hs-identifier">HasKeySize</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#generateKey"><span class="hs-identifier">generateKey</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="hs-comment">-- * RSA padding modes</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#MaskGenerationFunc"><span class="hs-identifier">MaskGenerationFunc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#OAEPParams"><span class="hs-identifier">OAEPParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#PSSParams"><span class="hs-identifier">PSSParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="hs-comment">-- * CMS attributes</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier">Attribute</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#findAttribute"><span class="hs-identifier">findAttribute</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#setAttribute"><span class="hs-identifier">setAttribute</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#filterAttributes"><span class="hs-identifier">filterAttributes</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Originator information</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OriginatorInfo"><span class="hs-identifier">OriginatorInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#CertificateChoice"><span class="hs-identifier">CertificateChoice</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OtherCertificateFormat"><span class="hs-identifier">OtherCertificateFormat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#RevocationInfoChoice"><span class="hs-identifier">RevocationInfoChoice</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OtherRevocationInfoFormat"><span class="hs-identifier">OtherRevocationInfoFormat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-comment">-- * ASN.1 representation</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ASN1ObjectExact"><span class="hs-identifier">ASN1ObjectExact</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BinaryEncoding</span></span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Encoding</span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unzip3</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html"><span class="hs-identifier">Crypto.Store.ASN1.Parse</span></a></span><span>
</span><span id="line-166"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html"><span class="hs-identifier">Crypto.Store.CMS.Algorithms</span></a></span><span>
</span><span id="line-167"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html"><span class="hs-identifier">Crypto.Store.CMS.Attribute</span></a></span><span>
</span><span id="line-168"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Authenticated.html"><span class="hs-identifier">Crypto.Store.CMS.Authenticated</span></a></span><span>
</span><span id="line-169"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.AuthEnveloped.html"><span class="hs-identifier">Crypto.Store.CMS.AuthEnveloped</span></a></span><span>
</span><span id="line-170"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Digested.html"><span class="hs-identifier">Crypto.Store.CMS.Digested</span></a></span><span>
</span><span id="line-171"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html"><span class="hs-identifier">Crypto.Store.CMS.Encrypted</span></a></span><span>
</span><span id="line-172"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html"><span class="hs-identifier">Crypto.Store.CMS.Enveloped</span></a></span><span>
</span><span id="line-173"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html"><span class="hs-identifier">Crypto.Store.CMS.OriginatorInfo</span></a></span><span>
</span><span id="line-174"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html"><span class="hs-identifier">Crypto.Store.CMS.Info</span></a></span><span>
</span><span id="line-175"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.PEM.html"><span class="hs-identifier">Crypto.Store.CMS.PEM</span></a></span><span>
</span><span id="line-176"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html"><span class="hs-identifier">Crypto.Store.CMS.Signed</span></a></span><span>
</span><span id="line-177"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html"><span class="hs-identifier">Crypto.Store.CMS.Type</span></a></span><span>
</span><span id="line-178"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html"><span class="hs-identifier">Crypto.Store.CMS.Util</span></a></span><span>
</span><span id="line-179"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.Error.html"><span class="hs-identifier">Crypto.Store.Error</span></a></span><span>
</span><span id="line-180"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.Util.html"><span class="hs-identifier">Crypto.Store.Util</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- DigestedData</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | Add a digested-data layer on the specified content info.</span><span>
</span><span id="line-186"></span><span class="annot"><a href="Crypto.Store.CMS.html#digestData"><span class="hs-identifier hs-type">digestData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#DigestAlgorithm"><span class="hs-identifier hs-type">DigestAlgorithm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Digested.html#DigestedData"><span class="hs-identifier hs-type">DigestedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier hs-type">EncapsulatedContent</span></a></span><span>
</span><span id="line-187"></span><span id="digestData"><span class="annot"><span class="annottext">digestData :: DigestAlgorithm -&gt; ContentInfo -&gt; DigestedData EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#digestData"><span class="hs-identifier hs-var hs-var">digestData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#DigestAlgorithm"><span class="hs-identifier hs-type">DigestAlgorithm</span></a></span><span> </span><span id="local-6989586621679146069"><span class="annot"><span class="annottext">DigestProxy hashAlg
</span><a href="#local-6989586621679146069"><span class="hs-identifier hs-var">alg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679146068"><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146068"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DigestedData EncapsulatedContent
</span><a href="#local-6989586621679146067"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679146067"><span class="annot"><span class="annottext">dd :: DigestedData EncapsulatedContent
</span><a href="#local-6989586621679146067"><span class="hs-identifier hs-var hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Digested.html#DigestedData"><span class="hs-identifier hs-type">DigestedData</span></a></span><span>
</span><span id="line-189"></span><span>                 </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ddDigestAlgorithm :: DigestProxy hashAlg
</span><a href="Crypto.Store.CMS.Digested.html#ddDigestAlgorithm"><span class="hs-identifier hs-var">ddDigestAlgorithm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DigestProxy hashAlg
</span><a href="#local-6989586621679146069"><span class="hs-identifier hs-var">alg</span></a></span><span>
</span><span id="line-190"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ddContentType :: ContentType
</span><a href="Crypto.Store.CMS.Digested.html#ddContentType"><span class="hs-identifier hs-var">ddContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146068"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-191"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ddEncapsulatedContent :: EncapsulatedContent
</span><a href="Crypto.Store.CMS.Digested.html#ddEncapsulatedContent"><span class="hs-identifier hs-var">ddEncapsulatedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146068"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-192"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ddDigest :: Digest hashAlg
</span><a href="Crypto.Store.CMS.Digested.html#ddDigest"><span class="hs-identifier hs-var">ddDigest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">hash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146068"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | Return the inner content info but only if the digest is valid.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Crypto.Store.CMS.html#digestVerify"><span class="hs-identifier hs-type">digestVerify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Digested.html#DigestedData"><span class="hs-identifier hs-type">DigestedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier hs-type">EncapsulatedContent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-197"></span><span id="digestVerify"><span class="annot"><span class="annottext">digestVerify :: DigestedData EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#digestVerify"><span class="hs-identifier hs-var hs-var">digestVerify</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Digested.html#DigestedData"><span class="hs-identifier hs-type">DigestedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679146047"><span id="local-6989586621679146048"><span id="local-6989586621679146049"><span id="local-6989586621679146050"><span class="annot"><span class="annottext">EncapsulatedContent
Digest hashAlg
ContentType
DigestProxy hashAlg
ddDigest :: Digest hashAlg
ddEncapsulatedContent :: EncapsulatedContent
ddContentType :: ContentType
ddDigestAlgorithm :: DigestProxy hashAlg
ddDigest :: ()
ddEncapsulatedContent :: forall content. DigestedData content -&gt; content
ddContentType :: forall content. DigestedData content -&gt; ContentType
ddDigestAlgorithm :: ()
</span><a href="#local-6989586621679146047"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679146045"><span class="hs-identifier hs-var">acceptable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StoreError
</span><a href="Crypto.Store.Error.html#InvalidParameter"><span class="hs-identifier hs-var">InvalidParameter</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Digest too weak&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Digest hashAlg
</span><a href="#local-6989586621679146047"><span class="hs-identifier hs-var">ddDigest</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">hash</span></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146048"><span class="hs-identifier hs-var">ddEncapsulatedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679146049"><span class="hs-identifier hs-var">ddContentType</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146048"><span class="hs-identifier hs-var">ddEncapsulatedContent</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#DigestMismatch"><span class="hs-identifier hs-var">DigestMismatch</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679146045"><span class="annot"><span class="annottext">acceptable :: Bool
</span><a href="#local-6989586621679146045"><span class="hs-identifier hs-var hs-var">acceptable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall params. HasStrength params =&gt; params -&gt; Bool
</span><a href="Crypto.Store.CMS.Algorithms.html#securityAcceptable"><span class="hs-identifier hs-var">securityAcceptable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall hashAlg.
HashAlgorithm hashAlg =&gt;
DigestProxy hashAlg -&gt; DigestAlgorithm
</span><a href="Crypto.Store.CMS.Algorithms.html#DigestAlgorithm"><span class="hs-identifier hs-var">DigestAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">DigestProxy hashAlg
</span><a href="#local-6989586621679146050"><span class="hs-identifier hs-var">ddDigestAlgorithm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- EncryptedData</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Add an encrypted-data layer on the specified content info.  The content is</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- encrypted with specified key and algorithm.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- Some optional attributes can be added but will not be encrypted.</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Crypto.Store.CMS.html#encryptData"><span class="hs-identifier hs-type">encryptData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#ContentEncryptionParams"><span class="hs-identifier hs-type">ContentEncryptionParams</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-215"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedData"><span class="hs-identifier hs-type">EncryptedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span id="encryptData"><span class="annot"><span class="annottext">encryptData :: EncapsulatedContent
-&gt; ContentEncryptionParams
-&gt; [Attribute]
-&gt; ContentInfo
-&gt; Either StoreError (EncryptedData EncapsulatedContent)
</span><a href="Crypto.Store.CMS.html#encryptData"><span class="hs-identifier hs-var hs-var">encryptData</span></a></span></span><span> </span><span id="local-6989586621679146037"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146037"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679146036"><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146036"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679146035"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679146035"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679146034"><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146034"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">forall {content}. content -&gt; EncryptedData content
</span><a href="#local-6989586621679146033"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall cek ba.
(ByteArray cek, ByteArray ba) =&gt;
cek -&gt; ContentEncryptionParams -&gt; ba -&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#contentEncrypt"><span class="hs-identifier hs-var">contentEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146037"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146036"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146034"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679146033"><span class="annot"><span class="annottext">build :: content -&gt; EncryptedData content
</span><a href="#local-6989586621679146033"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679146030"><span class="annot"><span class="annottext">content
</span><a href="#local-6989586621679146030"><span class="hs-identifier hs-var">ec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedData"><span class="hs-identifier hs-type">EncryptedData</span></a></span><span>
</span><span id="line-220"></span><span>                   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">edContentType :: ContentType
</span><a href="Crypto.Store.CMS.Encrypted.html#edContentType"><span class="hs-identifier hs-var">edContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146034"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-221"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edContentEncryptionParams :: ContentEncryptionParams
</span><a href="Crypto.Store.CMS.Encrypted.html#edContentEncryptionParams"><span class="hs-identifier hs-var">edContentEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146036"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-222"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edEncryptedContent :: content
</span><a href="Crypto.Store.CMS.Encrypted.html#edEncryptedContent"><span class="hs-identifier hs-var">edEncryptedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">content
</span><a href="#local-6989586621679146030"><span class="hs-identifier hs-var">ec</span></a></span><span>
</span><span id="line-223"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">edUnprotectedAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.Encrypted.html#edUnprotectedAttrs"><span class="hs-identifier hs-var">edUnprotectedAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679146035"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-224"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Decrypt an encrypted content info using the specified key.</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Crypto.Store.CMS.html#decryptData"><span class="hs-identifier hs-type">decryptData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedData"><span class="hs-identifier hs-type">EncryptedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-230"></span><span id="decryptData"><span class="annot"><span class="annottext">decryptData :: EncapsulatedContent
-&gt; EncryptedData EncapsulatedContent
-&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decryptData"><span class="hs-identifier hs-var hs-var">decryptData</span></a></span></span><span> </span><span id="local-6989586621679146024"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146024"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedData"><span class="hs-identifier hs-type">EncryptedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679146020"><span id="local-6989586621679146021"><span id="local-6989586621679146022"><span id="local-6989586621679146023"><span class="annot"><span class="annottext">[Attribute]
EncapsulatedContent
ContentType
ContentEncryptionParams
edUnprotectedAttrs :: [Attribute]
edEncryptedContent :: EncapsulatedContent
edContentEncryptionParams :: ContentEncryptionParams
edContentType :: ContentType
edUnprotectedAttrs :: forall content. EncryptedData content -&gt; [Attribute]
edEncryptedContent :: forall content. EncryptedData content -&gt; content
edContentEncryptionParams :: forall content. EncryptedData content -&gt; ContentEncryptionParams
edContentType :: forall content. EncryptedData content -&gt; ContentType
</span><a href="#local-6989586621679146020"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679146019"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146019"><span class="hs-identifier hs-var">decrypted</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall cek ba.
(ByteArray cek, ByteArray ba) =&gt;
cek -&gt; ContentEncryptionParams -&gt; ba -&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#contentDecrypt"><span class="hs-identifier hs-var">contentDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146024"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146022"><span class="hs-identifier hs-var">edContentEncryptionParams</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146021"><span class="hs-identifier hs-var">edEncryptedContent</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679146023"><span class="hs-identifier hs-var">edContentType</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146019"><span class="hs-identifier hs-var">decrypted</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- EnvelopedData</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Add an enveloped-data layer on the specified content info.  The content is</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- encrypted with specified key and algorithm.  The key is then processed by</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- one or several 'ProducerOfRI' functions to create recipient info elements.</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Some optional attributes can be added but will not be encrypted.</span><span>
</span><span id="line-242"></span><span id="local-6989586621679146319"><span class="annot"><a href="Crypto.Store.CMS.html#envelopData"><span class="hs-identifier hs-type">envelopData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679146319"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OriginatorInfo"><span class="hs-identifier hs-type">OriginatorInfo</span></a></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#ContentEncryptionParams"><span class="hs-identifier hs-type">ContentEncryptionParams</span></a></span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146319"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-249"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146319"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-250"></span><span id="envelopData"><span class="annot"><span class="annottext">envelopData :: forall (f :: * -&gt; *).
Applicative f =&gt;
OriginatorInfo
-&gt; EncapsulatedContent
-&gt; ContentEncryptionParams
-&gt; [ProducerOfRI f]
-&gt; [Attribute]
-&gt; ContentInfo
-&gt; f (Either StoreError (EnvelopedData EncapsulatedContent))
</span><a href="Crypto.Store.CMS.html#envelopData"><span class="hs-identifier hs-var hs-var">envelopData</span></a></span></span><span> </span><span id="local-6989586621679146007"><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679146007"><span class="hs-identifier hs-var">oinfo</span></a></span></span><span> </span><span id="local-6989586621679146006"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146006"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679146005"><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146005"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679146004"><span class="annot"><span class="annottext">[ProducerOfRI f]
</span><a href="#local-6989586621679146004"><span class="hs-identifier hs-var">envFns</span></a></span></span><span> </span><span id="local-6989586621679146003"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679146003"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679146002"><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146002"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError [RecipientInfo]
-&gt; Either StoreError (EnvelopedData EncapsulatedContent)
</span><a href="#local-6989586621679146001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146006"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProducerOfRI f]
</span><a href="#local-6989586621679146004"><span class="hs-identifier hs-var">envFns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679145996"><span class="annot"><span class="annottext">ebs :: Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145996"><span class="hs-identifier hs-var hs-var">ebs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall cek ba.
(ByteArray cek, ByteArray ba) =&gt;
cek -&gt; ContentEncryptionParams -&gt; ba -&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#contentEncrypt"><span class="hs-identifier hs-var">contentEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679146006"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146005"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146002"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679146001"><span class="annot"><span class="annottext">f :: Either StoreError [RecipientInfo]
-&gt; Either StoreError (EnvelopedData EncapsulatedContent)
</span><a href="#local-6989586621679146001"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679145993"><span class="annot"><span class="annottext">Either StoreError [RecipientInfo]
</span><a href="#local-6989586621679145993"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {content}.
content -&gt; [RecipientInfo] -&gt; EnvelopedData content
</span><a href="#local-6989586621679145992"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145996"><span class="hs-identifier hs-var">ebs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError [RecipientInfo]
</span><a href="#local-6989586621679145993"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679145992"><span class="annot"><span class="annottext">build :: content -&gt; [RecipientInfo] -&gt; EnvelopedData content
</span><a href="#local-6989586621679145992"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679145991"><span class="annot"><span class="annottext">content
</span><a href="#local-6989586621679145991"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679145990"><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145990"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span>
</span><span id="line-256"></span><span>                       </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">evOriginatorInfo :: OriginatorInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#evOriginatorInfo"><span class="hs-identifier hs-var">evOriginatorInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679146007"><span class="hs-identifier hs-var">oinfo</span></a></span><span>
</span><span id="line-257"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evRecipientInfos :: [RecipientInfo]
</span><a href="Crypto.Store.CMS.Enveloped.html#evRecipientInfos"><span class="hs-identifier hs-var">evRecipientInfos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145990"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-258"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evContentType :: ContentType
</span><a href="Crypto.Store.CMS.Enveloped.html#evContentType"><span class="hs-identifier hs-var">evContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679146002"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-259"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evContentEncryptionParams :: ContentEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#evContentEncryptionParams"><span class="hs-identifier hs-var">evContentEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679146005"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-260"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evEncryptedContent :: content
</span><a href="Crypto.Store.CMS.Enveloped.html#evEncryptedContent"><span class="hs-identifier hs-var">evEncryptedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">content
</span><a href="#local-6989586621679145991"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-261"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evUnprotectedAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.Enveloped.html#evUnprotectedAttrs"><span class="hs-identifier hs-var">evUnprotectedAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679146003"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-262"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Recover an enveloped content info using the specified 'ConsumerOfRI'</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- function.</span><span>
</span><span id="line-266"></span><span id="local-6989586621679146301"><span class="annot"><a href="Crypto.Store.CMS.html#openEnvelopedData"><span class="hs-identifier hs-type">openEnvelopedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679146301"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-267"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146301"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-268"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span>
</span><span id="line-269"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146301"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-270"></span><span id="openEnvelopedData"><span class="annot"><span class="annottext">openEnvelopedData :: forall (m :: * -&gt; *).
Monad m =&gt;
ConsumerOfRI m
-&gt; EnvelopedData EncapsulatedContent
-&gt; m (Either StoreError ContentInfo)
</span><a href="Crypto.Store.CMS.html#openEnvelopedData"><span class="hs-identifier hs-var hs-var">openEnvelopedData</span></a></span></span><span> </span><span id="local-6989586621679145971"><span class="annot"><span class="annottext">ConsumerOfRI m
</span><a href="#local-6989586621679145971"><span class="hs-identifier hs-var">devFn</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679145965"><span id="local-6989586621679145966"><span id="local-6989586621679145967"><span id="local-6989586621679145968"><span id="local-6989586621679145969"><span id="local-6989586621679145970"><span class="annot"><span class="annottext">[Attribute]
[RecipientInfo]
EncapsulatedContent
ContentType
OriginatorInfo
ContentEncryptionParams
evUnprotectedAttrs :: [Attribute]
evEncryptedContent :: EncapsulatedContent
evContentEncryptionParams :: ContentEncryptionParams
evContentType :: ContentType
evRecipientInfos :: [RecipientInfo]
evOriginatorInfo :: OriginatorInfo
evUnprotectedAttrs :: forall content. EnvelopedData content -&gt; [Attribute]
evEncryptedContent :: forall content. EnvelopedData content -&gt; content
evContentEncryptionParams :: forall content. EnvelopedData content -&gt; ContentEncryptionParams
evContentType :: forall content. EnvelopedData content -&gt; ContentType
evRecipientInfos :: forall content. EnvelopedData content -&gt; [RecipientInfo]
evOriginatorInfo :: forall content. EnvelopedData content -&gt; OriginatorInfo
</span><a href="#local-6989586621679145965"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679145964"><span class="annot"><span class="annottext">Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145964"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b.
Monad m =&gt;
[m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-var">riAttempts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall {cek}.
ByteArray cek =&gt;
cek -&gt; Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145962"><span class="hs-identifier hs-var">decr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConsumerOfRI m
</span><a href="#local-6989586621679145971"><span class="hs-identifier hs-var">devFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145969"><span class="hs-identifier hs-var">evRecipientInfos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145964"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145960"><span class="hs-identifier hs-var">ct</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679145960"><span class="annot"><span class="annottext">ct :: ContentType
</span><a href="#local-6989586621679145960"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145968"><span class="hs-identifier hs-var">evContentType</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621679145959"><span class="annot"><span class="annottext">params :: ContentEncryptionParams
</span><a href="#local-6989586621679145959"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679145967"><span class="hs-identifier hs-var">evContentEncryptionParams</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679145962"><span class="annot"><span class="annottext">decr :: cek -&gt; Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145962"><span class="hs-identifier hs-var hs-var">decr</span></a></span></span><span> </span><span id="local-6989586621679145955"><span class="annot"><span class="annottext">cek
</span><a href="#local-6989586621679145955"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall cek ba.
(ByteArray cek, ByteArray ba) =&gt;
cek -&gt; ContentEncryptionParams -&gt; ba -&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#contentDecrypt"><span class="hs-identifier hs-var">contentDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">cek
</span><a href="#local-6989586621679145955"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679145959"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145966"><span class="hs-identifier hs-var">evEncryptedContent</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- AuthenticatedData</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Key used for authentication.</span><span>
</span><span id="line-282"></span><span class="hs-keyword">type</span><span> </span><span id="AuthenticationKey"><span class="annot"><a href="Crypto.Store.CMS.html#AuthenticationKey"><span class="hs-identifier hs-var">AuthenticationKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | Add an authenticated-data layer on the specified content info.  The content</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- is MACed with the specified key and algorithms.  The key is then processed by</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- one or several 'ProducerOfRI' functions to create recipient info elements.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- Two lists of optional attributes can be provided.  The attributes will be</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- part of message authentication when provided in the first list.</span><span>
</span><span id="line-290"></span><span id="local-6989586621679146282"><span class="annot"><a href="Crypto.Store.CMS.html#generateAuthenticatedData"><span class="hs-identifier hs-type">generateAuthenticatedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679146282"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-291"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OriginatorInfo"><span class="hs-identifier hs-type">OriginatorInfo</span></a></span><span>
</span><span id="line-292"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.html#AuthenticationKey"><span class="hs-identifier hs-type">AuthenticationKey</span></a></span><span>
</span><span id="line-293"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#MACAlgorithm"><span class="hs-identifier hs-type">MACAlgorithm</span></a></span><span>
</span><span id="line-294"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#DigestAlgorithm"><span class="hs-identifier hs-type">DigestAlgorithm</span></a></span><span>
</span><span id="line-295"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146282"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-299"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146282"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Authenticated.html#AuthenticatedData"><span class="hs-identifier hs-type">AuthenticatedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier hs-type">EncapsulatedContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-300"></span><span id="generateAuthenticatedData"><span class="annot"><span class="annottext">generateAuthenticatedData :: forall (f :: * -&gt; *).
Applicative f =&gt;
OriginatorInfo
-&gt; EncapsulatedContent
-&gt; MACAlgorithm
-&gt; Maybe DigestAlgorithm
-&gt; [ProducerOfRI f]
-&gt; [Attribute]
-&gt; [Attribute]
-&gt; ContentInfo
-&gt; f (Either StoreError (AuthenticatedData EncapsulatedContent))
</span><a href="Crypto.Store.CMS.html#generateAuthenticatedData"><span class="hs-identifier hs-var hs-var">generateAuthenticatedData</span></a></span></span><span> </span><span id="local-6989586621679145945"><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679145945"><span class="hs-identifier hs-var">oinfo</span></a></span></span><span> </span><span id="local-6989586621679145944"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145944"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679145943"><span class="annot"><span class="annottext">MACAlgorithm
</span><a href="#local-6989586621679145943"><span class="hs-identifier hs-var">macAlg</span></a></span></span><span> </span><span id="local-6989586621679145942"><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><a href="#local-6989586621679145942"><span class="hs-identifier hs-var">digAlg</span></a></span></span><span> </span><span id="local-6989586621679145941"><span class="annot"><span class="annottext">[ProducerOfRI f]
</span><a href="#local-6989586621679145941"><span class="hs-identifier hs-var">envFns</span></a></span></span><span> </span><span id="local-6989586621679145940"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145940"><span class="hs-identifier hs-var">aAttrs</span></a></span></span><span> </span><span id="local-6989586621679145939"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145939"><span class="hs-identifier hs-var">uAttrs</span></a></span></span><span> </span><span id="local-6989586621679145938"><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145938"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *}.
Functor f =&gt;
f [RecipientInfo] -&gt; f (AuthenticatedData EncapsulatedContent)
</span><a href="#local-6989586621679145937"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145944"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProducerOfRI f]
</span><a href="#local-6989586621679145941"><span class="hs-identifier hs-var">envFns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679145936"><span class="annot"><span class="annottext">msg :: EncapsulatedContent
</span><a href="#local-6989586621679145936"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145938"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679145935"><span class="annot"><span class="annottext">ct :: ContentType
</span><a href="#local-6989586621679145935"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145938"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679145934"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145934"><span class="hs-identifier hs-var">aAttrs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679145933"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145933"><span class="hs-identifier hs-var">input</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><a href="#local-6989586621679145942"><span class="hs-identifier hs-var">digAlg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145940"><span class="hs-identifier hs-var">aAttrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145936"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679145932"><span class="annot"><span class="annottext">DigestAlgorithm
</span><a href="#local-6989586621679145932"><span class="hs-identifier hs-var">dig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-310"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679145930"><span class="annot"><span class="annottext">md :: EncapsulatedContent
</span><a href="#local-6989586621679145930"><span class="hs-identifier hs-var hs-var">md</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall message.
ByteArrayAccess message =&gt;
DigestAlgorithm -&gt; message -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Algorithms.html#digest"><span class="hs-identifier hs-var">digest</span></a></span><span> </span><span class="annot"><span class="annottext">DigestAlgorithm
</span><a href="#local-6989586621679145932"><span class="hs-identifier hs-var">dig</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145936"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-311"></span><span>                    </span><span id="local-6989586621679145928"><span class="annot"><span class="annottext">l :: [Attribute]
</span><a href="#local-6989586621679145928"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; [Attribute] -&gt; [Attribute]
</span><a href="Crypto.Store.CMS.Attribute.html#setContentTypeAttr"><span class="hs-identifier hs-var">setContentTypeAttr</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145935"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent -&gt; [Attribute] -&gt; [Attribute]
</span><a href="Crypto.Store.CMS.Attribute.html#setMessageDigestAttr"><span class="hs-identifier hs-var">setMessageDigestAttr</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145930"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145940"><span class="hs-identifier hs-var">aAttrs</span></a></span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145928"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#encodeAuthAttrs"><span class="hs-identifier hs-var">encodeAuthAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145928"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679145922"><span class="annot"><span class="annottext">ebs :: MessageAuthenticationCode
</span><a href="#local-6989586621679145922"><span class="hs-identifier hs-var hs-var">ebs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key message.
(ByteArrayAccess key, ByteArrayAccess message) =&gt;
MACAlgorithm -&gt; key -&gt; message -&gt; MessageAuthenticationCode
</span><a href="Crypto.Store.CMS.Algorithms.html#mac"><span class="hs-identifier hs-var">mac</span></a></span><span> </span><span class="annot"><span class="annottext">MACAlgorithm
</span><a href="#local-6989586621679145943"><span class="hs-identifier hs-var">macAlg</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145944"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145933"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679145937"><span class="annot"><span class="annottext">f :: f [RecipientInfo] -&gt; f (AuthenticatedData EncapsulatedContent)
</span><a href="#local-6989586621679145937"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679145918"><span class="annot"><span class="annottext">f [RecipientInfo]
</span><a href="#local-6989586621679145918"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageAuthenticationCode
-&gt; [RecipientInfo] -&gt; AuthenticatedData EncapsulatedContent
</span><a href="#local-6989586621679145917"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145922"><span class="hs-identifier hs-var">ebs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f [RecipientInfo]
</span><a href="#local-6989586621679145918"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679145917"><span class="annot"><span class="annottext">build :: MessageAuthenticationCode
-&gt; [RecipientInfo] -&gt; AuthenticatedData EncapsulatedContent
</span><a href="#local-6989586621679145917"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679145916"><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145916"><span class="hs-identifier hs-var">authTag</span></a></span></span><span> </span><span id="local-6989586621679145915"><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145915"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Authenticated.html#AuthenticatedData"><span class="hs-identifier hs-type">AuthenticatedData</span></a></span><span>
</span><span id="line-317"></span><span>                            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">adOriginatorInfo :: OriginatorInfo
</span><a href="Crypto.Store.CMS.Authenticated.html#adOriginatorInfo"><span class="hs-identifier hs-var">adOriginatorInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679145945"><span class="hs-identifier hs-var">oinfo</span></a></span><span>
</span><span id="line-318"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adRecipientInfos :: [RecipientInfo]
</span><a href="Crypto.Store.CMS.Authenticated.html#adRecipientInfos"><span class="hs-identifier hs-var">adRecipientInfos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145915"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-319"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adMACAlgorithm :: MACAlgorithm
</span><a href="Crypto.Store.CMS.Authenticated.html#adMACAlgorithm"><span class="hs-identifier hs-var">adMACAlgorithm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MACAlgorithm
</span><a href="#local-6989586621679145943"><span class="hs-identifier hs-var">macAlg</span></a></span><span>
</span><span id="line-320"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adDigestAlgorithm :: Maybe DigestAlgorithm
</span><a href="Crypto.Store.CMS.Authenticated.html#adDigestAlgorithm"><span class="hs-identifier hs-var">adDigestAlgorithm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><a href="#local-6989586621679145942"><span class="hs-identifier hs-var">digAlg</span></a></span><span>
</span><span id="line-321"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adContentType :: ContentType
</span><a href="Crypto.Store.CMS.Authenticated.html#adContentType"><span class="hs-identifier hs-var">adContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145938"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-322"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adEncapsulatedContent :: EncapsulatedContent
</span><a href="Crypto.Store.CMS.Authenticated.html#adEncapsulatedContent"><span class="hs-identifier hs-var">adEncapsulatedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145938"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-323"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adAuthAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.Authenticated.html#adAuthAttrs"><span class="hs-identifier hs-var">adAuthAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145934"><span class="hs-identifier hs-var">aAttrs'</span></a></span><span>
</span><span id="line-324"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adMAC :: MessageAuthenticationCode
</span><a href="Crypto.Store.CMS.Authenticated.html#adMAC"><span class="hs-identifier hs-var">adMAC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145916"><span class="hs-identifier hs-var">authTag</span></a></span><span>
</span><span id="line-325"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">adUnauthAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.Authenticated.html#adUnauthAttrs"><span class="hs-identifier hs-var">adUnauthAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145939"><span class="hs-identifier hs-var">uAttrs</span></a></span><span>
</span><span id="line-326"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Verify the integrity of an authenticated content info using the specified</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- 'ConsumerOfRI' function.  The inner content info is returned only if the MAC</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- could be verified.</span><span>
</span><span id="line-331"></span><span id="local-6989586621679146274"><span class="annot"><a href="Crypto.Store.CMS.html#verifyAuthenticatedData"><span class="hs-identifier hs-type">verifyAuthenticatedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679146274"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-332"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146274"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-333"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Authenticated.html#AuthenticatedData"><span class="hs-identifier hs-type">AuthenticatedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier hs-type">EncapsulatedContent</span></a></span><span>
</span><span id="line-334"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146274"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-335"></span><span id="verifyAuthenticatedData"><span class="annot"><span class="annottext">verifyAuthenticatedData :: forall (m :: * -&gt; *).
Monad m =&gt;
ConsumerOfRI m
-&gt; AuthenticatedData EncapsulatedContent
-&gt; m (Either StoreError ContentInfo)
</span><a href="Crypto.Store.CMS.html#verifyAuthenticatedData"><span class="hs-identifier hs-var hs-var">verifyAuthenticatedData</span></a></span></span><span> </span><span id="local-6989586621679145897"><span class="annot"><span class="annottext">ConsumerOfRI m
</span><a href="#local-6989586621679145897"><span class="hs-identifier hs-var">devFn</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Authenticated.html#AuthenticatedData"><span class="hs-identifier hs-type">AuthenticatedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679145888"><span id="local-6989586621679145889"><span id="local-6989586621679145890"><span id="local-6989586621679145891"><span id="local-6989586621679145892"><span id="local-6989586621679145893"><span id="local-6989586621679145894"><span id="local-6989586621679145895"><span id="local-6989586621679145896"><span class="annot"><span class="annottext">[Attribute]
[RecipientInfo]
Maybe DigestAlgorithm
EncapsulatedContent
MessageAuthenticationCode
ContentType
OriginatorInfo
MACAlgorithm
adUnauthAttrs :: [Attribute]
adMAC :: MessageAuthenticationCode
adAuthAttrs :: [Attribute]
adEncapsulatedContent :: EncapsulatedContent
adContentType :: ContentType
adDigestAlgorithm :: Maybe DigestAlgorithm
adMACAlgorithm :: MACAlgorithm
adRecipientInfos :: [RecipientInfo]
adOriginatorInfo :: OriginatorInfo
adUnauthAttrs :: forall content. AuthenticatedData content -&gt; [Attribute]
adMAC :: forall content.
AuthenticatedData content -&gt; MessageAuthenticationCode
adAuthAttrs :: forall content. AuthenticatedData content -&gt; [Attribute]
adEncapsulatedContent :: forall content. AuthenticatedData content -&gt; content
adContentType :: forall content. AuthenticatedData content -&gt; ContentType
adDigestAlgorithm :: forall content. AuthenticatedData content -&gt; Maybe DigestAlgorithm
adMACAlgorithm :: forall content. AuthenticatedData content -&gt; MACAlgorithm
adRecipientInfos :: forall content. AuthenticatedData content -&gt; [RecipientInfo]
adOriginatorInfo :: forall content. AuthenticatedData content -&gt; OriginatorInfo
</span><a href="#local-6989586621679145888"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b.
Monad m =&gt;
[m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-var">riAttempts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall {key}.
ByteArrayAccess key =&gt;
key -&gt; Either StoreError ContentInfo
</span><a href="#local-6989586621679145887"><span class="hs-identifier hs-var">unwrap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConsumerOfRI m
</span><a href="#local-6989586621679145897"><span class="hs-identifier hs-var">devFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145895"><span class="hs-identifier hs-var">adRecipientInfos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679145886"><span class="annot"><span class="annottext">msg :: EncapsulatedContent
</span><a href="#local-6989586621679145886"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145891"><span class="hs-identifier hs-var">adEncapsulatedContent</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679145885"><span class="annot"><span class="annottext">ct :: ContentType
</span><a href="#local-6989586621679145885"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145892"><span class="hs-identifier hs-var">adContentType</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679145882"><span class="annot"><span class="annottext">noAttr :: Bool
</span><a href="#local-6989586621679145882"><span class="hs-identifier hs-var hs-var">noAttr</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145890"><span class="hs-identifier hs-var">adAuthAttrs</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679145875"><span class="annot"><span class="annottext">mdMatch :: Bool
</span><a href="#local-6989586621679145875"><span class="hs-identifier hs-var hs-var">mdMatch</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><a href="#local-6989586621679145893"><span class="hs-identifier hs-var">adDigestAlgorithm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>                    </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-344"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679145874"><span class="annot"><span class="annottext">DigestAlgorithm
</span><a href="#local-6989586621679145874"><span class="hs-identifier hs-var">dig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe EncapsulatedContent
</span><a href="#local-6989586621679145873"><span class="hs-identifier hs-var">mdAttr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall message.
ByteArrayAccess message =&gt;
DigestAlgorithm -&gt; message -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Algorithms.html#digest"><span class="hs-identifier hs-var">digest</span></a></span><span> </span><span class="annot"><span class="annottext">DigestAlgorithm
</span><a href="#local-6989586621679145874"><span class="hs-identifier hs-var">dig</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145886"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679145871"><span class="annot"><span class="annottext">mdAccept :: Bool
</span><a href="#local-6989586621679145871"><span class="hs-identifier hs-var hs-var">mdAccept</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">forall params. HasStrength params =&gt; params -&gt; Bool
</span><a href="Crypto.Store.CMS.Algorithms.html#securityAcceptable"><span class="hs-identifier hs-var">securityAcceptable</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><a href="#local-6989586621679145893"><span class="hs-identifier hs-var">adDigestAlgorithm</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679145867"><span class="annot"><span class="annottext">macAccept :: Bool
</span><a href="#local-6989586621679145867"><span class="hs-identifier hs-var hs-var">macAccept</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall params. HasStrength params =&gt; params -&gt; Bool
</span><a href="Crypto.Store.CMS.Algorithms.html#securityAcceptable"><span class="hs-identifier hs-var">securityAcceptable</span></a></span><span> </span><span class="annot"><span class="annottext">MACAlgorithm
</span><a href="#local-6989586621679145894"><span class="hs-identifier hs-var">adMACAlgorithm</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621679145863"><span class="annot"><span class="annottext">attrMatch :: Bool
</span><a href="#local-6989586621679145863"><span class="hs-identifier hs-var hs-var">attrMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ContentType
</span><a href="#local-6989586621679145862"><span class="hs-identifier hs-var">ctAttr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145885"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145875"><span class="hs-identifier hs-var">mdMatch</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679145873"><span class="annot"><span class="annottext">mdAttr :: Maybe EncapsulatedContent
</span><a href="#local-6989586621679145873"><span class="hs-identifier hs-var hs-var">mdAttr</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; Maybe EncapsulatedContent
</span><a href="Crypto.Store.CMS.Attribute.html#getMessageDigestAttr"><span class="hs-identifier hs-var">getMessageDigestAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145890"><span class="hs-identifier hs-var">adAuthAttrs</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679145862"><span class="annot"><span class="annottext">ctAttr :: Maybe ContentType
</span><a href="#local-6989586621679145862"><span class="hs-identifier hs-var hs-var">ctAttr</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; Maybe ContentType
</span><a href="Crypto.Store.CMS.Attribute.html#getContentTypeAttr"><span class="hs-identifier hs-var">getContentTypeAttr</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145890"><span class="hs-identifier hs-var">adAuthAttrs</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679145858"><span class="annot"><span class="annottext">input :: EncapsulatedContent
</span><a href="#local-6989586621679145858"><span class="hs-identifier hs-var hs-var">input</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145882"><span class="hs-identifier hs-var">noAttr</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145886"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#encodeAuthAttrs"><span class="hs-identifier hs-var">encodeAuthAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145890"><span class="hs-identifier hs-var">adAuthAttrs</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679145887"><span class="annot"><span class="annottext">unwrap :: key -&gt; Either StoreError ContentInfo
</span><a href="#local-6989586621679145887"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span id="local-6989586621679145852"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679145852"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe DigestAlgorithm
</span><a href="#local-6989586621679145893"><span class="hs-identifier hs-var">adDigestAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145882"><span class="hs-identifier hs-var">noAttr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StoreError
</span><a href="Crypto.Store.Error.html#InvalidInput"><span class="hs-identifier hs-var">InvalidInput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Missing auth attributes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145882"><span class="hs-identifier hs-var">noAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145863"><span class="hs-identifier hs-var">attrMatch</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StoreError
</span><a href="Crypto.Store.Error.html#InvalidInput"><span class="hs-identifier hs-var">InvalidInput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid auth attributes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145871"><span class="hs-identifier hs-var">mdAccept</span></a></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StoreError
</span><a href="Crypto.Store.Error.html#InvalidParameter"><span class="hs-identifier hs-var">InvalidParameter</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Digest too weak&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145867"><span class="hs-identifier hs-var">macAccept</span></a></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; StoreError
</span><a href="Crypto.Store.Error.html#InvalidParameter"><span class="hs-identifier hs-var">InvalidParameter</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAC too weak&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145889"><span class="hs-identifier hs-var">adMAC</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">forall key message.
(ByteArrayAccess key, ByteArrayAccess message) =&gt;
MACAlgorithm -&gt; key -&gt; message -&gt; MessageAuthenticationCode
</span><a href="Crypto.Store.CMS.Algorithms.html#mac"><span class="hs-identifier hs-var">mac</span></a></span><span> </span><span class="annot"><span class="annottext">MACAlgorithm
</span><a href="#local-6989586621679145894"><span class="hs-identifier hs-var">adMACAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679145852"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145858"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#BadContentMAC"><span class="hs-identifier hs-var">BadContentMAC</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145892"><span class="hs-identifier hs-var">adContentType</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145891"><span class="hs-identifier hs-var">adEncapsulatedContent</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- AuthEnvelopedData</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Add an authenticated-enveloped-data layer on the specified content info.</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- The content is encrypted with specified key and algorithm.  The key is then</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- processed by one or several 'ProducerOfRI' functions to create recipient info</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- elements.</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- Some attributes can be added but will not be encrypted.  The attributes</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- will be part of message authentication when provided in the first list.</span><span>
</span><span id="line-370"></span><span id="local-6989586621679146263"><span class="annot"><a href="Crypto.Store.CMS.html#authEnvelopData"><span class="hs-identifier hs-type">authEnvelopData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679146263"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-371"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OriginatorInfo"><span class="hs-identifier hs-type">OriginatorInfo</span></a></span><span>
</span><span id="line-372"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span>
</span><span id="line-373"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#AuthContentEncryptionParams"><span class="hs-identifier hs-type">AuthContentEncryptionParams</span></a></span><span>
</span><span id="line-374"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146263"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-378"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146263"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.AuthEnveloped.html#AuthEnvelopedData"><span class="hs-identifier hs-type">AuthEnvelopedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-379"></span><span id="authEnvelopData"><span class="annot"><span class="annottext">authEnvelopData :: forall (f :: * -&gt; *).
Applicative f =&gt;
OriginatorInfo
-&gt; EncapsulatedContent
-&gt; AuthContentEncryptionParams
-&gt; [ProducerOfRI f]
-&gt; [Attribute]
-&gt; [Attribute]
-&gt; ContentInfo
-&gt; f (Either StoreError (AuthEnvelopedData EncapsulatedContent))
</span><a href="Crypto.Store.CMS.html#authEnvelopData"><span class="hs-identifier hs-var hs-var">authEnvelopData</span></a></span></span><span> </span><span id="local-6989586621679145840"><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679145840"><span class="hs-identifier hs-var">oinfo</span></a></span></span><span> </span><span id="local-6989586621679145839"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145839"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679145838"><span class="annot"><span class="annottext">AuthContentEncryptionParams
</span><a href="#local-6989586621679145838"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679145837"><span class="annot"><span class="annottext">[ProducerOfRI f]
</span><a href="#local-6989586621679145837"><span class="hs-identifier hs-var">envFns</span></a></span></span><span> </span><span id="local-6989586621679145836"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145836"><span class="hs-identifier hs-var">aAttrs</span></a></span></span><span> </span><span id="local-6989586621679145835"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145835"><span class="hs-identifier hs-var">uAttrs</span></a></span></span><span> </span><span id="local-6989586621679145834"><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145834"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError [RecipientInfo]
-&gt; Either StoreError (AuthEnvelopedData EncapsulatedContent)
</span><a href="#local-6989586621679145833"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145839"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProducerOfRI f]
</span><a href="#local-6989586621679145837"><span class="hs-identifier hs-var">envFns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679145829"><span class="annot"><span class="annottext">raw :: EncapsulatedContent
</span><a href="#local-6989586621679145829"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">AuthContentEncryptionParams
</span><a href="#local-6989586621679145838"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621679145827"><span class="annot"><span class="annottext">aad :: EncapsulatedContent
</span><a href="#local-6989586621679145827"><span class="hs-identifier hs-var hs-var">aad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#encodeAuthAttrs"><span class="hs-identifier hs-var">encodeAuthAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145836"><span class="hs-identifier hs-var">aAttrs</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679145823"><span class="annot"><span class="annottext">ebs :: Either StoreError (MessageAuthenticationCode, EncapsulatedContent)
</span><a href="#local-6989586621679145823"><span class="hs-identifier hs-var hs-var">ebs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall cek aad ba.
(ByteArray cek, ByteArrayAccess aad, ByteArray ba) =&gt;
cek
-&gt; AuthContentEncryptionParams
-&gt; ba
-&gt; aad
-&gt; ba
-&gt; Either StoreError (MessageAuthenticationCode, ba)
</span><a href="Crypto.Store.CMS.Algorithms.html#authContentEncrypt"><span class="hs-identifier hs-var">authContentEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145839"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">AuthContentEncryptionParams
</span><a href="#local-6989586621679145838"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145829"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145827"><span class="hs-identifier hs-var">aad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145834"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span id="local-6989586621679145833"><span class="annot"><span class="annottext">f :: Either StoreError [RecipientInfo]
-&gt; Either StoreError (AuthEnvelopedData EncapsulatedContent)
</span><a href="#local-6989586621679145833"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679145819"><span class="annot"><span class="annottext">Either StoreError [RecipientInfo]
</span><a href="#local-6989586621679145819"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {content}.
(MessageAuthenticationCode, content)
-&gt; [RecipientInfo] -&gt; AuthEnvelopedData content
</span><a href="#local-6989586621679145818"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError (MessageAuthenticationCode, EncapsulatedContent)
</span><a href="#local-6989586621679145823"><span class="hs-identifier hs-var">ebs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError [RecipientInfo]
</span><a href="#local-6989586621679145819"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621679145818"><span class="annot"><span class="annottext">build :: (MessageAuthenticationCode, content)
-&gt; [RecipientInfo] -&gt; AuthEnvelopedData content
</span><a href="#local-6989586621679145818"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145817"><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145817"><span class="hs-identifier hs-var">authTag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679145816"><span class="annot"><span class="annottext">content
</span><a href="#local-6989586621679145816"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679145815"><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145815"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.AuthEnveloped.html#AuthEnvelopedData"><span class="hs-identifier hs-type">AuthEnvelopedData</span></a></span><span>
</span><span id="line-387"></span><span>                       </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aeOriginatorInfo :: OriginatorInfo
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeOriginatorInfo"><span class="hs-identifier hs-var">aeOriginatorInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679145840"><span class="hs-identifier hs-var">oinfo</span></a></span><span>
</span><span id="line-388"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeRecipientInfos :: [RecipientInfo]
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeRecipientInfos"><span class="hs-identifier hs-var">aeRecipientInfos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145815"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-389"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeContentType :: ContentType
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeContentType"><span class="hs-identifier hs-var">aeContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145834"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-390"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeContentEncryptionParams :: ASN1ObjectExact AuthContentEncryptionParams
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeContentEncryptionParams"><span class="hs-identifier hs-var">aeContentEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; EncapsulatedContent -&gt; ASN1ObjectExact a
</span><a href="Crypto.Store.CMS.Util.html#ASN1ObjectExact"><span class="hs-identifier hs-var">ASN1ObjectExact</span></a></span><span> </span><span class="annot"><span class="annottext">AuthContentEncryptionParams
</span><a href="#local-6989586621679145838"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145829"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-391"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeEncryptedContent :: content
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeEncryptedContent"><span class="hs-identifier hs-var">aeEncryptedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">content
</span><a href="#local-6989586621679145816"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-392"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeAuthAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeAuthAttrs"><span class="hs-identifier hs-var">aeAuthAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145836"><span class="hs-identifier hs-var">aAttrs</span></a></span><span>
</span><span id="line-393"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeMAC :: MessageAuthenticationCode
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeMAC"><span class="hs-identifier hs-var">aeMAC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145817"><span class="hs-identifier hs-var">authTag</span></a></span><span>
</span><span id="line-394"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeUnauthAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#aeUnauthAttrs"><span class="hs-identifier hs-var">aeUnauthAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145835"><span class="hs-identifier hs-var">uAttrs</span></a></span><span>
</span><span id="line-395"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Recover an authenticated-enveloped content info using the specified</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- 'ConsumerOfRI' function.</span><span>
</span><span id="line-399"></span><span id="local-6989586621679146252"><span class="annot"><a href="Crypto.Store.CMS.html#openAuthEnvelopedData"><span class="hs-identifier hs-type">openAuthEnvelopedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679146252"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-400"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146252"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-401"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.AuthEnveloped.html#AuthEnvelopedData"><span class="hs-identifier hs-type">AuthEnvelopedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span>
</span><span id="line-402"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146252"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-403"></span><span id="openAuthEnvelopedData"><span class="annot"><span class="annottext">openAuthEnvelopedData :: forall (m :: * -&gt; *).
Monad m =&gt;
ConsumerOfRI m
-&gt; AuthEnvelopedData EncapsulatedContent
-&gt; m (Either StoreError ContentInfo)
</span><a href="Crypto.Store.CMS.html#openAuthEnvelopedData"><span class="hs-identifier hs-var hs-var">openAuthEnvelopedData</span></a></span></span><span> </span><span id="local-6989586621679145794"><span class="annot"><span class="annottext">ConsumerOfRI m
</span><a href="#local-6989586621679145794"><span class="hs-identifier hs-var">devFn</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.AuthEnveloped.html#AuthEnvelopedData"><span class="hs-identifier hs-type">AuthEnvelopedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679145786"><span id="local-6989586621679145787"><span id="local-6989586621679145788"><span id="local-6989586621679145789"><span id="local-6989586621679145790"><span id="local-6989586621679145791"><span id="local-6989586621679145792"><span id="local-6989586621679145793"><span class="annot"><span class="annottext">[Attribute]
[RecipientInfo]
EncapsulatedContent
MessageAuthenticationCode
ASN1ObjectExact AuthContentEncryptionParams
ContentType
OriginatorInfo
aeUnauthAttrs :: [Attribute]
aeMAC :: MessageAuthenticationCode
aeAuthAttrs :: [Attribute]
aeEncryptedContent :: EncapsulatedContent
aeContentEncryptionParams :: ASN1ObjectExact AuthContentEncryptionParams
aeContentType :: ContentType
aeRecipientInfos :: [RecipientInfo]
aeOriginatorInfo :: OriginatorInfo
aeUnauthAttrs :: forall content. AuthEnvelopedData content -&gt; [Attribute]
aeMAC :: forall content.
AuthEnvelopedData content -&gt; MessageAuthenticationCode
aeAuthAttrs :: forall content. AuthEnvelopedData content -&gt; [Attribute]
aeEncryptedContent :: forall content. AuthEnvelopedData content -&gt; content
aeContentEncryptionParams :: forall content.
AuthEnvelopedData content
-&gt; ASN1ObjectExact AuthContentEncryptionParams
aeContentType :: forall content. AuthEnvelopedData content -&gt; ContentType
aeRecipientInfos :: forall content. AuthEnvelopedData content -&gt; [RecipientInfo]
aeOriginatorInfo :: forall content. AuthEnvelopedData content -&gt; OriginatorInfo
</span><a href="#local-6989586621679145786"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621679145785"><span class="annot"><span class="annottext">Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145785"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b.
Monad m =&gt;
[m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-var">riAttempts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall {cek}.
ByteArray cek =&gt;
cek -&gt; Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145784"><span class="hs-identifier hs-var">decr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConsumerOfRI m
</span><a href="#local-6989586621679145794"><span class="hs-identifier hs-var">devFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679145792"><span class="hs-identifier hs-var">aeRecipientInfos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145785"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145783"><span class="hs-identifier hs-var">ct</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679145783"><span class="annot"><span class="annottext">ct :: ContentType
</span><a href="#local-6989586621679145783"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145791"><span class="hs-identifier hs-var">aeContentType</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679145782"><span class="annot"><span class="annottext">params :: AuthContentEncryptionParams
</span><a href="#local-6989586621679145782"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ASN1ObjectExact a -&gt; a
</span><a href="Crypto.Store.CMS.Util.html#exactObject"><span class="hs-identifier hs-var">exactObject</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ObjectExact AuthContentEncryptionParams
</span><a href="#local-6989586621679145790"><span class="hs-identifier hs-var">aeContentEncryptionParams</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679145780"><span class="annot"><span class="annottext">raw :: EncapsulatedContent
</span><a href="#local-6989586621679145780"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ASN1ObjectExact a -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#exactObjectRaw"><span class="hs-identifier hs-var">exactObjectRaw</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ObjectExact AuthContentEncryptionParams
</span><a href="#local-6989586621679145790"><span class="hs-identifier hs-var">aeContentEncryptionParams</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621679145778"><span class="annot"><span class="annottext">aad :: EncapsulatedContent
</span><a href="#local-6989586621679145778"><span class="hs-identifier hs-var hs-var">aad</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.AuthEnveloped.html#encodeAuthAttrs"><span class="hs-identifier hs-var">encodeAuthAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679145788"><span class="hs-identifier hs-var">aeAuthAttrs</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679145784"><span class="annot"><span class="annottext">decr :: cek -&gt; Either StoreError EncapsulatedContent
</span><a href="#local-6989586621679145784"><span class="hs-identifier hs-var hs-var">decr</span></a></span></span><span> </span><span id="local-6989586621679145773"><span class="annot"><span class="annottext">cek
</span><a href="#local-6989586621679145773"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall cek aad ba.
(ByteArray cek, ByteArrayAccess aad, ByteArray ba) =&gt;
cek
-&gt; AuthContentEncryptionParams
-&gt; ba
-&gt; aad
-&gt; ba
-&gt; MessageAuthenticationCode
-&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#authContentDecrypt"><span class="hs-identifier hs-var">authContentDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">cek
</span><a href="#local-6989586621679145773"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">AuthContentEncryptionParams
</span><a href="#local-6989586621679145782"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145780"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145778"><span class="hs-identifier hs-var">aad</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145789"><span class="hs-identifier hs-var">aeEncryptedContent</span></a></span><span> </span><span class="annot"><span class="annottext">MessageAuthenticationCode
</span><a href="#local-6989586621679145787"><span class="hs-identifier hs-var">aeMAC</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- SignedData</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Add a signed-data layer on the specified content info.  The content is</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- processed by one or several 'ProducerOfSI' functions to create signer info</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- elements.</span><span>
</span><span id="line-419"></span><span id="local-6989586621679146245"><span class="annot"><a href="Crypto.Store.CMS.html#signData"><span class="hs-identifier hs-type">signData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679146245"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-420"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#ProducerOfSI"><span class="hs-identifier hs-type">ProducerOfSI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146245"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146245"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignedData"><span class="hs-identifier hs-type">SignedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier hs-type">EncapsulatedContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-421"></span><span id="signData"><span class="annot"><span class="annottext">signData :: forall (f :: * -&gt; *).
Applicative f =&gt;
[ProducerOfSI f]
-&gt; ContentInfo
-&gt; f (Either StoreError (SignedData EncapsulatedContent))
</span><a href="Crypto.Store.CMS.html#signData"><span class="hs-identifier hs-var hs-var">signData</span></a></span></span><span> </span><span id="local-6989586621679145763"><span class="annot"><span class="annottext">[ProducerOfSI f]
</span><a href="#local-6989586621679145763"><span class="hs-identifier hs-var">sigFns</span></a></span></span><span> </span><span id="local-6989586621679145762"><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145762"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="annottext">Either
  StoreError
  [(SignerInfo, [CertificateChoice], [RevocationInfoChoice])]
-&gt; Either StoreError (SignedData EncapsulatedContent)
</span><a href="#local-6989586621679145761"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679145760"><span class="annot"><span class="annottext">ProducerOfSI f
</span><a href="#local-6989586621679145760"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProducerOfSI f
</span><a href="#local-6989586621679145760"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145759"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145758"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProducerOfSI f]
</span><a href="#local-6989586621679145763"><span class="hs-identifier hs-var">sigFns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-424"></span><span>    </span><span id="local-6989586621679145758"><span class="annot"><span class="annottext">msg :: EncapsulatedContent
</span><a href="#local-6989586621679145758"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145762"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621679145759"><span class="annot"><span class="annottext">ct :: ContentType
</span><a href="#local-6989586621679145759"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145762"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621679145761"><span class="annot"><span class="annottext">f :: Either
  StoreError
  [(SignerInfo, [CertificateChoice], [RevocationInfoChoice])]
-&gt; Either StoreError (SignedData EncapsulatedContent)
</span><a href="#local-6989586621679145761"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {t :: * -&gt; *}.
(Foldable t, Foldable t) =&gt;
([SignerInfo], t [CertificateChoice], t [RevocationInfoChoice])
-&gt; SignedData EncapsulatedContent
</span><a href="#local-6989586621679145754"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><span class="hs-identifier hs-var">unzip3</span></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679145754"><span class="annot"><span class="annottext">build :: ([SignerInfo], t [CertificateChoice], t [RevocationInfoChoice])
-&gt; SignedData EncapsulatedContent
</span><a href="#local-6989586621679145754"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145747"><span class="annot"><span class="annottext">[SignerInfo]
</span><a href="#local-6989586621679145747"><span class="hs-identifier hs-var">sis</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679145746"><span class="annot"><span class="annottext">t [CertificateChoice]
</span><a href="#local-6989586621679145746"><span class="hs-identifier hs-var">certLists</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679145745"><span class="annot"><span class="annottext">t [RevocationInfoChoice]
</span><a href="#local-6989586621679145745"><span class="hs-identifier hs-var">crlLists</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignedData"><span class="hs-identifier hs-type">SignedData</span></a></span><span>
</span><span id="line-430"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sdDigestAlgorithms :: [DigestAlgorithm]
</span><a href="Crypto.Store.CMS.Signed.html#sdDigestAlgorithms"><span class="hs-identifier hs-var">sdDigestAlgorithms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SignerInfo -&gt; DigestAlgorithm
</span><a href="Crypto.Store.CMS.Signed.html#siDigestAlgorithm"><span class="hs-identifier hs-var">siDigestAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">[SignerInfo]
</span><a href="#local-6989586621679145747"><span class="hs-identifier hs-var">sis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sdContentType :: ContentType
</span><a href="Crypto.Store.CMS.Signed.html#sdContentType"><span class="hs-identifier hs-var">sdContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; ContentType
</span><a href="Crypto.Store.CMS.Info.html#getContentType"><span class="hs-identifier hs-var">getContentType</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145762"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sdEncapsulatedContent :: EncapsulatedContent
</span><a href="Crypto.Store.CMS.Signed.html#sdEncapsulatedContent"><span class="hs-identifier hs-var">sdEncapsulatedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentInfo
</span><a href="#local-6989586621679145762"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sdCertificates :: [CertificateChoice]
</span><a href="Crypto.Store.CMS.Signed.html#sdCertificates"><span class="hs-identifier hs-var">sdCertificates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">t [CertificateChoice]
</span><a href="#local-6989586621679145746"><span class="hs-identifier hs-var">certLists</span></a></span><span>
</span><span id="line-434"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sdCRLs :: [RevocationInfoChoice]
</span><a href="Crypto.Store.CMS.Signed.html#sdCRLs"><span class="hs-identifier hs-var">sdCRLs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">t [RevocationInfoChoice]
</span><a href="#local-6989586621679145745"><span class="hs-identifier hs-var">crlLists</span></a></span><span>
</span><span id="line-435"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sdSignerInfos :: [SignerInfo]
</span><a href="Crypto.Store.CMS.Signed.html#sdSignerInfos"><span class="hs-identifier hs-var">sdSignerInfos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SignerInfo]
</span><a href="#local-6989586621679145747"><span class="hs-identifier hs-var">sis</span></a></span><span>
</span><span id="line-436"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | Verify a signed content info using the specified 'ConsumerOfSI' function.</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- Verification of at least one signer info must be successful in order to</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- return the inner content info.</span><span>
</span><span id="line-441"></span><span id="local-6989586621679146231"><span class="annot"><a href="Crypto.Store.CMS.html#verifySignedData"><span class="hs-identifier hs-type">verifySignedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679146231"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-442"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#ConsumerOfSI"><span class="hs-identifier hs-type">ConsumerOfSI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146231"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignedData"><span class="hs-identifier hs-type">SignedData</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#EncapsulatedContent"><span class="hs-identifier hs-type">EncapsulatedContent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146231"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-443"></span><span id="verifySignedData"><span class="annot"><span class="annottext">verifySignedData :: forall (m :: * -&gt; *).
Monad m =&gt;
ConsumerOfSI m
-&gt; SignedData EncapsulatedContent
-&gt; m (Either StoreError ContentInfo)
</span><a href="Crypto.Store.CMS.html#verifySignedData"><span class="hs-identifier hs-var hs-var">verifySignedData</span></a></span></span><span> </span><span id="local-6989586621679145730"><span class="annot"><span class="annottext">ConsumerOfSI m
</span><a href="#local-6989586621679145730"><span class="hs-identifier hs-var">verFn</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Signed.html#SignedData"><span class="hs-identifier hs-type">SignedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679145724"><span id="local-6989586621679145725"><span id="local-6989586621679145726"><span id="local-6989586621679145727"><span id="local-6989586621679145728"><span id="local-6989586621679145729"><span class="annot"><span class="annottext">[RevocationInfoChoice]
[CertificateChoice]
[DigestAlgorithm]
[SignerInfo]
EncapsulatedContent
ContentType
sdSignerInfos :: [SignerInfo]
sdCRLs :: [RevocationInfoChoice]
sdCertificates :: [CertificateChoice]
sdEncapsulatedContent :: EncapsulatedContent
sdContentType :: ContentType
sdDigestAlgorithms :: [DigestAlgorithm]
sdSignerInfos :: forall content. SignedData content -&gt; [SignerInfo]
sdCRLs :: forall content. SignedData content -&gt; [RevocationInfoChoice]
sdCertificates :: forall content. SignedData content -&gt; [CertificateChoice]
sdEncapsulatedContent :: forall content. SignedData content -&gt; content
sdContentType :: forall content. SignedData content -&gt; ContentType
sdDigestAlgorithms :: forall content. SignedData content -&gt; [DigestAlgorithm]
</span><a href="#local-6989586621679145724"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Either StoreError ContentInfo
</span><a href="#local-6989586621679145723"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; m Bool) -&gt; [a] -&gt; m Bool
</span><a href="Crypto.Store.CMS.html#siAttemps"><span class="hs-identifier hs-var">siAttemps</span></a></span><span> </span><span class="annot"><span class="annottext">SignerInfo -&gt; m Bool
</span><a href="#local-6989586621679145721"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">[SignerInfo]
</span><a href="#local-6989586621679145724"><span class="hs-identifier hs-var">sdSignerInfos</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679145720"><span class="annot"><span class="annottext">msg :: EncapsulatedContent
</span><a href="#local-6989586621679145720"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145727"><span class="hs-identifier hs-var">sdEncapsulatedContent</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span id="local-6989586621679145719"><span class="annot"><span class="annottext">ct :: ContentType
</span><a href="#local-6989586621679145719"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145728"><span class="hs-identifier hs-var">sdContentType</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679145721"><span class="annot"><span class="annottext">valid :: SignerInfo -&gt; m Bool
</span><a href="#local-6989586621679145721"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span id="local-6989586621679145718"><span class="annot"><span class="annottext">SignerInfo
</span><a href="#local-6989586621679145718"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsumerOfSI m
</span><a href="#local-6989586621679145730"><span class="hs-identifier hs-var">verFn</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145719"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145720"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">SignerInfo
</span><a href="#local-6989586621679145718"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="annot"><span class="annottext">[CertificateChoice]
</span><a href="#local-6989586621679145726"><span class="hs-identifier hs-var">sdCertificates</span></a></span><span> </span><span class="annot"><span class="annottext">[RevocationInfoChoice]
</span><a href="#local-6989586621679145725"><span class="hs-identifier hs-var">sdCRLs</span></a></span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621679145723"><span class="annot"><span class="annottext">f :: Bool -&gt; Either StoreError ContentInfo
</span><a href="#local-6989586621679145723"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679145717"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145717"><span class="hs-identifier hs-var">bool</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145717"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679145728"><span class="hs-identifier hs-var">sdContentType</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145727"><span class="hs-identifier hs-var">sdEncapsulatedContent</span></a></span><span>
</span><span id="line-450"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#SignatureNotVerified"><span class="hs-identifier hs-var">SignatureNotVerified</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- Utilities</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span id="local-6989586621679146295"><span id="local-6989586621679146296"><span class="annot"><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-type">riAttempts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679146296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679146296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146295"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146295"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-456"></span><span id="riAttempts"><span class="annot"><span class="annottext">riAttempts :: forall (m :: * -&gt; *) b.
Monad m =&gt;
[m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-var hs-var">riAttempts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#NoRecipientInfoFound"><span class="hs-identifier hs-var">NoRecipientInfoFound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span class="annot"><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-var">riAttempts</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679145711"><span class="annot"><span class="annottext">m (Either StoreError b)
</span><a href="#local-6989586621679145711"><span class="hs-identifier hs-var">single</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either StoreError b)
</span><a href="#local-6989586621679145711"><span class="hs-identifier hs-var">single</span></a></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Crypto.Store.CMS.html#riAttempts"><span class="hs-identifier hs-var">riAttempts</span></a></span><span> </span><span id="local-6989586621679145710"><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><a href="#local-6989586621679145710"><span class="hs-identifier hs-var">list</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b.
Monad m =&gt;
[m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="#local-6989586621679145709"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><a href="#local-6989586621679145710"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679145709"><span class="annot"><span class="annottext">loop :: [m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="#local-6989586621679145709"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#NoRecipientInfoMatched"><span class="hs-identifier hs-var">NoRecipientInfoMatched</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="#local-6989586621679145709"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145703"><span class="annot"><span class="annottext">m (Either StoreError b)
</span><a href="#local-6989586621679145703"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679145702"><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><a href="#local-6989586621679145702"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either StoreError b)
</span><a href="#local-6989586621679145703"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[m (Either StoreError b)]
-&gt; Either StoreError b -&gt; m (Either StoreError b)
</span><a href="#local-6989586621679145701"><span class="hs-identifier hs-var">orTail</span></a></span><span> </span><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><a href="#local-6989586621679145702"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>    </span><span id="local-6989586621679145701"><span class="annot"><span class="annottext">orTail :: [m (Either StoreError b)]
-&gt; Either StoreError b -&gt; m (Either StoreError b)
</span><a href="#local-6989586621679145701"><span class="hs-identifier hs-var hs-var">orTail</span></a></span></span><span> </span><span id="local-6989586621679145700"><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><a href="#local-6989586621679145700"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m (Either StoreError b)] -&gt; m (Either StoreError b)
</span><a href="#local-6989586621679145709"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><a href="#local-6989586621679145700"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><a href="#local-6989586621679145701"><span class="hs-identifier hs-var">orTail</span></a></span><span> </span><span class="annot"><span class="annottext">[m (Either StoreError b)]
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621679145699"><span class="annot"><span class="annottext">Either StoreError b
</span><a href="#local-6989586621679145699"><span class="hs-identifier hs-var">success</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError b
</span><a href="#local-6989586621679145699"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span id="local-6989586621679146226"><span id="local-6989586621679146227"><span class="annot"><a href="Crypto.Store.CMS.html#siAttemps"><span class="hs-identifier hs-type">siAttemps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679146227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679146226"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679146226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679146227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-467"></span><span id="siAttemps"><span class="annot"><span class="annottext">siAttemps :: forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; m Bool) -&gt; [a] -&gt; m Bool
</span><a href="Crypto.Store.CMS.html#siAttemps"><span class="hs-identifier hs-var hs-var">siAttemps</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Crypto.Store.CMS.html#siAttemps"><span class="hs-identifier hs-var">siAttemps</span></a></span><span> </span><span id="local-6989586621679145694"><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679145694"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679145693"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679145693"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679145692"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679145692"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679145694"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679145693"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
</span><a href="#local-6989586621679145691"><span class="hs-identifier hs-var">orTail</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679145691"><span class="annot"><span class="annottext">orTail :: Bool -&gt; m Bool
</span><a href="#local-6989586621679145691"><span class="hs-identifier hs-var hs-var">orTail</span></a></span></span><span> </span><span id="local-6989586621679145688"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145688"><span class="hs-identifier hs-var">bool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679145688"><span class="hs-identifier hs-var">bool</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; m Bool) -&gt; [a] -&gt; m Bool
</span><a href="Crypto.Store.CMS.html#siAttemps"><span class="hs-identifier hs-var">siAttemps</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679145694"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679145692"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span id="local-6989586621679146218"><span class="annot"><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-type">decode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1Event</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679146218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679146218"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-472"></span><span id="decode"><span class="annot"><span class="annottext">decode :: forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var hs-var">decode</span></a></span></span><span> </span><span id="local-6989586621679145684"><span class="annot"><span class="annottext">ParseASN1 [ASN1Event] a
</span><a href="#local-6989586621679145684"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679145683"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145683"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either StoreError [ASN1Repr]
</span><a href="#local-6989586621679145682"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
</span><a href="Crypto.Store.Util.html#mapLeft"><span class="hs-identifier hs-var">mapLeft</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; StoreError
</span><a href="Crypto.Store.Error.html#ParseFailure"><span class="hs-identifier hs-var">ParseFailure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall e a.
Monoid e =&gt;
ParseASN1 e a -&gt; [(ASN1, e)] -&gt; Either String a
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1_"><span class="hs-identifier hs-var">runParseASN1_</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 [ASN1Event] a
</span><a href="#local-6989586621679145684"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679145682"><span class="annot"><span class="annottext">vals :: Either StoreError [ASN1Repr]
</span><a href="#local-6989586621679145682"><span class="hs-identifier hs-var hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
</span><a href="Crypto.Store.Util.html#mapLeft"><span class="hs-identifier hs-var">mapLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; StoreError
</span><a href="Crypto.Store.Error.html#DecodingError"><span class="hs-identifier hs-var">DecodingError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
ASN1DecodingRepr a =&gt;
a -&gt; EncapsulatedContent -&gt; Either ASN1Error [ASN1Repr]
</span><span class="hs-identifier hs-var">decodeASN1Repr'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145683"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- | Encode the information for encapsulation in another content info.</span><span>
</span><span id="line-476"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-type">encapsulate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-477"></span><span id="encapsulate"><span class="annot"><span class="annottext">encapsulate :: ContentInfo -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var hs-var">encapsulate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#DataCI"><span class="hs-identifier hs-type">DataCI</span></a></span><span> </span><span id="local-6989586621679145672"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145672"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145672"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-478"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#SignedDataCI"><span class="hs-identifier hs-type">SignedDataCI</span></a></span><span> </span><span id="local-6989586621679145670"><span class="annot"><span class="annottext">SignedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145670"><span class="hs-identifier hs-var">ed</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">SignedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145670"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-479"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#EnvelopedDataCI"><span class="hs-identifier hs-type">EnvelopedDataCI</span></a></span><span> </span><span id="local-6989586621679145668"><span class="annot"><span class="annottext">EnvelopedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145668"><span class="hs-identifier hs-var">ed</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">EnvelopedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145668"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-480"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#DigestedDataCI"><span class="hs-identifier hs-type">DigestedDataCI</span></a></span><span> </span><span id="local-6989586621679145666"><span class="annot"><span class="annottext">DigestedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145666"><span class="hs-identifier hs-var">dd</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">DigestedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145666"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-481"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#EncryptedDataCI"><span class="hs-identifier hs-type">EncryptedDataCI</span></a></span><span> </span><span id="local-6989586621679145664"><span class="annot"><span class="annottext">EncryptedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145664"><span class="hs-identifier hs-var">ed</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145664"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-482"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#AuthenticatedDataCI"><span class="hs-identifier hs-type">AuthenticatedDataCI</span></a></span><span> </span><span id="local-6989586621679145662"><span class="annot"><span class="annottext">AuthenticatedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145662"><span class="hs-identifier hs-var">ad</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145662"><span class="hs-identifier hs-var">ad</span></a></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Crypto.Store.CMS.html#encapsulate"><span class="hs-identifier hs-var">encapsulate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Info.html#AuthEnvelopedDataCI"><span class="hs-identifier hs-type">AuthEnvelopedDataCI</span></a></span><span> </span><span id="local-6989586621679145660"><span class="annot"><span class="annottext">AuthEnvelopedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145660"><span class="hs-identifier hs-var">ae</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall obj.
ProduceASN1Object ASN1P obj =&gt;
obj -&gt; EncapsulatedContent
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">AuthEnvelopedData (Encap EncapsulatedContent)
</span><a href="#local-6989586621679145660"><span class="hs-identifier hs-var">ae</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- | Decode the information from encapsulated content.</span><span>
</span><span id="line-486"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-type">decapsulate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Info.html#ContentInfo"><span class="hs-identifier hs-type">ContentInfo</span></a></span><span>
</span><span id="line-487"></span><span id="decapsulate"><span class="annot"><span class="annottext">decapsulate :: ContentType -&gt; EncapsulatedContent -&gt; Either StoreError ContentInfo
</span><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var hs-var">decapsulate</span></a></span></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#DataType"><span class="hs-identifier hs-var">DataType</span></a></span><span> </span><span id="local-6989586621679145658"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145658"><span class="hs-identifier hs-var">bs</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncapsulatedContent -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#DataCI"><span class="hs-identifier hs-var">DataCI</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145658"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#SignedDataType"><span class="hs-identifier hs-var">SignedDataType</span></a></span><span> </span><span id="local-6989586621679145656"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145656"><span class="hs-identifier hs-var">bs</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignedData (Encap EncapsulatedContent) -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#SignedDataCI"><span class="hs-identifier hs-var">SignedDataCI</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145656"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-489"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#EnvelopedDataType"><span class="hs-identifier hs-var">EnvelopedDataType</span></a></span><span> </span><span id="local-6989586621679145653"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145653"><span class="hs-identifier hs-var">bs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EnvelopedData (Encap EncapsulatedContent) -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#EnvelopedDataCI"><span class="hs-identifier hs-var">EnvelopedDataCI</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145653"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-490"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#DigestedDataType"><span class="hs-identifier hs-var">DigestedDataType</span></a></span><span> </span><span id="local-6989586621679145651"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145651"><span class="hs-identifier hs-var">bs</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DigestedData (Encap EncapsulatedContent) -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#DigestedDataCI"><span class="hs-identifier hs-var">DigestedDataCI</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145651"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#EncryptedDataType"><span class="hs-identifier hs-var">EncryptedDataType</span></a></span><span> </span><span id="local-6989586621679145649"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145649"><span class="hs-identifier hs-var">bs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncryptedData (Encap EncapsulatedContent) -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#EncryptedDataCI"><span class="hs-identifier hs-var">EncryptedDataCI</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145649"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#AuthenticatedDataType"><span class="hs-identifier hs-var">AuthenticatedDataType</span></a></span><span> </span><span id="local-6989586621679145647"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145647"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthenticatedData (Encap EncapsulatedContent) -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#AuthenticatedDataCI"><span class="hs-identifier hs-var">AuthenticatedDataCI</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145647"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Crypto.Store.CMS.html#decapsulate"><span class="hs-identifier hs-var">decapsulate</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="Crypto.Store.CMS.Type.html#AuthEnvelopedDataType"><span class="hs-identifier hs-var">AuthEnvelopedDataType</span></a></span><span> </span><span id="local-6989586621679145645"><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145645"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthEnvelopedData (Encap EncapsulatedContent) -&gt; ContentInfo
</span><a href="Crypto.Store.CMS.Info.html#AuthEnvelopedDataCI"><span class="hs-identifier hs-var">AuthEnvelopedDataCI</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ParseASN1 [ASN1Event] a
-&gt; EncapsulatedContent -&gt; Either StoreError a
</span><a href="Crypto.Store.CMS.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">EncapsulatedContent
</span><a href="#local-6989586621679145645"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-494"></span></pre></body></html>